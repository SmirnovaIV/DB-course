<?php
 ob_start();class phpGSB {var $apikey  = "";var $version  = "0.2";var $realversion= "0.2.4";var $apiversion = "2.3";var $ob   = "";var $adminemail = "";var $usinglists = array('googpub-phish-shavar','goog-malware-shavar');var $mainlist = array();var $verbose = true;var $transtarted= false;var $transenabled=true;var $pingfilepath="";function phpGSB($v11e0eed8d3696c0a632f822df385ab3c=false,$v14c4b06b824ec593239362517f538b29=false,$v5f4dcc3b5aa765d61d8327deb882cf99=false,$v67b3dba8bc6778101892eb77249db32e="localhost",$v2c7aea4237e25b4f8ee3b0bf77d6fed0=true)  {if(!$v2c7aea4237e25b4f8ee3b0bf77d6fed0)    $this->silent();if($v11e0eed8d3696c0a632f822df385ab3c&&$v14c4b06b824ec593239362517f538b29)     $this->dbConnect($v11e0eed8d3696c0a632f822df385ab3c,$v14c4b06b824ec593239362517f538b29,$v5f4dcc3b5aa765d61d8327deb882cf99,$v67b3dba8bc6778101892eb77249db32e);}function close()  {mysql_close();$this->outputmsg("Closing phpGSB. (Peak Memory: ".(round(memory_get_peak_usage()/1048576,3))."MB)");}function silent()  {$this->verbose = false;}function trans_disable()  {$this->transenabled = false;}function trans_enable()  {$this->transenabled = true;}function trans_begin()  {if($this->transenabled)   {$this->transtarted = true;$this->outputmsg("Begin MySQL Transaction");mysql_query("BEGIN");}}function trans_commit()  {if($this->transtarted&&mysql_ping()&&$this->transenabled)   {$this->transtarted = false;$this->outputmsg("Comitting Transaction");mysql_query("COMMIT");}}function trans_rollback()  {if($this->transtarted&&mysql_ping()&&$this->transenabled)   {$this->transtarted = false;$this->outputmsg("Rolling Back Transaction");mysql_query("ROLLBACK");}}function outputmsg($v6e2baaf3b97dbeef01c0043275f9a0e7)  {if($this->verbose)   {echo $v6e2baaf3b97dbeef01c0043275f9a0e7.'...<br/>';$this->ob .= ob_get_contents();ob_flush();}}function fatalerror($v6e2baaf3b97dbeef01c0043275f9a0e7)  {if($this->verbose)   {print_r($v6e2baaf3b97dbeef01c0043275f9a0e7);echo '...<br/>';$this->ob .= ob_get_contents();ob_end_flush();}$this->trans_rollback();die();}function dbConnect($v11e0eed8d3696c0a632f822df385ab3c,$v14c4b06b824ec593239362517f538b29,$v5f4dcc3b5aa765d61d8327deb882cf99,$v67b3dba8bc6778101892eb77249db32e="localhost")  {$v2a304a1348456ccd2234cd71a81bd338 = mysql_connect($v67b3dba8bc6778101892eb77249db32e, $v14c4b06b824ec593239362517f538b29, $v5f4dcc3b5aa765d61d8327deb882cf99);if (!$v2a304a1348456ccd2234cd71a81bd338) {$this->fatalerror('Could not connect: ' . mysql_error());}$this->outputmsg('Connected successfully to database server');$vdcf2d52423a44d70c72c606e2820deee = mysql_select_db($v11e0eed8d3696c0a632f822df385ab3c, $v2a304a1348456ccd2234cd71a81bd338);if (!$vdcf2d52423a44d70c72c606e2820deee) {$this->fatalerror('Can\'t use $database : ' . mysql_error());}$this->outputmsg('Connected to database successfully');}function calc($v07213a0161f52846ab198be103b5ab43)  {if($v07213a0161f52846ab198be103b5ab43==1)   {return 60;}elseif($v07213a0161f52846ab198be103b5ab43>5)   {return 28800;}else   {return floor((pow(2,$v07213a0161f52846ab198be103b5ab43) * 7.5) * ((rand(0,1000)/1000) + 1));}}function Backoff($v6134868d557a12c94ece2d0e28e2c663=false,$v599dcce2998a6b40b1e38e8c6006cb0a)  {if($v599dcce2998a6b40b1e38e8c6006cb0a=="data")    $v8c7dd922ad47494fc02c388e12c00eac = 'nextcheck.dat';else    $v8c7dd922ad47494fc02c388e12c00eac = 'nextcheckl.dat';$vab1a998cb466cb61b883ed74d44507e8 = explode('||',file_get_contents($this->pingfilepath.$v8c7dd922ad47494fc02c388e12c00eac));$vab1a998cb466cb61b883ed74d44507e8[1] = $vab1a998cb466cb61b883ed74d44507e8[1] + 1;$v783e8e29e6a8c3e22baa58a19420eb4f = $this->calc($vab1a998cb466cb61b883ed74d44507e8[1]);$v3103a7d8f63cb184287c558ca51c6160 = time()+$v783e8e29e6a8c3e22baa58a19420eb4f.'||'.$vab1a998cb466cb61b883ed74d44507e8[1];file_put_contents($this->pingfilepath.$v8c7dd922ad47494fc02c388e12c00eac,$v3103a7d8f63cb184287c558ca51c6160);$this->fatalerror(array("Invalid Response... Backing Off",$v6134868d557a12c94ece2d0e28e2c663));}function setTimeout($v783e8e29e6a8c3e22baa58a19420eb4f)  {$vab1a998cb466cb61b883ed74d44507e8 = explode('||',file_get_contents($this->pingfilepath.'nextcheck.dat'));$v3103a7d8f63cb184287c558ca51c6160 = time()+$v783e8e29e6a8c3e22baa58a19420eb4f.'||'.$vab1a998cb466cb61b883ed74d44507e8[1];file_put_contents($this->pingfilepath.'nextcheck.dat',$v3103a7d8f63cb184287c558ca51c6160);}function checkTimeout($v599dcce2998a6b40b1e38e8c6006cb0a)  {if($v599dcce2998a6b40b1e38e8c6006cb0a=="data")    $v8c7dd922ad47494fc02c388e12c00eac = 'nextcheck.dat';else    $v8c7dd922ad47494fc02c388e12c00eac = 'nextcheckl.dat';$vab1a998cb466cb61b883ed74d44507e8 = explode('||',file_get_contents($this->pingfilepath.$v8c7dd922ad47494fc02c388e12c00eac));if(time()<$vab1a998cb466cb61b883ed74d44507e8[0])   {$this->fatalerror("Must wait another ".($vab1a998cb466cb61b883ed74d44507e8[0]-time()). " seconds before another request");}else    $this->outputmsg("Allowed to request");}function googleDownloader($v572d4e421e5e6b9bc11d815e8a027112,$v93da65a9fd0004d9477aeac024e08e15,$v25dbdb0c49fe37d19deca9524b55a5b9=false)  {$vd88fc6edf21ea464d35ff76288b84103 = curl_init();curl_setopt($vd88fc6edf21ea464d35ff76288b84103, CURLOPT_URL, $v572d4e421e5e6b9bc11d815e8a027112);curl_setopt($vd88fc6edf21ea464d35ff76288b84103, CURLOPT_HEADER, 0);curl_setopt($vd88fc6edf21ea464d35ff76288b84103, CURLOPT_FOLLOWLOCATION, true);curl_setopt($vd88fc6edf21ea464d35ff76288b84103, CURLOPT_RETURNTRANSFER, true);if(is_array($v93da65a9fd0004d9477aeac024e08e15))    curl_setopt_array($vd88fc6edf21ea464d35ff76288b84103, $v93da65a9fd0004d9477aeac024e08e15);$v8d777f385d3dfec8815d20f7496026dc = curl_exec($vd88fc6edf21ea464d35ff76288b84103);$vcaf9b6b99962bf5c2264824231d7a40c = curl_getinfo($vd88fc6edf21ea464d35ff76288b84103);curl_close($vd88fc6edf21ea464d35ff76288b84103);if($v25dbdb0c49fe37d19deca9524b55a5b9&&$vcaf9b6b99962bf5c2264824231d7a40c['http_code']>299)   {$this->Backoff($vcaf9b6b99962bf5c2264824231d7a40c,$v25dbdb0c49fe37d19deca9524b55a5b9);}return array($vcaf9b6b99962bf5c2264824231d7a40c,$v8d777f385d3dfec8815d20f7496026dc);}function resetDatabase()  {if(!empty($this->adminemail))    mail($this->adminemail,'Reset Database Request Issued','For some crazy unknown reason GSB requested a database reset at '.time());foreach($this->usinglists as $v2063c1608d6e0baf80249c42e2be5804)   {mysql_query("TRUNCATE TABLE `$v2063c1608d6e0baf80249c42e2be5804-s-index`");mysql_query("TRUNCATE TABLE `$v2063c1608d6e0baf80249c42e2be5804-s-hosts`");mysql_query("TRUNCATE TABLE `$v2063c1608d6e0baf80249c42e2be5804-s-prefixes`");mysql_query("TRUNCATE TABLE `$v2063c1608d6e0baf80249c42e2be5804-a-index`");mysql_query("TRUNCATE TABLE `$v2063c1608d6e0baf80249c42e2be5804-a-hosts`");mysql_query("TRUNCATE TABLE `$v2063c1608d6e0baf80249c42e2be5804-a-prefixes`");}}function processChunks($v55a9a43166ae6f653db9ab59e745e043,$v63f9ef60d1a8cf9e83dafb175219c324)  {$v2c4251e65e89bf6d4e1856899b365ff7 = array();$v6370c43af2a003d5a5ac13c67c93cbc3 = array();$v90f4e3995492727f4f13e1bc72476f7b = trim($v55a9a43166ae6f653db9ab59e745e043);$v3148fde04e50c5ab9b86a48b3e090c06 = $v90f4e3995492727f4f13e1bc72476f7b;while(strlen($v3148fde04e50c5ab9b86a48b3e090c06)>0)   {$vcb6c4d2d5034d3e7276e1b1654eb4662 = explode("\n",$v3148fde04e50c5ab9b86a48b3e090c06,2);$vf30cc4644adebccc12cc1ebf57d426d1 = explode(':',$vcb6c4d2d5034d3e7276e1b1654eb4662[0]);$v599dcce2998a6b40b1e38e8c6006cb0a = $vf30cc4644adebccc12cc1ebf57d426d1[0];$v7a96c8563cec784ca00fa1bbff2cea36 = $vf30cc4644adebccc12cc1ebf57d426d1[1];$vd4fe46374d7d015eaa1377f1c48bf022 = $vf30cc4644adebccc12cc1ebf57d426d1[2];$v8e6d793671fd3f7bfd71966dd6f198c0 = $vf30cc4644adebccc12cc1ebf57d426d1[3];if($v8e6d793671fd3f7bfd71966dd6f198c0>0)    {$ve29fb666a4c007a90ffdad8adf310db7 = array();$v18118dbc1e15fb3e701effb6b7546886 = bin2hex(substr($vcb6c4d2d5034d3e7276e1b1654eb4662[1],0,$v8e6d793671fd3f7bfd71966dd6f198c0));if($v599dcce2998a6b40b1e38e8c6006cb0a=='a')     {$v51e6270ef0203137c8168333d157a050 = 0;while(strlen($v18118dbc1e15fb3e701effb6b7546886)>0)      {$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['HOSTKEY'] = substr($v18118dbc1e15fb3e701effb6b7546886, 0, 8);$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['COUNT'] = substr($v18118dbc1e15fb3e701effb6b7546886, 8, 2);$v18118dbc1e15fb3e701effb6b7546886 = substr($v18118dbc1e15fb3e701effb6b7546886,10);$v89b67c967e46b0855b67ea3d5598778c = hexdec($ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['COUNT']);if($v89b67c967e46b0855b67ea3d5598778c>0)       {for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v89b67c967e46b0855b67ea3d5598778c;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['PAIRS'][$v865c0c0b4ab0e063e5caa3387c1a8741]['PREFIX'] = substr($v18118dbc1e15fb3e701effb6b7546886, 0, ($vd4fe46374d7d015eaa1377f1c48bf022*2));$v18118dbc1e15fb3e701effb6b7546886 = substr($v18118dbc1e15fb3e701effb6b7546886,(($vd4fe46374d7d015eaa1377f1c48bf022*2)));}}elseif($v89b67c967e46b0855b67ea3d5598778c<0)       {$this->fatalerror(array("Decoding Error, Somethings gone wrong!",$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]));}$v51e6270ef0203137c8168333d157a050++;}$v6370c43af2a003d5a5ac13c67c93cbc3['CHUNKNUM'] = $v7a96c8563cec784ca00fa1bbff2cea36;$v6370c43af2a003d5a5ac13c67c93cbc3['HASHLEN'] = $vd4fe46374d7d015eaa1377f1c48bf022;$v6370c43af2a003d5a5ac13c67c93cbc3['CHUNKLEN'] = $v8e6d793671fd3f7bfd71966dd6f198c0;$v6370c43af2a003d5a5ac13c67c93cbc3['REAL'] = $ve29fb666a4c007a90ffdad8adf310db7;$this->saveChunkPart($v6370c43af2a003d5a5ac13c67c93cbc3,"ADD",$v63f9ef60d1a8cf9e83dafb175219c324);unset($v6370c43af2a003d5a5ac13c67c93cbc3);}elseif($v599dcce2998a6b40b1e38e8c6006cb0a=='s')     {$v51e6270ef0203137c8168333d157a050 = 0;while(strlen($v18118dbc1e15fb3e701effb6b7546886)>0)      {$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['HOSTKEY'] = substr($v18118dbc1e15fb3e701effb6b7546886, 0, 8);$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['COUNT'] = substr($v18118dbc1e15fb3e701effb6b7546886, 8, 2);$v18118dbc1e15fb3e701effb6b7546886 = substr($v18118dbc1e15fb3e701effb6b7546886,10);$v89b67c967e46b0855b67ea3d5598778c = hexdec($ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['COUNT']);if($v89b67c967e46b0855b67ea3d5598778c>0)       {for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v89b67c967e46b0855b67ea3d5598778c;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['PAIRS'][$v865c0c0b4ab0e063e5caa3387c1a8741]['ADDCHUNKNUM'] = substr($v18118dbc1e15fb3e701effb6b7546886, 0, 8);$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['PAIRS'][$v865c0c0b4ab0e063e5caa3387c1a8741]['PREFIX'] = substr($v18118dbc1e15fb3e701effb6b7546886, 8, ($vd4fe46374d7d015eaa1377f1c48bf022*2));$v18118dbc1e15fb3e701effb6b7546886 = substr($v18118dbc1e15fb3e701effb6b7546886,(($vd4fe46374d7d015eaa1377f1c48bf022*2)+8));}}elseif($v89b67c967e46b0855b67ea3d5598778c==0)       {$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]['PAIRS'][0]['ADDCHUNKNUM'] = substr($v18118dbc1e15fb3e701effb6b7546886, 0, 8);$v18118dbc1e15fb3e701effb6b7546886 = substr($v18118dbc1e15fb3e701effb6b7546886, 8);}else       {$this->fatalerror(array("Decoding Error, Somethings gone wrong!",$ve29fb666a4c007a90ffdad8adf310db7[$v51e6270ef0203137c8168333d157a050]));}$v51e6270ef0203137c8168333d157a050++;}$v2c4251e65e89bf6d4e1856899b365ff7['CHUNKNUM'] = $v7a96c8563cec784ca00fa1bbff2cea36;$v2c4251e65e89bf6d4e1856899b365ff7['HASHLEN'] = $vd4fe46374d7d015eaa1377f1c48bf022;$v2c4251e65e89bf6d4e1856899b365ff7['CHUNKLEN'] = $v8e6d793671fd3f7bfd71966dd6f198c0;$v2c4251e65e89bf6d4e1856899b365ff7['REAL'] = $ve29fb666a4c007a90ffdad8adf310db7;$this->saveChunkPart($v2c4251e65e89bf6d4e1856899b365ff7,"SUB",$v63f9ef60d1a8cf9e83dafb175219c324);unset($v2c4251e65e89bf6d4e1856899b365ff7);}else     {$this->outputmsg("DISCARDED CHUNKNUM: $v7a96c8563cec784ca00fa1bbff2cea36 (Had no valid label)");}}else    {if($v599dcce2998a6b40b1e38e8c6006cb0a=='a')     {$v6370c43af2a003d5a5ac13c67c93cbc3['CHUNKNUM'] = $v7a96c8563cec784ca00fa1bbff2cea36;$v6370c43af2a003d5a5ac13c67c93cbc3['HASHLEN'] = $vd4fe46374d7d015eaa1377f1c48bf022;$v6370c43af2a003d5a5ac13c67c93cbc3['CHUNKLEN'] = $v8e6d793671fd3f7bfd71966dd6f198c0;$this->saveChunkPart($v6370c43af2a003d5a5ac13c67c93cbc3,"ADD",$v63f9ef60d1a8cf9e83dafb175219c324);unset($v6370c43af2a003d5a5ac13c67c93cbc3);}elseif($v599dcce2998a6b40b1e38e8c6006cb0a=='s')     {$v2c4251e65e89bf6d4e1856899b365ff7['CHUNKNUM'] = $v7a96c8563cec784ca00fa1bbff2cea36;$v2c4251e65e89bf6d4e1856899b365ff7['HASHLEN'] = $vd4fe46374d7d015eaa1377f1c48bf022;$v2c4251e65e89bf6d4e1856899b365ff7['CHUNKLEN'] = $v8e6d793671fd3f7bfd71966dd6f198c0;$this->saveChunkPart($v2c4251e65e89bf6d4e1856899b365ff7,"SUB",$v63f9ef60d1a8cf9e83dafb175219c324);unset($v2c4251e65e89bf6d4e1856899b365ff7);}else     {$this->outputmsg("DISCARDED CHUNKNUM: $v7a96c8563cec784ca00fa1bbff2cea36 (Empty)");}}$v3148fde04e50c5ab9b86a48b3e090c06 = substr($vcb6c4d2d5034d3e7276e1b1654eb4662[1],$v8e6d793671fd3f7bfd71966dd6f198c0);}return true;}function saveChunkPart($v8d777f385d3dfec8815d20f7496026dc,$v599dcce2998a6b40b1e38e8c6006cb0a,$v63f9ef60d1a8cf9e83dafb175219c324)  {$v63f9ef60d1a8cf9e83dafb175219c324 = trim($v63f9ef60d1a8cf9e83dafb175219c324);$v9802498ba78929acf03f331e5ff3792b = array();$v69d0be523d3d20c6b8a4d86d28b38425 = array();$v02e626748d7fd2eb64d838e038ea5bc3 = array();if($v599dcce2998a6b40b1e38e8c6006cb0a=="SUB")   {$v2063c1608d6e0baf80249c42e2be5804 = $v8d777f385d3dfec8815d20f7496026dc;if(!isset($this->mainlist['s'][$v63f9ef60d1a8cf9e83dafb175219c324][$v2063c1608d6e0baf80249c42e2be5804['CHUNKNUM']]))    {$this->mainlist['s'][$v63f9ef60d1a8cf9e83dafb175219c324][$v2063c1608d6e0baf80249c42e2be5804['CHUNKNUM']] = true;$v9802498ba78929acf03f331e5ff3792b[] = "('{$v2063c1608d6e0baf80249c42e2be5804['CHUNKNUM']}','{$v2063c1608d6e0baf80249c42e2be5804['CHUNKLEN']}')";if($v2063c1608d6e0baf80249c42e2be5804['CHUNKLEN']>0)     {foreach($v2063c1608d6e0baf80249c42e2be5804['REAL'] as $v1fdd50b19896cfbf2e5acc30487e09e2=>$v10249b906046c4dfb392f99ecdedbad0)      {$v69d0be523d3d20c6b8a4d86d28b38425[] = "('{$v10249b906046c4dfb392f99ecdedbad0['HOSTKEY']}','{$v2063c1608d6e0baf80249c42e2be5804['CHUNKNUM']}','{$v10249b906046c4dfb392f99ecdedbad0['COUNT']}','')";if(isset($v10249b906046c4dfb392f99ecdedbad0['PAIRS'])&&count($v10249b906046c4dfb392f99ecdedbad0['PAIRS'])>0)       {foreach($v10249b906046c4dfb392f99ecdedbad0['PAIRS'] as $v19eb78cc0dfe2f90105cbe3a4eef2e8c=>$v711b07cf4c9fe2bbfd33be94b1cb76b4)        {if( isset($v711b07cf4c9fe2bbfd33be94b1cb76b4['PREFIX']) ) {$v02e626748d7fd2eb64d838e038ea5bc3[] = "('{$v10249b906046c4dfb392f99ecdedbad0['HOSTKEY']}','{$v711b07cf4c9fe2bbfd33be94b1cb76b4['ADDCHUNKNUM']}','{$v711b07cf4c9fe2bbfd33be94b1cb76b4['PREFIX']}','')";}else {$v02e626748d7fd2eb64d838e038ea5bc3[] = "('{$v10249b906046c4dfb392f99ecdedbad0['HOSTKEY']}','{$v711b07cf4c9fe2bbfd33be94b1cb76b4['ADDCHUNKNUM']}','','')";}}}}}}}else if($v599dcce2998a6b40b1e38e8c6006cb0a=="ADD")    {$v2063c1608d6e0baf80249c42e2be5804 = $v8d777f385d3dfec8815d20f7496026dc;if(!isset($this->mainlist['a'][$v63f9ef60d1a8cf9e83dafb175219c324][$v2063c1608d6e0baf80249c42e2be5804['CHUNKNUM']]))     {$this->mainlist['a'][$v63f9ef60d1a8cf9e83dafb175219c324][$v2063c1608d6e0baf80249c42e2be5804['CHUNKNUM']] = true;$v9802498ba78929acf03f331e5ff3792b[] = "('{$v2063c1608d6e0baf80249c42e2be5804['CHUNKNUM']}','{$v2063c1608d6e0baf80249c42e2be5804['CHUNKLEN']}')";if($v2063c1608d6e0baf80249c42e2be5804['CHUNKLEN']>0)      {foreach($v2063c1608d6e0baf80249c42e2be5804['REAL'] as $v1fdd50b19896cfbf2e5acc30487e09e2=>$v10249b906046c4dfb392f99ecdedbad0)       {$v69d0be523d3d20c6b8a4d86d28b38425[] = "('{$v10249b906046c4dfb392f99ecdedbad0['HOSTKEY']}','{$v2063c1608d6e0baf80249c42e2be5804['CHUNKNUM']}','{$v10249b906046c4dfb392f99ecdedbad0['COUNT']}','')";if(isset($v10249b906046c4dfb392f99ecdedbad0['PAIRS'])&&count($v10249b906046c4dfb392f99ecdedbad0['PAIRS'])>0)        {foreach($v10249b906046c4dfb392f99ecdedbad0['PAIRS'] as $v19eb78cc0dfe2f90105cbe3a4eef2e8c=>$v711b07cf4c9fe2bbfd33be94b1cb76b4)         {if( isset($v711b07cf4c9fe2bbfd33be94b1cb76b4['PREFIX']) ) {$v02e626748d7fd2eb64d838e038ea5bc3[] = "('{$v10249b906046c4dfb392f99ecdedbad0['HOSTKEY']}','{$v711b07cf4c9fe2bbfd33be94b1cb76b4['PREFIX']}','')";}else {$v02e626748d7fd2eb64d838e038ea5bc3[] = "('{$v10249b906046c4dfb392f99ecdedbad0['HOSTKEY']}','','')";}}}}}}}if(count($v9802498ba78929acf03f331e5ff3792b)>0)   {if($v599dcce2998a6b40b1e38e8c6006cb0a=="ADD")     $v3b2a8bb8f3b642bcd60b5093fe30b0e5 = 'a';elseif($v599dcce2998a6b40b1e38e8c6006cb0a=="SUB")     $v3b2a8bb8f3b642bcd60b5093fe30b0e5 = 's';$v025991550441a3d1d3167b9df8665ae6 = implode(', ',$v9802498ba78929acf03f331e5ff3792b);$v50eee823668524538a1938f43e3c6d63 = mysql_query("INSERT INTO `$v63f9ef60d1a8cf9e83dafb175219c324-$v3b2a8bb8f3b642bcd60b5093fe30b0e5-index` (`ChunkNum`,`Chunklen`) VALUES $v025991550441a3d1d3167b9df8665ae6;");$vcb5e100e5a9a3e7f6d1fd97512215282 = mysql_error();if($v50eee823668524538a1938f43e3c6d63)    {if(count($v69d0be523d3d20c6b8a4d86d28b38425)>0)     {$v8d99628870129b85f93ef7b579a53eda = implode(', ',$v69d0be523d3d20c6b8a4d86d28b38425);mysql_query("INSERT INTO `$v63f9ef60d1a8cf9e83dafb175219c324-$v3b2a8bb8f3b642bcd60b5093fe30b0e5-hosts` (`Hostkey`,`Chunknum`,`Count`,`FullHash`) VALUES $v8d99628870129b85f93ef7b579a53eda;");$vcb5e100e5a9a3e7f6d1fd97512215282 = mysql_error();if(!empty($vcb5e100e5a9a3e7f6d1fd97512215282))       $this->outputmsg("INSERTED $v63f9ef60d1a8cf9e83dafb175219c324 $v599dcce2998a6b40b1e38e8c6006cb0a HOST KEYS ".mysql_error());}if(count($v02e626748d7fd2eb64d838e038ea5bc3)>0)     {$v3e04b64a11435e65c167595ef867a48e = implode(', ',$v02e626748d7fd2eb64d838e038ea5bc3);if($v599dcce2998a6b40b1e38e8c6006cb0a=="ADD")       mysql_query("INSERT INTO `$v63f9ef60d1a8cf9e83dafb175219c324-$v3b2a8bb8f3b642bcd60b5093fe30b0e5-prefixes` (`Hostkey`,`Prefix`,`FullHash`) VALUES $v3e04b64a11435e65c167595ef867a48e;");elseif($v599dcce2998a6b40b1e38e8c6006cb0a=="SUB")       mysql_query("INSERT INTO `$v63f9ef60d1a8cf9e83dafb175219c324-$v3b2a8bb8f3b642bcd60b5093fe30b0e5-prefixes` (`Hostkey`,`AddChunkNum`,`Prefix`,`FullHash`) VALUES $v3e04b64a11435e65c167595ef867a48e;");$vcb5e100e5a9a3e7f6d1fd97512215282 = mysql_error();if(!empty($vcb5e100e5a9a3e7f6d1fd97512215282))       $this->outputmsg("INSERTED $v63f9ef60d1a8cf9e83dafb175219c324 $v599dcce2998a6b40b1e38e8c6006cb0a PREFIX HOST KEYS ".mysql_error());}}elseif(!empty($vcb5e100e5a9a3e7f6d1fd97512215282))     $this->outputmsg("COULD NOT SAVE $v63f9ef60d1a8cf9e83dafb175219c324 $v599dcce2998a6b40b1e38e8c6006cb0a INDEXS ".mysql_error());}}function getRanges($v63f9ef60d1a8cf9e83dafb175219c324,$v15d61712450a686a7f365adf4fef581f)  {$v2c6c93bd8aace73ba864ea45a632fc9d = $v63f9ef60d1a8cf9e83dafb175219c324.'-'.$v15d61712450a686a7f365adf4fef581f.'-index';$v53e61336bb49ec978968786b07dea50b = mysql_query("SELECT ChunkNum FROM `$v2c6c93bd8aace73ba864ea45a632fc9d` ORDER BY `ChunkNum` ASC");$v8d8102fb58fd9e8e1b76f1907171bc97 = array();$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($v53e61336bb49ec978968786b07dea50b, MYSQL_BOTH))   {$this->mainlist[$v15d61712450a686a7f365adf4fef581f][$v63f9ef60d1a8cf9e83dafb175219c324][$vf1965a857bc285d26fe22023aa5ab50d['ChunkNum']] = true;if($v865c0c0b4ab0e063e5caa3387c1a8741==0)    {$vea2b2676c28c0db26d39331a336c6b92 = $vf1965a857bc285d26fe22023aa5ab50d['ChunkNum'];$v2327346e833efcd6b2e7b3f0a4df8ebb = $vf1965a857bc285d26fe22023aa5ab50d['ChunkNum'];}else    {$vcd26d9e10ce691cc69aa2b90dcebbdac = $v2327346e833efcd6b2e7b3f0a4df8ebb + 1;if($vf1965a857bc285d26fe22023aa5ab50d['ChunkNum']!=$vcd26d9e10ce691cc69aa2b90dcebbdac)     {if($vea2b2676c28c0db26d39331a336c6b92==$v2327346e833efcd6b2e7b3f0a4df8ebb)       $v8d8102fb58fd9e8e1b76f1907171bc97[] = $vea2b2676c28c0db26d39331a336c6b92;else       $v8d8102fb58fd9e8e1b76f1907171bc97[] = $vea2b2676c28c0db26d39331a336c6b92.'-'.$v2327346e833efcd6b2e7b3f0a4df8ebb;$vea2b2676c28c0db26d39331a336c6b92 = $vf1965a857bc285d26fe22023aa5ab50d['ChunkNum'];}$v2327346e833efcd6b2e7b3f0a4df8ebb = $vf1965a857bc285d26fe22023aa5ab50d['ChunkNum'];}$v865c0c0b4ab0e063e5caa3387c1a8741++;}if($vea2b2676c28c0db26d39331a336c6b92>0&&$v2327346e833efcd6b2e7b3f0a4df8ebb>0)   {if($vea2b2676c28c0db26d39331a336c6b92==$v2327346e833efcd6b2e7b3f0a4df8ebb)     $v8d8102fb58fd9e8e1b76f1907171bc97[] = $vea2b2676c28c0db26d39331a336c6b92;else     $v8d8102fb58fd9e8e1b76f1907171bc97[] = $vea2b2676c28c0db26d39331a336c6b92.'-'.$v2327346e833efcd6b2e7b3f0a4df8ebb;}return $v8d8102fb58fd9e8e1b76f1907171bc97;}function getFullRanges($v63f9ef60d1a8cf9e83dafb175219c324)  {$vf56137c1dd8d2543aa4f8118cc68904d = $this->getRanges($v63f9ef60d1a8cf9e83dafb175219c324,'s');$ve4dd93321c911bb01add9a5a25af76b4 = $this->getRanges($v63f9ef60d1a8cf9e83dafb175219c324,'a');return array("Subranges"=>$vf56137c1dd8d2543aa4f8118cc68904d,"Addranges"=>$ve4dd93321c911bb01add9a5a25af76b4);}function formattedRequest($v63f9ef60d1a8cf9e83dafb175219c324)  {$v1d7e5b604a0e4cf071a3e7cf7107cc2f = $this->getFullRanges($v63f9ef60d1a8cf9e83dafb175219c324);$v539aafbe862bc4f896d356f15760fd45 = '';if(count($v1d7e5b604a0e4cf071a3e7cf7107cc2f['Subranges'])>0)    $v539aafbe862bc4f896d356f15760fd45 .= 's:'.implode(',',$v1d7e5b604a0e4cf071a3e7cf7107cc2f['Subranges']);if(count($v1d7e5b604a0e4cf071a3e7cf7107cc2f['Subranges'])>0&&count($v1d7e5b604a0e4cf071a3e7cf7107cc2f['Addranges'])>0)    $v539aafbe862bc4f896d356f15760fd45 .= ':';if(count($v1d7e5b604a0e4cf071a3e7cf7107cc2f['Addranges'])>0)    $v539aafbe862bc4f896d356f15760fd45 .= 'a:'.implode(',',$v1d7e5b604a0e4cf071a3e7cf7107cc2f['Addranges']);return $v63f9ef60d1a8cf9e83dafb175219c324.';'.$v539aafbe862bc4f896d356f15760fd45."\n";}function deleteRange($v37b19816109a32106d109e83bbb3c97d,$v15d61712450a686a7f365adf4fef581f,$v63f9ef60d1a8cf9e83dafb175219c324)  {$vb3cd90040f4d077d7c4f7cc436f0ebec = $v63f9ef60d1a8cf9e83dafb175219c324.'-'.$v15d61712450a686a7f365adf4fef581f;if(substr_count($v37b19816109a32106d109e83bbb3c97d,'-')>0)   {$va16e1f0f164f5e1621cd356bf13d1114 = explode('-',trim($v37b19816109a32106d109e83bbb3c97d));$vab1565439a9d158428f2caa7a8e33f52 = "`ChunkNum` >= '{$va16e1f0f164f5e1621cd356bf13d1114[0]}' AND `ChunkNum` <= '{$va16e1f0f164f5e1621cd356bf13d1114[1]}'";}else    $vab1565439a9d158428f2caa7a8e33f52 = "`ChunkNum` = '$v37b19816109a32106d109e83bbb3c97d'";mysql_query("DELETE FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-index` WHERE $vab1565439a9d158428f2caa7a8e33f52");$result = mysql_query("SELECT `Hostkey` FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-hosts` WHERE $vab1565439a9d158428f2caa7a8e33f52");$v3da4c651ccf2b47c1867910d4b06fbe4 = array();if($result&&mysql_num_rows($result)>0)   {while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result, MYSQL_ASSOC))    {if(!empty($vf1965a857bc285d26fe22023aa5ab50d['Hostkey']))      $v3da4c651ccf2b47c1867910d4b06fbe4[] = $vf1965a857bc285d26fe22023aa5ab50d['Hostkey'];}$v94a1f1a87f6cb225dc9fc80113cb21a7 = implode("' OR `Hostkey` = '",$v3da4c651ccf2b47c1867910d4b06fbe4);mysql_query("DELETE FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-prefixes` WHERE `Hostkey` = '$v94a1f1a87f6cb225dc9fc80113cb21a7'");mysql_query("DELETE FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-hosts` WHERE $vab1565439a9d158428f2caa7a8e33f52");}}function getData($v841a2d689ad86bd1611447453c22c6fc)  {if(empty($v841a2d689ad86bd1611447453c22c6fc))    $this->fatalerror("Missing a body for data request");$this->trans_begin();$v8f04f9c9d7c4d08367698d40c96c04fb = array(CURLOPT_POST=>true,CURLOPT_POSTFIELDS=>$v841a2d689ad86bd1611447453c22c6fc."\n");$result = $this->googleDownloader("http://sba.yandex.net/downloads?client=api&apikey=".$this->apikey."&appver=".$this->version."&pver=".$this->apiversion,$v8f04f9c9d7c4d08367698d40c96c04fb,"data");preg_match('/^n:(.*)$/m', $result[1], $ve3cc92c14a5e6dd1a7d94b6ff634d7fc);$v90272dda245ae1fb3cf197e91a8689dc = $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[1];$this->setTimeout($v90272dda245ae1fb3cf197e91a8689dc);if(substr_count($result[1],'r:pleasereset')>0)    $this->resetDatabase();else   {$vee1aeb5b7e25464af8971b2faca3ae25 = array();if(substr_count($result[1],'i:')>0)    {$v6c48b8edbe487618988d38b877fd2300 = explode('i:',$result[1]);unset($v6c48b8edbe487618988d38b877fd2300[0]);foreach($v6c48b8edbe487618988d38b877fd2300 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)     {$v70f381290ba9e911ccfe3573292682ec = explode("\n",trim($v2063c1608d6e0baf80249c42e2be5804));$v63f9ef60d1a8cf9e83dafb175219c324 = $v70f381290ba9e911ccfe3573292682ec[0];unset($v70f381290ba9e911ccfe3573292682ec[0]);$vee1aeb5b7e25464af8971b2faca3ae25[$v63f9ef60d1a8cf9e83dafb175219c324] = $v70f381290ba9e911ccfe3573292682ec;}foreach($vee1aeb5b7e25464af8971b2faca3ae25 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)     {$v63f9ef60d1a8cf9e83dafb175219c324 = $v3c6e0b8a9c15224a8228b9a98ca1531d;foreach($v2063c1608d6e0baf80249c42e2be5804 as $v34e09f165968553e1f324dba23b16ee4=>$v4c7397cfde0bd9cf2cab8dc6a49dce0a)      {if(substr_count($v4c7397cfde0bd9cf2cab8dc6a49dce0a,"u:")>0)       {$v18118dbc1e15fb3e701effb6b7546886 = $this->googleDownloader('http://'.trim(str_replace('u:','',$v4c7397cfde0bd9cf2cab8dc6a49dce0a)),false,"data");$v9d090a4005926e9e2a32e05cbd8c2fc6 = $this->processChunks($v18118dbc1e15fb3e701effb6b7546886[1],$v63f9ef60d1a8cf9e83dafb175219c324);$this->outputmsg("Saved a chunk file");}elseif(substr_count($v4c7397cfde0bd9cf2cab8dc6a49dce0a,"ad:")>0)       {if(substr_count($v4c7397cfde0bd9cf2cab8dc6a49dce0a,',')>0)        {$v4c7397cfde0bd9cf2cab8dc6a49dce0a = explode(',',trim(str_replace("ad:","",$v4c7397cfde0bd9cf2cab8dc6a49dce0a)));foreach($v4c7397cfde0bd9cf2cab8dc6a49dce0a as $va6bc828c5bb2b1f75e10b77f163bb920=>$v99f96e18636c884d2c8aca5b70dbead3)         {$this->deleteRange($v99f96e18636c884d2c8aca5b70dbead3,'a',$v63f9ef60d1a8cf9e83dafb175219c324);}}else         $this->deleteRange(trim(str_replace("ad:","",$v4c7397cfde0bd9cf2cab8dc6a49dce0a)),'a',$v63f9ef60d1a8cf9e83dafb175219c324);}elseif(substr_count($v4c7397cfde0bd9cf2cab8dc6a49dce0a,"sd:")>0)       {if(substr_count($v4c7397cfde0bd9cf2cab8dc6a49dce0a,',')>0)        {$v4c7397cfde0bd9cf2cab8dc6a49dce0a = explode(',',trim(str_replace("sd:","",$v4c7397cfde0bd9cf2cab8dc6a49dce0a)));foreach($v4c7397cfde0bd9cf2cab8dc6a49dce0a as $va6bc828c5bb2b1f75e10b77f163bb920=>$v99f96e18636c884d2c8aca5b70dbead3)         {$this->deleteRange($v99f96e18636c884d2c8aca5b70dbead3,'s',$v63f9ef60d1a8cf9e83dafb175219c324);}}else         $this->deleteRange(trim(str_replace("sd:","",$v4c7397cfde0bd9cf2cab8dc6a49dce0a)),'s',$v63f9ef60d1a8cf9e83dafb175219c324);}}}}else    {$this->outputmsg('No data available in list');}}$this->trans_commit();return true;}function runUpdate()  {$this->checkTimeout('data');$vf0ffd3b7c2574ac324603ed00488c850 = "";foreach($this->usinglists as $v2063c1608d6e0baf80249c42e2be5804)    $vf0ffd3b7c2574ac324603ed00488c850 .= $this->formattedRequest($v2063c1608d6e0baf80249c42e2be5804);$this->outputmsg("Using $vf0ffd3b7c2574ac324603ed00488c850");$this->getData($vf0ffd3b7c2574ac324603ed00488c850);}function validateMethod()  {$vc78bd47f6af6291187ad968471d5c943 = array(   "http://host/%25%32%35" => "http://host/%25",   "http://host/%25%32%35%25%32%35" => "http://host/%25%25",   "http://host/%2525252525252525" => "http://host/%25",   "http://host/asdf%25%32%35asd" => "http://host/asdf%25asd",   "http://host/%%%25%32%35asd%%" => "http://host/%25%25%25asd%25%25",   "http://www.google.com/" => "http://www.google.com/",   "http://%31%36%38%2e%31%38%38%2e%39%39%2e%32%36/%2E%73%65%63%75%72%65/%77%77%77%2E%65%62%61%79%2E%63%6F%6D/" => "http://168.188.99.26/.secure/www.ebay.com/",   "http://195.127.0.11/uploads/%20%20%20%20/.verify/.eBaysecure=updateuserdataxplimnbqmn-xplmvalidateinfoswqpcmlx=hgplmcx/" => "http://195.127.0.11/uploads/%20%20%20%20/.verify/.eBaysecure=updateuserdataxplimnbqmn-xplmvalidateinfoswqpcmlx=hgplmcx/",   "http://host%23.com/%257Ea%2521b%2540c%2523d%2524e%25f%255E00%252611%252A22%252833%252944_55%252B" => 'http://host%23.com/~a!b@c%23d$e%25f^00&11*22(33)44_55+',   "http://3279880203/blah" => "http://195.127.0.11/blah",   "http://www.google.com/blah/.." => "http://www.google.com/",   "www.google.com/" => "http://www.google.com/",   "www.google.com" => "http://www.google.com/",   "http://www.evil.com/blah#frag" => "http://www.evil.com/blah",   "http://www.GOOgle.com/" => "http://www.google.com/",   "http://www.google.com.../" => "http://www.google.com/",   "http://www.google.com/foo\tbar\rbaz\n2" => "http://www.google.com/foobarbaz2",   "http://www.google.com/q?" => "http://www.google.com/q?",   "http://www.google.com/q?r?" => "http://www.google.com/q?r?",   "http://www.google.com/q?r?s" => "http://www.google.com/q?r?s",   "http://evil.com/foo#bar#baz" => "http://evil.com/foo",   "http://evil.com/foo;" => "http://evil.com/foo;",   "http://evil.com/foo?bar;" => "http://evil.com/foo?bar;",   "http://\x01\x80.com/" => "http://%01%80.com/",   "http://notrailingslash.com" => "http://notrailingslash.com/",   "http://www.gotaport.com:1234/" => "http://www.gotaport.com:1234/",   "  http://www.google.com/  " => "http://www.google.com/",   "http:// leadingspace.com/" => "http://%20leadingspace.com/",   "http://%20leadingspace.com/" => "http://%20leadingspace.com/",   "%20leadingspace.com/" => "http://%20leadingspace.com/",   "https://www.securesite.com/" => "https://www.securesite.com/",   "http://host.com/ab%23cd" => "http://host.com/ab%23cd",   "http://host.com//twoslashes?more//slashes" => "http://host.com/twoslashes?more//slashes"   );foreach($vc78bd47f6af6291187ad968471d5c943 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)   {$vc849d1c1d3876d69eb5af1a4ecda6fac = $this->Canonicalize($v3c6e0b8a9c15224a8228b9a98ca1531d);$vc849d1c1d3876d69eb5af1a4ecda6fac = $vc849d1c1d3876d69eb5af1a4ecda6fac['GSBURL'];if($vc849d1c1d3876d69eb5af1a4ecda6fac==$v2063c1608d6e0baf80249c42e2be5804)     outputmsg("<span style='color:green'>PASSED: $v3c6e0b8a9c15224a8228b9a98ca1531d</span>");else     outputmsg("<span style='color:red'>INVALID: <br>ORIGINAL: $v3c6e0b8a9c15224a8228b9a98ca1531d<br>EXPECTED: $v2063c1608d6e0baf80249c42e2be5804<br>RECIEVED: $vc849d1c1d3876d69eb5af1a4ecda6fac<br> </span>");}}function j_parseUrl($v572d4e421e5e6b9bc11d815e8a027112)   {$v2133fd717402a7966ee88d06f9e0b792 = '/^(?:([^:\/?#]+):)?(?:\/\/\/?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?(((?:\/(\w:))?((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/';$vb3b44e43aa5421d268e5747dd2d5f5c8 = '/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((?:\/(\w:))?(\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/';preg_match($vb3b44e43aa5421d268e5747dd2d5f5c8, $v572d4e421e5e6b9bc11d815e8a027112, $ve3cc92c14a5e6dd1a7d94b6ff634d7fc);if(empty($ve3cc92c14a5e6dd1a7d94b6ff634d7fc))   {unset($ve3cc92c14a5e6dd1a7d94b6ff634d7fc);preg_match($v2133fd717402a7966ee88d06f9e0b792, $v572d4e421e5e6b9bc11d815e8a027112, $ve3cc92c14a5e6dd1a7d94b6ff634d7fc);}$v78f0805fa8ffadabda721fdaf85b3ca9 = array("source"=>'',"scheme"=>'',"authority"=>'',"userinfo"=>'',"user"=>'',"password"=>'',"host"=>'',"port"=>'',"relative"=>'',"path"=>'',"drive"=>'',"directory"=>'',"file"=>'',"query"=>'',"fragment"=>'');switch (count ($ve3cc92c14a5e6dd1a7d94b6ff634d7fc)) {case 15: $v78f0805fa8ffadabda721fdaf85b3ca9['fragment'] = $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[14];case 14: $v78f0805fa8ffadabda721fdaf85b3ca9['query'] = $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[13];case 13: $v78f0805fa8ffadabda721fdaf85b3ca9['file'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[12];case 12: $v78f0805fa8ffadabda721fdaf85b3ca9['directory'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[11];case 11: $v78f0805fa8ffadabda721fdaf85b3ca9['drive'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[10];case 10: $v78f0805fa8ffadabda721fdaf85b3ca9['path'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[9];case 9: $v78f0805fa8ffadabda721fdaf85b3ca9['relative'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[8];case 8: $v78f0805fa8ffadabda721fdaf85b3ca9['port'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[7];case 7: $v78f0805fa8ffadabda721fdaf85b3ca9['host'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[6];case 6: $v78f0805fa8ffadabda721fdaf85b3ca9['password'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[5];case 5: $v78f0805fa8ffadabda721fdaf85b3ca9['user'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[4];case 4: $v78f0805fa8ffadabda721fdaf85b3ca9['userinfo'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[3];case 3: $v78f0805fa8ffadabda721fdaf85b3ca9['authority'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[2];case 2: $v78f0805fa8ffadabda721fdaf85b3ca9['scheme'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[1];case 1: $v78f0805fa8ffadabda721fdaf85b3ca9['source'] =  $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[0];}return $v78f0805fa8ffadabda721fdaf85b3ca9;}function is_ip($v957b527bcfbad2e80f58d20683931435)   {return preg_match("/^([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])" .   "(\.([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3}$/", $v957b527bcfbad2e80f58d20683931435);}function is_hex($v9dd4e461268c8034f5c8564e155c67a6)   {if(($v9dd4e461268c8034f5c8564e155c67a6+3) == 3)    return dechex(hexdec($v9dd4e461268c8034f5c8564e155c67a6)) == $v9dd4e461268c8034f5c8564e155c67a6;return false;}function is_octal($v9dd4e461268c8034f5c8564e155c67a6)  {return substr($v9dd4e461268c8034f5c8564e155c67a6,0,1) == 0;}function hexoct2dec($v2063c1608d6e0baf80249c42e2be5804)  {if(substr_count(substr($v2063c1608d6e0baf80249c42e2be5804,0,2),'0x')>0&&$this->is_hex($v2063c1608d6e0baf80249c42e2be5804))   {return hexdec($v2063c1608d6e0baf80249c42e2be5804);}elseif($this->is_octal($v2063c1608d6e0baf80249c42e2be5804))   {return octdec($v2063c1608d6e0baf80249c42e2be5804);}else    return false;}function iphexdec($vb8d1b43eae73587ba56baef574709ecb)  {$v3d801aa532c1cec3ee82d87a99fdf63f = str_replace('0x','',$vb8d1b43eae73587ba56baef574709ecb);$v3d801aa532c1cec3ee82d87a99fdf63f = ltrim($v3d801aa532c1cec3ee82d87a99fdf63f,"0");return hexdec($v3d801aa532c1cec3ee82d87a99fdf63f);}function hexIPtoIP($vb8d1b43eae73587ba56baef574709ecb)  {$v81c37467982bd5626c6de537f8321574 = str_replace('0x','',$vb8d1b43eae73587ba56baef574709ecb);$v81c37467982bd5626c6de537f8321574 = ltrim($v81c37467982bd5626c6de537f8321574,"0");if($this->is_hex($v81c37467982bd5626c6de537f8321574))   {if(strlen($v81c37467982bd5626c6de537f8321574)>8)    {$v81c37467982bd5626c6de537f8321574 = substr($v81c37467982bd5626c6de537f8321574,-8);}$v8765282fd806970a8fa44429c70496aa = preg_split('//', $v81c37467982bd5626c6de537f8321574, -1, PREG_SPLIT_NO_EMPTY);while(count($v8765282fd806970a8fa44429c70496aa)<8)     array_unshift($v8765282fd806970a8fa44429c70496aa,0);$v230170e9aa671ed2ba78dd2f5f964e35 = hexdec($v8765282fd806970a8fa44429c70496aa[0].$v8765282fd806970a8fa44429c70496aa[1]).'.'.hexdec($v8765282fd806970a8fa44429c70496aa[2].$v8765282fd806970a8fa44429c70496aa[3]).'.'.hexdec($v8765282fd806970a8fa44429c70496aa[4].$v8765282fd806970a8fa44429c70496aa[5]).'.'.hexdec($v8765282fd806970a8fa44429c70496aa[6].$v8765282fd806970a8fa44429c70496aa[7]);if($this->is_ip($v230170e9aa671ed2ba78dd2f5f964e35))     return $v230170e9aa671ed2ba78dd2f5f964e35;else     return false;}else    return false;}function isValid_IP($v957b527bcfbad2e80f58d20683931435)  {if($this->is_ip($v957b527bcfbad2e80f58d20683931435))    return $v957b527bcfbad2e80f58d20683931435;$vb7eb20390e92339a90a6e6a43db2a100 = $this->hexIPtoIP($v957b527bcfbad2e80f58d20683931435);if($vb7eb20390e92339a90a6e6a43db2a100)    return $vb7eb20390e92339a90a6e6a43db2a100;$v1fadced22cae6da2595e5eee4b62e845 = $this->hexIPtoIP(dechex($v957b527bcfbad2e80f58d20683931435));if($v1fadced22cae6da2595e5eee4b62e845)    return $v1fadced22cae6da2595e5eee4b62e845;$v24b806c8349e8e385b49243771f4c8a2 = explode('.',$v957b527bcfbad2e80f58d20683931435);$v24b806c8349e8e385b49243771f4c8a2[0] = $this->hexoct2dec($v24b806c8349e8e385b49243771f4c8a2[0]);if(count($v24b806c8349e8e385b49243771f4c8a2)==2)   {if($v24b806c8349e8e385b49243771f4c8a2[0]<=255&&is_int($v24b806c8349e8e385b49243771f4c8a2[0])&&is_int($v24b806c8349e8e385b49243771f4c8a2[1]))    {$v830a4589b3516d50c40b812b6d8fe610 = dechex($v24b806c8349e8e385b49243771f4c8a2[1]);$v8765282fd806970a8fa44429c70496aa = preg_split('//', $v830a4589b3516d50c40b812b6d8fe610, -1, PREG_SPLIT_NO_EMPTY);if(count($v8765282fd806970a8fa44429c70496aa)>4)     {$v230170e9aa671ed2ba78dd2f5f964e35 = $v24b806c8349e8e385b49243771f4c8a2[0].'.'.$this->iphexdec($v8765282fd806970a8fa44429c70496aa[0].$v8765282fd806970a8fa44429c70496aa[1]).'.'.$this->iphexdec($v8765282fd806970a8fa44429c70496aa[2].$v8765282fd806970a8fa44429c70496aa[3]).'.'.$this->iphexdec($v8765282fd806970a8fa44429c70496aa[4].$v8765282fd806970a8fa44429c70496aa[5]);if($this->is_ip($v230170e9aa671ed2ba78dd2f5f964e35))       return $v230170e9aa671ed2ba78dd2f5f964e35;}}}$v24b806c8349e8e385b49243771f4c8a2[1] = $this->hexoct2dec($v24b806c8349e8e385b49243771f4c8a2[1]);if(count($v24b806c8349e8e385b49243771f4c8a2)==3)   {if(($v24b806c8349e8e385b49243771f4c8a2[0]<=255&&is_int($v24b806c8349e8e385b49243771f4c8a2[0]))&&($v24b806c8349e8e385b49243771f4c8a2[1]<=255&&is_int($v24b806c8349e8e385b49243771f4c8a2[1]))&&is_int($v24b806c8349e8e385b49243771f4c8a2[2]))    {$v0ed856809cc13cff31a27446ac3924f0 = dechex($v24b806c8349e8e385b49243771f4c8a2[2]);$v8765282fd806970a8fa44429c70496aa = preg_split('//', $v0ed856809cc13cff31a27446ac3924f0, -1, PREG_SPLIT_NO_EMPTY);if(count($v8765282fd806970a8fa44429c70496aa)>3)     {$v230170e9aa671ed2ba78dd2f5f964e35 = $v24b806c8349e8e385b49243771f4c8a2[0].'.'.$v24b806c8349e8e385b49243771f4c8a2[1].'.'.$this->iphexdec($v8765282fd806970a8fa44429c70496aa[0].$v8765282fd806970a8fa44429c70496aa[1]).'.'.$this->iphexdec($v8765282fd806970a8fa44429c70496aa[2].$v8765282fd806970a8fa44429c70496aa[3]);if($this->is_ip($v230170e9aa671ed2ba78dd2f5f964e35))       return $v230170e9aa671ed2ba78dd2f5f964e35;}}}if(count($v24b806c8349e8e385b49243771f4c8a2)>=4)   {$v588612cb36b9523457f6cb347fa3df23 = array($v24b806c8349e8e385b49243771f4c8a2[2],$v24b806c8349e8e385b49243771f4c8a2[3]);foreach($v588612cb36b9523457f6cb347fa3df23 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)    {if(!$v588612cb36b9523457f6cb347fa3df23[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $this->hexoct2dec($v2063c1608d6e0baf80249c42e2be5804))      return false;}array_unshift($v588612cb36b9523457f6cb347fa3df23,$v24b806c8349e8e385b49243771f4c8a2[0],$v24b806c8349e8e385b49243771f4c8a2[1]);$v230170e9aa671ed2ba78dd2f5f964e35 = implode('.',$v588612cb36b9523457f6cb347fa3df23);if($this->is_ip($v230170e9aa671ed2ba78dd2f5f964e35))     return $v230170e9aa671ed2ba78dd2f5f964e35;}return false;}function flexURLEncode($v572d4e421e5e6b9bc11d815e8a027112,$vfe510037441bcb2f88537f73983fcd8b=false)  {$v3e6c686e2f9ad98037bd5de4ea2add22 = preg_split('//', $v572d4e421e5e6b9bc11d815e8a027112, -1, PREG_SPLIT_NO_EMPTY);if(count($v3e6c686e2f9ad98037bd5de4ea2add22)>0)   {foreach($v3e6c686e2f9ad98037bd5de4ea2add22 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)    {$v5b7f33be48f19c25e1af2f96cffc569f = ord($v2063c1608d6e0baf80249c42e2be5804);if($v5b7f33be48f19c25e1af2f96cffc569f<=32||$v5b7f33be48f19c25e1af2f96cffc569f>=127||($v2063c1608d6e0baf80249c42e2be5804=='#'&&!$vfe510037441bcb2f88537f73983fcd8b)||$v2063c1608d6e0baf80249c42e2be5804=='%')      $v3e6c686e2f9ad98037bd5de4ea2add22[$v3c6e0b8a9c15224a8228b9a98ca1531d] = rawurlencode($v2063c1608d6e0baf80249c42e2be5804);}return implode('',$v3e6c686e2f9ad98037bd5de4ea2add22);}else    return $v572d4e421e5e6b9bc11d815e8a027112;}function Canonicalize($v572d4e421e5e6b9bc11d815e8a027112)  {$v0e8daaadbaf07971e637adabcf3780b8 = trim(str_replace(array("\x09","\x0A","\x0D","\x0B"),'',$v572d4e421e5e6b9bc11d815e8a027112));$v0e8daaadbaf07971e637adabcf3780b8 = $this->flexURLEncode($v0e8daaadbaf07971e637adabcf3780b8,true);$v78f0805fa8ffadabda721fdaf85b3ca9 = $this->j_parseUrl($v0e8daaadbaf07971e637adabcf3780b8);$v0897acf49c7c1ea9f76efe59187aa046 = $v78f0805fa8ffadabda721fdaf85b3ca9['host'];$vd6fe1d0be6347b8ef2427fa629c04485 = $v78f0805fa8ffadabda721fdaf85b3ca9['path'];$v1b1cc7f086b3f074da452bc3129981eb = $v78f0805fa8ffadabda721fdaf85b3ca9['query'];$va396a9036072dee716c98f60ad2eeb3b = "";$v126cd71f5f355ec79d9d538fe572ee65 = "";$v6844644f8e14556a52995a419941d4cf = "";for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < 50;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v0897acf49c7c1ea9f76efe59187aa046 = rawurldecode($v0897acf49c7c1ea9f76efe59187aa046);$vd6fe1d0be6347b8ef2427fa629c04485 = rawurldecode($vd6fe1d0be6347b8ef2427fa629c04485);$v1b1cc7f086b3f074da452bc3129981eb = rawurldecode($v1b1cc7f086b3f074da452bc3129981eb);if($v0897acf49c7c1ea9f76efe59187aa046==$va396a9036072dee716c98f60ad2eeb3b&&$vd6fe1d0be6347b8ef2427fa629c04485==$v126cd71f5f355ec79d9d538fe572ee65&&$v1b1cc7f086b3f074da452bc3129981eb==$v6844644f8e14556a52995a419941d4cf)     break;$va396a9036072dee716c98f60ad2eeb3b = $v0897acf49c7c1ea9f76efe59187aa046;$v126cd71f5f355ec79d9d538fe572ee65 = $vd6fe1d0be6347b8ef2427fa629c04485;$v6844644f8e14556a52995a419941d4cf = $v1b1cc7f086b3f074da452bc3129981eb;}$v0897acf49c7c1ea9f76efe59187aa046 = trim($v0897acf49c7c1ea9f76efe59187aa046,'.');$v0897acf49c7c1ea9f76efe59187aa046 = preg_replace("/\.{2,}/",".",$v0897acf49c7c1ea9f76efe59187aa046);$v0897acf49c7c1ea9f76efe59187aa046 = strtolower($v0897acf49c7c1ea9f76efe59187aa046);$va7e49d9ebbfb8ea87b2037de0e1dc1ac = $this->isValid_IP($v0897acf49c7c1ea9f76efe59187aa046);if($va7e49d9ebbfb8ea87b2037de0e1dc1ac)   {$vde6954c0436f6edcfcf41618f7b26f49 = true;$v3302968bf366112cad32c8b99a2cb319 = $va7e49d9ebbfb8ea87b2037de0e1dc1ac;}else   {$vde6954c0436f6edcfcf41618f7b26f49 = false;$v3302968bf366112cad32c8b99a2cb319 = $v0897acf49c7c1ea9f76efe59187aa046;}$v2977f7fd81dde0de0b07eb6d40735b68 = explode('/',$vd6fe1d0be6347b8ef2427fa629c04485);foreach($v2977f7fd81dde0de0b07eb6d40735b68 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)   {if($v2063c1608d6e0baf80249c42e2be5804=="..")    {if($v3c6e0b8a9c15224a8228b9a98ca1531d!=0)     {unset($v2977f7fd81dde0de0b07eb6d40735b68[$v3c6e0b8a9c15224a8228b9a98ca1531d-1]);unset($v2977f7fd81dde0de0b07eb6d40735b68[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}else      unset($v2977f7fd81dde0de0b07eb6d40735b68[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}elseif($v2063c1608d6e0baf80249c42e2be5804=="."||empty($v2063c1608d6e0baf80249c42e2be5804))     unset($v2977f7fd81dde0de0b07eb6d40735b68[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}if(substr($vd6fe1d0be6347b8ef2427fa629c04485,-1,1)=="/")    $v9516dfb15f51c7ee19a4d46b8c0dbe1d = "/";else    $v9516dfb15f51c7ee19a4d46b8c0dbe1d = false;$vd6fe1d0be6347b8ef2427fa629c04485 = "/".implode("/",$v2977f7fd81dde0de0b07eb6d40735b68);if($v9516dfb15f51c7ee19a4d46b8c0dbe1d&&substr($vd6fe1d0be6347b8ef2427fa629c04485,-1,1)!="/")    $vd6fe1d0be6347b8ef2427fa629c04485 .= $v9516dfb15f51c7ee19a4d46b8c0dbe1d;$v3302968bf366112cad32c8b99a2cb319 = $this->flexURLEncode($v3302968bf366112cad32c8b99a2cb319);$vd6fe1d0be6347b8ef2427fa629c04485 = $this->flexURLEncode($vd6fe1d0be6347b8ef2427fa629c04485);$v1b1cc7f086b3f074da452bc3129981eb = $this->flexURLEncode($v1b1cc7f086b3f074da452bc3129981eb);if(empty($v78f0805fa8ffadabda721fdaf85b3ca9['scheme']))    $v78f0805fa8ffadabda721fdaf85b3ca9['scheme'] = 'http';$v89797a3a1b6bde4929b7cb0c2c909d7a = $v78f0805fa8ffadabda721fdaf85b3ca9['scheme'].'://';$vf10b9206f9ba6ba9eb1a6c084a594ef5 = $v89797a3a1b6bde4929b7cb0c2c909d7a;if(!empty($v78f0805fa8ffadabda721fdaf85b3ca9['userinfo']))    $vf10b9206f9ba6ba9eb1a6c084a594ef5 .= $v78f0805fa8ffadabda721fdaf85b3ca9['userinfo'].'@';$v89797a3a1b6bde4929b7cb0c2c909d7a .= $v3302968bf366112cad32c8b99a2cb319;$vf10b9206f9ba6ba9eb1a6c084a594ef5 .= $v3302968bf366112cad32c8b99a2cb319;if(!empty($v78f0805fa8ffadabda721fdaf85b3ca9['port']))   {$v89797a3a1b6bde4929b7cb0c2c909d7a .= ':'.$v78f0805fa8ffadabda721fdaf85b3ca9['port'];$vf10b9206f9ba6ba9eb1a6c084a594ef5 .= ':'.$v78f0805fa8ffadabda721fdaf85b3ca9['port'];}$v89797a3a1b6bde4929b7cb0c2c909d7a .= $vd6fe1d0be6347b8ef2427fa629c04485;$vf10b9206f9ba6ba9eb1a6c084a594ef5 .= $vd6fe1d0be6347b8ef2427fa629c04485;if(substr_count($v0e8daaadbaf07971e637adabcf3780b8,"?")>0)   {$v89797a3a1b6bde4929b7cb0c2c909d7a .= '?'.$v78f0805fa8ffadabda721fdaf85b3ca9['query'];$vf10b9206f9ba6ba9eb1a6c084a594ef5 .= '?'.$v78f0805fa8ffadabda721fdaf85b3ca9['query'];}if(!empty($v78f0805fa8ffadabda721fdaf85b3ca9['fragment']))    $vf10b9206f9ba6ba9eb1a6c084a594ef5 .= '#'.$v78f0805fa8ffadabda721fdaf85b3ca9['fragment'];return array("GSBURL"=>$v89797a3a1b6bde4929b7cb0c2c909d7a,"CleanURL"=>$vf10b9206f9ba6ba9eb1a6c084a594ef5,"Parts"=>array("Host"=>$v3302968bf366112cad32c8b99a2cb319,"Path"=>$vd6fe1d0be6347b8ef2427fa629c04485,"Query"=>$v1b1cc7f086b3f074da452bc3129981eb,"IP"=>$vde6954c0436f6edcfcf41618f7b26f49));}function sha256($v8d777f385d3dfec8815d20f7496026dc)  {return hash('sha256',$v8d777f385d3dfec8815d20f7496026dc);}function makeHostKey($v67b3dba8bc6778101892eb77249db32e,$vde6954c0436f6edcfcf41618f7b26f49)  {if($vde6954c0436f6edcfcf41618f7b26f49)    $v85cf4e6d42a71e693fd780c8b29accdd = array($v67b3dba8bc6778101892eb77249db32e."/");else   {$vd36e695135f27b0c121ea42ec0cb0e69 = explode(".",$v67b3dba8bc6778101892eb77249db32e);if(count($vd36e695135f27b0c121ea42ec0cb0e69)>2)    {$vfe504cfa025fe47ec9c150fba3be4d35 = array_reverse($vd36e695135f27b0c121ea42ec0cb0e69);$v830a4589b3516d50c40b812b6d8fe610 = array_slice($vfe504cfa025fe47ec9c150fba3be4d35,0,3);$v0ed856809cc13cff31a27446ac3924f0 = array_slice($v830a4589b3516d50c40b812b6d8fe610,0,2);$v85cf4e6d42a71e693fd780c8b29accdd = array(implode('.',array_reverse($v830a4589b3516d50c40b812b6d8fe610))."/",implode('.',array_reverse($v0ed856809cc13cff31a27446ac3924f0))."/");}else     $v85cf4e6d42a71e693fd780c8b29accdd = array($v67b3dba8bc6778101892eb77249db32e."/");}$v7dbaa5e5fc24af1edec984e9bfc33e2f = array();foreach($v85cf4e6d42a71e693fd780c8b29accdd as $v2063c1608d6e0baf80249c42e2be5804)   {$v6f54e350af42b24e7961a18091df537b = $this->sha256($v2063c1608d6e0baf80249c42e2be5804);$v7dbaa5e5fc24af1edec984e9bfc33e2f[$v6f54e350af42b24e7961a18091df537b] = array("Host"=>$v2063c1608d6e0baf80249c42e2be5804,"Prefix"=>substr($v6f54e350af42b24e7961a18091df537b,0,8),"Hash"=>$v6f54e350af42b24e7961a18091df537b);}return $v7dbaa5e5fc24af1edec984e9bfc33e2f;}function makeHashes($v8ea8b013cf35bab1442cb4c7305192aa)  {if(count($v8ea8b013cf35bab1442cb4c7305192aa)>0)   {$v2e8e83cade6cb42f1b579c5a5e1db78b = array();foreach($v8ea8b013cf35bab1442cb4c7305192aa as $v2063c1608d6e0baf80249c42e2be5804)    {$v6f54e350af42b24e7961a18091df537b = $this->sha256($v2063c1608d6e0baf80249c42e2be5804);$v2e8e83cade6cb42f1b579c5a5e1db78b[$v6f54e350af42b24e7961a18091df537b] = array("Original"=>$v2063c1608d6e0baf80249c42e2be5804,"Prefix"=>substr($v6f54e350af42b24e7961a18091df537b,0,8),"Hash"=>$v6f54e350af42b24e7961a18091df537b);}return $v2e8e83cade6cb42f1b579c5a5e1db78b;}else    return false;}function makePrefixes($v67b3dba8bc6778101892eb77249db32e,$vd6fe1d0be6347b8ef2427fa629c04485,$v1b1cc7f086b3f074da452bc3129981eb,$vde6954c0436f6edcfcf41618f7b26f49)  {$v735e5189fad047c92ac9f292e73ed303 = array();$ve503dfa9a1947c6b3d47a18a00f997b6 = array();$ve503dfa9a1947c6b3d47a18a00f997b6[] = $v67b3dba8bc6778101892eb77249db32e;if(!$vde6954c0436f6edcfcf41618f7b26f49)   {$vd36e695135f27b0c121ea42ec0cb0e69 = explode('.',$v67b3dba8bc6778101892eb77249db32e);$vfe504cfa025fe47ec9c150fba3be4d35 = array_reverse($vd36e695135f27b0c121ea42ec0cb0e69);if(count($vfe504cfa025fe47ec9c150fba3be4d35)>5)     $v6ac6e3972340a6cde8278dd6b566b18b = 5;else     $v6ac6e3972340a6cde8278dd6b566b18b = count($vfe504cfa025fe47ec9c150fba3be4d35);$vff8420f46c253a0d84ba06a9f95f454b = array_slice($vfe504cfa025fe47ec9c150fba3be4d35,0,$v6ac6e3972340a6cde8278dd6b566b18b);while($v6ac6e3972340a6cde8278dd6b566b18b>1)    {$ve503dfa9a1947c6b3d47a18a00f997b6[] = implode('.',array_reverse($vff8420f46c253a0d84ba06a9f95f454b));$v6ac6e3972340a6cde8278dd6b566b18b--;$vff8420f46c253a0d84ba06a9f95f454b = array_slice($vfe504cfa025fe47ec9c150fba3be4d35,0,$v6ac6e3972340a6cde8278dd6b566b18b);}}else    $ve503dfa9a1947c6b3d47a18a00f997b6[] = $v67b3dba8bc6778101892eb77249db32e;$ve503dfa9a1947c6b3d47a18a00f997b6 = array_unique($ve503dfa9a1947c6b3d47a18a00f997b6);$v2598fe3ec117781a941e0e8ff655eaec = array();if(!empty($vd6fe1d0be6347b8ef2427fa629c04485))   {$v2977f7fd81dde0de0b07eb6d40735b68 = explode("/",$vd6fe1d0be6347b8ef2427fa629c04485);if(count($v2977f7fd81dde0de0b07eb6d40735b68)>4)     $v60f006e16d0735198436cc209f4bc394 = 4;else     $v60f006e16d0735198436cc209f4bc394 = count($v2977f7fd81dde0de0b07eb6d40735b68);}foreach($ve503dfa9a1947c6b3d47a18a00f997b6 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)   {if(!empty($v1b1cc7f086b3f074da452bc3129981eb))     $v2598fe3ec117781a941e0e8ff655eaec[] = $v2063c1608d6e0baf80249c42e2be5804.$vd6fe1d0be6347b8ef2427fa629c04485.'?'.$v1b1cc7f086b3f074da452bc3129981eb;$v2598fe3ec117781a941e0e8ff655eaec[] = $v2063c1608d6e0baf80249c42e2be5804.$vd6fe1d0be6347b8ef2427fa629c04485;if(!empty($vd6fe1d0be6347b8ef2427fa629c04485))    {$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v143cd3554a54316a108078ccfcb39ee7 = "";while($v865c0c0b4ab0e063e5caa3387c1a8741<$v60f006e16d0735198436cc209f4bc394)     {if($v865c0c0b4ab0e063e5caa3387c1a8741!=count($v2977f7fd81dde0de0b07eb6d40735b68)-1)       $v143cd3554a54316a108078ccfcb39ee7 = $v143cd3554a54316a108078ccfcb39ee7.$v2977f7fd81dde0de0b07eb6d40735b68[$v865c0c0b4ab0e063e5caa3387c1a8741]."/";else       $v143cd3554a54316a108078ccfcb39ee7 = $v143cd3554a54316a108078ccfcb39ee7.$v2977f7fd81dde0de0b07eb6d40735b68[$v865c0c0b4ab0e063e5caa3387c1a8741];$v2598fe3ec117781a941e0e8ff655eaec[] = $v2063c1608d6e0baf80249c42e2be5804.$v143cd3554a54316a108078ccfcb39ee7;$v865c0c0b4ab0e063e5caa3387c1a8741++;}}}$v2598fe3ec117781a941e0e8ff655eaec = array_unique($v2598fe3ec117781a941e0e8ff655eaec);return $this->makeHashes($v2598fe3ec117781a941e0e8ff655eaec);}function processFullLookup($v8d777f385d3dfec8815d20f7496026dc)  {$v3148fde04e50c5ab9b86a48b3e090c06 = $v8d777f385d3dfec8815d20f7496026dc;$vf371d87dfac21e8bd3ac0b2670c19c62 = array();while(strlen($v3148fde04e50c5ab9b86a48b3e090c06)>0)   {$vcb6c4d2d5034d3e7276e1b1654eb4662 = explode("\n",$v3148fde04e50c5ab9b86a48b3e090c06,2);$vf30cc4644adebccc12cc1ebf57d426d1 = explode(':',$vcb6c4d2d5034d3e7276e1b1654eb4662[0]);$v63f9ef60d1a8cf9e83dafb175219c324 = $vf30cc4644adebccc12cc1ebf57d426d1[0];$vdc5f1a5d0689f57c34693609c28816d2 = $vf30cc4644adebccc12cc1ebf57d426d1[1];$v8e6d793671fd3f7bfd71966dd6f198c0 = $vf30cc4644adebccc12cc1ebf57d426d1[2];$v18118dbc1e15fb3e701effb6b7546886 = bin2hex(substr($vcb6c4d2d5034d3e7276e1b1654eb4662[1],0,$v8e6d793671fd3f7bfd71966dd6f198c0));while(strlen($v18118dbc1e15fb3e701effb6b7546886)>0)    {$vf371d87dfac21e8bd3ac0b2670c19c62[$v63f9ef60d1a8cf9e83dafb175219c324][$vdc5f1a5d0689f57c34693609c28816d2] = substr($v18118dbc1e15fb3e701effb6b7546886,0,64);$v18118dbc1e15fb3e701effb6b7546886 = substr($v18118dbc1e15fb3e701effb6b7546886,64);}$v3148fde04e50c5ab9b86a48b3e090c06 = substr($vcb6c4d2d5034d3e7276e1b1654eb4662[1],$v8e6d793671fd3f7bfd71966dd6f198c0);}return $vf371d87dfac21e8bd3ac0b2670c19c62;}function addFullHash($v851f5ac9941d720844d143ed9cfcf60a,$v7a96c8563cec784ca00fa1bbff2cea36,$v6f54e350af42b24e7961a18091df537b,$v63f9ef60d1a8cf9e83dafb175219c324)  {$vb3cd90040f4d077d7c4f7cc436f0ebec = $v63f9ef60d1a8cf9e83dafb175219c324."-a";$result = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-hosts` WHERE `Hostkey` = '$v851f5ac9941d720844d143ed9cfcf60a' AND `Chunknum` = '$v7a96c8563cec784ca00fa1bbff2cea36'");if($result&&mysql_num_rows($result)>0)   {while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result, MYSQL_ASSOC))    {if(empty($vf1965a857bc285d26fe22023aa5ab50d['FullHash']))     {$v50c8f95796c6aa164927763531542f4c = mysql_query("UPDATE `$vb3cd90040f4d077d7c4f7cc436f0ebec-hosts` SET `FullHash` = '$v6f54e350af42b24e7961a18091df537b' WHERE `ID` = '{$vf1965a857bc285d26fe22023aa5ab50d['ID']}';");if(!$v50c8f95796c6aa164927763531542f4c)       $this->fatalerror("Could not cache full-hash key. $v851f5ac9941d720844d143ed9cfcf60a, $v7a96c8563cec784ca00fa1bbff2cea36, $v6f54e350af42b24e7961a18091df537b, $v63f9ef60d1a8cf9e83dafb175219c324");}}}else   {$result = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-prefixes` WHERE `Prefix` = '$v851f5ac9941d720844d143ed9cfcf60a'");while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result, MYSQL_ASSOC))    {if(empty($vf1965a857bc285d26fe22023aa5ab50d['FullHash']))     {$v1ddfeb43f1a80c133b66d8fe3871772c = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-hosts` WHERE `Hostkey` = '{$vf1965a857bc285d26fe22023aa5ab50d['Hostkey']}' AND `Chunknum` = '$v7a96c8563cec784ca00fa1bbff2cea36'");while ($v9d16343560041e36c7a88076d2bcb61f = mysql_fetch_array($v1ddfeb43f1a80c133b66d8fe3871772c, MYSQL_ASSOC))      {if(hexdec($v9d16343560041e36c7a88076d2bcb61f['Count'])>0)       {$v50c8f95796c6aa164927763531542f4c = mysql_query("UPDATE `$vb3cd90040f4d077d7c4f7cc436f0ebec-prefixes` SET `FullHash` = '$v6f54e350af42b24e7961a18091df537b' WHERE `ID` = '{$vf1965a857bc285d26fe22023aa5ab50d['ID']}';");if(!$v50c8f95796c6aa164927763531542f4c)         $this->fatalerror("Could not cache full-hash key. $v851f5ac9941d720844d143ed9cfcf60a, $v7a96c8563cec784ca00fa1bbff2cea36, $v6f54e350af42b24e7961a18091df537b, $v63f9ef60d1a8cf9e83dafb175219c324");}}}}}}function cacheCheck($v851f5ac9941d720844d143ed9cfcf60a)  {foreach($this->usinglists as $v2063c1608d6e0baf80249c42e2be5804)   {$vb3cd90040f4d077d7c4f7cc436f0ebec = $v2063c1608d6e0baf80249c42e2be5804."-a";$result = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-hosts` WHERE `Hostkey` = '$v851f5ac9941d720844d143ed9cfcf60a' AND `FullHash` != ''");if($result&&mysql_num_rows($result)>0)    {while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result, MYSQL_ASSOC))     {return array($vf1965a857bc285d26fe22023aa5ab50d['FullHash'],$vf1965a857bc285d26fe22023aa5ab50d['Chunknum']);}}else    {$result = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-prefixes` WHERE `Prefix` = '$v851f5ac9941d720844d143ed9cfcf60a' AND `FullHash` != ''");if($result&&mysql_num_rows($result)>0)     {while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result, MYSQL_ASSOC))      {$v1ddfeb43f1a80c133b66d8fe3871772c = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-hosts` WHERE `Hostkey` = '{$vf1965a857bc285d26fe22023aa5ab50d['Hostkey']}'");while ($v9d16343560041e36c7a88076d2bcb61f = mysql_fetch_array($v1ddfeb43f1a80c133b66d8fe3871772c, MYSQL_ASSOC))       {if(hexdec($v9d16343560041e36c7a88076d2bcb61f['Count'])>0)        {return array($vf1965a857bc285d26fe22023aa5ab50d['FullHash'],$v9d16343560041e36c7a88076d2bcb61f['Chunknum']);}}}}}}return false;}function doFullLookup($v735e5189fad047c92ac9f292e73ed303,$v6c63408165910e81650cdab62909f98a)  {$v0d3c98f2dc0fa66efbc0f9a87fc914ee = $v735e5189fad047c92ac9f292e73ed303;$ve304632380e40ce59c75b0b9ad54fd6f = strlen($v735e5189fad047c92ac9f292e73ed303[0][0])/2;$v2fa47f7c65fec19cc163b195725e3844 = count($v735e5189fad047c92ac9f292e73ed303)*$ve304632380e40ce59c75b0b9ad54fd6f;foreach($v735e5189fad047c92ac9f292e73ed303 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)   {$v6e447ab04e269e4c14caf4e192a01c18 = $this->cacheCheck($v2063c1608d6e0baf80249c42e2be5804[0]);if($v6e447ab04e269e4c14caf4e192a01c18)    {if(isset($v6c63408165910e81650cdab62909f98a[$v6e447ab04e269e4c14caf4e192a01c18[0]]))     {foreach($v0d3c98f2dc0fa66efbc0f9a87fc914ee as $v04fca4df1d06587ca383632b5d5b202d)      {if($v04fca4df1d06587ca383632b5d5b202d[1]==$v6e447ab04e269e4c14caf4e192a01c18[1]&&$v2063c1608d6e0baf80249c42e2be5804[0]==$v6c63408165910e81650cdab62909f98a[$v6e447ab04e269e4c14caf4e192a01c18[0]]['Prefix'])       {return true;}}}}$v735e5189fad047c92ac9f292e73ed303[$v3c6e0b8a9c15224a8228b9a98ca1531d] = pack("H*",$v2063c1608d6e0baf80249c42e2be5804[0]);}$v841a2d689ad86bd1611447453c22c6fc = "$ve304632380e40ce59c75b0b9ad54fd6f:$v2fa47f7c65fec19cc163b195725e3844\n".implode("",$v735e5189fad047c92ac9f292e73ed303);$v8f04f9c9d7c4d08367698d40c96c04fb = array(CURLOPT_POST=>true,CURLOPT_POSTFIELDS=>$v841a2d689ad86bd1611447453c22c6fc);$result = $this->googleDownloader("http://sba.yandex.net/gethash?client=api&apikey=".$this->apikey."&appver=".$this->version."&pver=".$this->apiversion,$v8f04f9c9d7c4d08367698d40c96c04fb,"lookup");if($result[0]['http_code']==200&&!empty($result[1]))   {$vd03da233b496174da1a8053fcc7d8744 = $this->processFullLookup($result[1]);foreach($vd03da233b496174da1a8053fcc7d8744 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)    {foreach($v2063c1608d6e0baf80249c42e2be5804 as $v1fdd50b19896cfbf2e5acc30487e09e2=>$v10249b906046c4dfb392f99ecdedbad0)     {if(isset($v6c63408165910e81650cdab62909f98a[$v10249b906046c4dfb392f99ecdedbad0]))      {foreach($v0d3c98f2dc0fa66efbc0f9a87fc914ee as $v04fca4df1d06587ca383632b5d5b202d)       {if($v04fca4df1d06587ca383632b5d5b202d[1]==$v1fdd50b19896cfbf2e5acc30487e09e2&&$v04fca4df1d06587ca383632b5d5b202d[0]==$v6c63408165910e81650cdab62909f98a[$v10249b906046c4dfb392f99ecdedbad0]['Prefix'])        {$this->addFullHash($v04fca4df1d06587ca383632b5d5b202d[0],$v04fca4df1d06587ca383632b5d5b202d[1],$v10249b906046c4dfb392f99ecdedbad0,$v3c6e0b8a9c15224a8228b9a98ca1531d);return true;}}}}}return false;}elseif($result[0]['http_code']==204&&strlen($result[1])==0)   {return false;}else   {$this->fatalerror("ERROR: Invalid response returned from GSB ({$result[0]['http_code']})");}}function subCheck($v63f9ef60d1a8cf9e83dafb175219c324,$vee7e50e9ad9983275f73da838886f7cf,$v15d61712450a686a7f365adf4fef581f)  {$vb3cd90040f4d077d7c4f7cc436f0ebec = $v63f9ef60d1a8cf9e83dafb175219c324.'-s';if($v15d61712450a686a7f365adf4fef581f=="prefix")   {foreach($vee7e50e9ad9983275f73da838886f7cf as $v2063c1608d6e0baf80249c42e2be5804)    {$result = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-prefixes` WHERE `Prefix` = '{$v2063c1608d6e0baf80249c42e2be5804[0]}'");if($result&&mysql_num_rows($result)>0)     {while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result, MYSQL_ASSOC))      {if(hexdec($vf1965a857bc285d26fe22023aa5ab50d['AddChunkNum'])==$v2063c1608d6e0baf80249c42e2be5804[1])        return true;}}}return false;}elseif($v15d61712450a686a7f365adf4fef581f=="hostkey")   {foreach($vee7e50e9ad9983275f73da838886f7cf as $v2063c1608d6e0baf80249c42e2be5804)    {$result = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-prefixes` WHERE `Hostkey` = '{$v2063c1608d6e0baf80249c42e2be5804[0]}'");if($result&&mysql_num_rows($result)>0)     {while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result, MYSQL_ASSOC))      {if(hexdec($vf1965a857bc285d26fe22023aa5ab50d['AddChunkNum'])==$v2063c1608d6e0baf80249c42e2be5804[1]&&empty($vf1965a857bc285d26fe22023aa5ab50d['Prefix']))        return true;}}}return false;}$this->fatalerror("Invalid SubCheck Mode $v15d61712450a686a7f365adf4fef581f");}function doLookup($v572d4e421e5e6b9bc11d815e8a027112)  {$ve6dbca21d4865b265ca2780205b19305 = $this->usinglists;$v89797a3a1b6bde4929b7cb0c2c909d7a = $this->Canonicalize($v572d4e421e5e6b9bc11d815e8a027112);$v7736afb1c2633a7d47dfa3973a0938fd = $this->makeHostKey($v89797a3a1b6bde4929b7cb0c2c909d7a['Parts']['Host'],$v89797a3a1b6bde4929b7cb0c2c909d7a['Parts']['IP']);$v9c28d32df234037773be184dbdafc274 = array();foreach($ve6dbca21d4865b265ca2780205b19305 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)   {$vb3cd90040f4d077d7c4f7cc436f0ebec = $v2063c1608d6e0baf80249c42e2be5804.'-a';foreach($v7736afb1c2633a7d47dfa3973a0938fd as $v34e09f165968553e1f324dba23b16ee4=>$v4c7397cfde0bd9cf2cab8dc6a49dce0a)    {$result = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-hosts` WHERE `Hostkey` = '{$v4c7397cfde0bd9cf2cab8dc6a49dce0a['Prefix']}'");if($result&&mysql_num_rows($result)>0)     {while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result, MYSQL_ASSOC))      {$va36d23a4be489019d38b0a1863ac45b1 = hexdec($vf1965a857bc285d26fe22023aa5ab50d['Count']);if($va36d23a4be489019d38b0a1863ac45b1>0)       {if(!isset($v735e5189fad047c92ac9f292e73ed303))        {$v735e5189fad047c92ac9f292e73ed303 = $this->makePrefixes($v89797a3a1b6bde4929b7cb0c2c909d7a['Parts']['Host'],$v89797a3a1b6bde4929b7cb0c2c909d7a['Parts']['Path'],$v89797a3a1b6bde4929b7cb0c2c909d7a['Parts']['Query'],$v89797a3a1b6bde4929b7cb0c2c909d7a['Parts']['IP']);$vd5a7ac463fc10072f7e19feacdf2851a = array();foreach($v735e5189fad047c92ac9f292e73ed303 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v2063c1608d6e0baf80249c42e2be5804)         {$vd5a7ac463fc10072f7e19feacdf2851a[] = " `Prefix` = '{$v2063c1608d6e0baf80249c42e2be5804['Prefix']}' ";}$vd5a7ac463fc10072f7e19feacdf2851a = implode("OR",$vd5a7ac463fc10072f7e19feacdf2851a);}$v1ddfeb43f1a80c133b66d8fe3871772c = mysql_query("SELECT * FROM `$vb3cd90040f4d077d7c4f7cc436f0ebec-prefixes` WHERE ($vd5a7ac463fc10072f7e19feacdf2851a) AND `Hostkey` = '{$vf1965a857bc285d26fe22023aa5ab50d['Hostkey']}'");if($v1ddfeb43f1a80c133b66d8fe3871772c&&mysql_num_rows($v1ddfeb43f1a80c133b66d8fe3871772c)>0)        {$v3e97252373431ef16dfc06622d38f771 = array();$v4b16f504ed4a43c2b905222cda323a6a = array();while ($v9d16343560041e36c7a88076d2bcb61f = mysql_fetch_array($v1ddfeb43f1a80c133b66d8fe3871772c, MYSQL_ASSOC))         {$v3e97252373431ef16dfc06622d38f771[] = array($v9d16343560041e36c7a88076d2bcb61f['Prefix'],$vf1965a857bc285d26fe22023aa5ab50d['Chunknum']);}$vbd387639e4dc80e945d945697eb00c5a = $this->subCheck($v2063c1608d6e0baf80249c42e2be5804,$v3e97252373431ef16dfc06622d38f771,"prefix");if(!$vbd387639e4dc80e945d945697eb00c5a)         {$vd17c45a5b48e322b0b0a8b67c72af2a8 = $this->doFullLookup($v3e97252373431ef16dfc06622d38f771,$v735e5189fad047c92ac9f292e73ed303);if($vd17c45a5b48e322b0b0a8b67c72af2a8)           return true;}}}else       {$vbd387639e4dc80e945d945697eb00c5a = $this->subCheck($v2063c1608d6e0baf80249c42e2be5804,array(array($vf1965a857bc285d26fe22023aa5ab50d['Hostkey'],$vf1965a857bc285d26fe22023aa5ab50d['Chunknum'])),"hostkey");if(!$vbd387639e4dc80e945d945697eb00c5a)        {$vd17c45a5b48e322b0b0a8b67c72af2a8 = $this->doFullLookup(array(array($vf1965a857bc285d26fe22023aa5ab50d['Hostkey'],$vf1965a857bc285d26fe22023aa5ab50d['Chunknum'])),$v7736afb1c2633a7d47dfa3973a0938fd);if($vd17c45a5b48e322b0b0a8b67c72af2a8)          return true;}}}}}}return false;}}?>