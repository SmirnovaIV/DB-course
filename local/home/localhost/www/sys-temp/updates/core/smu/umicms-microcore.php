<?php
 if(!defined("CURRENT_VERSION_LINE")) define("CURRENT_VERSION_LINE", "");if(!defined("CURRENT_WORKING_DIR")) define("CURRENT_WORKING_DIR", dirname(dirname(dirname(__FILE__))));$vd2962d9ba1823a204aa406e3fe3f906b = array('ru');function showWorkTime($v6f8f57715090da2632453988d9a1501b, $vc9e9a848920877e76685b2e4e76de38d=0) {}interface iSingleton {public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL);};interface iUmiEntinty {public function getId();public function commit();public function update();public static function filterInputString($vb45cffe084dd3d20d928bee85e7b0f21);};interface iMapContainer {public function get($v3c6e0b8a9c15224a8228b9a98ca1531d);public function set($v3c6e0b8a9c15224a8228b9a98ca1531d, $v2063c1608d6e0baf80249c42e2be5804);public function del($v3c6e0b8a9c15224a8228b9a98ca1531d);public function getArrayCopy();public function clear();public function __get($v3c6e0b8a9c15224a8228b9a98ca1531d);public function __set($v3c6e0b8a9c15224a8228b9a98ca1531d, $v2063c1608d6e0baf80249c42e2be5804);public function __unset($v3c6e0b8a9c15224a8228b9a98ca1531d);}abstract class singleton {private static $instances = Array();abstract protected function __construct();public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {if (!isset(singleton::$instances[$v4a8a08f09d37b73795649038408b5f33])) {singleton::$instances[$v4a8a08f09d37b73795649038408b5f33] = new $v4a8a08f09d37b73795649038408b5f33;}return singleton::$instances[$v4a8a08f09d37b73795649038408b5f33];}public function __clone() {throw new coreException('Singletone clonning is not permitted.');}public static function setInstance($v7123a699d77db6479a1d8ece2c4f1c16, $v6f66e878c62db60568a3487869695820 = NULL) {if (is_null($v6f66e878c62db60568a3487869695820)) {throw new coreException('Unknown class name for set instance.');}return singleton::$instances[$v6f66e878c62db60568a3487869695820] = $v7123a699d77db6479a1d8ece2c4f1c16;}protected function disableCache() {if(!defined('MYSQL_DISABLE_CACHE')) {define('MYSQL_DISABLE_CACHE', '1');}}protected function translateLabel($vd304ba20e96d87411588eeabac850e34) {$v851f5ac9941d720844d143ed9cfcf60a = "i18n::";if(substr($vd304ba20e96d87411588eeabac850e34, 0, strlen($v851f5ac9941d720844d143ed9cfcf60a)) == $v851f5ac9941d720844d143ed9cfcf60a) {$v341be97d9aff90c9978347f66f945b77 = getLabel(substr($vd304ba20e96d87411588eeabac850e34, strlen($v851f5ac9941d720844d143ed9cfcf60a)));}else {$v341be97d9aff90c9978347f66f945b77 = getLabel($vd304ba20e96d87411588eeabac850e34);}return (is_null($v341be97d9aff90c9978347f66f945b77)) ? $vd304ba20e96d87411588eeabac850e34 : $v341be97d9aff90c9978347f66f945b77;}};abstract class umiEntinty {protected $id, $is_updated = false;protected $bNeedUpdateCache = false;public function __construct($vb80bb7740288fda1f201890375a60c8f, $vf1965a857bc285d26fe22023aa5ab50d = false) {$this->setId($vb80bb7740288fda1f201890375a60c8f);$this->is_updated = false;if($this->loadInfo($vf1965a857bc285d26fe22023aa5ab50d) === false) {throw new privateException("Failed to load info for {$this->store_type} with id {$vb80bb7740288fda1f201890375a60c8f}");}}public function __clone() {throw new coreException('umiEntinty must not be cloned');}public function __destruct() {if ($this->is_updated) {$this->save();$this->setIsUpdated(false);$this->updateCache();}elseif ($this->bNeedUpdateCache) {$this->updateCache();}}public function getId() {return $this->id;}protected function setId($vb80bb7740288fda1f201890375a60c8f) {$this->id = (int) $vb80bb7740288fda1f201890375a60c8f;}public function getIsUpdated() {return $this->is_updated;}public function setIsUpdated($v50e544b8aa9b48fae6d78fb7574d402f = true) {$this->is_updated = (bool) $v50e544b8aa9b48fae6d78fb7574d402f;$this->bNeedUpdateCache = $this->is_updated;}public function beforeSerialize() {}public function afterSerialize() {}public function afterUnSerialize() {}abstract protected function loadInfo();abstract protected function save();public function commit() {if ($this->is_updated) {$this->disableCache();$v9b207167e5381c47682c6b4f58a623fb = $this->save();if (cacheFrontend::getInstance()->getIsConnected()) {$this->update();}else {$this->setIsUpdated(false);}return $v9b207167e5381c47682c6b4f58a623fb;}else {return false;}}public function update() {$v9b207167e5381c47682c6b4f58a623fb = $this->loadInfo();$this->setIsUpdated(false);$this->updateCache();return $v9b207167e5381c47682c6b4f58a623fb;}public static function filterInputString($vb45cffe084dd3d20d928bee85e7b0f21) {$vb45cffe084dd3d20d928bee85e7b0f21 = l_mysql_real_escape_string($vb45cffe084dd3d20d928bee85e7b0f21);return $vb45cffe084dd3d20d928bee85e7b0f21;}public function __toString() {return (string) $this->getId();}protected function updateCache() {cacheFrontend::getInstance()->save($this, $this->store_type);}protected function disableCache() {if (!defined('MYSQL_DISABLE_CACHE')) {if (get_class($this) === "umiObjectProperty") {return;}define('MYSQL_DISABLE_CACHE', '1');}}protected function translateLabel($vd304ba20e96d87411588eeabac850e34) {$v851f5ac9941d720844d143ed9cfcf60a = "i18n::";if (substr($vd304ba20e96d87411588eeabac850e34, 0, strlen($v851f5ac9941d720844d143ed9cfcf60a)) == $v851f5ac9941d720844d143ed9cfcf60a) {$v341be97d9aff90c9978347f66f945b77 = getLabel(substr($vd304ba20e96d87411588eeabac850e34, strlen($v851f5ac9941d720844d143ed9cfcf60a)));}else {$v341be97d9aff90c9978347f66f945b77 = getLabel($vd304ba20e96d87411588eeabac850e34);}return (is_null($v341be97d9aff90c9978347f66f945b77)) ? $vd304ba20e96d87411588eeabac850e34 : $v341be97d9aff90c9978347f66f945b77;}protected function translateI18n($v341be97d9aff90c9978347f66f945b77, $v240bf022e685b0ee30ad9fe9e1fb5d5b = "") {$vd304ba20e96d87411588eeabac850e34 = getI18n($v341be97d9aff90c9978347f66f945b77, $v240bf022e685b0ee30ad9fe9e1fb5d5b);return (is_null($vd304ba20e96d87411588eeabac850e34)) ? $v341be97d9aff90c9978347f66f945b77 : $vd304ba20e96d87411588eeabac850e34;}};class cacheFrontend extends singleton implements iSingleton {public static $cacheMode = false;public static $currentlangId = false;public static $currentDomainId = false;public static $adminMode = false;public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function getIsConnected() {return false;}protected function __construct() {}public function load() {return false;}public function save() {return false;}public function loadSql() {return false;}public function saveSql() {return false;}public function flush() {return false;}public function del() {return false;}public function loadData() {return false;}public function saveData($v3c6e0b8a9c15224a8228b9a98ca1531d, $v8d777f385d3dfec8815d20f7496026dc, $vcd91e7679d575a2c548bd2c889c23b9e = 5) {}};class ConnectionPool {private static $instance = null;private $pool = array('core' => null);private $connectionClassName = 'mysqlConnection';private function __construct() {return;}static public function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {if(!self::$instance) {self::$instance = new ConnectionPool();}return self::$instance;}public function init() {foreach($this->pool as $v4717d53ebfdfea8477f780ec66151dcb) {if($v4717d53ebfdfea8477f780ec66151dcb instanceof Connection) {$v4717d53ebfdfea8477f780ec66151dcb->open();}}}public function setConnectionObjectClass($v6f66e878c62db60568a3487869695820 = 'mysqlConnection') {if(class_exists($v6f66e878c62db60568a3487869695820) && in_array('IConnection', class_implements($v6f66e878c62db60568a3487869695820)) ) {$this->connectionClassName = $v6f66e878c62db60568a3487869695820;}}public function getConnectionClasses() {return array_keys($this->pool);}public function addConnectionClass($v6f66e878c62db60568a3487869695820) {if(!array_key_exists($v6f66e878c62db60568a3487869695820, $this->pool)) {$this->pool[$v6f66e878c62db60568a3487869695820] = null;}return true;}public function delConnectionClass($v6f66e878c62db60568a3487869695820){if($v6f66e878c62db60568a3487869695820 == 'core') return false;if(isset($this->pool[$v6f66e878c62db60568a3487869695820])){$v4717d53ebfdfea8477f780ec66151dcb = $this->pool[$v6f66e878c62db60568a3487869695820];if($v4717d53ebfdfea8477f780ec66151dcb instanceof Connection) {$v4717d53ebfdfea8477f780ec66151dcb->close();}unset($this->pool[$v6f66e878c62db60568a3487869695820]);return true;}return false;}public function addConnection($v6f66e878c62db60568a3487869695820, $v67b3dba8bc6778101892eb77249db32e, $vd56b699830e77ba53855679cb1d252da, $v5f4dcc3b5aa765d61d8327deb882cf99, $v4cd4a49f25984e26fe708c1fbd896653, $v901555fb06e346cb065ceb9808dcfc25 = false, $v23c6323bfb57bb630b8a2ecf703d6bb0 = false) {$v4176792ad5323d74f2338590ad9db4e4 = $this->connectionClassName;$v4717d53ebfdfea8477f780ec66151dcb    = new $v4176792ad5323d74f2338590ad9db4e4($v67b3dba8bc6778101892eb77249db32e, $vd56b699830e77ba53855679cb1d252da, $v5f4dcc3b5aa765d61d8327deb882cf99, $v4cd4a49f25984e26fe708c1fbd896653, $v901555fb06e346cb065ceb9808dcfc25, $v23c6323bfb57bb630b8a2ecf703d6bb0);if(isset($this->pool[$v6f66e878c62db60568a3487869695820])) {if($this->pool[$v6f66e878c62db60568a3487869695820] instanceof Connection) {$this->pool[$v6f66e878c62db60568a3487869695820]->close();}}$this->pool[$v6f66e878c62db60568a3487869695820] = $v4717d53ebfdfea8477f780ec66151dcb;return true;}public function delConnection($v6f66e878c62db60568a3487869695820) {if(isset($this->pool[$v6f66e878c62db60568a3487869695820])){$v4717d53ebfdfea8477f780ec66151dcb = $this->pool[$v6f66e878c62db60568a3487869695820];if($v4717d53ebfdfea8477f780ec66151dcb instanceof Connection) {$v4717d53ebfdfea8477f780ec66151dcb->close();}$this->pool[$v6f66e878c62db60568a3487869695820] = null;return true;}return false;}public function getConnection($v6f66e878c62db60568a3487869695820 = 'core') {if(!isset($this->pool[$v6f66e878c62db60568a3487869695820])) {$v6f66e878c62db60568a3487869695820 = 'core';}$v4717d53ebfdfea8477f780ec66151dcb = $this->pool[$v6f66e878c62db60568a3487869695820];if(!($v4717d53ebfdfea8477f780ec66151dcb instanceof IConnection)) {throw new Exception("No suitable connection found");}return $v4717d53ebfdfea8477f780ec66151dcb;}public function closeConnection($v6f66e878c62db60568a3487869695820) {if(isset($this->pool[$v6f66e878c62db60568a3487869695820])){$v4717d53ebfdfea8477f780ec66151dcb = $this->pool[$v6f66e878c62db60568a3487869695820];if($v4717d53ebfdfea8477f780ec66151dcb instanceof Connection) {$v4717d53ebfdfea8477f780ec66151dcb->close();}return true;}return false;}};interface IConnection {public function __construct($v67b3dba8bc6778101892eb77249db32e, $vd56b699830e77ba53855679cb1d252da, $v5f4dcc3b5aa765d61d8327deb882cf99, $v4cd4a49f25984e26fe708c1fbd896653, $v901555fb06e346cb065ceb9808dcfc25 = false, $v23c6323bfb57bb630b8a2ecf703d6bb0 = false, $v7e85bcb66fb9a809d5ab4f62a8b8bea8 = true);public function open();public function close();public function query($vbe571b25caf2bbed46f6e47182670bf7, $v3ede331cca63faafb68a34acb42767c6 = false);public function queryResult($vbe571b25caf2bbed46f6e47182670bf7, $v3ede331cca63faafb68a34acb42767c6 = false);public function errorOccured();public function errorDescription();public function isOpen();public function escape($va43c1b0aa53a0c908810c06ab1ff3967);public function getConnectionInfo();};interface IQueryResult extends IteratorAggregate {const FETCH_ARRAY  = 0;const FETCH_ROW    = 1;const FETCH_ASSOC  = 2;const FETCH_OBJECT = 3;public function __construct($_ResultResource, $_fetchType = self::FETCH_ARRAY);public function setFetchType($v78897dfaf41a79226c8c760832b0f4ba);public function getFetchType();public function fetch();public function length();};interface IQueryResultIterator extends Iterator {};class mysqlConnection implements IConnection {private $host  = null;private $username = null;private $password = null;private $dbname  = null;private $port  = false;private $persistent = false;private $critical   = true;private $conn  = null;private $queryCache = array();private $isOpen     = false;public function __construct($v67b3dba8bc6778101892eb77249db32e, $vd56b699830e77ba53855679cb1d252da, $v5f4dcc3b5aa765d61d8327deb882cf99, $v4cd4a49f25984e26fe708c1fbd896653, $v901555fb06e346cb065ceb9808dcfc25 = false, $v23c6323bfb57bb630b8a2ecf703d6bb0 = false, $v7e85bcb66fb9a809d5ab4f62a8b8bea8 = true) {$this->host       = $v67b3dba8bc6778101892eb77249db32e;$this->username   = $vd56b699830e77ba53855679cb1d252da;$this->password   = $v5f4dcc3b5aa765d61d8327deb882cf99;$this->dbname     = $v4cd4a49f25984e26fe708c1fbd896653;$this->port       = $v901555fb06e346cb065ceb9808dcfc25;$this->persistent = $v23c6323bfb57bb630b8a2ecf703d6bb0;$this->critical   = $v7e85bcb66fb9a809d5ab4f62a8b8bea8;}public function open() {if($this->isOpen) return true;try {$vcf1e8c14e54505f60aa10ceb8d5d8ab3 = $this->host . ($this->port ? ':' . $this->port : '');if($this->persistent) {$this->conn = mysql_pconnect($vcf1e8c14e54505f60aa10ceb8d5d8ab3, $this->username, $this->password);}else {$this->conn = mysql_connect($vcf1e8c14e54505f60aa10ceb8d5d8ab3, $this->username, $this->password, true);}if($this->errorOccured()) throw new Exception();if(!mysql_select_db($this->dbname, $this->conn)) throw new Exception();mysql_query("SET NAMES utf8", $this->conn);mysql_query("SET CHARSET utf8", $this->conn);mysql_query("SET CHARACTER SET utf8", $this->conn);mysql_query("SET character_set_client = 'utf8'", $this->conn);mysql_query("SET SESSION collation_connection = 'utf8_general_ci'", $this->conn);mysql_query("SET SQL_BIG_SELECTS=1", $this->conn);}catch(Exception $ve1671797c52e15f763380b45e841ec32) {if($this->critical)    mysql_fatal();else    return false;}$this->isOpen = true;return true;}public function close() {if($this->isOpen) {mysql_close($this->conn);$this->isOpen = false;}}public function query($vbe571b25caf2bbed46f6e47182670bf7, $v3ede331cca63faafb68a34acb42767c6 = false) {if(!$this->open()) return false;$vbe571b25caf2bbed46f6e47182670bf7 = trim($vbe571b25caf2bbed46f6e47182670bf7, " \t\n");if(defined('SQL_QUERY_DEBUG') && SQL_QUERY_DEBUG) {echo $vbe571b25caf2bbed46f6e47182670bf7, "\r\n";}if(strtoupper(substr($vbe571b25caf2bbed46f6e47182670bf7, 0, 6)) != "SELECT" || defined('MYSQL_DISABLE_CACHE')) {$result = mysql_query($vbe571b25caf2bbed46f6e47182670bf7, $this->conn);if($this->errorOccured()) {throw new databaseException($this->errorDescription($vbe571b25caf2bbed46f6e47182670bf7));}return $result;}$v0800fc577294c34e0b28ad2839435945 = md5($vbe571b25caf2bbed46f6e47182670bf7);if(isset($this->queryCache[$v0800fc577294c34e0b28ad2839435945]) && $v3ede331cca63faafb68a34acb42767c6 == false) {$result = $this->queryCache[$v0800fc577294c34e0b28ad2839435945][0];if($this->queryCache[$v0800fc577294c34e0b28ad2839435945][1]) {mysql_data_seek($result, 0);}}else {$result = mysql_query($vbe571b25caf2bbed46f6e47182670bf7, $this->conn);if( $this->errorOccured() ) {$this->queryCache[$v0800fc577294c34e0b28ad2839435945] = false;throw new databaseException( $this->errorDescription($vbe571b25caf2bbed46f6e47182670bf7) );}else {if(SQL_QUERY_CACHE) {$this->queryCache[$v0800fc577294c34e0b28ad2839435945] = array($result, mysql_num_rows($result));}}}return $result;}public function queryResult($vbe571b25caf2bbed46f6e47182670bf7, $v3ede331cca63faafb68a34acb42767c6 = false) {$result = $this->query($vbe571b25caf2bbed46f6e47182670bf7, $v3ede331cca63faafb68a34acb42767c6);return $result ? new mysqlQueryResult($result) : null;}public function errorOccured() {return (strlen(mysql_error($this->conn)) != 0);}public function errorDescription($vc4477f6813fbe8d695d230ed95c5e388 = null) {$v7343c51166ec07160acdf47370768d7a = mysql_error($this->conn);if($vc4477f6813fbe8d695d230ed95c5e388) $v7343c51166ec07160acdf47370768d7a .= " in query: " . $vc4477f6813fbe8d695d230ed95c5e388;return $v7343c51166ec07160acdf47370768d7a;}public function isOpen() {return $this->isOpen;}public function escape($va43c1b0aa53a0c908810c06ab1ff3967) {if($this->isOpen) {return mysql_real_escape_string($va43c1b0aa53a0c908810c06ab1ff3967);}else {return addslashes($va43c1b0aa53a0c908810c06ab1ff3967);}}public function getConnectionInfo() {return array (   'host' => $this->host,   'port' => $this->port,   'user' => $this->username,   'password' => $this->password,   'dbname' => $this->dbname,   'link' => $this->conn  );}};class mysqlQueryResult implements IQueryResult {private $resource  = null;private $fetchType = IQueryResult::FETCH_ARRAY;public function __construct($_mysqlResultResource, $_fetchType = IQueryResult::FETCH_ARRAY) {$this->resource  = $_mysqlResultResource;$this->fetchType = $_fetchType;}public function getIterator() {return new mysqlQueryResultIterator($this->resource, $this->fetchType);}public function setFetchType($v78897dfaf41a79226c8c760832b0f4ba) {if($v78897dfaf41a79226c8c760832b0f4ba > 3) $this->fetchType = IQueryResult::FETCH_ARRAY;else $this->fetchType = $v78897dfaf41a79226c8c760832b0f4ba;}public function getFetchType() {return $this->fetchType;}public function fetch() {$result = null;switch($this->fetchType) {case IQueryResult::FETCH_ARRAY  : $result = mysql_fetch_array($this->resource);break;case IQueryResult::FETCH_ROW    : $result = mysql_fetch_row($this->resource);break;case IQueryResult::FETCH_ASSOC  : $result = mysql_fetch_assoc($this->resource);break;case IQueryResult::FETCH_OBJECT : $result = mysql_fetch_object($this->resource);break;}return $result;}public function length() {return mysql_num_rows($this->resource);}};class mysqlQueryResultIterator implements IQueryResultIterator {private $resource = null;private $number   = 0;private $rowcount = 0;private $fetchType = IQueryResult::FETCH_ARRAY;function __construct($_mysqlResultResource, $_fetchType = IQueryResult::FETCH_ARRAY) {$this->resource = $_mysqlResultResource;$this->fetchType = $_fetchType;$this->rowcount = $this->resource ? mysql_num_rows($this->resource) : 0;}function rewind() {if($this->resource && (mysql_num_rows($this->resource) > 0)) {mysql_data_seek($this->resource, 0);}$this->number  = 0;}function valid() {return $this->number < $this->rowcount;}function key() {return $this->number;}function current() {switch($this->fetchType) {case IQueryResult::FETCH_ARRAY  : return mysql_fetch_array($this->resource);case IQueryResult::FETCH_ROW    : return mysql_fetch_row($this->resource);case IQueryResult::FETCH_ASSOC  : return mysql_fetch_assoc($this->resource);case IQueryResult::FETCH_OBJECT : return mysql_fetch_object($this->resource);}}function next() {$this->number++;}};interface iDbSchemeConverter {public function __construct (iConnection $v4717d53ebfdfea8477f780ec66151dcb, $vd6fe1d0be6347b8ef2427fa629c04485);public function saveXmlToFile();public function restoreDataBase();public function restoreShowCreateTable($v80071f37861c360a27b7327e132c911a);public function getTablesInfo();}class dbSchemeConverter {private $connection;private $dbname;private $dom;private $destinationFile = false;private $sourceFile = false;private $mode = false;private $completed = false;private $state = array();private $inParts = false;private $limit = 1000;private $converterLog = array();public function __construct (iConnection $v4717d53ebfdfea8477f780ec66151dcb) {$this->connection = $v4717d53ebfdfea8477f780ec66151dcb;$vf83bf6b24599a93e973dac160a961455 = $v4717d53ebfdfea8477f780ec66151dcb->getConnectionInfo();$this->dbname = $vf83bf6b24599a93e973dac160a961455['dbname'];}public function setDestinationFile($vd6fe1d0be6347b8ef2427fa629c04485) {$this->destinationFile = $vd6fe1d0be6347b8ef2427fa629c04485;}public function setSourceFile($vd6fe1d0be6347b8ef2427fa629c04485) {$this->sourceFile = $vd6fe1d0be6347b8ef2427fa629c04485;}public function setMode($v15d61712450a686a7f365adf4fef581f = false, $v04ac3ec752774373fb54a91eed1e234a = false, $vaa9f73eea60a006820d0f8768bc8a3fc = 1000) {$this->mode = $v15d61712450a686a7f365adf4fef581f;$this->inParts = $v04ac3ec752774373fb54a91eed1e234a;if ((int) $vaa9f73eea60a006820d0f8768bc8a3fc > 0) $this->limit = (int) $vaa9f73eea60a006820d0f8768bc8a3fc;}public function run() {$this->converterLog = array();switch ($this->mode) {case 'save': {if (!$this->destinationFile) throw new coreException("Please set destination file name");$this->saveXmlToFile();return true;}case 'restore': {$this->getState();$this->restoreDataBase();$this->saveState();return $this->completed;}default: {throw new coreException("Don't know what to do. Please set any appropriate mode.");}}}public function getConverterLog() {return $this->converterLog;}protected function writeLog($v78e731027d8fd50ed642340b7c9a63b3) {if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $v78e731027d8fd50ed642340b7c9a63b3 . "\n\r";else $this->converterLog[] = $v78e731027d8fd50ed642340b7c9a63b3;}protected function reportError($vcb5e100e5a9a3e7f6d1fd97512215282) {if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $vcb5e100e5a9a3e7f6d1fd97512215282 . "\n\r";else $this->converterLog[] = $vcb5e100e5a9a3e7f6d1fd97512215282;}protected function getState() {if (!$this->inParts) return;if (!$this->sourceFile || !$this->destinationFile) {throw new coreException("Please set destination and source file name");}if (file_exists(CURRENT_WORKING_DIR . "/sys-temp/updates/" . md5($this->destinationFile))) {$this->state = unserialize(file_get_contents(CURRENT_WORKING_DIR . "/sys-temp/updates/" . md5($this->destinationFile)));}else {$vdac681f343395a626d61c242bc234b54 = new DOMDocument();if (!$vdac681f343395a626d61c242bc234b54->load($this->sourceFile)) {throw new coreException("Can't load xml: " . $this->sourceFile);}$this->state = array();$ve0117b0fce4515cd6ec5ca5ad796b642 = $vdac681f343395a626d61c242bc234b54->getElementsByTagName('table');foreach ($ve0117b0fce4515cd6ec5ca5ad796b642 as $ve081598e046522840f75fc5afa5eb561) {$this->state[$ve081598e046522840f75fc5afa5eb561->getAttribute('name')] = array();}}}protected function saveState() {if (!$this->inParts) return;if ($this->completed && file_exists(CURRENT_WORKING_DIR . "/sys-temp/updates/" . md5($this->destinationFile))) {unlink(CURRENT_WORKING_DIR . "/sys-temp/updates/" . md5($this->destinationFile));}else {file_put_contents(CURRENT_WORKING_DIR . "/sys-temp/updates/" . md5($this->destinationFile), serialize($this->state));}}private function dumpToXml() {$vdd988cfd769c9f7fbd795a0f5da8e751 = new DOMDocument('1.0', 'utf-8');$vdd988cfd769c9f7fbd795a0f5da8e751->formatOutput = XML_FORMAT_OUTPUT;$vf9b47c173ce144c4a2941b18f85f1657 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('tables', '');$vdd988cfd769c9f7fbd795a0f5da8e751->appendChild($vf9b47c173ce144c4a2941b18f85f1657);$v9ab2ec7ea4a2041306f7bdf150fcd453 = $this->connection->queryResult("SHOW TABLES");foreach ($v9ab2ec7ea4a2041306f7bdf150fcd453 as $vaab9e1de16f38176f86d7a92ba337a8d) {$result = $this->connection->queryResult("SHOW CREATE TABLE `{$vaab9e1de16f38176f86d7a92ba337a8d[0]}`");foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {$v8aa521021a9a89250be765eadd3ed752 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('table', '');$vf9b47c173ce144c4a2941b18f85f1657->appendChild($v8aa521021a9a89250be765eadd3ed752);$vc29a0c0bef824ee1691bc91da9b60bb7 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('name');$v8aa521021a9a89250be765eadd3ed752->appendChild($vc29a0c0bef824ee1691bc91da9b60bb7);$v7affb12a524a065ba5ff47dc80e5bd68 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vaab9e1de16f38176f86d7a92ba337a8d[0]}");$vc29a0c0bef824ee1691bc91da9b60bb7->appendChild($v7affb12a524a065ba5ff47dc80e5bd68);if (preg_match('/DEFAULT\s+CHARSET=([^\s]+)/is', $vf1965a857bc285d26fe22023aa5ab50d[1], $vdbd153490a1c3720a970a611afc4371c)) {if (isset($vdbd153490a1c3720a970a611afc4371c[1])){$vc599f22132934e4b3d154f1cfd56cb2e = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('charset');$v8aa521021a9a89250be765eadd3ed752->appendChild($vc599f22132934e4b3d154f1cfd56cb2e);$ve5d0962eff92f38b2e72c53d669e3626 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vdbd153490a1c3720a970a611afc4371c[1]}");$vc599f22132934e4b3d154f1cfd56cb2e->appendChild($ve5d0962eff92f38b2e72c53d669e3626);}}if (preg_match('/ENGINE=([^\s]+)/is', $vf1965a857bc285d26fe22023aa5ab50d[1], $vad1943a9fd6d3d7ee1e6af41a5b0d3e7)) {if (isset($vad1943a9fd6d3d7ee1e6af41a5b0d3e7[1])) {$v8f7e1a71bc5f9dce800cee376eb7ce23 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('engine');$v8aa521021a9a89250be765eadd3ed752->appendChild($v8f7e1a71bc5f9dce800cee376eb7ce23);$vf7c4490f8f7e88649bad5b724644eb93 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vad1943a9fd6d3d7ee1e6af41a5b0d3e7[1]}");$v8f7e1a71bc5f9dce800cee376eb7ce23->appendChild($vf7c4490f8f7e88649bad5b724644eb93);}}$vf1965a857bc285d26fe22023aa5ab50d[1] = preg_replace("/\)\s+ENGINE=(.*)/is", "", $vf1965a857bc285d26fe22023aa5ab50d[1]);$vf1965a857bc285d26fe22023aa5ab50d[1] = preg_replace("/CREATE\s+TABLE\s+`(.*)`\s+\(/i", "", $vf1965a857bc285d26fe22023aa5ab50d[1]);preg_match("/(CONSTRAINT\s.*)/is", $vf1965a857bc285d26fe22023aa5ab50d[1], $vd178923285d63e9968956a0a4758267e);if (isset($vd178923285d63e9968956a0a4758267e[1])) {$v7d0eebcb8f63adb4c1f9fc3daf46885f = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('constraints', '');$v8aa521021a9a89250be765eadd3ed752->appendChild($v7d0eebcb8f63adb4c1f9fc3daf46885f);$vd178923285d63e9968956a0a4758267e = explode(',',$vd178923285d63e9968956a0a4758267e[1]);foreach ($vd178923285d63e9968956a0a4758267e as $v3677ab7adaf00725e9fdbaed503a94e3) {$v46bd73f579ba23905e73677fb1afec2c = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('constraint', '');$v7d0eebcb8f63adb4c1f9fc3daf46885f->appendChild($v46bd73f579ba23905e73677fb1afec2c);preg_match("/`([a-zA-Z0-9?_\s+])+`/", $v3677ab7adaf00725e9fdbaed503a94e3, $v9c28d32df234037773be184dbdafc274);preg_match("/`(.*)`/", $v9c28d32df234037773be184dbdafc274[0], $vb068931cc450442b63f5b3d276ea4297);$vb068931cc450442b63f5b3d276ea4297[1] = str_replace('?', ' ', $vb068931cc450442b63f5b3d276ea4297[1]);preg_match("/FOREIGN\s+KEY\s+\(`([a-zA-Z0-9_])+`\)/i", $v3677ab7adaf00725e9fdbaed503a94e3, $v9c28d32df234037773be184dbdafc274);preg_match("/`(.*)`/", $v9c28d32df234037773be184dbdafc274[0], $vbb29c5595c5076e1231e67c7f2bc85b6);preg_match("/REFERENCES\s+`(.*)`\s+\(/i", $v3677ab7adaf00725e9fdbaed503a94e3, $v20459cc30c07816a23805604d092f22f);preg_match("/REFERENCES\s+`.*`\s+\(`(.*)`/i", $v3677ab7adaf00725e9fdbaed503a94e3, $v7b2ea0625e2a6f14b0ed8a13a38924c2);$vc29a0c0bef824ee1691bc91da9b60bb7 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('name');$v46bd73f579ba23905e73677fb1afec2c->appendChild($vc29a0c0bef824ee1691bc91da9b60bb7);$v7affb12a524a065ba5ff47dc80e5bd68 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vb068931cc450442b63f5b3d276ea4297[1]}");$vc29a0c0bef824ee1691bc91da9b60bb7->appendChild($v7affb12a524a065ba5ff47dc80e5bd68);$v31c42d0e732b08c885b76fa37cc7acc2 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('field');$v46bd73f579ba23905e73677fb1afec2c->appendChild($v31c42d0e732b08c885b76fa37cc7acc2);$v57e27ca74c5e54c344c5894320e56241 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vbb29c5595c5076e1231e67c7f2bc85b6[1]}");$v31c42d0e732b08c885b76fa37cc7acc2->appendChild($v57e27ca74c5e54c344c5894320e56241);$v85e9ab7d2846f57c5c27469b16454468 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('ref-table');$v46bd73f579ba23905e73677fb1afec2c->appendChild($v85e9ab7d2846f57c5c27469b16454468);$v3268af892d00bd0f74f5675fa61d7298 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$v20459cc30c07816a23805604d092f22f[1]}");$v85e9ab7d2846f57c5c27469b16454468->appendChild($v3268af892d00bd0f74f5675fa61d7298);$vde54f046021e5f497123ada7f65836fe = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('ref-field');$v46bd73f579ba23905e73677fb1afec2c->appendChild($vde54f046021e5f497123ada7f65836fe);$v8f7acac5fa7d14c769bef005b6b04e08 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$v7b2ea0625e2a6f14b0ed8a13a38924c2[1]}");$vde54f046021e5f497123ada7f65836fe->appendChild($v8f7acac5fa7d14c769bef005b6b04e08);preg_match("/ON\s+DELETE\s+(CASCADE|SET\s+NULL)/i", $v3677ab7adaf00725e9fdbaed503a94e3, $vbcc17da57901a31e4cc3fba8876be8f6);if (isset($vbcc17da57901a31e4cc3fba8876be8f6[1])) {$v616fe4faff6079442b75ec8afcec4788 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('on-delete');$v46bd73f579ba23905e73677fb1afec2c->appendChild($v616fe4faff6079442b75ec8afcec4788);$ve5c8f996bbf2cc2318bbbb265eb6d1a5 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vbcc17da57901a31e4cc3fba8876be8f6[1]}");$v616fe4faff6079442b75ec8afcec4788->appendChild($ve5c8f996bbf2cc2318bbbb265eb6d1a5);}preg_match("/ON\s+UPDATE\s+(CASCADE|SET\s+NULL)/i", $v3677ab7adaf00725e9fdbaed503a94e3, $vaf9d6dce8d058cbfb5da8f0f05e7ab4e);if (isset($vaf9d6dce8d058cbfb5da8f0f05e7ab4e[1])) {$vf42ef5beec1cbb8c8993f53acb6f63b0 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('on-update');$v46bd73f579ba23905e73677fb1afec2c->appendChild($vf42ef5beec1cbb8c8993f53acb6f63b0);$v9fff4607129f87c27db1e0506cf87db1 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vaf9d6dce8d058cbfb5da8f0f05e7ab4e[1]}");$vf42ef5beec1cbb8c8993f53acb6f63b0->appendChild($v9fff4607129f87c27db1e0506cf87db1);}}$vf1965a857bc285d26fe22023aa5ab50d[1] = preg_replace("/(CONSTRAINT\s.*)/is", '', $vf1965a857bc285d26fe22023aa5ab50d[1]);}preg_match("/PRIMARY\s+KEY\s+\(`(.*)`\)/i", $vf1965a857bc285d26fe22023aa5ab50d[1], $v570346d3ab4c94d612d87e2b4c11fa19);if (isset($v570346d3ab4c94d612d87e2b4c11fa19[1])) {$vf1965a857bc285d26fe22023aa5ab50d[1] = preg_replace("/PRIMARY\s+KEY\s+\(`.*`\)/i", '', $vf1965a857bc285d26fe22023aa5ab50d[1]);}preg_match("/UNIQUE\s+KEY\s+(.*)\)/i", $vf1965a857bc285d26fe22023aa5ab50d[1], $v3529589900c75126818a69e896e8d0fb);if (isset($v3529589900c75126818a69e896e8d0fb[1])) {$vf1965a857bc285d26fe22023aa5ab50d[1] = preg_replace("/UNIQUE\s+KEY\s+.*\)/i", '', $vf1965a857bc285d26fe22023aa5ab50d[1]);}preg_match("/(KEY\s.*)/is", $vf1965a857bc285d26fe22023aa5ab50d[1], $v14f802e1fba977727845e8872c1743a7);if(isset($v570346d3ab4c94d612d87e2b4c11fa19[1]) || isset($v14f802e1fba977727845e8872c1743a7[1]) || isset($v3529589900c75126818a69e896e8d0fb[1])) {$v0615948ca3f33523852fba208a218e40 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('indexes', '');$v8aa521021a9a89250be765eadd3ed752->appendChild($v0615948ca3f33523852fba208a218e40);}if (isset($v570346d3ab4c94d612d87e2b4c11fa19[1])) {$v36b319e553f48e7ceec4152b1b6a03eb = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('index', '');$v0615948ca3f33523852fba208a218e40->appendChild($v36b319e553f48e7ceec4152b1b6a03eb);$vd84f86942f3b468c7a94ffd29f1692c5 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('type');$v36b319e553f48e7ceec4152b1b6a03eb->appendChild($vd84f86942f3b468c7a94ffd29f1692c5);$vd715cd65fa587a300e46c7cf192bb431 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("PRIMARY");$vd84f86942f3b468c7a94ffd29f1692c5->appendChild($vd715cd65fa587a300e46c7cf192bb431);$v3519c0cc6f934f2bb6eb86822b2e861a = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('field', "{$v570346d3ab4c94d612d87e2b4c11fa19[1]}");$v36b319e553f48e7ceec4152b1b6a03eb->appendChild($v3519c0cc6f934f2bb6eb86822b2e861a);}if (isset($v3529589900c75126818a69e896e8d0fb[1])) {$v36b319e553f48e7ceec4152b1b6a03eb = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('index', '');$v0615948ca3f33523852fba208a218e40->appendChild($v36b319e553f48e7ceec4152b1b6a03eb);$vd84f86942f3b468c7a94ffd29f1692c5 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('type');$v36b319e553f48e7ceec4152b1b6a03eb->appendChild($vd84f86942f3b468c7a94ffd29f1692c5);$vd715cd65fa587a300e46c7cf192bb431 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("UNIQUE");$vd84f86942f3b468c7a94ffd29f1692c5->appendChild($vd715cd65fa587a300e46c7cf192bb431);preg_match("/`(.*)`\s+\(/", $v3529589900c75126818a69e896e8d0fb[1], $vb068931cc450442b63f5b3d276ea4297);$vc29a0c0bef824ee1691bc91da9b60bb7 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('name');$v36b319e553f48e7ceec4152b1b6a03eb->appendChild($vc29a0c0bef824ee1691bc91da9b60bb7);$v7affb12a524a065ba5ff47dc80e5bd68 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vb068931cc450442b63f5b3d276ea4297[1]}");$vc29a0c0bef824ee1691bc91da9b60bb7->appendChild($v7affb12a524a065ba5ff47dc80e5bd68);preg_match("/\((.*)/", $v3529589900c75126818a69e896e8d0fb[1], $v9c28d32df234037773be184dbdafc274);$vd05b6ed7d2345020440df396d6da7f73 = explode(',', $v9c28d32df234037773be184dbdafc274[1]);foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {preg_match("/\((\d+)\)/", $v06e3d36fa30cea095545139854ad1fb9, $v2fa47f7c65fec19cc163b195725e3844);preg_match("/`(.*)`/", $v06e3d36fa30cea095545139854ad1fb9, $v972bf3f05d14ffbdb817bef60638ff00);$v3519c0cc6f934f2bb6eb86822b2e861a = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('field', "{$v972bf3f05d14ffbdb817bef60638ff00[1]}");$v36b319e553f48e7ceec4152b1b6a03eb->appendChild($v3519c0cc6f934f2bb6eb86822b2e861a);if(isset($v2fa47f7c65fec19cc163b195725e3844[1])) {$vc4c577e2cfb01bdf7f46b8aed811e349 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('length');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($vc4c577e2cfb01bdf7f46b8aed811e349);$vbe3826963325fafe464b3893b63399e1 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$v2fa47f7c65fec19cc163b195725e3844[1]}");$vc4c577e2cfb01bdf7f46b8aed811e349->appendChild($vbe3826963325fafe464b3893b63399e1);}}}if (isset($v14f802e1fba977727845e8872c1743a7[1])) {$v14f802e1fba977727845e8872c1743a7[1] = preg_replace("/`\),/", "` ),", $v14f802e1fba977727845e8872c1743a7[1]);$v14f802e1fba977727845e8872c1743a7[1] = preg_replace("/\)\),/", ") ),", $v14f802e1fba977727845e8872c1743a7[1]);$v14f802e1fba977727845e8872c1743a7 = preg_split("/\s+\),/",$v14f802e1fba977727845e8872c1743a7[1]);foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) {$v3c6e0b8a9c15224a8228b9a98ca1531d = trim($v3c6e0b8a9c15224a8228b9a98ca1531d);if (strlen($v3c6e0b8a9c15224a8228b9a98ca1531d)) {preg_match("/`(.*)`\s+\(/", $v3c6e0b8a9c15224a8228b9a98ca1531d, $vb068931cc450442b63f5b3d276ea4297);$v36b319e553f48e7ceec4152b1b6a03eb = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('index', '');$v0615948ca3f33523852fba208a218e40->appendChild($v36b319e553f48e7ceec4152b1b6a03eb);$vc29a0c0bef824ee1691bc91da9b60bb7 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('name');$v36b319e553f48e7ceec4152b1b6a03eb->appendChild($vc29a0c0bef824ee1691bc91da9b60bb7);$v7affb12a524a065ba5ff47dc80e5bd68 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vb068931cc450442b63f5b3d276ea4297[1]}");$vc29a0c0bef824ee1691bc91da9b60bb7->appendChild($v7affb12a524a065ba5ff47dc80e5bd68);preg_match("/\((.*)/", $v3c6e0b8a9c15224a8228b9a98ca1531d, $v9c28d32df234037773be184dbdafc274);$vd05b6ed7d2345020440df396d6da7f73 = explode(',', $v9c28d32df234037773be184dbdafc274[1]);foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {preg_match("/\((\d+)\)/", $v06e3d36fa30cea095545139854ad1fb9, $v2fa47f7c65fec19cc163b195725e3844);preg_match("/`(.*)`/", $v06e3d36fa30cea095545139854ad1fb9, $v972bf3f05d14ffbdb817bef60638ff00);$v3519c0cc6f934f2bb6eb86822b2e861a = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('field', "{$v972bf3f05d14ffbdb817bef60638ff00[1]}");$v36b319e553f48e7ceec4152b1b6a03eb->appendChild($v3519c0cc6f934f2bb6eb86822b2e861a);if(isset($v2fa47f7c65fec19cc163b195725e3844[1])) {$vc4c577e2cfb01bdf7f46b8aed811e349 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('length');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($vc4c577e2cfb01bdf7f46b8aed811e349);$vbe3826963325fafe464b3893b63399e1 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$v2fa47f7c65fec19cc163b195725e3844[1]}");$vc4c577e2cfb01bdf7f46b8aed811e349->appendChild($vbe3826963325fafe464b3893b63399e1);}}}}$vf1965a857bc285d26fe22023aa5ab50d[1] = preg_replace("/(KEY\s.*)/is", '', $vf1965a857bc285d26fe22023aa5ab50d[1]);}$vf25666ec7d1e534a13f641251310e226 = preg_split('/\n/',$vf1965a857bc285d26fe22023aa5ab50d[1]);$v55110d7377696363c7b1992850a3102a = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('fields', '');$v8aa521021a9a89250be765eadd3ed752->appendChild($v55110d7377696363c7b1992850a3102a);foreach ($vf25666ec7d1e534a13f641251310e226 as $v06e3d36fa30cea095545139854ad1fb9) {$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/,$/s", "", $v06e3d36fa30cea095545139854ad1fb9);$v06e3d36fa30cea095545139854ad1fb9 = trim($v06e3d36fa30cea095545139854ad1fb9);if (strlen($v06e3d36fa30cea095545139854ad1fb9)>1) {$v3519c0cc6f934f2bb6eb86822b2e861a = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('field');$v55110d7377696363c7b1992850a3102a->appendChild($v3519c0cc6f934f2bb6eb86822b2e861a);preg_match("/COMMENT\s+'(.*)'/i", $v06e3d36fa30cea095545139854ad1fb9, $v06d4cd63bde972fc66a0aed41d2f5c51);if (isset($v06d4cd63bde972fc66a0aed41d2f5c51[1])) {$v333d4e8e00d9533b1a986b85cb68a2d7 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('comment');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($v333d4e8e00d9533b1a986b85cb68a2d7);$vb420ab913b515a67edf91b99b23fcd94 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$v06d4cd63bde972fc66a0aed41d2f5c51[1]}");$v333d4e8e00d9533b1a986b85cb68a2d7->appendChild($vb420ab913b515a67edf91b99b23fcd94);$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/COMMENT\s+'.*'/i", "", $v06e3d36fa30cea095545139854ad1fb9);}preg_match("/\s+(BINARY|UNSIGNED\s+ZEROFILL|UNSIGNED|on\s+update\s+CURRENT_TIMESTAMP)/i", $v06e3d36fa30cea095545139854ad1fb9, $vd2eb444e35c0a71f0a85df8194acb5b6);if(isset($vd2eb444e35c0a71f0a85df8194acb5b6[1])) {$va900d2a490d6314ab0fa284c0afd20af = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('attributes');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($va900d2a490d6314ab0fa284c0afd20af);$v1c9856f244f76695dac6f3e6a08761c4 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vd2eb444e35c0a71f0a85df8194acb5b6[1]}");$va900d2a490d6314ab0fa284c0afd20af->appendChild($v1c9856f244f76695dac6f3e6a08761c4);$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/\s+BINARY|\s+UNSIGNED\s+ZEROFILL|\s+UNSIGNED|\s+on\s+update\s+CURRENT_TIMESTAMP/i", "", $v06e3d36fa30cea095545139854ad1fb9);}preg_match("/\s+(NOT\s+NULL)/i", $v06e3d36fa30cea095545139854ad1fb9, $v78a62b57a46b05718f1fc38e9be60223);if(isset($v78a62b57a46b05718f1fc38e9be60223[1])) {$v6093c18a542b533deabe01279f68a9ff = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('not-null');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($v6093c18a542b533deabe01279f68a9ff);$v6b853dfb19bee3eef67c33b658dd0753 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("1");$v6093c18a542b533deabe01279f68a9ff->appendChild($v6b853dfb19bee3eef67c33b658dd0753);$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/\s+NOT\s+NULL/i", "", $v06e3d36fa30cea095545139854ad1fb9);}preg_match("/\s+(AUTO_INCREMENT)/i", $v06e3d36fa30cea095545139854ad1fb9, $v8c36426826ccf38cedc202042ef32a38);if(isset($v8c36426826ccf38cedc202042ef32a38[1])) {$v464f947c2cd3d7fcab84ba97b1eddaab = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('increment');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($v464f947c2cd3d7fcab84ba97b1eddaab);$v548e43f2cdf2f615fd675c94c140a2ce = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("1");$v464f947c2cd3d7fcab84ba97b1eddaab->appendChild($v548e43f2cdf2f615fd675c94c140a2ce);$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/\s+AUTO_INCREMENT/i", "", $v06e3d36fa30cea095545139854ad1fb9);}preg_match("/\s+DEFAULT\s+(.*)/i", $v06e3d36fa30cea095545139854ad1fb9, $vc21f969b5f03d33d43e04f8f136e7682);if(isset($vc21f969b5f03d33d43e04f8f136e7682[1])) {preg_match("/'(.*)'/", $vc21f969b5f03d33d43e04f8f136e7682[1], $ve3cc92c14a5e6dd1a7d94b6ff634d7fc);if (isset($ve3cc92c14a5e6dd1a7d94b6ff634d7fc[1])) $vc21f969b5f03d33d43e04f8f136e7682[1] = $ve3cc92c14a5e6dd1a7d94b6ff634d7fc[1];$v06ef98e04ec8d66e6046a23cbac99a68 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('default');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($v06ef98e04ec8d66e6046a23cbac99a68);$v0db17aa1d80e20064fe42736b1c76de8 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vc21f969b5f03d33d43e04f8f136e7682[1]}");$v06ef98e04ec8d66e6046a23cbac99a68->appendChild($v0db17aa1d80e20064fe42736b1c76de8);$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/\s+DEFAULT\s+.*/i", "", $v06e3d36fa30cea095545139854ad1fb9);}preg_match("/`(.*)`/", $v06e3d36fa30cea095545139854ad1fb9, $vb068931cc450442b63f5b3d276ea4297);if (isset($vb068931cc450442b63f5b3d276ea4297[1])) {$vc29a0c0bef824ee1691bc91da9b60bb7 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('name');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($vc29a0c0bef824ee1691bc91da9b60bb7);$v7affb12a524a065ba5ff47dc80e5bd68 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vb068931cc450442b63f5b3d276ea4297[1]}");$vc29a0c0bef824ee1691bc91da9b60bb7->appendChild($v7affb12a524a065ba5ff47dc80e5bd68);$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/`.*`/", "", $v06e3d36fa30cea095545139854ad1fb9);}preg_match("/\((\d+|\d+,\d+)\)/", $v06e3d36fa30cea095545139854ad1fb9, $vf7bd60b75b29d79b660a2859395c1a24);if (isset($vf7bd60b75b29d79b660a2859395c1a24[1])) {$v9f0786fd7358950c74f2ecec9958a608 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('size');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($v9f0786fd7358950c74f2ecec9958a608);$v6f4cf5076b722f9563e0fa6dbcff3018 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$vf7bd60b75b29d79b660a2859395c1a24[1]}");$v9f0786fd7358950c74f2ecec9958a608->appendChild($v6f4cf5076b722f9563e0fa6dbcff3018);$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/\({$vf7bd60b75b29d79b660a2859395c1a24[1]}\)/", "", $v06e3d36fa30cea095545139854ad1fb9);}preg_match("/\((.*)\)/", $v06e3d36fa30cea095545139854ad1fb9, $vf7bd60b75b29d79b660a2859395c1a24);if (isset($vf7bd60b75b29d79b660a2859395c1a24[1])) {$v93da65a9fd0004d9477aeac024e08e15 = preg_replace("/'/", '', $vf7bd60b75b29d79b660a2859395c1a24[1]);$v93da65a9fd0004d9477aeac024e08e15 = explode(',', $v93da65a9fd0004d9477aeac024e08e15);foreach ($v93da65a9fd0004d9477aeac024e08e15 as $vef3e30e070f70244fd6578d88a6b77ac) {$v3854490910df9108058de2c5c98b8b13 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('option', $vef3e30e070f70244fd6578d88a6b77ac);$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($v3854490910df9108058de2c5c98b8b13);}$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/\((.*)\)/", "", $v06e3d36fa30cea095545139854ad1fb9);}$v06e3d36fa30cea095545139854ad1fb9 = preg_replace("/,/", "", $v06e3d36fa30cea095545139854ad1fb9);$v06e3d36fa30cea095545139854ad1fb9 = trim($v06e3d36fa30cea095545139854ad1fb9);if ($v06e3d36fa30cea095545139854ad1fb9) {$vd84f86942f3b468c7a94ffd29f1692c5 = $vdd988cfd769c9f7fbd795a0f5da8e751->createAttribute('type');$v3519c0cc6f934f2bb6eb86822b2e861a->appendChild($vd84f86942f3b468c7a94ffd29f1692c5);$vd715cd65fa587a300e46c7cf192bb431 = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode("{$v06e3d36fa30cea095545139854ad1fb9}");$vd84f86942f3b468c7a94ffd29f1692c5->appendChild($vd715cd65fa587a300e46c7cf192bb431);}}}}}return $vdd988cfd769c9f7fbd795a0f5da8e751->saveXML($vdd988cfd769c9f7fbd795a0f5da8e751->documentElement, DOM_LOAD_OPTIONS);}public function saveXmlToFile() {if (!file_put_contents($this->destinationFile, $this->dumpToXml())) {throw new coreException("Cannot create new xml file " . $this->destinationFile);}}public function restoreShowCreateTable($v80071f37861c360a27b7327e132c911a) {$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument();if (!$v9a09b4dfda82e3e665e31092d1c3ec8d->load($this->sourceFile)) {throw new coreException("Can't load xml: " . $this->sourceFile);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v9a09b4dfda82e3e665e31092d1c3ec8d);$vaab9e1de16f38176f86d7a92ba337a8d = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']")->item(0);$v6b463f2cc2f409da62a14ee5fe4b816a = "CREATE TABLE `{$v80071f37861c360a27b7327e132c911a}` (\n";$vc7ec484aa0cc70ef637682bd6e5bfe2e = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('fields');if(is_object($vc7ec484aa0cc70ef637682bd6e5bfe2e->item(0))) {$vd05b6ed7d2345020440df396d6da7f73 = $vc7ec484aa0cc70ef637682bd6e5bfe2e->item(0)->getElementsByTagName('field');foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {$v6b463f2cc2f409da62a14ee5fe4b816a .="\t";if($v972bf3f05d14ffbdb817bef60638ff00 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('name')) $v6b463f2cc2f409da62a14ee5fe4b816a .= "`{$v972bf3f05d14ffbdb817bef60638ff00}`";if($v833750ac635fcc57dc33ecafe365f9a7 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('type')) $v6b463f2cc2f409da62a14ee5fe4b816a .=" {$v833750ac635fcc57dc33ecafe365f9a7}";if ($v59ebf8e686724f0cf779fb2a9ecf59c2 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('size')) $v6b463f2cc2f409da62a14ee5fe4b816a .="({$v59ebf8e686724f0cf779fb2a9ecf59c2})";if($v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option')->length) {$v93da65a9fd0004d9477aeac024e08e15 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option');$v2216ff1f4b7cff0a68acab5c55100e4f = '';$v865c0c0b4ab0e063e5caa3387c1a8741 = 1;foreach ($v93da65a9fd0004d9477aeac024e08e15 as $vef3e30e070f70244fd6578d88a6b77ac) {if($v865c0c0b4ab0e063e5caa3387c1a8741 == $v93da65a9fd0004d9477aeac024e08e15->length) $v2216ff1f4b7cff0a68acab5c55100e4f .= "'{$vef3e30e070f70244fd6578d88a6b77ac->nodeValue}'";else $v2216ff1f4b7cff0a68acab5c55100e4f .= "'{$vef3e30e070f70244fd6578d88a6b77ac->nodeValue}',";$v865c0c0b4ab0e063e5caa3387c1a8741++;}$v6b463f2cc2f409da62a14ee5fe4b816a .="({$v2216ff1f4b7cff0a68acab5c55100e4f})";}if ($v33045d9ddb408d27dbcbc3ca53d5583e = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('attributes')) $v6b463f2cc2f409da62a14ee5fe4b816a .=" {$v33045d9ddb408d27dbcbc3ca53d5583e}";if ($v1f662954e1ee120a4aab8716234e109a = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('not-null')) $v6b463f2cc2f409da62a14ee5fe4b816a .=" NOT NULL";if($v06e3d36fa30cea095545139854ad1fb9->hasAttribute('default')){$vb40b5e5897a4cdfa5bb06346fa44deb3=$v06e3d36fa30cea095545139854ad1fb9->getAttribute('default');if($vb40b5e5897a4cdfa5bb06346fa44deb3 !='NULL') $vb40b5e5897a4cdfa5bb06346fa44deb3 = "'{$vb40b5e5897a4cdfa5bb06346fa44deb3}'";$v6b463f2cc2f409da62a14ee5fe4b816a .=" DEFAULT {$vb40b5e5897a4cdfa5bb06346fa44deb3}";}if ($vdb70917e4a5b25354aed4db9dadb0afc = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('increment')) $v6b463f2cc2f409da62a14ee5fe4b816a .=" AUTO_INCREMENT";if ($vf23104cd881ba30152c4981a93d80185 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('comment')) $v6b463f2cc2f409da62a14ee5fe4b816a .=" COMMENT '{$vf23104cd881ba30152c4981a93d80185}'";$v6b463f2cc2f409da62a14ee5fe4b816a .= ",\n";}}$v7e41f53a3c84926d1d7995de56944c27 = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('indexes');if(is_object($v7e41f53a3c84926d1d7995de56944c27->item(0))) {$v626998f31a2e3a6b36816dcb3bb63ab3 = $v7e41f53a3c84926d1d7995de56944c27->item(0)->getElementsByTagName('index');foreach ($v626998f31a2e3a6b36816dcb3bb63ab3 as $v6a992d5529f459a44fee58c733255e86) {$v6b463f2cc2f409da62a14ee5fe4b816a .="\t";if($va83af96ce0bc256deeb3ce660dcebacc = $v6a992d5529f459a44fee58c733255e86->getAttribute('type')) $v6b463f2cc2f409da62a14ee5fe4b816a .= "{$va83af96ce0bc256deeb3ce660dcebacc} ";$v6b463f2cc2f409da62a14ee5fe4b816a .= "KEY";if($v14374754c27bc1eef6a7e737213600e3 = $v6a992d5529f459a44fee58c733255e86->getAttribute('name')) $v6b463f2cc2f409da62a14ee5fe4b816a .= " `{$v14374754c27bc1eef6a7e737213600e3}`";if($v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field')->length) {$vd05b6ed7d2345020440df396d6da7f73 = $v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field');$v339cc492c232e5b3a1242dcbf6240e04 = '';$v865c0c0b4ab0e063e5caa3387c1a8741 = 1;foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {$v319e2726bcc98302437312a8ebfe9deb = "`{$v06e3d36fa30cea095545139854ad1fb9->nodeValue}`";if($v0f1a6fa1e9e0963e1ac389661ba0b603 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('length')) $v319e2726bcc98302437312a8ebfe9deb .= "({$v0f1a6fa1e9e0963e1ac389661ba0b603})";if($v865c0c0b4ab0e063e5caa3387c1a8741 == $vd05b6ed7d2345020440df396d6da7f73->length) $v339cc492c232e5b3a1242dcbf6240e04 .= $v319e2726bcc98302437312a8ebfe9deb;else $v339cc492c232e5b3a1242dcbf6240e04 .= "{$v319e2726bcc98302437312a8ebfe9deb},";$v865c0c0b4ab0e063e5caa3387c1a8741++;}$v6b463f2cc2f409da62a14ee5fe4b816a .=" ({$v339cc492c232e5b3a1242dcbf6240e04})";}$v6b463f2cc2f409da62a14ee5fe4b816a .= ",\n";}}$vedc2dd68d1be92a82a9d8362bbae0895 = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('constraints');if(is_object($vedc2dd68d1be92a82a9d8362bbae0895->item(0))) {$vd178923285d63e9968956a0a4758267e = $vedc2dd68d1be92a82a9d8362bbae0895->item(0)->getElementsByTagName('constraint');foreach ($vd178923285d63e9968956a0a4758267e as $v3677ab7adaf00725e9fdbaed503a94e3) {$v6b463f2cc2f409da62a14ee5fe4b816a .= "\tCONSTRAINT";if($v4d5fdbc896088855bd8a568b5ffd9abb = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('name')) $v6b463f2cc2f409da62a14ee5fe4b816a .= " `{$v4d5fdbc896088855bd8a568b5ffd9abb}`";if ($vfd40c91ee81d59fccbcab8644500e3e4 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('field')) $v6b463f2cc2f409da62a14ee5fe4b816a .= " FOREIGN KEY (`{$vfd40c91ee81d59fccbcab8644500e3e4}`)";if ($v9b992b703884cf36b8cad1966fe086f9 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-table')) $v6b463f2cc2f409da62a14ee5fe4b816a .= " REFERENCES `{$v9b992b703884cf36b8cad1966fe086f9}`";if($v1aaf3ab1a76a2b4e7a6bf784293cc4df = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-field')) $v6b463f2cc2f409da62a14ee5fe4b816a .= " (`{$v1aaf3ab1a76a2b4e7a6bf784293cc4df}`)";if($v269738db81007d986968bb0e3e20768b = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('on-delete')) $v6b463f2cc2f409da62a14ee5fe4b816a .= " ON DELETE {$v269738db81007d986968bb0e3e20768b}";if($v844db8803d63e7e046c30d82b772d410 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('on-update')) $v6b463f2cc2f409da62a14ee5fe4b816a .= " ON UPDATE {$v844db8803d63e7e046c30d82b772d410}";$v6b463f2cc2f409da62a14ee5fe4b816a .= ",\n";}}$v6b463f2cc2f409da62a14ee5fe4b816a = preg_replace("/,$/s", "", $v6b463f2cc2f409da62a14ee5fe4b816a);if($v0499bf152a9954b9cf9981fd078eb0b8 = $vaab9e1de16f38176f86d7a92ba337a8d->getAttribute('engine')) $v6b463f2cc2f409da62a14ee5fe4b816a .= ") ENGINE={$v0499bf152a9954b9cf9981fd078eb0b8}";if($vd5cbc6798435d4fe67a443679b239dd6 = $vaab9e1de16f38176f86d7a92ba337a8d->getAttribute('charset')) $v6b463f2cc2f409da62a14ee5fe4b816a .= " DEFAULT CHARSET={$vd5cbc6798435d4fe67a443679b239dd6}";$v6b463f2cc2f409da62a14ee5fe4b816a .= "\n";return $v6b463f2cc2f409da62a14ee5fe4b816a;}private function createDataBaseTable($v80071f37861c360a27b7327e132c911a) {$v6b463f2cc2f409da62a14ee5fe4b816a = $this->restoreShowCreateTable($v80071f37861c360a27b7327e132c911a);$v260ca9dd8a4577fc00b7bd5810298076 = true;try {$this->connection->queryResult($v6b463f2cc2f409da62a14ee5fe4b816a);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->reportError($ve1671797c52e15f763380b45e841ec32->getMessage());$v260ca9dd8a4577fc00b7bd5810298076 = false;}if ($v260ca9dd8a4577fc00b7bd5810298076) $this->writeLog("Data base table {$v80071f37861c360a27b7327e132c911a} has been created");}private function changeTableEngine($v80071f37861c360a27b7327e132c911a, $v0499bf152a9954b9cf9981fd078eb0b8){$v260ca9dd8a4577fc00b7bd5810298076 = true;try {$this->connection->queryResult("ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` ENGINE={$v0499bf152a9954b9cf9981fd078eb0b8}");}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->reportError($ve1671797c52e15f763380b45e841ec32->getMessage());$v260ca9dd8a4577fc00b7bd5810298076 = false;}if ($v260ca9dd8a4577fc00b7bd5810298076) $this->writeLog("Data base table ({$v80071f37861c360a27b7327e132c911a}) engine has been changed");}private function changeTableCharset($v80071f37861c360a27b7327e132c911a, $vd5cbc6798435d4fe67a443679b239dd6){$v260ca9dd8a4577fc00b7bd5810298076 = true;try {$this->connection->queryResult("ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` DEFAULT CHARACTER SET {$vd5cbc6798435d4fe67a443679b239dd6}");}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->reportError($ve1671797c52e15f763380b45e841ec32->getMessage());$v260ca9dd8a4577fc00b7bd5810298076 = false;}if ($v260ca9dd8a4577fc00b7bd5810298076) $this->writeLog("Data base table ({$v80071f37861c360a27b7327e132c911a}) character set has been changed");$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument();if (!$v9a09b4dfda82e3e665e31092d1c3ec8d->load($this->sourceFile)) {throw new coreException("Can't load xml: " . $this->sourceFile);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v9a09b4dfda82e3e665e31092d1c3ec8d);$vaab9e1de16f38176f86d7a92ba337a8d = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']")->item(0);$vc7ec484aa0cc70ef637682bd6e5bfe2e = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('fields');if(is_object($vc7ec484aa0cc70ef637682bd6e5bfe2e->item(0))) {$vd05b6ed7d2345020440df396d6da7f73 = $vc7ec484aa0cc70ef637682bd6e5bfe2e->item(0)->getElementsByTagName('field');foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {if($v972bf3f05d14ffbdb817bef60638ff00 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('name')) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'modify');}}}private function createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, $veca07335a33c5aeb5e1bc7c98b4b9d80) {$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument();if (!$v9a09b4dfda82e3e665e31092d1c3ec8d->load($this->sourceFile)) {throw new coreException("Can't load xml: " . $this->sourceFile);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v9a09b4dfda82e3e665e31092d1c3ec8d);if (!$v06e3d36fa30cea095545139854ad1fb9 = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}']")->item(0)) {throw new coreException("Cannot change {$v80071f37861c360a27b7327e132c911a}.{$v972bf3f05d14ffbdb817bef60638ff00}");}if ($veca07335a33c5aeb5e1bc7c98b4b9d80 =='add') $ve32bc0b0e4d21d624198a196f73a0d72 = "ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` ADD ";else $ve32bc0b0e4d21d624198a196f73a0d72 = "ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` MODIFY ";$ve32bc0b0e4d21d624198a196f73a0d72 .= "`{$v972bf3f05d14ffbdb817bef60638ff00}`";if ($v833750ac635fcc57dc33ecafe365f9a7 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('type')) $ve32bc0b0e4d21d624198a196f73a0d72 .=" {$v833750ac635fcc57dc33ecafe365f9a7}";if ($v59ebf8e686724f0cf779fb2a9ecf59c2 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('size')) $ve32bc0b0e4d21d624198a196f73a0d72 .="({$v59ebf8e686724f0cf779fb2a9ecf59c2})";if ($v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option')->length) {$v93da65a9fd0004d9477aeac024e08e15 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option');$v2216ff1f4b7cff0a68acab5c55100e4f = '';$v865c0c0b4ab0e063e5caa3387c1a8741 = 1;foreach ($v93da65a9fd0004d9477aeac024e08e15 as $vef3e30e070f70244fd6578d88a6b77ac) {if($v865c0c0b4ab0e063e5caa3387c1a8741 == $v93da65a9fd0004d9477aeac024e08e15->length) $v2216ff1f4b7cff0a68acab5c55100e4f .= "'{$vef3e30e070f70244fd6578d88a6b77ac->nodeValue}'";else $v2216ff1f4b7cff0a68acab5c55100e4f .= "'{$vef3e30e070f70244fd6578d88a6b77ac->nodeValue}',";$v865c0c0b4ab0e063e5caa3387c1a8741++;}$ve32bc0b0e4d21d624198a196f73a0d72 .="({$v2216ff1f4b7cff0a68acab5c55100e4f})";}if ($v33045d9ddb408d27dbcbc3ca53d5583e = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('attributes')) $ve32bc0b0e4d21d624198a196f73a0d72 .=" {$v33045d9ddb408d27dbcbc3ca53d5583e}";if ($v1f662954e1ee120a4aab8716234e109a = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('not-null')) $ve32bc0b0e4d21d624198a196f73a0d72 .=" NOT NULL";if ($v06e3d36fa30cea095545139854ad1fb9->hasAttribute('default')){$vb40b5e5897a4cdfa5bb06346fa44deb3=$v06e3d36fa30cea095545139854ad1fb9->getAttribute('default');if ($vb40b5e5897a4cdfa5bb06346fa44deb3 !='NULL') $vb40b5e5897a4cdfa5bb06346fa44deb3 = "'{$vb40b5e5897a4cdfa5bb06346fa44deb3}'";$ve32bc0b0e4d21d624198a196f73a0d72 .=" DEFAULT {$vb40b5e5897a4cdfa5bb06346fa44deb3}";}if ($vdb70917e4a5b25354aed4db9dadb0afc = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('increment')) $ve32bc0b0e4d21d624198a196f73a0d72 .=" AUTO_INCREMENT";if ($vf23104cd881ba30152c4981a93d80185 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('comment')) $ve32bc0b0e4d21d624198a196f73a0d72 .=" COMMENT '{$vf23104cd881ba30152c4981a93d80185}'";$v260ca9dd8a4577fc00b7bd5810298076 = true;try {$this->connection->queryResult($ve32bc0b0e4d21d624198a196f73a0d72);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->reportError($ve1671797c52e15f763380b45e841ec32->getMessage());$v260ca9dd8a4577fc00b7bd5810298076 = false;}if ($v260ca9dd8a4577fc00b7bd5810298076) {if ($veca07335a33c5aeb5e1bc7c98b4b9d80 == 'add') $this->writeLog("Data base table ({$v80071f37861c360a27b7327e132c911a}) field ({$v972bf3f05d14ffbdb817bef60638ff00}) has been created");else $this->writeLog("Data base table ({$v80071f37861c360a27b7327e132c911a}) field ({$v972bf3f05d14ffbdb817bef60638ff00}) has been changed");}}private function createTableIndex($v80071f37861c360a27b7327e132c911a, $v14374754c27bc1eef6a7e737213600e3, $veca07335a33c5aeb5e1bc7c98b4b9d80) {$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument();if (!$v9a09b4dfda82e3e665e31092d1c3ec8d->load($this->sourceFile)) {throw new coreException("Can't load xml: " . $this->sourceFile);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v9a09b4dfda82e3e665e31092d1c3ec8d);if(!$v6a992d5529f459a44fee58c733255e86 = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@name='{$v14374754c27bc1eef6a7e737213600e3}']")->item(0)) throw new coreException("Cannot change index {$v14374754c27bc1eef6a7e737213600e3} in table {$v80071f37861c360a27b7327e132c911a}");$v54ab67a5a309953d86da71541c0723c0 = "ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` ADD ";if ($va83af96ce0bc256deeb3ce660dcebacc = $v6a992d5529f459a44fee58c733255e86->getAttribute('type')) {if ($va83af96ce0bc256deeb3ce660dcebacc == "UNIQUE") $v54ab67a5a309953d86da71541c0723c0 .= "UNIQUE";}else $v54ab67a5a309953d86da71541c0723c0 .="INDEX";if ($v14374754c27bc1eef6a7e737213600e3) $v54ab67a5a309953d86da71541c0723c0 .=" `{$v14374754c27bc1eef6a7e737213600e3}`";if ($v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field')->length) {$vd05b6ed7d2345020440df396d6da7f73 = $v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field');$v339cc492c232e5b3a1242dcbf6240e04 = '';$v865c0c0b4ab0e063e5caa3387c1a8741 = 1;foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {$v319e2726bcc98302437312a8ebfe9deb = "`{$v06e3d36fa30cea095545139854ad1fb9->nodeValue}`";if($v0f1a6fa1e9e0963e1ac389661ba0b603 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('length')) $v319e2726bcc98302437312a8ebfe9deb .="({$v0f1a6fa1e9e0963e1ac389661ba0b603})";if($v865c0c0b4ab0e063e5caa3387c1a8741 == $vd05b6ed7d2345020440df396d6da7f73->length) $v339cc492c232e5b3a1242dcbf6240e04 .= $v319e2726bcc98302437312a8ebfe9deb;else $v339cc492c232e5b3a1242dcbf6240e04 .= "{$v319e2726bcc98302437312a8ebfe9deb},";$v865c0c0b4ab0e063e5caa3387c1a8741++;}$v54ab67a5a309953d86da71541c0723c0 .=" ({$v339cc492c232e5b3a1242dcbf6240e04})";}if ($veca07335a33c5aeb5e1bc7c98b4b9d80 =='modify') {if ($v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field')->length) {$vd05b6ed7d2345020440df396d6da7f73 = $v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field');foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {$v319e2726bcc98302437312a8ebfe9deb = $v06e3d36fa30cea095545139854ad1fb9->nodeValue;if($v3677ab7adaf00725e9fdbaed503a94e3 = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@field='{$v319e2726bcc98302437312a8ebfe9deb}']")->item(0)) {if($v4d5fdbc896088855bd8a568b5ffd9abb = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('name')) $this->connection->queryResult("ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` DROP FOREIGN KEY `{$v4d5fdbc896088855bd8a568b5ffd9abb}`");}}}$this->connection->queryResult("ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` DROP INDEX `{$v14374754c27bc1eef6a7e737213600e3}`");$v260ca9dd8a4577fc00b7bd5810298076 = true;try {$this->connection->queryResult($v54ab67a5a309953d86da71541c0723c0);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->reportError($ve1671797c52e15f763380b45e841ec32->getMessage());$v260ca9dd8a4577fc00b7bd5810298076 = false;}if ($v260ca9dd8a4577fc00b7bd5810298076) $this->writeLog("Data base table ({$v80071f37861c360a27b7327e132c911a}) index ({$v14374754c27bc1eef6a7e737213600e3}) has been changed");if ($v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field')->length) {$vd05b6ed7d2345020440df396d6da7f73 = $v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field');foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {$v319e2726bcc98302437312a8ebfe9deb = $v06e3d36fa30cea095545139854ad1fb9->nodeValue;if($v3677ab7adaf00725e9fdbaed503a94e3 = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@field='{$v319e2726bcc98302437312a8ebfe9deb}']")->item(0)) {if($v4d5fdbc896088855bd8a568b5ffd9abb = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('name')) $this->createTableConstraint($v80071f37861c360a27b7327e132c911a, $v4d5fdbc896088855bd8a568b5ffd9abb, 'add');}}}}else {$v260ca9dd8a4577fc00b7bd5810298076 = true;try {$this->connection->queryResult($v54ab67a5a309953d86da71541c0723c0);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->reportError($ve1671797c52e15f763380b45e841ec32->getMessage());$v260ca9dd8a4577fc00b7bd5810298076 = false;}if ($v260ca9dd8a4577fc00b7bd5810298076) $this->writeLog("Data base table ({$v80071f37861c360a27b7327e132c911a}) index ({$v14374754c27bc1eef6a7e737213600e3}) has been created");}}private function createTableConstraint($v80071f37861c360a27b7327e132c911a, $v4d5fdbc896088855bd8a568b5ffd9abb, $veca07335a33c5aeb5e1bc7c98b4b9d80) {$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument();if (!$v9a09b4dfda82e3e665e31092d1c3ec8d->load($this->sourceFile)) {throw new coreException("Can't load xml: " . $this->sourceFile);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v9a09b4dfda82e3e665e31092d1c3ec8d);if (!$v3677ab7adaf00725e9fdbaed503a94e3 = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}']")->item(0)) throw new coreException("Cannot change constraint {$v4d5fdbc896088855bd8a568b5ffd9abb} in table {$v80071f37861c360a27b7327e132c911a}");if ($veca07335a33c5aeb5e1bc7c98b4b9d80 =='modify') $this->connection->queryResult("ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` DROP FOREIGN KEY `{$v4d5fdbc896088855bd8a568b5ffd9abb}`");$v0480ae49c25d260515a7ddff4de63231 = "ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` ADD CONSTRAINT";$v0480ae49c25d260515a7ddff4de63231 .=" `{$v4d5fdbc896088855bd8a568b5ffd9abb}`";if ($vfd40c91ee81d59fccbcab8644500e3e4 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('field')) $v0480ae49c25d260515a7ddff4de63231 .=" FOREIGN KEY (`{$vfd40c91ee81d59fccbcab8644500e3e4}`)";if ($v9b992b703884cf36b8cad1966fe086f9 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-table')) $v0480ae49c25d260515a7ddff4de63231 .=" REFERENCES `{$v9b992b703884cf36b8cad1966fe086f9}`";if($v1aaf3ab1a76a2b4e7a6bf784293cc4df = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-field')) $v0480ae49c25d260515a7ddff4de63231 .=" (`{$v1aaf3ab1a76a2b4e7a6bf784293cc4df}`)";if($v269738db81007d986968bb0e3e20768b = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('on-delete')) $v0480ae49c25d260515a7ddff4de63231 .=" ON DELETE {$v269738db81007d986968bb0e3e20768b}";if($v844db8803d63e7e046c30d82b772d410 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('on-update')) $v0480ae49c25d260515a7ddff4de63231 .=" ON UPDATE {$v844db8803d63e7e046c30d82b772d410}";$v260ca9dd8a4577fc00b7bd5810298076 = true;try {$this->connection->queryResult($v0480ae49c25d260515a7ddff4de63231);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->reportError($ve1671797c52e15f763380b45e841ec32->getMessage());$v260ca9dd8a4577fc00b7bd5810298076 = false;}if ($v260ca9dd8a4577fc00b7bd5810298076) {if ($veca07335a33c5aeb5e1bc7c98b4b9d80 == 'add') $this->writeLog("Data base table ({$v80071f37861c360a27b7327e132c911a}) constraint ({$v4d5fdbc896088855bd8a568b5ffd9abb}) has been created");else $this->writeLog("Data base table ({$v80071f37861c360a27b7327e132c911a}) constraint ({$v4d5fdbc896088855bd8a568b5ffd9abb}) has been changed");}if($v269738db81007d986968bb0e3e20768b) {if ($v269738db81007d986968bb0e3e20768b == "SET NULL") {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<END
					UPDATE `{$v80071f37861c360a27b7327e132c911a}`
					SET {$vfd40c91ee81d59fccbcab8644500e3e4} = null
					WHERE {$vfd40c91ee81d59fccbcab8644500e3e4} NOT IN (
						SELECT {$v1aaf3ab1a76a2b4e7a6bf784293cc4df}
						FROM {$v9b992b703884cf36b8cad1966fe086f9}
					)
END;   }if ($v269738db81007d986968bb0e3e20768b == "CASCADE") {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<END
					DELETE FROM `{$v80071f37861c360a27b7327e132c911a}`
					WHERE {$vfd40c91ee81d59fccbcab8644500e3e4} NOT IN (
						SELECT {$v1aaf3ab1a76a2b4e7a6bf784293cc4df}
						FROM {$v9b992b703884cf36b8cad1966fe086f9}
					)
END;   }$this->connection->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);}}public function restoreDataBase() {$vdac681f343395a626d61c242bc234b54 = new DOMDocument();if (!$vdac681f343395a626d61c242bc234b54->load($this->sourceFile)) {throw new coreException("Can't load xml: " . $this->sourceFile);}$v719ad8631f632a1d7d6ef89cbac6ad69 = new DOMDocument();if (!$v719ad8631f632a1d7d6ef89cbac6ad69->load($this->destinationFile)) {throw new coreException("Can't load xml: " . $this->destinationFile);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v719ad8631f632a1d7d6ef89cbac6ad69);$ve0117b0fce4515cd6ec5ca5ad796b642 = $vdac681f343395a626d61c242bc234b54->getElementsByTagName('table');foreach ($ve0117b0fce4515cd6ec5ca5ad796b642 as $vaab9e1de16f38176f86d7a92ba337a8d) {$v80071f37861c360a27b7327e132c911a = $vaab9e1de16f38176f86d7a92ba337a8d->getAttribute('name');if ($this->inParts && isset($this->state[$v80071f37861c360a27b7327e132c911a]['complete']) && $this->state[$v80071f37861c360a27b7327e132c911a]['complete'] == true) continue;$this->connection->queryResult("SET foreign_key_checks = 0");$this->writeLog("Start checking table {$v80071f37861c360a27b7327e132c911a}");if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']")->length) $this->createDataBaseTable($v80071f37861c360a27b7327e132c911a);else {$v770c639e20ac2f19c5ae0da373080e25 = l_mysql_query("SELECT count(*) FROM `{$v80071f37861c360a27b7327e132c911a}`");list($va516bbcfe024488c3bc26c21e7c2ae6b) = mysql_fetch_row($v770c639e20ac2f19c5ae0da373080e25);if ($va516bbcfe024488c3bc26c21e7c2ae6b > 10000) {$v6ae39f7819d3b799bf81a86b76525767 = $this->checkTableRestore($v80071f37861c360a27b7327e132c911a);if($this->inParts) {end($this->state);$this->completed = ((key($this->state) == $v80071f37861c360a27b7327e132c911a) && $v6ae39f7819d3b799bf81a86b76525767);return $this->completed;}continue;}$v0499bf152a9954b9cf9981fd078eb0b8 = $vaab9e1de16f38176f86d7a92ba337a8d->getAttribute('engine');if(!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}' and @engine='{$v0499bf152a9954b9cf9981fd078eb0b8}']")->item(0)) $this->changeTableEngine($v80071f37861c360a27b7327e132c911a, $v0499bf152a9954b9cf9981fd078eb0b8);$vd5cbc6798435d4fe67a443679b239dd6 = $vaab9e1de16f38176f86d7a92ba337a8d->getAttribute('charset');if(!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}' and @charset='{$vd5cbc6798435d4fe67a443679b239dd6}']")->item(0)) $this->changeTableCharset($v80071f37861c360a27b7327e132c911a, $vd5cbc6798435d4fe67a443679b239dd6);$vc7ec484aa0cc70ef637682bd6e5bfe2e = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('fields');if (is_object($vc7ec484aa0cc70ef637682bd6e5bfe2e->item(0))) {$vd05b6ed7d2345020440df396d6da7f73 = $vc7ec484aa0cc70ef637682bd6e5bfe2e->item(0)->getElementsByTagName('field');$v7e41f53a3c84926d1d7995de56944c27 = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('indexes');if(is_object($v7e41f53a3c84926d1d7995de56944c27->item(0))) {$v626998f31a2e3a6b36816dcb3bb63ab3 = $v7e41f53a3c84926d1d7995de56944c27->item(0)->getElementsByTagName('index');foreach ($v626998f31a2e3a6b36816dcb3bb63ab3 as $v6a992d5529f459a44fee58c733255e86){if($v6a992d5529f459a44fee58c733255e86->getAttribute('type') == 'PRIMARY') {if($v7431f604cf1d265c1c02cb3e7faed60c = $v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field')->item(0)->nodeValue) {if ($v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@type='PRIMARY']/field")->item(0)) {$v341bd7ad194928c2a29b85f54147c6a4 = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@type='PRIMARY']/field")->item(0)->nodeValue;if ($v7431f604cf1d265c1c02cb3e7faed60c != $v341bd7ad194928c2a29b85f54147c6a4) {if($v6cfbf553dfee5bf39b9277983e56407a = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name = '{$v341bd7ad194928c2a29b85f54147c6a4}' and @increment='1']")->item(0)) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v341bd7ad194928c2a29b85f54147c6a4, 'modify');if($vd178923285d63e9968956a0a4758267e = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table/constraints/constraint[@ref-table='{$v80071f37861c360a27b7327e132c911a}' and @ref-field='{$v341bd7ad194928c2a29b85f54147c6a4}']")) {foreach($vd178923285d63e9968956a0a4758267e as $v3677ab7adaf00725e9fdbaed503a94e3) {$v4d5fdbc896088855bd8a568b5ffd9abb = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('name');$vefc6d526040cc303278e28b1d806cebe = $v3677ab7adaf00725e9fdbaed503a94e3->parentNode->parentNode->getAttribute('name');$this->connection->queryResult("ALTER TABLE `{$vefc6d526040cc303278e28b1d806cebe}` DROP FOREIGN KEY `{$v4d5fdbc896088855bd8a568b5ffd9abb}`");}}$this->connection->queryResult("ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` DROP PRIMARY KEY");$this->connection->queryResult("ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` ADD PRIMARY KEY ({$v7431f604cf1d265c1c02cb3e7faed60c})");}}else $this->connection->queryResult("ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` ADD PRIMARY KEY ({$v7431f604cf1d265c1c02cb3e7faed60c})");}}}}foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {if ($v972bf3f05d14ffbdb817bef60638ff00 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('name')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'add');else {if ($v833750ac635fcc57dc33ecafe365f9a7 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('type')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @type='{$v833750ac635fcc57dc33ecafe365f9a7}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'modify');}if ($v59ebf8e686724f0cf779fb2a9ecf59c2 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('size')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @size='{$v59ebf8e686724f0cf779fb2a9ecf59c2}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'modify');}if ($v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option')->length) {$v93da65a9fd0004d9477aeac024e08e15 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option');foreach ($v93da65a9fd0004d9477aeac024e08e15 as $vef3e30e070f70244fd6578d88a6b77ac) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}'][option ='{$vef3e30e070f70244fd6578d88a6b77ac->nodeValue}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'modify');}}if ($v33045d9ddb408d27dbcbc3ca53d5583e = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('attributes')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @attributes='{$v33045d9ddb408d27dbcbc3ca53d5583e}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'modify');}if ($v1f662954e1ee120a4aab8716234e109a = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('not-null')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @not-null='{$v1f662954e1ee120a4aab8716234e109a}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'modify');}if ($v06e3d36fa30cea095545139854ad1fb9->hasAttribute('default')){$vb40b5e5897a4cdfa5bb06346fa44deb3=$v06e3d36fa30cea095545139854ad1fb9->getAttribute('default');if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @default='{$vb40b5e5897a4cdfa5bb06346fa44deb3}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'modify');}if ($vdb70917e4a5b25354aed4db9dadb0afc = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('increment')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @increment='{$vdb70917e4a5b25354aed4db9dadb0afc}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'modify');}if ($vf23104cd881ba30152c4981a93d80185 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('comment')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @comment='{$vf23104cd881ba30152c4981a93d80185}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'modify');}}}}}$v7e41f53a3c84926d1d7995de56944c27 = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('indexes');if(is_object($v7e41f53a3c84926d1d7995de56944c27->item(0))) {$v626998f31a2e3a6b36816dcb3bb63ab3 = $v7e41f53a3c84926d1d7995de56944c27->item(0)->getElementsByTagName('index');foreach ($v626998f31a2e3a6b36816dcb3bb63ab3 as $v6a992d5529f459a44fee58c733255e86) {if($v14374754c27bc1eef6a7e737213600e3 = $v6a992d5529f459a44fee58c733255e86->getAttribute('name')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@name='{$v14374754c27bc1eef6a7e737213600e3}']")->length) $this->createTableIndex($v80071f37861c360a27b7327e132c911a, $v14374754c27bc1eef6a7e737213600e3, 'add');else {if($va83af96ce0bc256deeb3ce660dcebacc = $v6a992d5529f459a44fee58c733255e86->getAttribute('type')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@name='{$v14374754c27bc1eef6a7e737213600e3}' and @type='{$va83af96ce0bc256deeb3ce660dcebacc}']")->length) $this->createTableIndex($v80071f37861c360a27b7327e132c911a, $v14374754c27bc1eef6a7e737213600e3, 'modify');}if($v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field')->length) {$vd05b6ed7d2345020440df396d6da7f73 = $v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field');foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@name='{$v14374754c27bc1eef6a7e737213600e3}'][field = '{$v06e3d36fa30cea095545139854ad1fb9->nodeValue}']")->length) $this->createTableIndex($v80071f37861c360a27b7327e132c911a, $v14374754c27bc1eef6a7e737213600e3, 'modify');else {if($v0f1a6fa1e9e0963e1ac389661ba0b603 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('length')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@name='{$v14374754c27bc1eef6a7e737213600e3}'][field[@length='{$v0f1a6fa1e9e0963e1ac389661ba0b603}'] ='{$v06e3d36fa30cea095545139854ad1fb9->nodeValue}']")->length) $this->createTableIndex($v80071f37861c360a27b7327e132c911a, $v14374754c27bc1eef6a7e737213600e3, 'modify');}}}}}}}}$vedc2dd68d1be92a82a9d8362bbae0895 = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('constraints');if(is_object($vedc2dd68d1be92a82a9d8362bbae0895->item(0))) {$vd178923285d63e9968956a0a4758267e = $vedc2dd68d1be92a82a9d8362bbae0895->item(0)->getElementsByTagName('constraint');foreach ($vd178923285d63e9968956a0a4758267e as $v3677ab7adaf00725e9fdbaed503a94e3) {if ($v4d5fdbc896088855bd8a568b5ffd9abb = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('name')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}']")->item(0)) $this->createTableConstraint($v80071f37861c360a27b7327e132c911a, $v4d5fdbc896088855bd8a568b5ffd9abb, 'add');else {if ($vfd40c91ee81d59fccbcab8644500e3e4 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('field')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @field='{$vfd40c91ee81d59fccbcab8644500e3e4}']")->item(0)) $this->createTableConstraint($v80071f37861c360a27b7327e132c911a, $v4d5fdbc896088855bd8a568b5ffd9abb, 'modify');}if ($v9b992b703884cf36b8cad1966fe086f9 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-table')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @ref-table='{$v9b992b703884cf36b8cad1966fe086f9}']")->item(0)) $this->createTableConstraint($v80071f37861c360a27b7327e132c911a, $v4d5fdbc896088855bd8a568b5ffd9abb, 'modify');}if ($v1aaf3ab1a76a2b4e7a6bf784293cc4df = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-field')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @ref-field='{$v1aaf3ab1a76a2b4e7a6bf784293cc4df}']")->item(0)) $this->createTableConstraint($v80071f37861c360a27b7327e132c911a, $v4d5fdbc896088855bd8a568b5ffd9abb, 'modify');}if ($v269738db81007d986968bb0e3e20768b = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('on-delete')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @on-delete='{$v269738db81007d986968bb0e3e20768b}']")->item(0)) $this->createTableConstraint($v80071f37861c360a27b7327e132c911a, $v4d5fdbc896088855bd8a568b5ffd9abb, 'modify');}if ($v844db8803d63e7e046c30d82b772d410 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('on-update')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @on-update='{$v844db8803d63e7e046c30d82b772d410}']")->item(0)) $this->createTableConstraint($v80071f37861c360a27b7327e132c911a, $v4d5fdbc896088855bd8a568b5ffd9abb, 'modify');}}}}}}$this->connection->queryResult("SET foreign_key_checks = 1");if($this->inParts) {$this->state[$v80071f37861c360a27b7327e132c911a]['complete'] = true;end($this->state);$this->completed = (key($this->state) == $v80071f37861c360a27b7327e132c911a);return $this->completed;}}}protected function prepareTable($v80071f37861c360a27b7327e132c911a) {if ($this->inParts) {if (isset($this->state[$v80071f37861c360a27b7327e132c911a]['info'])) {return $this->state[$v80071f37861c360a27b7327e132c911a]['info'];}}$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument();$v9a09b4dfda82e3e665e31092d1c3ec8d->load($this->sourceFile);$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v9a09b4dfda82e3e665e31092d1c3ec8d);$vaa9c62903e6c715017ac9e17affc86c8 = $this->restoreShowCreateTable($v80071f37861c360a27b7327e132c911a);$v6bc414d01b568a956ec80b9451c47dd2 = $v80071f37861c360a27b7327e132c911a . '_temp';while(true) {$v260ca9dd8a4577fc00b7bd5810298076 = false;try {$this->connection->queryResult("SHOW CREATE TABLE `{$v6bc414d01b568a956ec80b9451c47dd2}`");}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$v260ca9dd8a4577fc00b7bd5810298076 = true;}if (!$v260ca9dd8a4577fc00b7bd5810298076) {$result = $this->connection->queryResult("SHOW CREATE TABLE `{$v6bc414d01b568a956ec80b9451c47dd2}`");foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {$v05b32caf5bda74d902a7d17bcd503c4d = str_replace($v6bc414d01b568a956ec80b9451c47dd2, $v80071f37861c360a27b7327e132c911a, $vf1965a857bc285d26fe22023aa5ab50d[1]);$v05b32caf5bda74d902a7d17bcd503c4d = preg_replace("/\s/", '', $v05b32caf5bda74d902a7d17bcd503c4d);$v2b0e19a624ce9c16fe44c27f349421f3 = preg_replace("/\s/", "", $vaa9c62903e6c715017ac9e17affc86c8);if (stripos($v2b0e19a624ce9c16fe44c27f349421f3, $v05b32caf5bda74d902a7d17bcd503c4d) !== false) {l_mysql_query("DROP TABLE `{$v6bc414d01b568a956ec80b9451c47dd2}`");$v260ca9dd8a4577fc00b7bd5810298076 = true;}}}if ($v260ca9dd8a4577fc00b7bd5810298076) {break;}else {$v6bc414d01b568a956ec80b9451c47dd2 .= '1';}}if ($v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint")->length) {$vd178923285d63e9968956a0a4758267e = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint");foreach ($vd178923285d63e9968956a0a4758267e as $v3677ab7adaf00725e9fdbaed503a94e3){$v4d5fdbc896088855bd8a568b5ffd9abb = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('name');try {l_mysql_query("ALTER TABLE `{$v80071f37861c360a27b7327e132c911a}` DROP FOREIGN KEY `{$v4d5fdbc896088855bd8a568b5ffd9abb}`");}catch (Exception $ve1671797c52e15f763380b45e841ec32){}$v269738db81007d986968bb0e3e20768b = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('on-delete');if($v269738db81007d986968bb0e3e20768b) {$vfd40c91ee81d59fccbcab8644500e3e4 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('field');$v9b992b703884cf36b8cad1966fe086f9 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-table');$v1aaf3ab1a76a2b4e7a6bf784293cc4df = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-field');if ($v269738db81007d986968bb0e3e20768b == "SET NULL") {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<END
							UPDATE `{$v80071f37861c360a27b7327e132c911a}`
							SET {$vfd40c91ee81d59fccbcab8644500e3e4} = null
							WHERE {$vfd40c91ee81d59fccbcab8644500e3e4} NOT IN (
								SELECT {$v1aaf3ab1a76a2b4e7a6bf784293cc4df}
								FROM {$v9b992b703884cf36b8cad1966fe086f9}
							)
END;     }if ($v269738db81007d986968bb0e3e20768b == "CASCADE") {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<END
							DELETE FROM `{$v80071f37861c360a27b7327e132c911a}`
							WHERE {$vfd40c91ee81d59fccbcab8644500e3e4} NOT IN (
								SELECT {$v1aaf3ab1a76a2b4e7a6bf784293cc4df}
								FROM {$v9b992b703884cf36b8cad1966fe086f9}
							)
END;     }try {l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}catch (Exception $ve1671797c52e15f763380b45e841ec32){}}}}$vaa9c62903e6c715017ac9e17affc86c8 = str_replace("CREATE TABLE `{$v80071f37861c360a27b7327e132c911a}`", "CREATE TABLE `{$v6bc414d01b568a956ec80b9451c47dd2}`", $vaa9c62903e6c715017ac9e17affc86c8);l_mysql_query($vaa9c62903e6c715017ac9e17affc86c8);$v770c639e20ac2f19c5ae0da373080e25 = l_mysql_query("SELECT count(*) FROM `{$v80071f37861c360a27b7327e132c911a}`", true);list($va516bbcfe024488c3bc26c21e7c2ae6b) = mysql_fetch_row($v770c639e20ac2f19c5ae0da373080e25);$vcaf9b6b99962bf5c2264824231d7a40c = array(   'temp_table' => $v6bc414d01b568a956ec80b9451c47dd2,   'count_rows' => $va516bbcfe024488c3bc26c21e7c2ae6b  );if ($this->inParts) {$this->state[$v80071f37861c360a27b7327e132c911a]['info'] = $vcaf9b6b99962bf5c2264824231d7a40c;}return $vcaf9b6b99962bf5c2264824231d7a40c;}protected function restoreTableInParts($v80071f37861c360a27b7327e132c911a) {$vcaf9b6b99962bf5c2264824231d7a40c = $this->prepareTable($v80071f37861c360a27b7327e132c911a);$v6bc414d01b568a956ec80b9451c47dd2 = $vcaf9b6b99962bf5c2264824231d7a40c['temp_table'];$va516bbcfe024488c3bc26c21e7c2ae6b = $vcaf9b6b99962bf5c2264824231d7a40c['count_rows'];$vd05b6ed7d2345020440df396d6da7f73 = $this->getNecessaryFields($v80071f37861c360a27b7327e132c911a);$vd05b6ed7d2345020440df396d6da7f73 = implode(', ', $vd05b6ed7d2345020440df396d6da7f73);if ($this->inParts) {$v7a86c157ee9713c34fbd7a1ee40f0c5a = isset($this->state[$v80071f37861c360a27b7327e132c911a]['info']['offset']) ? $this->state[$v80071f37861c360a27b7327e132c911a]['info']['offset'] : 0;l_mysql_query("INSERT INTO `{$v6bc414d01b568a956ec80b9451c47dd2}` ({$vd05b6ed7d2345020440df396d6da7f73}) (SELECT {$vd05b6ed7d2345020440df396d6da7f73} FROM {$v80071f37861c360a27b7327e132c911a} LIMIT {$this->limit} OFFSET {$v7a86c157ee9713c34fbd7a1ee40f0c5a})");}else {$v2764ca9d34e90313978d044f27ae433b = ceil($va516bbcfe024488c3bc26c21e7c2ae6b / $this->limit);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v2764ca9d34e90313978d044f27ae433b;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v7a86c157ee9713c34fbd7a1ee40f0c5a = $v865c0c0b4ab0e063e5caa3387c1a8741 * $this->limit;l_mysql_query("INSERT INTO `{$v6bc414d01b568a956ec80b9451c47dd2}` ({$vd05b6ed7d2345020440df396d6da7f73}) (SELECT {$vd05b6ed7d2345020440df396d6da7f73} FROM {$v80071f37861c360a27b7327e132c911a} LIMIT {$this->limit} OFFSET {$v7a86c157ee9713c34fbd7a1ee40f0c5a})");}}$vad8a8576a4307920be1bb16930b4ec0a = l_mysql_query("SELECT count(*) FROM `{$v6bc414d01b568a956ec80b9451c47dd2}`", true);list($v7815232913d5ca8d9b04c4bdb8f72c24) = mysql_fetch_row($vad8a8576a4307920be1bb16930b4ec0a);if ($va516bbcfe024488c3bc26c21e7c2ae6b == $v7815232913d5ca8d9b04c4bdb8f72c24) {l_mysql_query("DROP TABLE `{$v80071f37861c360a27b7327e132c911a}`");l_mysql_query("RENAME TABLE `{$v6bc414d01b568a956ec80b9451c47dd2}` TO `{$v80071f37861c360a27b7327e132c911a}`");$this->writeLog("Data base table ({$v80071f37861c360a27b7327e132c911a}) structure has been updated");if ($this->inParts) {$this->state[$v80071f37861c360a27b7327e132c911a]['complete'] = true;}return true;}else {if ($this->inParts) {$this->state[$v80071f37861c360a27b7327e132c911a]['info']['offset'] = $v7a86c157ee9713c34fbd7a1ee40f0c5a + $this->limit;$this->writeLog("{$v7815232913d5ca8d9b04c4bdb8f72c24}({$va516bbcfe024488c3bc26c21e7c2ae6b}) rows have been updated in table `({$v80071f37861c360a27b7327e132c911a})`");}else {$this->reportError(getLabel("label-errors-13059") . $v80071f37861c360a27b7327e132c911a . "/");}return false;}}protected function checkTableRestore($v80071f37861c360a27b7327e132c911a) {if($this->inParts && isset($this->state[$v80071f37861c360a27b7327e132c911a]['info'])) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}$vdac681f343395a626d61c242bc234b54 = new DOMDocument();if (!$vdac681f343395a626d61c242bc234b54->load($this->sourceFile)) {throw new coreException("Can't load xml: " . $this->sourceFile);}$v719ad8631f632a1d7d6ef89cbac6ad69 = new DOMDocument();if (!$v719ad8631f632a1d7d6ef89cbac6ad69->load($this->destinationFile)) {throw new coreException("Can't load xml: " . $this->destinationFile);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v719ad8631f632a1d7d6ef89cbac6ad69);$ve0117b0fce4515cd6ec5ca5ad796b642 = $vdac681f343395a626d61c242bc234b54->getElementsByTagName('table');foreach ($ve0117b0fce4515cd6ec5ca5ad796b642 as $ve081598e046522840f75fc5afa5eb561) {if ($ve081598e046522840f75fc5afa5eb561->getAttribute('name') == $v80071f37861c360a27b7327e132c911a){$vaab9e1de16f38176f86d7a92ba337a8d = $ve081598e046522840f75fc5afa5eb561;break;}}$vc7ec484aa0cc70ef637682bd6e5bfe2e = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('fields');if (is_object($vc7ec484aa0cc70ef637682bd6e5bfe2e->item(0))) {$vd05b6ed7d2345020440df396d6da7f73 = $vc7ec484aa0cc70ef637682bd6e5bfe2e->item(0)->getElementsByTagName('field');foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {if ($v972bf3f05d14ffbdb817bef60638ff00 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('name')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}']")->length) $this->createTableField($v80071f37861c360a27b7327e132c911a, $v972bf3f05d14ffbdb817bef60638ff00, 'add');else {if ($v833750ac635fcc57dc33ecafe365f9a7 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('type')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @type='{$v833750ac635fcc57dc33ecafe365f9a7}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($v59ebf8e686724f0cf779fb2a9ecf59c2 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('size')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @size='{$v59ebf8e686724f0cf779fb2a9ecf59c2}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option')->length) {$v93da65a9fd0004d9477aeac024e08e15 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option');foreach ($v93da65a9fd0004d9477aeac024e08e15 as $vef3e30e070f70244fd6578d88a6b77ac) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}'][option ='{$vef3e30e070f70244fd6578d88a6b77ac->nodeValue}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}}if ($v33045d9ddb408d27dbcbc3ca53d5583e = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('attributes')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @attributes='{$v33045d9ddb408d27dbcbc3ca53d5583e}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($v1f662954e1ee120a4aab8716234e109a = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('not-null')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @not-null='{$v1f662954e1ee120a4aab8716234e109a}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($v06e3d36fa30cea095545139854ad1fb9->hasAttribute('default')){$vb40b5e5897a4cdfa5bb06346fa44deb3=$v06e3d36fa30cea095545139854ad1fb9->getAttribute('default');if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @default='{$vb40b5e5897a4cdfa5bb06346fa44deb3}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($vdb70917e4a5b25354aed4db9dadb0afc = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('increment')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @increment='{$vdb70917e4a5b25354aed4db9dadb0afc}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($vf23104cd881ba30152c4981a93d80185 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('comment')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field[@name='{$v972bf3f05d14ffbdb817bef60638ff00}' and @comment='{$vf23104cd881ba30152c4981a93d80185}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}}}}}$v7e41f53a3c84926d1d7995de56944c27 = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('indexes');if(is_object($v7e41f53a3c84926d1d7995de56944c27->item(0))) {$v626998f31a2e3a6b36816dcb3bb63ab3 = $v7e41f53a3c84926d1d7995de56944c27->item(0)->getElementsByTagName('index');foreach ($v626998f31a2e3a6b36816dcb3bb63ab3 as $v6a992d5529f459a44fee58c733255e86) {if($v14374754c27bc1eef6a7e737213600e3 = $v6a992d5529f459a44fee58c733255e86->getAttribute('name')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@name='{$v14374754c27bc1eef6a7e737213600e3}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}else {if($va83af96ce0bc256deeb3ce660dcebacc = $v6a992d5529f459a44fee58c733255e86->getAttribute('type')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@name='{$v14374754c27bc1eef6a7e737213600e3}' and @type='{$va83af96ce0bc256deeb3ce660dcebacc}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if($v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field')->length) {$vd05b6ed7d2345020440df396d6da7f73 = $v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field');foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@name='{$v14374754c27bc1eef6a7e737213600e3}'][field = '{$v06e3d36fa30cea095545139854ad1fb9->nodeValue}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}else {if($v0f1a6fa1e9e0963e1ac389661ba0b603 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('length')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@name='{$v14374754c27bc1eef6a7e737213600e3}'][field[@length='{$v0f1a6fa1e9e0963e1ac389661ba0b603}'] ='{$v06e3d36fa30cea095545139854ad1fb9->nodeValue}']")->length) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}}}}}}if($v6a992d5529f459a44fee58c733255e86->getAttribute('type') == 'PRIMARY') {if($v7431f604cf1d265c1c02cb3e7faed60c = $v6a992d5529f459a44fee58c733255e86->getElementsByTagName('field')->item(0)->nodeValue) {if ($v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@type='PRIMARY']/field")->item(0)) {$v341bd7ad194928c2a29b85f54147c6a4 = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/indexes/index[@type='PRIMARY']/field")->item(0)->nodeValue;if ($v7431f604cf1d265c1c02cb3e7faed60c != $v341bd7ad194928c2a29b85f54147c6a4) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}else {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}}}}$vedc2dd68d1be92a82a9d8362bbae0895 = $vaab9e1de16f38176f86d7a92ba337a8d->getElementsByTagName('constraints');if(is_object($vedc2dd68d1be92a82a9d8362bbae0895->item(0))) {$vd178923285d63e9968956a0a4758267e = $vedc2dd68d1be92a82a9d8362bbae0895->item(0)->getElementsByTagName('constraint');foreach ($vd178923285d63e9968956a0a4758267e as $v3677ab7adaf00725e9fdbaed503a94e3) {if ($v4d5fdbc896088855bd8a568b5ffd9abb = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('name')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}']")->item(0)) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}else {if ($vfd40c91ee81d59fccbcab8644500e3e4 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('field')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @field='{$vfd40c91ee81d59fccbcab8644500e3e4}']")->item(0)) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($v9b992b703884cf36b8cad1966fe086f9 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-table')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @ref-table='{$v9b992b703884cf36b8cad1966fe086f9}']")->item(0)) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($v1aaf3ab1a76a2b4e7a6bf784293cc4df = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('ref-field')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @ref-field='{$v1aaf3ab1a76a2b4e7a6bf784293cc4df}']")->item(0)) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($v269738db81007d986968bb0e3e20768b = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('on-delete')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @on-delete='{$v269738db81007d986968bb0e3e20768b}']")->item(0)) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}if ($v844db8803d63e7e046c30d82b772d410 = $v3677ab7adaf00725e9fdbaed503a94e3->getAttribute('on-update')) {if (!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/constraints/constraint[@name='{$v4d5fdbc896088855bd8a568b5ffd9abb}' and @on-update='{$v844db8803d63e7e046c30d82b772d410}']")->item(0)) {return $this->restoreTableInParts($v80071f37861c360a27b7327e132c911a);}}}}}}$v0499bf152a9954b9cf9981fd078eb0b8 = $vaab9e1de16f38176f86d7a92ba337a8d->getAttribute('engine');if(!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}' and @engine='{$v0499bf152a9954b9cf9981fd078eb0b8}']")->item(0)) $this->changeTableEngine($v80071f37861c360a27b7327e132c911a, $v0499bf152a9954b9cf9981fd078eb0b8);$vd5cbc6798435d4fe67a443679b239dd6 = $vaab9e1de16f38176f86d7a92ba337a8d->getAttribute('charset');if(!$v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}' and @charset='{$vd5cbc6798435d4fe67a443679b239dd6}']")->item(0)) $this->changeTableCharset($v80071f37861c360a27b7327e132c911a, $vd5cbc6798435d4fe67a443679b239dd6);if ($this->inParts) {$this->state[$v80071f37861c360a27b7327e132c911a]['complete'] = true;}return true;}protected function getNecessaryFields($v80071f37861c360a27b7327e132c911a) {$vd05b6ed7d2345020440df396d6da7f73 = array();$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument();if (!$v9a09b4dfda82e3e665e31092d1c3ec8d->load($this->sourceFile)) {throw new coreException("Can't load xml: " . $this->sourceFile);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v9a09b4dfda82e3e665e31092d1c3ec8d);$vf25666ec7d1e534a13f641251310e226 = $v3d788fa62d7c185a1bee4c9147ee1091->query("//table[@name='{$v80071f37861c360a27b7327e132c911a}']/fields/field");if($vf25666ec7d1e534a13f641251310e226->length) {foreach($vf25666ec7d1e534a13f641251310e226 as $v06e3d36fa30cea095545139854ad1fb9) {$vd05b6ed7d2345020440df396d6da7f73[] = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('name');}}return $vd05b6ed7d2345020440df396d6da7f73;}}if(isset($_REQUEST['p'])) {$v83878c91171338902e0fe0fb97a8c47a = $_REQUEST['p'];if($v83878c91171338902e0fe0fb97a8c47a < 0 && $v83878c91171338902e0fe0fb97a8c47a != 'all') $v83878c91171338902e0fe0fb97a8c47a = 0;if($v83878c91171338902e0fe0fb97a8c47a != 'all') $v83878c91171338902e0fe0fb97a8c47a = (int) $v83878c91171338902e0fe0fb97a8c47a;$_REQUEST['p'] = $v83878c91171338902e0fe0fb97a8c47a;unset($v83878c91171338902e0fe0fb97a8c47a);}define('MB_ENCODING_SUPPORTED', function_exists('mb_internal_encoding'));if(MB_ENCODING_SUPPORTED) {define('MB_INTERNAL_ENCODING', mb_internal_encoding());}else {define('MB_INTERNAL_ENCODING', false);}function wa_strtolower($v341be97d9aff90c9978347f66f945b77) {if (MB_ENCODING_SUPPORTED) {mb_internal_encoding("UTF-8");return mb_strtolower($v341be97d9aff90c9978347f66f945b77);}else {return strtolower($v341be97d9aff90c9978347f66f945b77);}}function wa_strtoupper($v341be97d9aff90c9978347f66f945b77) {if (MB_ENCODING_SUPPORTED) {mb_internal_encoding("UTF-8");return mb_strtoupper($v341be97d9aff90c9978347f66f945b77);}else {return strtoupper($v341be97d9aff90c9978347f66f945b77);}}function wa_substr($v341be97d9aff90c9978347f66f945b77, $v5e0bdcbddccca4d66d74ba8c1cee1a68, $v7a86c157ee9713c34fbd7a1ee40f0c5a) {if (MB_ENCODING_SUPPORTED) {mb_internal_encoding("UTF-8");return mb_substr($v341be97d9aff90c9978347f66f945b77, $v5e0bdcbddccca4d66d74ba8c1cee1a68, $v7a86c157ee9713c34fbd7a1ee40f0c5a);}else {return substr($v341be97d9aff90c9978347f66f945b77, $v5e0bdcbddccca4d66d74ba8c1cee1a68, $v7a86c157ee9713c34fbd7a1ee40f0c5a);}}function wa_strlen($v341be97d9aff90c9978347f66f945b77) {if (MB_ENCODING_SUPPORTED) {mb_internal_encoding("UTF-8");return mb_strlen($v341be97d9aff90c9978347f66f945b77);}elseif(is_string($v341be97d9aff90c9978347f66f945b77)&& !preg_match('/[^\x00-\x7F]/S', $v341be97d9aff90c9978347f66f945b77)) {return strlen($v341be97d9aff90c9978347f66f945b77);}return strlen(utf8_decode($v341be97d9aff90c9978347f66f945b77));}function string_bytes($vb45cffe084dd3d20d928bee85e7b0f21) {if (!MB_ENCODING_SUPPORTED || MB_INTERNAL_ENCODING === 'ISO-8859-1') {return strlen($vb45cffe084dd3d20d928bee85e7b0f21);}mb_internal_encoding('ISO-8859-1');$ve2942a04780e223b215eb8b663cf5353 = strlen($vb45cffe084dd3d20d928bee85e7b0f21);mb_internal_encoding(MB_INTERNAL_ENCODING);return $ve2942a04780e223b215eb8b663cf5353;}function wa_strpos($v341be97d9aff90c9978347f66f945b77, $ve6f6362248805a36c61d205dbc6f4076) {if (MB_ENCODING_SUPPORTED) {mb_internal_encoding("UTF-8");return mb_strpos($v341be97d9aff90c9978347f66f945b77, $ve6f6362248805a36c61d205dbc6f4076);}else {return strpos($v341be97d9aff90c9978347f66f945b77, $ve6f6362248805a36c61d205dbc6f4076);}}function getArrayKey($vf1f713c9e000f5d3f280adbd124df4f5, $v3c6e0b8a9c15224a8228b9a98ca1531d) {if(!is_array($vf1f713c9e000f5d3f280adbd124df4f5)) {return false;}if($v3c6e0b8a9c15224a8228b9a98ca1531d === false) return NULL;if(array_key_exists($v3c6e0b8a9c15224a8228b9a98ca1531d, $vf1f713c9e000f5d3f280adbd124df4f5)) {return $vf1f713c9e000f5d3f280adbd124df4f5[$v3c6e0b8a9c15224a8228b9a98ca1531d];}else {return NULL;}}function getServerProtocol() {static $v81788ba0d7d02d81c063dbca621ba11b = NULL;if ( !$v81788ba0d7d02d81c063dbca621ba11b ) {if ((isset($_SERVER['HTTPS']) && ($_SERVER['HTTPS'] == 'on' || $_SERVER['HTTPS'] == 1)) ||    (isset($_SERVER['HTTP_X_FORWARDED_PROTO']) && $_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https') ||    strtolower(substr($_SERVER["SERVER_PROTOCOL"],0,5))=='https') {$v81788ba0d7d02d81c063dbca621ba11b = 'https';}else {$v81788ba0d7d02d81c063dbca621ba11b = 'http';}}return $v81788ba0d7d02d81c063dbca621ba11b;}function getRequest($v3c6e0b8a9c15224a8228b9a98ca1531d) {if ($v3c6e0b8a9c15224a8228b9a98ca1531d == 'p' || $v3c6e0b8a9c15224a8228b9a98ca1531d == 'per_page_limit') {$va363b8d13575101a0226e8d0d054f2e7 = prepareRequest($v3c6e0b8a9c15224a8228b9a98ca1531d);if ($va363b8d13575101a0226e8d0d054f2e7 !== false) return $va363b8d13575101a0226e8d0d054f2e7;}return getArrayKey($_REQUEST, $v3c6e0b8a9c15224a8228b9a98ca1531d);}function getSession($v3c6e0b8a9c15224a8228b9a98ca1531d) {if(!isset($_SESSION)) return NULL;return getArrayKey($_SESSION, $v3c6e0b8a9c15224a8228b9a98ca1531d);}function getServer($v3c6e0b8a9c15224a8228b9a98ca1531d) {if($v3c6e0b8a9c15224a8228b9a98ca1531d == 'REMOTE_ADDR' && getArrayKey($_SERVER, 'HTTP_X_REAL_IP') !== null) return getArrayKey($_SERVER, 'HTTP_X_REAL_IP');return getArrayKey($_SERVER, $v3c6e0b8a9c15224a8228b9a98ca1531d);}function getCookie($v3c6e0b8a9c15224a8228b9a98ca1531d) {return getArrayKey($_COOKIE, $v3c6e0b8a9c15224a8228b9a98ca1531d);}function getLabel($v3c6e0b8a9c15224a8228b9a98ca1531d, $vd6fe1d0be6347b8ef2427fa629c04485 = false) {$args = func_get_args();return ulangStream::getLabel($v3c6e0b8a9c15224a8228b9a98ca1531d, $vd6fe1d0be6347b8ef2427fa629c04485, $args);}function getI18n($v3c6e0b8a9c15224a8228b9a98ca1531d, $v240bf022e685b0ee30ad9fe9e1fb5d5b = "") {return ulangStream::getI18n($v3c6e0b8a9c15224a8228b9a98ca1531d, $v240bf022e685b0ee30ad9fe9e1fb5d5b);}function l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, $va7eb3552b40c56df3241c1b4b523dae5 = false, $v6f66e878c62db60568a3487869695820 = 'core') {static $vb10a8c0bede9eb4ea771b04db3149f28, $v865c0c0b4ab0e063e5caa3387c1a8741 = 0;if(is_null($vb10a8c0bede9eb4ea771b04db3149f28)) {$vb10a8c0bede9eb4ea771b04db3149f28 = ConnectionPool::getInstance();}$v0c1d0e2ef91d68bdb15eff954448b898 = $vb10a8c0bede9eb4ea771b04db3149f28->getConnection($v6f66e878c62db60568a3487869695820);$result = $v0c1d0e2ef91d68bdb15eff954448b898->query($vac5c74b64b4b8352ef2f181affb5ac2a, $va7eb3552b40c56df3241c1b4b523dae5);return $result;}function l_mysql_real_escape_string($v60ff169ad58411fd2225ed8018b24018, $v6f66e878c62db60568a3487869695820 = 'core') {static $vb10a8c0bede9eb4ea771b04db3149f28 = null;if(is_null($vb10a8c0bede9eb4ea771b04db3149f28)) {$vb10a8c0bede9eb4ea771b04db3149f28 = ConnectionPool::getInstance();}$v0c1d0e2ef91d68bdb15eff954448b898 = $vb10a8c0bede9eb4ea771b04db3149f28->getConnection($v6f66e878c62db60568a3487869695820);if($v0c1d0e2ef91d68bdb15eff954448b898->isOpen()) {$vcaf9b6b99962bf5c2264824231d7a40c = $v0c1d0e2ef91d68bdb15eff954448b898->getConnectionInfo();$v2a304a1348456ccd2234cd71a81bd338 = $vcaf9b6b99962bf5c2264824231d7a40c['link'];$result = mysql_real_escape_string($v60ff169ad58411fd2225ed8018b24018, $v2a304a1348456ccd2234cd71a81bd338);}else {$result = addslashes($v60ff169ad58411fd2225ed8018b24018);}return $result;}function l_mysql_insert_id($v6f66e878c62db60568a3487869695820 = 'core') {static $vb10a8c0bede9eb4ea771b04db3149f28 = null;if(is_null($vb10a8c0bede9eb4ea771b04db3149f28)) {$vb10a8c0bede9eb4ea771b04db3149f28 = ConnectionPool::getInstance();}$v4717d53ebfdfea8477f780ec66151dcb = $vb10a8c0bede9eb4ea771b04db3149f28->getConnection($v6f66e878c62db60568a3487869695820);$vcaf9b6b99962bf5c2264824231d7a40c = $v4717d53ebfdfea8477f780ec66151dcb->getConnectionInfo();$v2a304a1348456ccd2234cd71a81bd338 = $vcaf9b6b99962bf5c2264824231d7a40c['link'];return mysql_insert_id($v2a304a1348456ccd2234cd71a81bd338);}function l_mysql_error($v6f66e878c62db60568a3487869695820 = 'core') {static $vb10a8c0bede9eb4ea771b04db3149f28 = null;if(is_null($vb10a8c0bede9eb4ea771b04db3149f28)) {$vb10a8c0bede9eb4ea771b04db3149f28 = ConnectionPool::getInstance();}$v4717d53ebfdfea8477f780ec66151dcb = $vb10a8c0bede9eb4ea771b04db3149f28->getConnection($v6f66e878c62db60568a3487869695820);$vcaf9b6b99962bf5c2264824231d7a40c = $v4717d53ebfdfea8477f780ec66151dcb->getConnectionInfo();$v2a304a1348456ccd2234cd71a81bd338 = $vcaf9b6b99962bf5c2264824231d7a40c['link'];return mysql_error($v2a304a1348456ccd2234cd71a81bd338);}function l_mysql_affected_rows($v6f66e878c62db60568a3487869695820 = 'core') {static $vb10a8c0bede9eb4ea771b04db3149f28 = null;if(is_null($vb10a8c0bede9eb4ea771b04db3149f28)) {$vb10a8c0bede9eb4ea771b04db3149f28 = ConnectionPool::getInstance();}$v4717d53ebfdfea8477f780ec66151dcb = $vb10a8c0bede9eb4ea771b04db3149f28->getConnection($v6f66e878c62db60568a3487869695820);$vcaf9b6b99962bf5c2264824231d7a40c = $v4717d53ebfdfea8477f780ec66151dcb->getConnectionInfo();$v2a304a1348456ccd2234cd71a81bd338 = $vcaf9b6b99962bf5c2264824231d7a40c['link'];return mysql_affected_rows($v2a304a1348456ccd2234cd71a81bd338);}function bytes_strlen($vb45cffe084dd3d20d928bee85e7b0f21) {if(MB_ENCODING_SUPPORTED) {mb_internal_encoding("latin1");$va5a928b6b6b19de8a18398c7b29f47d7 = strlen($vb45cffe084dd3d20d928bee85e7b0f21);mb_internal_encoding(MB_INTERNAL_ENCODING);return $va5a928b6b6b19de8a18398c7b29f47d7;}else {return strlen($vb45cffe084dd3d20d928bee85e7b0f21);}}function bytes_substr($vb45cffe084dd3d20d928bee85e7b0f21, $vea2b2676c28c0db26d39331a336c6b92, $v2fa47f7c65fec19cc163b195725e3844 = false) {if(MB_ENCODING_SUPPORTED) {mb_internal_encoding("latin1");$vdccc8c8d061984a56d899361b4934477 = '';if($v2fa47f7c65fec19cc163b195725e3844 !== false) {$vdccc8c8d061984a56d899361b4934477 = substr($vb45cffe084dd3d20d928bee85e7b0f21, $vea2b2676c28c0db26d39331a336c6b92, $v2fa47f7c65fec19cc163b195725e3844);}else {$vdccc8c8d061984a56d899361b4934477 = substr($vb45cffe084dd3d20d928bee85e7b0f21, $vea2b2676c28c0db26d39331a336c6b92);}mb_internal_encoding(MB_INTERNAL_ENCODING);return $vdccc8c8d061984a56d899361b4934477;}else {if($v2fa47f7c65fec19cc163b195725e3844 !== false)    return substr($vb45cffe084dd3d20d928bee85e7b0f21, $vea2b2676c28c0db26d39331a336c6b92, $v2fa47f7c65fec19cc163b195725e3844);else    return substr($vb45cffe084dd3d20d928bee85e7b0f21, $vea2b2676c28c0db26d39331a336c6b92);}}function natsort2d(&$v0b7b66da920976f738db754a6716a9e8, $v6af2d999a15a64f0b143bbfa790c2f37 = 0) {if(is_array($v0b7b66da920976f738db754a6716a9e8) == false) {return;}$v3d801aa532c1cec3ee82d87a99fdf63f = $v26b75b176d665f24a5fd22a2ad815763 = Array();foreach ($v0b7b66da920976f738db754a6716a9e8 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {$v3d801aa532c1cec3ee82d87a99fdf63f[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v2063c1608d6e0baf80249c42e2be5804[$v6af2d999a15a64f0b143bbfa790c2f37];}natsort($v3d801aa532c1cec3ee82d87a99fdf63f);foreach ($v3d801aa532c1cec3ee82d87a99fdf63f as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {$v26b75b176d665f24a5fd22a2ad815763[] = $v0b7b66da920976f738db754a6716a9e8[$v3c6e0b8a9c15224a8228b9a98ca1531d];}$v0b7b66da920976f738db754a6716a9e8 = $v26b75b176d665f24a5fd22a2ad815763;}function removeDirectory($v736007832d2167baaae763fd3a3f3cf1) {if(!$v700f6fa0edb608ee5cc3cfa63f1c94cc = @opendir($v736007832d2167baaae763fd3a3f3cf1)) {return false;}while (($vbe8f80182e0c983916da7338c2c1c040 = readdir($v700f6fa0edb608ee5cc3cfa63f1c94cc)) !== false) {if($vbe8f80182e0c983916da7338c2c1c040=='.' || $vbe8f80182e0c983916da7338c2c1c040=='..') continue;if (!@unlink($v736007832d2167baaae763fd3a3f3cf1.'/'.$vbe8f80182e0c983916da7338c2c1c040)) {removeDirectory($v736007832d2167baaae763fd3a3f3cf1.'/'.$vbe8f80182e0c983916da7338c2c1c040);}}@rmdir($v736007832d2167baaae763fd3a3f3cf1);return true;}function getInterfaceLangs() {global $vd2962d9ba1823a204aa406e3fe3f906b;return $vd2962d9ba1823a204aa406e3fe3f906b;}function checkInterfaceLang($v851f5ac9941d720844d143ed9cfcf60a) {return $v851f5ac9941d720844d143ed9cfcf60a;$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$v5a05866850c28651fe234659f6c92ada = $v2245023265ae4cf87d02c8b6ba991139->get('system', 'interface-langs');return in_array($v851f5ac9941d720844d143ed9cfcf60a, $v5a05866850c28651fe234659f6c92ada) ? $v851f5ac9941d720844d143ed9cfcf60a : "ru";}function check_session() {$v957b527bcfbad2e80f58d20683931435 = getServer('REMOTE_ADDR');$v21d6f40cfb511982e4424e0e250a9557 = session::getInstance();if(is_null($v21d6f40cfb511982e4424e0e250a9557->get('session-owner-ip'))) {$v21d6f40cfb511982e4424e0e250a9557->set('session-owner-ip', $v957b527bcfbad2e80f58d20683931435);return true;}elseif ($v21d6f40cfb511982e4424e0e250a9557->get('session-owner-ip') == $v957b527bcfbad2e80f58d20683931435) {return true;}else {session::destroy();session::getInstance();return false;}}function enableOutputCompression() {if(extension_loaded('zlib') && !defined('DEBUG')) {$v7f2db423a49b305459147332fb01cf87 = ob_get_contents();while(@ob_end_clean());ob_start('ob_gzhandler');ob_start(array('umiExceptionHandler', 'outputBufferHandler'));echo $v7f2db423a49b305459147332fb01cf87;}}function disableOutputCompression() {static $v4f33252742282f871b0617168156fd55 = false;if($v4f33252742282f871b0617168156fd55) {return false;}while(@ob_end_clean());ob_start();header("Content-Encoding:");header("Content-Length:");header("Vary:");$v4f33252742282f871b0617168156fd55 = true;return true;}function array_extract_values($vf1f713c9e000f5d3f280adbd124df4f5, &$result = NULL, $v19358374f34dd2c9d2dc34952227664a = false) {if(is_array($vf1f713c9e000f5d3f280adbd124df4f5) == false) {return Array();}if(is_array($result) == false) {$result = Array();}foreach($vf1f713c9e000f5d3f280adbd124df4f5 as $v2063c1608d6e0baf80249c42e2be5804) {if(is_array($v2063c1608d6e0baf80249c42e2be5804) == false) {if($v2063c1608d6e0baf80249c42e2be5804 || $v19358374f34dd2c9d2dc34952227664a == true) {$result[] = $v2063c1608d6e0baf80249c42e2be5804;}}else {array_extract_values($v2063c1608d6e0baf80249c42e2be5804, $result, $v19358374f34dd2c9d2dc34952227664a);}}return $result;}function array_unique_arrays($vf1f713c9e000f5d3f280adbd124df4f5, $v3c6e0b8a9c15224a8228b9a98ca1531d) {$result = Array();$v14f802e1fba977727845e8872c1743a7 = Array();foreach($vf1f713c9e000f5d3f280adbd124df4f5 as $v47c80780ab608cc046f2a6e6f071feb6) {$v33e588420461dec019f1b83ed3119030 = isset($v47c80780ab608cc046f2a6e6f071feb6[$v3c6e0b8a9c15224a8228b9a98ca1531d]) ? $v47c80780ab608cc046f2a6e6f071feb6[$v3c6e0b8a9c15224a8228b9a98ca1531d] : NULL;if(in_array($v33e588420461dec019f1b83ed3119030, $v14f802e1fba977727845e8872c1743a7)) {continue;}else {$v14f802e1fba977727845e8872c1743a7[] = $v33e588420461dec019f1b83ed3119030;$result[] = $v47c80780ab608cc046f2a6e6f071feb6;}}return $result;}function array_distinct($vf1f713c9e000f5d3f280adbd124df4f5) {$result = $vad13e3e85208780288a2389c791b5c03 = array();foreach($vf1f713c9e000f5d3f280adbd124df4f5 as $vd4723c261c8c1a108ba1151bf1d1c6c3) {$v3c6e0b8a9c15224a8228b9a98ca1531d = sha1(serialize($vd4723c261c8c1a108ba1151bf1d1c6c3));if(in_array($v3c6e0b8a9c15224a8228b9a98ca1531d, $vad13e3e85208780288a2389c791b5c03)) {continue;}$result[] = $vd4723c261c8c1a108ba1151bf1d1c6c3;$vad13e3e85208780288a2389c791b5c03[] = $v3c6e0b8a9c15224a8228b9a98ca1531d;}return $result;}function array_positive_values($v47c80780ab608cc046f2a6e6f071feb6, $vf8532b6380228945d474f37fb6cdac27 = true) {if(is_array($v47c80780ab608cc046f2a6e6f071feb6) == false) {return Array();}$result = Array();foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {if($v2063c1608d6e0baf80249c42e2be5804) {if(is_array($v2063c1608d6e0baf80249c42e2be5804)) {if($vf8532b6380228945d474f37fb6cdac27) {$v2063c1608d6e0baf80249c42e2be5804 = array_positive_values($v2063c1608d6e0baf80249c42e2be5804, $vf8532b6380228945d474f37fb6cdac27);if(sizeof($v2063c1608d6e0baf80249c42e2be5804) == 0) {continue;}}}$result[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v2063c1608d6e0baf80249c42e2be5804;}}return $result;}function set_timebreak($vf1f6dc1a412a39696690dca7b862f852 = false) {global $v7551fc411eb85f94cf0c169b13caf0e0;if($vf1f6dc1a412a39696690dca7b862f852 == false) {$vf1f6dc1a412a39696690dca7b862f852 = microtime(true);}$v07cc694b9b3fc636710fa08b6922c42b = $vf1f6dc1a412a39696690dca7b862f852 - $v7551fc411eb85f94cf0c169b13caf0e0;return "\r\n<!-- This page generated in {$v07cc694b9b3fc636710fa08b6922c42b} secs -->\r\n";}function makeThumbnailFullUnsharpMask($vb798abe6e1b1318ee36b0dcb3fb9e4d3, $ve9f40e1f1d1658681dad2dac4ae0971e, $vfc021d54683383e5078ab9fefc4d53c8, $vf0598264a691a8f62272aca0e79af374) {if (function_exists('UnsharpMask')){return UnsharpMask($vb798abe6e1b1318ee36b0dcb3fb9e4d3, $ve9f40e1f1d1658681dad2dac4ae0971e, $vfc021d54683383e5078ab9fefc4d53c8, $vf0598264a691a8f62272aca0e79af374);}else{if ($ve9f40e1f1d1658681dad2dac4ae0971e > 500) $ve9f40e1f1d1658681dad2dac4ae0971e = 500;$ve9f40e1f1d1658681dad2dac4ae0971e = $ve9f40e1f1d1658681dad2dac4ae0971e * 0.016;if ($vfc021d54683383e5078ab9fefc4d53c8 > 50) $vfc021d54683383e5078ab9fefc4d53c8 = 50;$vfc021d54683383e5078ab9fefc4d53c8 = $vfc021d54683383e5078ab9fefc4d53c8 * 2;if ($vf0598264a691a8f62272aca0e79af374 > 255) $vf0598264a691a8f62272aca0e79af374 = 255;$vfc021d54683383e5078ab9fefc4d53c8 = abs(round($vfc021d54683383e5078ab9fefc4d53c8));if ($vfc021d54683383e5078ab9fefc4d53c8 == 0) {return $vb798abe6e1b1318ee36b0dcb3fb9e4d3;}$vf1290186a5d0b1ceab27f4e77c0c5d68 = imagesx($vb798abe6e1b1318ee36b0dcb3fb9e4d3);$v2510c39011c5be704182423e3a695e91 = imagesy($vb798abe6e1b1318ee36b0dcb3fb9e4d3);$vdd2b9c2d0f89eb88267d945e852649e1 = $vb798abe6e1b1318ee36b0dcb3fb9e4d3;$v731eea25c6c42b949dd8b33e55cb622e = $vb798abe6e1b1318ee36b0dcb3fb9e4d3;$v0912bfe735bcb6f63b4dc49ae3833df8 = imagecreatetruecolor($vf1290186a5d0b1ceab27f4e77c0c5d68, $v2510c39011c5be704182423e3a695e91);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $vfc021d54683383e5078ab9fefc4d53c8;$v865c0c0b4ab0e063e5caa3387c1a8741++)    {imagecopy   ($v0912bfe735bcb6f63b4dc49ae3833df8, $vdd2b9c2d0f89eb88267d945e852649e1, 0, 0, 1, 1, $vf1290186a5d0b1ceab27f4e77c0c5d68 - 1, $v2510c39011c5be704182423e3a695e91 - 1);imagecopymerge ($v0912bfe735bcb6f63b4dc49ae3833df8, $vdd2b9c2d0f89eb88267d945e852649e1, 1, 1, 0, 0, $vf1290186a5d0b1ceab27f4e77c0c5d68, $v2510c39011c5be704182423e3a695e91, 50);imagecopymerge ($v0912bfe735bcb6f63b4dc49ae3833df8, $vdd2b9c2d0f89eb88267d945e852649e1, 0, 1, 1, 0, $vf1290186a5d0b1ceab27f4e77c0c5d68 - 1, $v2510c39011c5be704182423e3a695e91, 33.33333);imagecopymerge ($v0912bfe735bcb6f63b4dc49ae3833df8, $vdd2b9c2d0f89eb88267d945e852649e1, 1, 0, 0, 1, $vf1290186a5d0b1ceab27f4e77c0c5d68, $v2510c39011c5be704182423e3a695e91 - 1, 25);imagecopymerge ($v0912bfe735bcb6f63b4dc49ae3833df8, $vdd2b9c2d0f89eb88267d945e852649e1, 0, 0, 1, 0, $vf1290186a5d0b1ceab27f4e77c0c5d68 - 1, $v2510c39011c5be704182423e3a695e91, 33.33333);imagecopymerge ($v0912bfe735bcb6f63b4dc49ae3833df8, $vdd2b9c2d0f89eb88267d945e852649e1, 1, 0, 0, 0, $vf1290186a5d0b1ceab27f4e77c0c5d68, $v2510c39011c5be704182423e3a695e91, 25);imagecopymerge ($v0912bfe735bcb6f63b4dc49ae3833df8, $vdd2b9c2d0f89eb88267d945e852649e1, 0, 0, 0, 1, $vf1290186a5d0b1ceab27f4e77c0c5d68, $v2510c39011c5be704182423e3a695e91 - 1, 20 );imagecopymerge ($v0912bfe735bcb6f63b4dc49ae3833df8, $vdd2b9c2d0f89eb88267d945e852649e1, 0, 1, 0, 0, $vf1290186a5d0b1ceab27f4e77c0c5d68, $v2510c39011c5be704182423e3a695e91, 16.666667);imagecopymerge ($v0912bfe735bcb6f63b4dc49ae3833df8, $vdd2b9c2d0f89eb88267d945e852649e1, 0, 0, 0, 0, $vf1290186a5d0b1ceab27f4e77c0c5d68, $v2510c39011c5be704182423e3a695e91, 50);}$vdd2b9c2d0f89eb88267d945e852649e1 = $v0912bfe735bcb6f63b4dc49ae3833df8;for ($v9dd4e461268c8034f5c8564e155c67a6 = 0;$v9dd4e461268c8034f5c8564e155c67a6 < $vf1290186a5d0b1ceab27f4e77c0c5d68;$v9dd4e461268c8034f5c8564e155c67a6++)    {for ($v415290769594460e2e485922904f345d = 0;$v415290769594460e2e485922904f345d < $v2510c39011c5be704182423e3a695e91;$v415290769594460e2e485922904f345d++)     {$ve7ee80f9d3ee77a07b7e0e40911d4b85 = ImageColorAt($v731eea25c6c42b949dd8b33e55cb622e, $v9dd4e461268c8034f5c8564e155c67a6, $v415290769594460e2e485922904f345d);$vcd8a4c8c79b1ff2c064026bb7cefe760 = (($ve7ee80f9d3ee77a07b7e0e40911d4b85 >> 16) & 0xFF);$vd7fd33dc47e7db31c2bdd232804331bf = (($ve7ee80f9d3ee77a07b7e0e40911d4b85 >> 8) & 0xFF);$v62f533cdf0bda50d31d41662bbe16e8e = ($ve7ee80f9d3ee77a07b7e0e40911d4b85 & 0xFF);$v82d175da0ae7901210ea5d63914f5212 = ImageColorAt($vdd2b9c2d0f89eb88267d945e852649e1, $v9dd4e461268c8034f5c8564e155c67a6, $v415290769594460e2e485922904f345d);$v56dc21b41aac91a611402ee281442e54 = (($v82d175da0ae7901210ea5d63914f5212 >> 16) & 0xFF);$vab27a9c8dd988ea5d32cd8f3e763b1b1 = (($v82d175da0ae7901210ea5d63914f5212 >> 8) & 0xFF);$vfbdaa5229703cc85625873f73f1ef573 = ($v82d175da0ae7901210ea5d63914f5212 & 0xFF);$v6c99f2ac4dbbc9ac99a83340dacd50cb = (abs($vcd8a4c8c79b1ff2c064026bb7cefe760 - $v56dc21b41aac91a611402ee281442e54) >= $vf0598264a691a8f62272aca0e79af374) ? max(0, min(255, ($ve9f40e1f1d1658681dad2dac4ae0971e * ($vcd8a4c8c79b1ff2c064026bb7cefe760 - $v56dc21b41aac91a611402ee281442e54)) + $vcd8a4c8c79b1ff2c064026bb7cefe760)) : $vcd8a4c8c79b1ff2c064026bb7cefe760;$v8f3e420d187de004189e440099d8e9b8 = (abs($vd7fd33dc47e7db31c2bdd232804331bf - $vab27a9c8dd988ea5d32cd8f3e763b1b1) >= $vf0598264a691a8f62272aca0e79af374) ? max(0, min(255, ($ve9f40e1f1d1658681dad2dac4ae0971e * ($vd7fd33dc47e7db31c2bdd232804331bf - $vab27a9c8dd988ea5d32cd8f3e763b1b1)) + $vd7fd33dc47e7db31c2bdd232804331bf)) : $vd7fd33dc47e7db31c2bdd232804331bf;$v4798968467b4ab45ea7902a5084666b8 = (abs($v62f533cdf0bda50d31d41662bbe16e8e - $vfbdaa5229703cc85625873f73f1ef573) >= $vf0598264a691a8f62272aca0e79af374) ? max(0, min(255, ($ve9f40e1f1d1658681dad2dac4ae0971e * ($v62f533cdf0bda50d31d41662bbe16e8e - $vfbdaa5229703cc85625873f73f1ef573)) + $v62f533cdf0bda50d31d41662bbe16e8e)) : $v62f533cdf0bda50d31d41662bbe16e8e;if (($vcd8a4c8c79b1ff2c064026bb7cefe760 != $v6c99f2ac4dbbc9ac99a83340dacd50cb) || ($vd7fd33dc47e7db31c2bdd232804331bf != $v8f3e420d187de004189e440099d8e9b8) || ($v62f533cdf0bda50d31d41662bbe16e8e != $v4798968467b4ab45ea7902a5084666b8))      {$vfbfe459f582d8ac5384527d6aaadb670 = ImageColorAllocate($vb798abe6e1b1318ee36b0dcb3fb9e4d3, $v6c99f2ac4dbbc9ac99a83340dacd50cb, $v8f3e420d187de004189e440099d8e9b8, $v4798968467b4ab45ea7902a5084666b8);ImageSetPixel($vb798abe6e1b1318ee36b0dcb3fb9e4d3, $v9dd4e461268c8034f5c8564e155c67a6, $v415290769594460e2e485922904f345d, $vfbfe459f582d8ac5384527d6aaadb670);}}}return $vb798abe6e1b1318ee36b0dcb3fb9e4d3;}}if (!defined('PATHINFO_FILENAME')) {define('PATHINFO_FILENAME', 8);}function getPathInfo($v435ed7e9f07f740abf511a62c00eef6e, $v4cdc77f34088dde17d82c8b05cc71a9e=NULL) {$vcaf9b6b99962bf5c2264824231d7a40c = pathinfo($v435ed7e9f07f740abf511a62c00eef6e);if (!isset($vcaf9b6b99962bf5c2264824231d7a40c['filename'])) {$vcaf9b6b99962bf5c2264824231d7a40c['filename'] = substr($vcaf9b6b99962bf5c2264824231d7a40c['basename'], 0, strrpos($vcaf9b6b99962bf5c2264824231d7a40c['basename'],'.'));}if (is_null($v4cdc77f34088dde17d82c8b05cc71a9e)) {return $vcaf9b6b99962bf5c2264824231d7a40c;}switch($v4cdc77f34088dde17d82c8b05cc71a9e) {case 'dirname':   case '1':    return $vcaf9b6b99962bf5c2264824231d7a40c['dirname'];break;case 'basename':   case '2':    return $vcaf9b6b99962bf5c2264824231d7a40c['basename'];break;case 'extension':   case '4':    return $vcaf9b6b99962bf5c2264824231d7a40c['extension'];break;case 'filename':   case '8':    return $vcaf9b6b99962bf5c2264824231d7a40c['filename'];break;default:    return $vcaf9b6b99962bf5c2264824231d7a40c;}}function makeThumbnailFull($vd6fe1d0be6347b8ef2427fa629c04485, $vf09cbf63485d929911164e808f84423b, $veaae26a6fb20ed3ef54fb23bfa0b1fcc, $vb435e227d5dd201e1768b2bcb2e0aa81, $va634e7960e04b1633c103382004fe526 = true, $v70c8b4c146f72fc2a6a1886dae113831 = 5, $vb5db1323df6de62d5bda823c63ad4cbe = false, $vd66636b253cb346dbb6240e30def3618 = 80) {$vf711798e436a77f680a1070c008a2a66=true;$v78805a221a988e79ef3f42d7c5bfd418 = new umiImageFile($vd6fe1d0be6347b8ef2427fa629c04485);$v3090ad88ff7c9ca191579b709069fe64 = $v78805a221a988e79ef3f42d7c5bfd418->getFileName();$veb9f74e698fbb6e2897b3791bc406cbf = strtolower($v78805a221a988e79ef3f42d7c5bfd418->getExt());$veb9f74e698fbb6e2897b3791bc406cbf = ($veb9f74e698fbb6e2897b3791bc406cbf=='bmp'?'jpg':$veb9f74e698fbb6e2897b3791bc406cbf);$v107703932395f334896434b598ccdc55 = Array('gif', 'jpeg', 'jpg', 'png', 'bmp');if(!in_array($veb9f74e698fbb6e2897b3791bc406cbf, $v107703932395f334896434b598ccdc55)) return "";$v3090ad88ff7c9ca191579b709069fe64 = substr($v3090ad88ff7c9ca191579b709069fe64, 0, (strlen($v3090ad88ff7c9ca191579b709069fe64) - (strlen($veb9f74e698fbb6e2897b3791bc406cbf) + 1)) );$vb43c766cbc1365dca0ffcee38e46b613 = sha1($v78805a221a988e79ef3f42d7c5bfd418->getDirName());if (!is_dir($vf09cbf63485d929911164e808f84423b . $vb43c766cbc1365dca0ffcee38e46b613)) {mkdir($vf09cbf63485d929911164e808f84423b . $vb43c766cbc1365dca0ffcee38e46b613, 0755, true);}$vddc9a97c07cfa1f9fe744dbc63143e5c = $v3090ad88ff7c9ca191579b709069fe64 . '_' . $veaae26a6fb20ed3ef54fb23bfa0b1fcc . '_' . $vb435e227d5dd201e1768b2bcb2e0aa81 . '_' . $v70c8b4c146f72fc2a6a1886dae113831 . '_' . $vd66636b253cb346dbb6240e30def3618 . "." . $veb9f74e698fbb6e2897b3791bc406cbf;$vf38211e4c6839893265bcda112b63f80 = $vf09cbf63485d929911164e808f84423b . $vb43c766cbc1365dca0ffcee38e46b613 . '/' . $vddc9a97c07cfa1f9fe744dbc63143e5c;if(!file_exists($vf38211e4c6839893265bcda112b63f80) || filemtime($vf38211e4c6839893265bcda112b63f80) < filemtime($vd6fe1d0be6347b8ef2427fa629c04485)) {if(file_exists($vf38211e4c6839893265bcda112b63f80)) {unlink($vf38211e4c6839893265bcda112b63f80);}$v3a8d65a128a22de38fe374a76974161c = $v78805a221a988e79ef3f42d7c5bfd418->getWidth();$v427c23061461a4b29c5d39dd32b7f2c6 = $v78805a221a988e79ef3f42d7c5bfd418->getHeight();if(!($v3a8d65a128a22de38fe374a76974161c && $v427c23061461a4b29c5d39dd32b7f2c6)) {throw new coreException(getLabel('error-image-corrupted', null, $vd6fe1d0be6347b8ef2427fa629c04485));}if($vb435e227d5dd201e1768b2bcb2e0aa81 == "auto") {$v3c10300988ff410c7f7181d43214229e = (int) round($v427c23061461a4b29c5d39dd32b7f2c6 * ($veaae26a6fb20ed3ef54fb23bfa0b1fcc / $v3a8d65a128a22de38fe374a76974161c));$vb435e227d5dd201e1768b2bcb2e0aa81=$v3c10300988ff410c7f7181d43214229e;$v6f81aaeb51b38cddc8851000851e9c98 = (int) $veaae26a6fb20ed3ef54fb23bfa0b1fcc;}else {if($veaae26a6fb20ed3ef54fb23bfa0b1fcc == "auto") {$v6f81aaeb51b38cddc8851000851e9c98 = (int) round($v3a8d65a128a22de38fe374a76974161c * ($vb435e227d5dd201e1768b2bcb2e0aa81 / $v427c23061461a4b29c5d39dd32b7f2c6));$veaae26a6fb20ed3ef54fb23bfa0b1fcc=$v6f81aaeb51b38cddc8851000851e9c98;}else {$v6f81aaeb51b38cddc8851000851e9c98 = (int) $veaae26a6fb20ed3ef54fb23bfa0b1fcc;}$v3c10300988ff410c7f7181d43214229e = (int) $vb435e227d5dd201e1768b2bcb2e0aa81;}$va13a7d0465adabf0bc59a5a26873cc4d=0;$v6918e386f5cdd77edf37c6f42cdad6a2=0;if (!intval($veaae26a6fb20ed3ef54fb23bfa0b1fcc) || !intval($vb435e227d5dd201e1768b2bcb2e0aa81)) {$va634e7960e04b1633c103382004fe526 = false;}if ($va634e7960e04b1633c103382004fe526){$v17370b9bf2bb4af83eba44b15e2315b9 = $v3a8d65a128a22de38fe374a76974161c/$veaae26a6fb20ed3ef54fb23bfa0b1fcc;$v205a8652407c62be13889d94c91f49e8 = $v427c23061461a4b29c5d39dd32b7f2c6/$vb435e227d5dd201e1768b2bcb2e0aa81;if ($v17370b9bf2bb4af83eba44b15e2315b9 > $v205a8652407c62be13889d94c91f49e8){$v6918e386f5cdd77edf37c6f42cdad6a2 = round(($v3a8d65a128a22de38fe374a76974161c-$veaae26a6fb20ed3ef54fb23bfa0b1fcc*$v205a8652407c62be13889d94c91f49e8)/2);$v3a8d65a128a22de38fe374a76974161c = round($veaae26a6fb20ed3ef54fb23bfa0b1fcc*$v205a8652407c62be13889d94c91f49e8);}elseif ($v17370b9bf2bb4af83eba44b15e2315b9 < $v205a8652407c62be13889d94c91f49e8){$va13a7d0465adabf0bc59a5a26873cc4d = round(($v427c23061461a4b29c5d39dd32b7f2c6-$vb435e227d5dd201e1768b2bcb2e0aa81*$v17370b9bf2bb4af83eba44b15e2315b9)/2);$v427c23061461a4b29c5d39dd32b7f2c6 = round($vb435e227d5dd201e1768b2bcb2e0aa81*$v17370b9bf2bb4af83eba44b15e2315b9);}if($v70c8b4c146f72fc2a6a1886dae113831) {switch ($v70c8b4c146f72fc2a6a1886dae113831):      case 1:       $v6918e386f5cdd77edf37c6f42cdad6a2 = 0;$va13a7d0465adabf0bc59a5a26873cc4d = 0;break;case 2:       $va13a7d0465adabf0bc59a5a26873cc4d = 0;break;case 3:       $v6918e386f5cdd77edf37c6f42cdad6a2 += $v6918e386f5cdd77edf37c6f42cdad6a2;$va13a7d0465adabf0bc59a5a26873cc4d = 0;break;case 4:       $v6918e386f5cdd77edf37c6f42cdad6a2 = 0;break;case 5:       break;case 6:       $v6918e386f5cdd77edf37c6f42cdad6a2 += $v6918e386f5cdd77edf37c6f42cdad6a2;break;case 7:       $v6918e386f5cdd77edf37c6f42cdad6a2 = 0;$va13a7d0465adabf0bc59a5a26873cc4d += $va13a7d0465adabf0bc59a5a26873cc4d;break;case 8:       $va13a7d0465adabf0bc59a5a26873cc4d += $va13a7d0465adabf0bc59a5a26873cc4d;break;case 9:       $v6918e386f5cdd77edf37c6f42cdad6a2 += $v6918e386f5cdd77edf37c6f42cdad6a2;$va13a7d0465adabf0bc59a5a26873cc4d += $va13a7d0465adabf0bc59a5a26873cc4d;break;endswitch;}}$vf12105146129696d6a7e0ed521db2e48 = imagecreatetruecolor($v6f81aaeb51b38cddc8851000851e9c98, $v3c10300988ff410c7f7181d43214229e);$v520584b026332b9e0b598c3d091329b1 = $v78805a221a988e79ef3f42d7c5bfd418->createImage($vd6fe1d0be6347b8ef2427fa629c04485);$v36cd38f49b9afa08222c0dc9ebfe35eb = $v520584b026332b9e0b598c3d091329b1['im'];if ($veaae26a6fb20ed3ef54fb23bfa0b1fcc*4 < $v3a8d65a128a22de38fe374a76974161c && $vb435e227d5dd201e1768b2bcb2e0aa81*4 < $v427c23061461a4b29c5d39dd32b7f2c6) {$_TMP=array();$_TMP['width'] = round($veaae26a6fb20ed3ef54fb23bfa0b1fcc*4);$_TMP['height'] = round($vb435e227d5dd201e1768b2bcb2e0aa81*4);$_TMP['image'] = imagecreatetruecolor($_TMP['width'], $_TMP['height']);if ($veb9f74e698fbb6e2897b3791bc406cbf == 'gif') {$_TMP['image_white'] = imagecolorallocate($_TMP['image'], 255, 255, 255);imagefill($_TMP['image'], 0, 0, $_TMP['image_white']);imagecolortransparent($_TMP['image'], $_TMP['image_white']);imagealphablending($v36cd38f49b9afa08222c0dc9ebfe35eb, TRUE);imagealphablending($_TMP['image'], TRUE);}else {imagealphablending($_TMP['image'], false);imagesavealpha($_TMP['image'], true);}imagecopyresampled($_TMP['image'], $v36cd38f49b9afa08222c0dc9ebfe35eb, 0, 0, $v6918e386f5cdd77edf37c6f42cdad6a2, $va13a7d0465adabf0bc59a5a26873cc4d, $_TMP['width'], $_TMP['height'], $v3a8d65a128a22de38fe374a76974161c, $v427c23061461a4b29c5d39dd32b7f2c6);imageDestroy($v36cd38f49b9afa08222c0dc9ebfe35eb);$v36cd38f49b9afa08222c0dc9ebfe35eb = $_TMP['image'];$v3a8d65a128a22de38fe374a76974161c = $_TMP['width'];$v427c23061461a4b29c5d39dd32b7f2c6 = $_TMP['height'];$v6918e386f5cdd77edf37c6f42cdad6a2 = 0;$va13a7d0465adabf0bc59a5a26873cc4d = 0;unset($_TMP);}if ($veb9f74e698fbb6e2897b3791bc406cbf == 'gif') {$vde6403c41549334bb72244a31e9edf52 = imagecolorallocate($vf12105146129696d6a7e0ed521db2e48, 255, 255, 255);imagefill($vf12105146129696d6a7e0ed521db2e48, 0, 0, $vde6403c41549334bb72244a31e9edf52);imagecolortransparent($vf12105146129696d6a7e0ed521db2e48, $vde6403c41549334bb72244a31e9edf52);imagealphablending($v36cd38f49b9afa08222c0dc9ebfe35eb, TRUE);imagealphablending($vf12105146129696d6a7e0ed521db2e48, TRUE);}else {imagealphablending($vf12105146129696d6a7e0ed521db2e48, false);imagesavealpha($vf12105146129696d6a7e0ed521db2e48, true);}imagecopyresampled($vf12105146129696d6a7e0ed521db2e48, $v36cd38f49b9afa08222c0dc9ebfe35eb, 0, 0, $v6918e386f5cdd77edf37c6f42cdad6a2, $va13a7d0465adabf0bc59a5a26873cc4d, $veaae26a6fb20ed3ef54fb23bfa0b1fcc, $vb435e227d5dd201e1768b2bcb2e0aa81, $v3a8d65a128a22de38fe374a76974161c, $v427c23061461a4b29c5d39dd32b7f2c6);if($vf711798e436a77f680a1070c008a2a66) $vf12105146129696d6a7e0ed521db2e48 = makeThumbnailFullUnsharpMask($vf12105146129696d6a7e0ed521db2e48,80,.5,3);switch($veb9f74e698fbb6e2897b3791bc406cbf) {case 'gif':      $v9b207167e5381c47682c6b4f58a623fb = imagegif($vf12105146129696d6a7e0ed521db2e48, $vf38211e4c6839893265bcda112b63f80);break;case 'png':      $v9b207167e5381c47682c6b4f58a623fb = imagepng($vf12105146129696d6a7e0ed521db2e48, $vf38211e4c6839893265bcda112b63f80);break;default:      $v9b207167e5381c47682c6b4f58a623fb = imagejpeg($vf12105146129696d6a7e0ed521db2e48, $vf38211e4c6839893265bcda112b63f80, $vd66636b253cb346dbb6240e30def3618);}if(!$v9b207167e5381c47682c6b4f58a623fb) {throw new coreException(getLabel('label-errors-16008'));}imageDestroy($v36cd38f49b9afa08222c0dc9ebfe35eb);imageDestroy($vf12105146129696d6a7e0ed521db2e48);if($vb5db1323df6de62d5bda823c63ad4cbe) {umiImageFile::addWatermark($vf38211e4c6839893265bcda112b63f80);}}$v2063c1608d6e0baf80249c42e2be5804 = new umiImageFile($vf38211e4c6839893265bcda112b63f80);$v47c80780ab608cc046f2a6e6f071feb6 = Array();$v47c80780ab608cc046f2a6e6f071feb6['size'] = $v2063c1608d6e0baf80249c42e2be5804->getSize();$v47c80780ab608cc046f2a6e6f071feb6['filename'] = $v2063c1608d6e0baf80249c42e2be5804->getFileName();$v47c80780ab608cc046f2a6e6f071feb6['filepath'] = $v2063c1608d6e0baf80249c42e2be5804->getFilePath();$v47c80780ab608cc046f2a6e6f071feb6['src'] = $v2063c1608d6e0baf80249c42e2be5804->getFilePath(true);$v47c80780ab608cc046f2a6e6f071feb6['ext'] = $v2063c1608d6e0baf80249c42e2be5804->getExt();$v47c80780ab608cc046f2a6e6f071feb6['width'] = $v2063c1608d6e0baf80249c42e2be5804->getWidth();$v47c80780ab608cc046f2a6e6f071feb6['height'] = $v2063c1608d6e0baf80249c42e2be5804->getHeight();if(cmsController::getInstance()->getCurrentMode() == "admin") {$v47c80780ab608cc046f2a6e6f071feb6['src'] = str_replace("&", "&amp;", $v47c80780ab608cc046f2a6e6f071feb6['src']);}return $v47c80780ab608cc046f2a6e6f071feb6;}function dateToString($vd7e6d55ba379a13d08c25d15faf2a23b) {$v32843450b4086a938bf63e4d7909012a = array('января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря');$v5fc732311905cb27e82d67f4f6511f7f = date('j.m.Y', $vd7e6d55ba379a13d08c25d15faf2a23b);list($v628b7db04235f228d40adc671413a8c8, $v7436f942d5ea836cb84f1bb2527d8286, $v84cdc76cabf41bd7c961f6ab12f117d8) = explode('.', $v5fc732311905cb27e82d67f4f6511f7f);return $v628b7db04235f228d40adc671413a8c8 . " " . $v32843450b4086a938bf63e4d7909012a[(int)$v7436f942d5ea836cb84f1bb2527d8286 - 1] . " " . $v84cdc76cabf41bd7c961f6ab12f117d8;}function sumToString($ve919dd9587d4362a1fe8ac17bca8875f, $v9917ada392ebda88af3f6e4044300b7b = 1, $v6cf1f4e2a7066245e675a155d56f6d0b = 'рубль', $vcd808596985e4e2257ccdf6d5d9e01bf = 'рубля', $vbcf270c5c35c5956bf3a74c83831806b = 'рублей') {if (!$ve919dd9587d4362a1fe8ac17bca8875f) {return rtrim("ноль " . $vbcf270c5c35c5956bf3a74c83831806b);}$ve3942d06e11c5c6b01ab38df0a357298 = "";$v3aadea69327f53af0ed5f8524326da10 = $ve919dd9587d4362a1fe8ac17bca8875f;if (strpos($ve919dd9587d4362a1fe8ac17bca8875f, '.') !== 0) {$ve919dd9587d4362a1fe8ac17bca8875f = number_format($ve919dd9587d4362a1fe8ac17bca8875f, 2, '.', '');list($v3aadea69327f53af0ed5f8524326da10, $v353f919127019723b871323d8fe74f36) = explode('.', $ve919dd9587d4362a1fe8ac17bca8875f);$veb706db5fa6ffda56c020f41aefe0579 = SummaStringThree($ve3942d06e11c5c6b01ab38df0a357298, $v353f919127019723b871323d8fe74f36 , 2, "копейка", "копейки", "копеек");$ve3942d06e11c5c6b01ab38df0a357298 = $veb706db5fa6ffda56c020f41aefe0579['Summa'];}$veb706db5fa6ffda56c020f41aefe0579 = SummaStringThree($ve3942d06e11c5c6b01ab38df0a357298, $v3aadea69327f53af0ed5f8524326da10, $v9917ada392ebda88af3f6e4044300b7b, $v6cf1f4e2a7066245e675a155d56f6d0b, $vcd808596985e4e2257ccdf6d5d9e01bf, $vbcf270c5c35c5956bf3a74c83831806b);$v3aadea69327f53af0ed5f8524326da10 = $veb706db5fa6ffda56c020f41aefe0579['TempValue'];$ve3942d06e11c5c6b01ab38df0a357298 = $veb706db5fa6ffda56c020f41aefe0579['Summa'];if (!$v3aadea69327f53af0ed5f8524326da10) return $ve3942d06e11c5c6b01ab38df0a357298;$veb706db5fa6ffda56c020f41aefe0579 = SummaStringThree($ve3942d06e11c5c6b01ab38df0a357298, $v3aadea69327f53af0ed5f8524326da10, 2, "тысяча", "тысячи", "тысяч");$v3aadea69327f53af0ed5f8524326da10 = $veb706db5fa6ffda56c020f41aefe0579['TempValue'];$ve3942d06e11c5c6b01ab38df0a357298 = $veb706db5fa6ffda56c020f41aefe0579['Summa'];if (!$v3aadea69327f53af0ed5f8524326da10) return $ve3942d06e11c5c6b01ab38df0a357298;$veb706db5fa6ffda56c020f41aefe0579 = SummaStringThree($ve3942d06e11c5c6b01ab38df0a357298, $v3aadea69327f53af0ed5f8524326da10, 1, "миллион", "миллиона", "миллионов");$v3aadea69327f53af0ed5f8524326da10 = $veb706db5fa6ffda56c020f41aefe0579['TempValue'];$ve3942d06e11c5c6b01ab38df0a357298 = $veb706db5fa6ffda56c020f41aefe0579['Summa'];if (!$v3aadea69327f53af0ed5f8524326da10) return $ve3942d06e11c5c6b01ab38df0a357298;$veb706db5fa6ffda56c020f41aefe0579 = SummaStringThree($ve3942d06e11c5c6b01ab38df0a357298, $v3aadea69327f53af0ed5f8524326da10, 1, "миллиард", "миллиарда", "миллиардов");$v3aadea69327f53af0ed5f8524326da10 = $veb706db5fa6ffda56c020f41aefe0579['TempValue'];$ve3942d06e11c5c6b01ab38df0a357298 = $veb706db5fa6ffda56c020f41aefe0579['Summa'];if (!$v3aadea69327f53af0ed5f8524326da10) return $ve3942d06e11c5c6b01ab38df0a357298;$veb706db5fa6ffda56c020f41aefe0579 = SummaStringThree($ve3942d06e11c5c6b01ab38df0a357298, $v3aadea69327f53af0ed5f8524326da10, 1, "триллион", "триллиона", "триллионов");$v3aadea69327f53af0ed5f8524326da10 = $veb706db5fa6ffda56c020f41aefe0579['TempValue'];$ve3942d06e11c5c6b01ab38df0a357298 = $veb706db5fa6ffda56c020f41aefe0579['Summa'];return $ve3942d06e11c5c6b01ab38df0a357298;}function SummaStringThree($v82fbfd42d9f7304e431b0798a04e61a1, $v0c64bb27d3c3a6fe704cf3cec9939414, $vfbb74fde562f07cc9b1426ee4405818f, $va95dcb8aebb202efeedb10d5538edeb9, $vb82088730f46fcafda9344780491c39f, $v853aedc489bfcc2f8404da5f348f12c1) {$v55276c10d84e1df7713b441e76e141f9 = 0;$v0a6f12f4bcd435ecd4f9ea816a050ae9 = 0;$v56a52989440e05d2ee4cc5028ec27d6c = "";$v8ddf878039b70767c4a5bcf4f0c4f65e = "";$v2b3357d90b70edb1773bba13390166c1 = "";$vb8cc1dd2627904d355624dff69eea10d = "";$v55276c10d84e1df7713b441e76e141f9 = strlen($v0c64bb27d3c3a6fe704cf3cec9939414) < 4 ? $v0c64bb27d3c3a6fe704cf3cec9939414 : substr($v0c64bb27d3c3a6fe704cf3cec9939414, -3);$v0c64bb27d3c3a6fe704cf3cec9939414 = floor($v0c64bb27d3c3a6fe704cf3cec9939414 / 1000);if ($v55276c10d84e1df7713b441e76e141f9 === 0) {if ($v82fbfd42d9f7304e431b0798a04e61a1 === "") $v82fbfd42d9f7304e431b0798a04e61a1 = $v853aedc489bfcc2f8404da5f348f12c1 . " ";return array('TempValue' => $v0c64bb27d3c3a6fe704cf3cec9939414, 'Summa' => $v82fbfd42d9f7304e431b0798a04e61a1);}$v56a52989440e05d2ee4cc5028ec27d6c = $v853aedc489bfcc2f8404da5f348f12c1;$vd792dbd0d4e23d206af10d977cb36d44 = floor($v55276c10d84e1df7713b441e76e141f9 / 100);switch ($vd792dbd0d4e23d206af10d977cb36d44) {case 0: $vb8cc1dd2627904d355624dff69eea10d = "";break;case 1: $vb8cc1dd2627904d355624dff69eea10d = "сто ";break;case 2: $vb8cc1dd2627904d355624dff69eea10d = "двести ";break;case 3: $vb8cc1dd2627904d355624dff69eea10d = "триста ";break;case 4: $vb8cc1dd2627904d355624dff69eea10d = "четыреста ";break;case 5: $vb8cc1dd2627904d355624dff69eea10d = "пятьсот ";break;case 6: $vb8cc1dd2627904d355624dff69eea10d = "шестьсот ";break;case 7: $vb8cc1dd2627904d355624dff69eea10d = "семьсот ";break;case 8: $vb8cc1dd2627904d355624dff69eea10d = "восемьсот ";break;case 9: $vb8cc1dd2627904d355624dff69eea10d = "девятьсот ";break;}$v55276c10d84e1df7713b441e76e141f9 = $v55276c10d84e1df7713b441e76e141f9 % 100;$v0a6f12f4bcd435ecd4f9ea816a050ae9 = intval(floor($v55276c10d84e1df7713b441e76e141f9 / 10));$v8ddf878039b70767c4a5bcf4f0c4f65e = "";switch ($v0a6f12f4bcd435ecd4f9ea816a050ae9) {case 0:    $v2b3357d90b70edb1773bba13390166c1 = "";break;case 1:    switch ($v55276c10d84e1df7713b441e76e141f9) {case 10: $v2b3357d90b70edb1773bba13390166c1 = "десять ";break;case 11: $v2b3357d90b70edb1773bba13390166c1 = "одиннадцать ";break;case 12: $v2b3357d90b70edb1773bba13390166c1 = "двенадцать ";break;case 13: $v2b3357d90b70edb1773bba13390166c1 = "тринадцать ";break;case 14: $v2b3357d90b70edb1773bba13390166c1 = "четырнадцать ";break;case 15: $v2b3357d90b70edb1773bba13390166c1 = "пятнадцать ";break;case 16: $v2b3357d90b70edb1773bba13390166c1 = "шестнадцать ";break;case 17: $v2b3357d90b70edb1773bba13390166c1 = "семнадцать ";break;case 18: $v2b3357d90b70edb1773bba13390166c1 = "восемнадцать ";break;case 19: $v2b3357d90b70edb1773bba13390166c1 = "девятнадцать ";break;}break;case 2: $v2b3357d90b70edb1773bba13390166c1 = "двадцать ";break;case 3: $v2b3357d90b70edb1773bba13390166c1 = "тридцать ";break;case 4: $v2b3357d90b70edb1773bba13390166c1 = "сорок ";break;case 5: $v2b3357d90b70edb1773bba13390166c1 = "пятьдесят ";break;case 6: $v2b3357d90b70edb1773bba13390166c1 = "шестьдесят ";break;case 7: $v2b3357d90b70edb1773bba13390166c1 = "семьдесят ";break;case 8: $v2b3357d90b70edb1773bba13390166c1 = "восемьдесят ";break;case 9: $v2b3357d90b70edb1773bba13390166c1 = "девяносто ";break;}if ($v0a6f12f4bcd435ecd4f9ea816a050ae9 !== 1) {$v81133077026f407c559b0037ea5a60af = $v55276c10d84e1df7713b441e76e141f9 % 10;switch($v81133077026f407c559b0037ea5a60af) {case 1:     switch($vfbb74fde562f07cc9b1426ee4405818f) {case 1: $v8ddf878039b70767c4a5bcf4f0c4f65e = "один ";break;case 2: $v8ddf878039b70767c4a5bcf4f0c4f65e = "одна ";break;case 3: $v8ddf878039b70767c4a5bcf4f0c4f65e = "одно ";break;}$v56a52989440e05d2ee4cc5028ec27d6c = $va95dcb8aebb202efeedb10d5538edeb9;break;case 2:     if ($vfbb74fde562f07cc9b1426ee4405818f === 2) {$v8ddf878039b70767c4a5bcf4f0c4f65e = "две ";}else {$v8ddf878039b70767c4a5bcf4f0c4f65e = "два ";}$v56a52989440e05d2ee4cc5028ec27d6c = $vb82088730f46fcafda9344780491c39f;break;case 3:     $v8ddf878039b70767c4a5bcf4f0c4f65e = "три ";$v56a52989440e05d2ee4cc5028ec27d6c = $vb82088730f46fcafda9344780491c39f;break;case 4:     $v8ddf878039b70767c4a5bcf4f0c4f65e = "четыре ";$v56a52989440e05d2ee4cc5028ec27d6c = $vb82088730f46fcafda9344780491c39f;break;case 5: $v8ddf878039b70767c4a5bcf4f0c4f65e = "пять ";break;case 6: $v8ddf878039b70767c4a5bcf4f0c4f65e = "шесть ";break;case 7: $v8ddf878039b70767c4a5bcf4f0c4f65e = "семь ";break;case 8: $v8ddf878039b70767c4a5bcf4f0c4f65e = "восемь ";break;case 9:$v8ddf878039b70767c4a5bcf4f0c4f65e = "девять ";break;}}$v82fbfd42d9f7304e431b0798a04e61a1 = rtrim(rtrim($vb8cc1dd2627904d355624dff69eea10d . $v2b3357d90b70edb1773bba13390166c1 . $v8ddf878039b70767c4a5bcf4f0c4f65e . $v56a52989440e05d2ee4cc5028ec27d6c) . " " . $v82fbfd42d9f7304e431b0798a04e61a1);return array('TempValue' => $v0c64bb27d3c3a6fe704cf3cec9939414, 'Summa' => $v82fbfd42d9f7304e431b0798a04e61a1);}function prepareRequest($v3c6e0b8a9c15224a8228b9a98ca1531d) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if ($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() != 'admin') return false;$ve4e46deb7f9cc58c7abfb32e5570b6f3 = getRequest('domain_id');$v5a05866850c28651fe234659f6c92ada = getRequest('lang_id');$v48908871a0d20dd2e5bd0a3d634ac745 = getRequest('rel');if (!is_array($ve4e46deb7f9cc58c7abfb32e5570b6f3) || !is_array($v5a05866850c28651fe234659f6c92ada)) return false;$v22884db148f0ffb0d830ba431102b0b5 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentModule();$vea9f6aca279138c58f705c8d4cb4b8ce = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentMethod();if(!$v22884db148f0ffb0d830ba431102b0b5 || !$vea9f6aca279138c58f705c8d4cb4b8ce) return false;if (!isset($_SESSION['paging'])) $_SESSION['paging'] = array();$v72ee76c5c29383b7c9f9225c1fa4d10b = $ve4e46deb7f9cc58c7abfb32e5570b6f3[0];if (!isset($_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b])) $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b] = array();$vf585b7f018bb4ced15a03683a733e50b = $v5a05866850c28651fe234659f6c92ada[0];if (!isset($_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b])) $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b] = array();if (!isset($_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5])) $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5] = array();if (!isset($_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce])) $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce] = array();if (!isset($_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce]['per_page_limit'])) $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce]['per_page_limit'] = 20;if (is_array($v48908871a0d20dd2e5bd0a3d634ac745)) {$va722790b49e8eb1f37a1c672326ec501 = $v48908871a0d20dd2e5bd0a3d634ac745[0];}else {$va722790b49e8eb1f37a1c672326ec501 = 0;}if (!isset($_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce][$va722790b49e8eb1f37a1c672326ec501])) $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce][$va722790b49e8eb1f37a1c672326ec501] = NULL;if ($v3c6e0b8a9c15224a8228b9a98ca1531d == 'per_page_limit') {$vfd99915015add1d849c02ad4b17e9336 = getArrayKey($_REQUEST, $v3c6e0b8a9c15224a8228b9a98ca1531d);if (!is_null($vfd99915015add1d849c02ad4b17e9336)) {$v9de78d59f762eb7ae7bb1b6b828bea0b = $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce]['per_page_limit'];$_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce]['per_page_limit'] = $vfd99915015add1d849c02ad4b17e9336;$v70317dcda32ebeb34e3c30445a495bf7 = $v9de78d59f762eb7ae7bb1b6b828bea0b/$vfd99915015add1d849c02ad4b17e9336;foreach ($_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce] as $v7ffc4d510260a8544e5550e62ec56bc1=>$v71860c77c6745379b0d44304d66b6a13) {if ((string) $v7ffc4d510260a8544e5550e62ec56bc1 == 'per_page_limit') continue;$_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce][$v7ffc4d510260a8544e5550e62ec56bc1] = (int) ($v71860c77c6745379b0d44304d66b6a13 * $v70317dcda32ebeb34e3c30445a495bf7);}if (($v9de78d59f762eb7ae7bb1b6b828bea0b != $vfd99915015add1d849c02ad4b17e9336) && isset($_REQUEST['p']) && $_REQUEST['p'] != 'all') {$_REQUEST['p'] = $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce][$va722790b49e8eb1f37a1c672326ec501];}}return $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce]['per_page_limit'];}if ($v3c6e0b8a9c15224a8228b9a98ca1531d == 'p') {$vd58c61d4baf203c327ec51adbd377a4e = getArrayKey($_REQUEST, $v3c6e0b8a9c15224a8228b9a98ca1531d);if (!is_null($vd58c61d4baf203c327ec51adbd377a4e)) {$_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce][$va722790b49e8eb1f37a1c672326ec501] = $vd58c61d4baf203c327ec51adbd377a4e;}}return $_SESSION['paging'][$v72ee76c5c29383b7c9f9225c1fa4d10b][$vf585b7f018bb4ced15a03683a733e50b][$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce][$va722790b49e8eb1f37a1c672326ec501];}function umi_var_dump($v2063c1608d6e0baf80249c42e2be5804, $ve70c4df10ef0983b9c8c31bd06b2a2c3 = false){$v777ea32888307cac75f53f3e38e3acc1 = getServer('HTTP_X_REAL_IP');if (!$v777ea32888307cac75f53f3e38e3acc1) {$v777ea32888307cac75f53f3e38e3acc1 = getServer('REMOTE_ADDR');}$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$v13dff00992bdb85c1d1da3a0732b95b8 = $v2245023265ae4cf87d02c8b6ba991139->get('debug', 'allowed-ip');$v13dff00992bdb85c1d1da3a0732b95b8 = is_array($v13dff00992bdb85c1d1da3a0732b95b8) ? $v13dff00992bdb85c1d1da3a0732b95b8 : array();if (in_array($v777ea32888307cac75f53f3e38e3acc1, $v13dff00992bdb85c1d1da3a0732b95b8)) {var_dump($v2063c1608d6e0baf80249c42e2be5804);}elseif ($ve70c4df10ef0983b9c8c31bd06b2a2c3) {var_dump($v2063c1608d6e0baf80249c42e2be5804);}}function elfinder_get_hash($vd6fe1d0be6347b8ef2427fa629c04485) {if (!strlen($vd6fe1d0be6347b8ef2427fa629c04485)) return '';$vd6fe1d0be6347b8ef2427fa629c04485 = str_replace('\\', '/', realpath("./" . trim($vd6fe1d0be6347b8ef2427fa629c04485, "./\\")));$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $v41275a535677f79ff347e01bc530c176->getUserId();$vee11cbb19052e40b07aac0ca060c23ee = umiObjectsCollection::getInstance()->getObject($v8e44f0089b076e18a718eb9ca3d94674);$v36cd38f49b9afa08222c0dc9ebfe35eb = "";if ($v8bb6d1e60be4323c974fc0cd44c6e711 = $vee11cbb19052e40b07aac0ca060c23ee->getValue('filemanager_directory')) {$v865c0c0b4ab0e063e5caa3387c1a8741 = 1;$vbd1e333d1166f18893b2bbeba10229a3 = explode(",", $v8bb6d1e60be4323c974fc0cd44c6e711);foreach ($vbd1e333d1166f18893b2bbeba10229a3 as $v5f8f22b8cdbaeee8cf857673a9b6ba20) {$v5f8f22b8cdbaeee8cf857673a9b6ba20 = trim($v5f8f22b8cdbaeee8cf857673a9b6ba20);$v5f8f22b8cdbaeee8cf857673a9b6ba20 = trim($v5f8f22b8cdbaeee8cf857673a9b6ba20, "/");if (!strlen($v5f8f22b8cdbaeee8cf857673a9b6ba20)) continue;$v06f0066e65410a0a1c9f39991a3f3b01 = realpath(CURRENT_WORKING_DIR . "/" . $v5f8f22b8cdbaeee8cf857673a9b6ba20);if (strpos($v06f0066e65410a0a1c9f39991a3f3b01, CURRENT_WORKING_DIR) === false || !is_dir($v06f0066e65410a0a1c9f39991a3f3b01)) continue;if (strpos($vd6fe1d0be6347b8ef2427fa629c04485, $v5f8f22b8cdbaeee8cf857673a9b6ba20) !== false) {$v36cd38f49b9afa08222c0dc9ebfe35eb = "files" . $v865c0c0b4ab0e063e5caa3387c1a8741;$vd6fe1d0be6347b8ef2427fa629c04485 = trim(str_replace(CURRENT_WORKING_DIR . "/" . $v5f8f22b8cdbaeee8cf857673a9b6ba20, "", $vd6fe1d0be6347b8ef2427fa629c04485), "/");break;}$v865c0c0b4ab0e063e5caa3387c1a8741++;}}else {$v9dd31139fda0f166a9d2a3418030d054 = str_replace('\\', '/', realpath(CURRENT_WORKING_DIR . "/images"));$vd5a166976ae1b74d6d14d8be6b9db02e = str_replace('\\', '/', realpath(CURRENT_WORKING_DIR . "/files"));if (strpos($vd6fe1d0be6347b8ef2427fa629c04485, $v9dd31139fda0f166a9d2a3418030d054) === 0) {$vd6fe1d0be6347b8ef2427fa629c04485 = trim(str_replace($v9dd31139fda0f166a9d2a3418030d054, "", $vd6fe1d0be6347b8ef2427fa629c04485), "/");$v36cd38f49b9afa08222c0dc9ebfe35eb = "images";}elseif (strpos($vd6fe1d0be6347b8ef2427fa629c04485, $vd5a166976ae1b74d6d14d8be6b9db02e) === 0) {$vd6fe1d0be6347b8ef2427fa629c04485 = trim(str_replace($vd5a166976ae1b74d6d14d8be6b9db02e, "", $vd6fe1d0be6347b8ef2427fa629c04485), "/");$v36cd38f49b9afa08222c0dc9ebfe35eb = "files";}}$vd6fe1d0be6347b8ef2427fa629c04485 = str_replace("/", DIRECTORY_SEPARATOR, $vd6fe1d0be6347b8ef2427fa629c04485);$v0800fc577294c34e0b28ad2839435945 = strtr(base64_encode($vd6fe1d0be6347b8ef2427fa629c04485), '+/=', '-_.');$v0800fc577294c34e0b28ad2839435945 = rtrim($v0800fc577294c34e0b28ad2839435945, '.');return strlen($v0800fc577294c34e0b28ad2839435945) ? "umi" . $v36cd38f49b9afa08222c0dc9ebfe35eb . "_" . $v0800fc577294c34e0b28ad2839435945 : "umi" . $v36cd38f49b9afa08222c0dc9ebfe35eb;}function get_server_load() {if (!stristr(PHP_OS, 'win') && function_exists('sys_getloadavg')) {$vec4d1eb36b22d19728e9d1d23ca84d1c = sys_getloadavg();return getLabel('load-average').$vec4d1eb36b22d19728e9d1d23ca84d1c[0].', '.$vec4d1eb36b22d19728e9d1d23ca84d1c[1].', '.$vec4d1eb36b22d19728e9d1d23ca84d1c[2];}}function secure_load_simple_xml($v0f635d0e0f3874fff8b581c132e6c7a7, &$v7059984336b2d926f78c0472111d55e8 = null) {$vbc681290d0bd0be5d0f93c128555c63d = libxml_disable_entity_loader(true);$v7059984336b2d926f78c0472111d55e8 = @simplexml_load_string($v0f635d0e0f3874fff8b581c132e6c7a7);libxml_disable_entity_loader($vbc681290d0bd0be5d0f93c128555c63d);return $v7059984336b2d926f78c0472111d55e8;}function secure_load_dom_document($v0f635d0e0f3874fff8b581c132e6c7a7, &$vc2d66aafee5d0e58e7682dd3e7b5d7f6 = null) {$vbc681290d0bd0be5d0f93c128555c63d = libxml_disable_entity_loader(true);if (is_null($vc2d66aafee5d0e58e7682dd3e7b5d7f6)) {$vc2d66aafee5d0e58e7682dd3e7b5d7f6 = new DOMDocument('1.0', 'utf-8');}$result = @$vc2d66aafee5d0e58e7682dd3e7b5d7f6->loadXML($v0f635d0e0f3874fff8b581c132e6c7a7, DOM_LOAD_OPTIONS);libxml_disable_entity_loader($vbc681290d0bd0be5d0f93c128555c63d);return $result;}class mainConfiguration {private static $instance = null;private $ini    = array();private $edited = false;private function __construct() {if(!is_readable(CONFIG_INI_PATH)) {throw new Exception("Can't find configuration file");}$this->ini = parse_ini_file(CONFIG_INI_PATH, true);if(isset($this->ini['system']) && isset($this->ini['system']['session-lifetime']) && $this->ini['system']['session-lifetime'] < 1) {$this->ini['system']['session-lifetime'] = 1440;}}public function __destruct() {if($this->edited) {$this->writeIni();}}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {if(!self::$instance) {self::$instance = new mainConfiguration();}return self::$instance;}public function getParsedIni() {return $this->ini;}public function get($v73d5342eba070f636ac3246f319bf77f, $ve04aa5104d082e4a51d241391941ba26) {if(isset($this->ini[$v73d5342eba070f636ac3246f319bf77f]) &&      isset($this->ini[$v73d5342eba070f636ac3246f319bf77f][$ve04aa5104d082e4a51d241391941ba26])) {$v2063c1608d6e0baf80249c42e2be5804 = $this->ini[$v73d5342eba070f636ac3246f319bf77f][$ve04aa5104d082e4a51d241391941ba26];$v2063c1608d6e0baf80249c42e2be5804 = $this->unescapeValue($v2063c1608d6e0baf80249c42e2be5804);if ($v73d5342eba070f636ac3246f319bf77f == 'system' && $ve04aa5104d082e4a51d241391941ba26 == 'session-lifetime' && $v2063c1608d6e0baf80249c42e2be5804 < 1) $v2063c1608d6e0baf80249c42e2be5804 = 1440;return $v2063c1608d6e0baf80249c42e2be5804;}else return null;}public function set($v73d5342eba070f636ac3246f319bf77f, $ve04aa5104d082e4a51d241391941ba26, $v2063c1608d6e0baf80249c42e2be5804) {if(!isset($this->ini[$v73d5342eba070f636ac3246f319bf77f])) {$this->ini[$v73d5342eba070f636ac3246f319bf77f] = array();}if($v2063c1608d6e0baf80249c42e2be5804 === null && isset($this->ini[$v73d5342eba070f636ac3246f319bf77f][$ve04aa5104d082e4a51d241391941ba26])) {unset($this->ini[$v73d5342eba070f636ac3246f319bf77f][$ve04aa5104d082e4a51d241391941ba26]);}else {if ($v73d5342eba070f636ac3246f319bf77f == 'system' && $ve04aa5104d082e4a51d241391941ba26 == 'session-lifetime' && $v2063c1608d6e0baf80249c42e2be5804 < 1) $v2063c1608d6e0baf80249c42e2be5804 = 1440;$this->ini[$v73d5342eba070f636ac3246f319bf77f][$ve04aa5104d082e4a51d241391941ba26] = $v2063c1608d6e0baf80249c42e2be5804;}$this->edited = true;}public function getList($v73d5342eba070f636ac3246f319bf77f) {if(isset($this->ini[$v73d5342eba070f636ac3246f319bf77f]) && is_array($this->ini[$v73d5342eba070f636ac3246f319bf77f])) {return array_keys($this->ini[$v73d5342eba070f636ac3246f319bf77f]);}return null;}public function includeParam($v3c6e0b8a9c15224a8228b9a98ca1531d, array $v21ffce5b8a6cc8cc6a41448dd69623c9 =  null) {static $v50e5261d8bca7ae22f750db5a5e38482 = Array();$vd6fe1d0be6347b8ef2427fa629c04485 = $this->get('includes', $v3c6e0b8a9c15224a8228b9a98ca1531d);if(strpos($vd6fe1d0be6347b8ef2427fa629c04485, "{") !== false) {if(class_exists('cmsController') && !sizeof($v50e5261d8bca7ae22f750db5a5e38482)) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if($v7572559ca86e781ba8fe8073a0b725c6 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()) {$v50e5261d8bca7ae22f750db5a5e38482['lang'] = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getPrefix();}if($v7572559ca86e781ba8fe8073a0b725c6 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()) {$v50e5261d8bca7ae22f750db5a5e38482['domain'] = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getHost();}}$v21ffce5b8a6cc8cc6a41448dd69623c9 = (is_null($v21ffce5b8a6cc8cc6a41448dd69623c9)) ? $v50e5261d8bca7ae22f750db5a5e38482 : array_merge($v21ffce5b8a6cc8cc6a41448dd69623c9, $v50e5261d8bca7ae22f750db5a5e38482);foreach($v21ffce5b8a6cc8cc6a41448dd69623c9 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) $vd6fe1d0be6347b8ef2427fa629c04485 = str_replace('{' . $v865c0c0b4ab0e063e5caa3387c1a8741 . '}', $v9e3669d19b675bd57058fd4664205d2a,  $vd6fe1d0be6347b8ef2427fa629c04485);}if(substr($vd6fe1d0be6347b8ef2427fa629c04485, 0, 2) == "~/") {$vd6fe1d0be6347b8ef2427fa629c04485 = CURRENT_WORKING_DIR . substr($vd6fe1d0be6347b8ef2427fa629c04485, 1);}return $vd6fe1d0be6347b8ef2427fa629c04485;}private function writeIni() {$vf45acc4a1a9cdb4fdf92ffb1ce8b7b2b = "";foreach($this->ini as $v594ee3c471d60af7fcbd5c817e19b259 => $v73d5342eba070f636ac3246f319bf77f) {if(empty($v73d5342eba070f636ac3246f319bf77f)) continue;$vf45acc4a1a9cdb4fdf92ffb1ce8b7b2b .= "[{$v594ee3c471d60af7fcbd5c817e19b259}]\n";foreach($v73d5342eba070f636ac3246f319bf77f as $vb068931cc450442b63f5b3d276ea4297 => $v2063c1608d6e0baf80249c42e2be5804) {if(is_array($v2063c1608d6e0baf80249c42e2be5804)) {foreach($v2063c1608d6e0baf80249c42e2be5804 as $v2d79067f0fcb37a2c56a7c466f56f0ae) {$v2d79067f0fcb37a2c56a7c466f56f0ae = ($v2d79067f0fcb37a2c56a7c466f56f0ae !== '') ? '"' . $v2d79067f0fcb37a2c56a7c466f56f0ae . '"' : '';$vf45acc4a1a9cdb4fdf92ffb1ce8b7b2b .= "{$vb068931cc450442b63f5b3d276ea4297}[] = {$v2d79067f0fcb37a2c56a7c466f56f0ae}\n";}}else {$v2063c1608d6e0baf80249c42e2be5804 = ($v2063c1608d6e0baf80249c42e2be5804 !== '') ? '"' . $v2063c1608d6e0baf80249c42e2be5804 . '"' : '';$vf45acc4a1a9cdb4fdf92ffb1ce8b7b2b .= "{$vb068931cc450442b63f5b3d276ea4297} = {$v2063c1608d6e0baf80249c42e2be5804}\n";}}$vf45acc4a1a9cdb4fdf92ffb1ce8b7b2b .= "\n";}file_put_contents(CONFIG_INI_PATH, $vf45acc4a1a9cdb4fdf92ffb1ce8b7b2b);}private function unescapeValue($v2063c1608d6e0baf80249c42e2be5804) {if(is_array($v2063c1608d6e0baf80249c42e2be5804)) {foreach($v2063c1608d6e0baf80249c42e2be5804 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {$v2063c1608d6e0baf80249c42e2be5804[$v865c0c0b4ab0e063e5caa3387c1a8741] = $this->unescapeValue($v9e3669d19b675bd57058fd4664205d2a);}return $v2063c1608d6e0baf80249c42e2be5804;}if(strlen($v2063c1608d6e0baf80249c42e2be5804) >= 2 && substr($v2063c1608d6e0baf80249c42e2be5804, 0, 1) == "'" && substr($v2063c1608d6e0baf80249c42e2be5804, -1, 1) == "'") {$v2063c1608d6e0baf80249c42e2be5804 = substr($v2063c1608d6e0baf80249c42e2be5804, 1, strlen($v2063c1608d6e0baf80249c42e2be5804) - 2);}return $v2063c1608d6e0baf80249c42e2be5804;}};if (!defined("CURRENT_WORKING_DIR")) {define("CURRENT_WORKING_DIR", str_replace("\\", "/", dirname(dirname(__FILE__))));}if(!defined('CONFIG_INI_PATH')) {define('CONFIG_INI_PATH', CURRENT_WORKING_DIR . '/config.ini');}if (!function_exists('showWorkTime')) {require_once CURRENT_WORKING_DIR . '/libs/root-src/profiler.php';}showWorkTime("config start");if(!class_exists('mainConfiguration')) {require CURRENT_WORKING_DIR . '/libs/configuration.php';}try {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();}catch (Exception $ve1671797c52e15f763380b45e841ec32) {echo 'Critical error: ', $ve1671797c52e15f763380b45e841ec32->getMessage();exit;}$v4d90362d661461e558408e982aaa49d3 = $v2245023265ae4cf87d02c8b6ba991139->getParsedIni();initConfigConstants($v4d90362d661461e558408e982aaa49d3);define("SYS_KERNEL_PATH", $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.kernel'));define("SYS_KERNEL_ASM", $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.kernel.assebled'));define("SYS_LIBS_PATH", $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.libs'));define("SYS_DEF_MODULE_PATH", $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.default-module'));define("SYS_TPLS_PATH", $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.tpl'));define("SYS_XSLT_PATH", $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.xsl'));define("SYS_SKIN_PATH", $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.skins'));define("SYS_ERRORS_PATH", $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.error'));define("SYS_MODULES_PATH", $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.modules'));define("SYS_CACHE_RUNTIME", $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.runtime-cache'));define("SYS_MANIFEST_PATH", $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.manifest'));define("SYS_KERNEL_STREAMS", $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.kernel.streams'));define("KEYWORD_GRAB_ALL", $v2245023265ae4cf87d02c8b6ba991139->get('kernel', 'grab-all-keyword'));$vfba0d91e419859c990a71867be15cec8 = $v2245023265ae4cf87d02c8b6ba991139->get('system', 'salt');if(!$vfba0d91e419859c990a71867be15cec8) {$vfba0d91e419859c990a71867be15cec8 = sha1(rand());$v2245023265ae4cf87d02c8b6ba991139->set('system', 'salt', $vfba0d91e419859c990a71867be15cec8);}define("SYS_CACHE_SALT", $vfba0d91e419859c990a71867be15cec8);spl_autoload_register('umiAutoload');if(!defined('_C_REQUIRES')) {showWorkTime("config require requires start");require SYS_LIBS_PATH . 'requires.php';showWorkTime("config require requires end");}$vad42f6697b035b7580e4fef93be20b4d = false;if($v2245023265ae4cf87d02c8b6ba991139->get('debug', 'enabled')) {$vde56be8fa19339d679efa6232455f342 = $v2245023265ae4cf87d02c8b6ba991139->get('debug', 'filter.ip');if(is_array($vde56be8fa19339d679efa6232455f342)) {if(in_array(getServer('REMOTE_ADDR'), $vde56be8fa19339d679efa6232455f342)) {$vad42f6697b035b7580e4fef93be20b4d = true;}}else {$vad42f6697b035b7580e4fef93be20b4d = true;}}if (!defined('DEBUG')) define('DEBUG', $vad42f6697b035b7580e4fef93be20b4d);if (!defined('DEBUG_SHOW_BACKTRACE')) {$v8300571deaa2e57d3c3261147394d566 = false;$v13dff00992bdb85c1d1da3a0732b95b8 = $v2245023265ae4cf87d02c8b6ba991139->get('debug', 'allowed-ip');$v13dff00992bdb85c1d1da3a0732b95b8 = is_array($v13dff00992bdb85c1d1da3a0732b95b8) ? $v13dff00992bdb85c1d1da3a0732b95b8 : array();if ($v2245023265ae4cf87d02c8b6ba991139->get('debug', 'show-backtrace') && (!count($v13dff00992bdb85c1d1da3a0732b95b8) || in_array(getServer('REMOTE_ADDR'), $v13dff00992bdb85c1d1da3a0732b95b8))) $v8300571deaa2e57d3c3261147394d566 = true;define('DEBUG_SHOW_BACKTRACE', $v8300571deaa2e57d3c3261147394d566);}if(!defined('_C_ERRORS')) {require SYS_LIBS_PATH . 'errors.php';}if ($vb2c6cc48f97ccd71b16d31d88fc177a6 = $v2245023265ae4cf87d02c8b6ba991139->get("system", "time-zone")) {@date_default_timezone_set($vb2c6cc48f97ccd71b16d31d88fc177a6);}initConfigConnections($v4d90362d661461e558408e982aaa49d3);if(defined("LIBXML_VERSION")) {define("DOM_LOAD_OPTIONS", (LIBXML_VERSION < 20621) ? 0 : LIBXML_COMPACT);}else {define("DOM_LOAD_OPTIONS", LIBXML_COMPACT);}if (!defined("PHP_INT_MAX")) define("PHP_INT_MAX", 4294967296 / 2 - 1);if(!isset($_ENV['OS']) || strtolower(substr($_ENV['OS'], 0, 3)) != "win") {setlocale(LC_NUMERIC, 'en_US.utf8');}if(function_exists("mb_internal_encoding")) {mb_internal_encoding('UTF-8');}ini_set("session.cookie_lifetime", "0");ini_set("session.use_cookies", "1");ini_set("session.use_only_cookies", "1");if(CLUSTER_CACHE_CORRECTION) {cacheFrontend::getInstance();clusterCacheSync::getInstance();}$v8273b38d8233dda449dd9d674247717d = getServer('REMOTE_ADDR');$v8dbfd5440d3380e440b362edaebe115a = array();$v1804956abd21cd701c0e7931d7ebf5df = l_mysql_query("SHOW TABLES LIKE 'cms3_objects'");$v486a9bbc2c582b30c8899b6f20a7e59e = l_mysql_query("SHOW TABLES LIKE 'cms3_object_types'");if(mysql_num_rows($v1804956abd21cd701c0e7931d7ebf5df) && mysql_num_rows($v486a9bbc2c582b30c8899b6f20a7e59e)) {$result = l_mysql_query("SELECT name FROM `cms3_objects` where type_id = (SELECT id FROM `cms3_object_types` where guid='ip-blacklist')");while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result)){$v8dbfd5440d3380e440b362edaebe115a[] = $vf1965a857bc285d26fe22023aa5ab50d[0];}}$v2cd233016f5ec924a04ddd693d8af11d = $v2245023265ae4cf87d02c8b6ba991139->get('kernel', 'ip-blacklist');if(!empty($v2cd233016f5ec924a04ddd693d8af11d) && $v8273b38d8233dda449dd9d674247717d !== null) {$vde56be8fa19339d679efa6232455f342 = explode(",", $v2cd233016f5ec924a04ddd693d8af11d);$v8dbfd5440d3380e440b362edaebe115a = array_merge($v8dbfd5440d3380e440b362edaebe115a, $vde56be8fa19339d679efa6232455f342);}foreach ($v8dbfd5440d3380e440b362edaebe115a as $vb80bb7740288fda1f201890375a60c8f => $v3c02ba7439c66ca418e19b4989f21dea) {$v3c02ba7439c66ca418e19b4989f21dea = trim($v3c02ba7439c66ca418e19b4989f21dea);if ($v3c02ba7439c66ca418e19b4989f21dea == $v8273b38d8233dda449dd9d674247717d) {$v7f2db423a49b305459147332fb01cf87 = OutputBuffer::current('HTTPOutputBuffer');$v7f2db423a49b305459147332fb01cf87->contentType('text/html');$v7f2db423a49b305459147332fb01cf87->charset('utf-8');$v7f2db423a49b305459147332fb01cf87->status('403 Forbidden');$v7f2db423a49b305459147332fb01cf87->clear();$v7f2db423a49b305459147332fb01cf87->end();}}function umiAutoload($v6f66e878c62db60568a3487869695820) {showWorkTime("umiAutoload ".$v6f66e878c62db60568a3487869695820." start",2);global $vbb2b21ef7774df8687ff02b0284505c6;if ($v6f66e878c62db60568a3487869695820 == "XSLTProcessor" && !class_exists("XSLTProcessor")){xslt_fatal();}if(defined('INTERRUPT_DEPRECATED_CALL') && INTERRUPT_DEPRECATED_CALL) {$v04acbbf097cd951f88078cfa9f755ffc = array('umiSelection', 'umiSelectionsParser');if(in_array($v6f66e878c62db60568a3487869695820, $v04acbbf097cd951f88078cfa9f755ffc)) {$ve1671797c52e15f763380b45e841ec32 = new coreException("Deprecated class \"{$v6f66e878c62db60568a3487869695820}\" called");traceException($ve1671797c52e15f763380b45e841ec32);}}if(isset($vbb2b21ef7774df8687ff02b0284505c6[$v6f66e878c62db60568a3487869695820])) {$v45b963397aa40d4a0063e0d85e4fe7a1 = $vbb2b21ef7774df8687ff02b0284505c6[$v6f66e878c62db60568a3487869695820];if(is_array($v45b963397aa40d4a0063e0d85e4fe7a1)) {foreach($v45b963397aa40d4a0063e0d85e4fe7a1 as $v47826cacc65c665212b821e6ff80b9b0) {require_once $v47826cacc65c665212b821e6ff80b9b0;showWorkTime("umiAutoload ".basename($v47826cacc65c665212b821e6ff80b9b0)." required",2);}}}showWorkTime("umiAutoload ".$v6f66e878c62db60568a3487869695820." end",2);}function initConfigConstants($v4d90362d661461e558408e982aaa49d3) {$v24226a6ae78009cfdb0ebfd01d968d41 = array(   'system:db-driver' => array('DB_DRIVER', '%value%'),   'system:version-line' => array('CURRENT_VERSION_LINE', '%value%'),   'system:session-lifetime' => array('SESSION_LIFETIME', '%value%'),   'system:default-date-format' => array('DEFAULT_DATE_FORMAT', '%value%'),   'kernel:use-reflection-extension' => array('USE_REFLECTION_EXT', '%value%'),   'kernel:cluster-cache-correction' => array('CLUSTER_CACHE_CORRECTION', '%value%'),   'kernel:xslt-nested-menu' => array('XSLT_NESTED_MENU', '%value%'),   'kernel:pages-auto-index' => array('PAGES_AUTO_INDEX', '%value%'),   'kernel:enable-pre-auth' => array('PRE_AUTH_ENABLED', '%value%'),   'kernel:ignore-module-names-overwrite' => array('IGNORE_MODULE_NAMES_OVERWRITE', '%value%'),   'kernel:xml-format-output' => array('XML_FORMAT_OUTPUT', '%value%'),   'kernel:selection-max-joins' => array('MAX_SELECTION_TABLE_JOINS', '%value%'),   'kernel:property-value-mode' => array('XML_PROP_VALUE_MODE', '%value%'),   'kernel:xml-macroses-disable' => array('XML_MACROSES_DISABLE', '%value%'),   'kernel:selection-calc-found-rows-disable' => array('DISABLE_CALC_FOUND_ROWS', '%value%'),   'kernel:sql-query-cache' => array('SQL_QUERY_CACHE', '%value%'),   'seo:calculate-e-tag' => array('CALC_E_TAG', '%value%'),   'seo:calculate-last-modified' => array('CALC_LAST_MODIFIED', '%value%')  );foreach($v24226a6ae78009cfdb0ebfd01d968d41 as $vb068931cc450442b63f5b3d276ea4297 => $v6680dba00f3a88f66f8029a93d71d93c) {list($v73d5342eba070f636ac3246f319bf77f, $ve04aa5104d082e4a51d241391941ba26) = explode(':', $vb068931cc450442b63f5b3d276ea4297);$v2063c1608d6e0baf80249c42e2be5804 = $v6680dba00f3a88f66f8029a93d71d93c[1];if(is_string($v2063c1608d6e0baf80249c42e2be5804)) {$vb78a8fc85436584420cc48cc283ca2d2 = isset($v4d90362d661461e558408e982aaa49d3[$v73d5342eba070f636ac3246f319bf77f][$ve04aa5104d082e4a51d241391941ba26]) ? $v4d90362d661461e558408e982aaa49d3[$v73d5342eba070f636ac3246f319bf77f][$ve04aa5104d082e4a51d241391941ba26] : "";$v2063c1608d6e0baf80249c42e2be5804 = str_replace('%value%', $vb78a8fc85436584420cc48cc283ca2d2, $v2063c1608d6e0baf80249c42e2be5804);}else if (!$v2063c1608d6e0baf80249c42e2be5804 && isset($v6680dba00f3a88f66f8029a93d71d93c[2])) {$v2063c1608d6e0baf80249c42e2be5804 = $v6680dba00f3a88f66f8029a93d71d93c[2];}if(!defined($v6680dba00f3a88f66f8029a93d71d93c[0])) {if($v6680dba00f3a88f66f8029a93d71d93c[0] == 'CURRENT_VERSION_LINE' && !$v2063c1608d6e0baf80249c42e2be5804) {continue;}define($v6680dba00f3a88f66f8029a93d71d93c[0], $v2063c1608d6e0baf80249c42e2be5804);}}}function initConfigConnections($v4d90362d661461e558408e982aaa49d3) {$v1e4e0a3ebca33b9df743bacb740ce1d4 = array();foreach($v4d90362d661461e558408e982aaa49d3['connections'] as $vb068931cc450442b63f5b3d276ea4297 => $v2063c1608d6e0baf80249c42e2be5804) {list($va2f2ed4f8ebc2cbb4c21a29dc40ab61d, $v1fda785a420c0ffe9a33d814a05d5273) = explode('.', $vb068931cc450442b63f5b3d276ea4297);if(!isset($v1e4e0a3ebca33b9df743bacb740ce1d4[$va2f2ed4f8ebc2cbb4c21a29dc40ab61d])) {$v1e4e0a3ebca33b9df743bacb740ce1d4[$va2f2ed4f8ebc2cbb4c21a29dc40ab61d] = array(          'type'        => 'mysql',          'host'    => 'localhost',          'login'       => 'root',          'password'    => '',          'dbname'      => 'umi',          'port'       => false,          'persistent'  => false,          'compression' => false);}$v1e4e0a3ebca33b9df743bacb740ce1d4[$va2f2ed4f8ebc2cbb4c21a29dc40ab61d][$v1fda785a420c0ffe9a33d814a05d5273] = $v2063c1608d6e0baf80249c42e2be5804;}$vb10a8c0bede9eb4ea771b04db3149f28 = ConnectionPool::getInstance();foreach($v1e4e0a3ebca33b9df743bacb740ce1d4 as $va2f2ed4f8ebc2cbb4c21a29dc40ab61d => $v7ed201fa20d25d22b291dc85ae9e5ced) {$vb10a8c0bede9eb4ea771b04db3149f28->setConnectionObjectClass();if($v7ed201fa20d25d22b291dc85ae9e5ced['dbname'] == '-=demo=-' || $v7ed201fa20d25d22b291dc85ae9e5ced['dbname'] == '-=custom=-') {if($v7ed201fa20d25d22b291dc85ae9e5ced['dbname'] == '-=demo=-') {require './demo-center.php';}$v7ed201fa20d25d22b291dc85ae9e5ced['host'] = MYSQL_HOST;$v7ed201fa20d25d22b291dc85ae9e5ced['login'] = MYSQL_LOGIN;$v7ed201fa20d25d22b291dc85ae9e5ced['password'] = MYSQL_PASSWORD;$v7ed201fa20d25d22b291dc85ae9e5ced['dbname'] = ($v7ed201fa20d25d22b291dc85ae9e5ced['dbname'] == '-=custom=-') ? MYSQL_DB_NAME : DEMO_DB_NAME;}$vb10a8c0bede9eb4ea771b04db3149f28->addConnection($va2f2ed4f8ebc2cbb4c21a29dc40ab61d, $v7ed201fa20d25d22b291dc85ae9e5ced['host'], $v7ed201fa20d25d22b291dc85ae9e5ced['login'], $v7ed201fa20d25d22b291dc85ae9e5ced['password'], $v7ed201fa20d25d22b291dc85ae9e5ced['dbname'],    ($v7ed201fa20d25d22b291dc85ae9e5ced['port'] !== false) ? $v7ed201fa20d25d22b291dc85ae9e5ced['port'] : false,    (bool) intval($v7ed201fa20d25d22b291dc85ae9e5ced['persistent']) );}if(DB_DRIVER == "mysql") {$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();ini_set('mysql.trace_mode', false);}}function mysql_fatal() {header(':', true, 503);require "./errors/mysql_failed.html";exit();}function xslt_fatal(){header(':', true, 503);require ("./errors/xslt_failed.html");exit();}if (!defined('_C_ERRORS')) {define('_C_ERRORS', true);}error_reporting(DEBUG ? (defined('E_DEPRECATED') ? ~E_STRICT & ~E_DEPRECATED : ~E_STRICT) : E_ERROR);ini_set("display_errors", "1");class umiExceptionHandler {private static $templateFile = NULL;protected static function getExceptionTemplate() {if ( !self::$templateFile ) {self::setExceptionTemplate(SYS_ERRORS_PATH . "exception.html.php")    || self::setExceptionTemplate(SYS_ERRORS_PATH . "exception.php");}return self::$templateFile;}protected static function setExceptionTemplate($v8c7dd922ad47494fc02c388e12c00eac) {if (!file_exists($v8c7dd922ad47494fc02c388e12c00eac) ) {self::$templateFile = NULL;return false;}else {self::$templateFile = $v8c7dd922ad47494fc02c388e12c00eac;}}protected static function printTemplate($ve1671797c52e15f763380b45e841ec32) {$v42552b1f133f9f8eb406d4f306ea9fd1 = new StdClass;$v42552b1f133f9f8eb406d4f306ea9fd1->code  = $ve1671797c52e15f763380b45e841ec32->getCode();$v42552b1f133f9f8eb406d4f306ea9fd1->message = $ve1671797c52e15f763380b45e841ec32->getMessage();$v42552b1f133f9f8eb406d4f306ea9fd1->type  = get_class($ve1671797c52e15f763380b45e841ec32);if (DEBUG_SHOW_BACKTRACE) {$v42552b1f133f9f8eb406d4f306ea9fd1->trace = $ve1671797c52e15f763380b45e841ec32->getTrace();$v42552b1f133f9f8eb406d4f306ea9fd1->traceAsString = $ve1671797c52e15f763380b45e841ec32->getTraceAsString();}require self::getExceptionTemplate();}public static function set($vab8c9e32f5757d87122d20d002fc1749='base', $v66f6181bcb4cff4cd38fbc804a036db6 = "") {$vab8c9e32f5757d87122d20d002fc1749 = $vab8c9e32f5757d87122d20d002fc1749."Handler";if ( method_exists(__CLASS__, $vab8c9e32f5757d87122d20d002fc1749) ) {self::setExceptionTemplate($v66f6181bcb4cff4cd38fbc804a036db6);return set_exception_handler(array(       __CLASS__,       $vab8c9e32f5757d87122d20d002fc1749      ));}else {throw new Exception("Error handler not exist");}}public static function restore() {return restore_exception_handler();}public static function createCrashReport($v78e731027d8fd50ed642340b7c9a63b3, $v04a75036e9d520bb983c5ed03b8d0182) {$v63a04a2f17915ed7c241c38ff2a29f4d = CURRENT_WORKING_DIR . "/errors/logs/exceptions/";if(!is_dir($v63a04a2f17915ed7c241c38ff2a29f4d)) {mkdir($v63a04a2f17915ed7c241c38ff2a29f4d, 0777, true);}try {$v6db435f352d7ea4a67807a3feb447bf7 = new umiLogger($v63a04a2f17915ed7c241c38ff2a29f4d);$v6db435f352d7ea4a67807a3feb447bf7->pushGlobalEnviroment();$v6db435f352d7ea4a67807a3feb447bf7->push($v78e731027d8fd50ed642340b7c9a63b3);$v6db435f352d7ea4a67807a3feb447bf7->push($v04a75036e9d520bb983c5ed03b8d0182);$v6db435f352d7ea4a67807a3feb447bf7->save();return true;}catch (Exception $ve1671797c52e15f763380b45e841ec32) {echo "Can't log exception";return false;}}public static function baseHandler($ve1671797c52e15f763380b45e841ec32) {if (!defined('CURRENT_WORKING_DIR')) {define(     'CURRENT_WORKING_DIR',     dirname(dirname(__FILE__))    );}require_once CURRENT_WORKING_DIR . "/classes/system/utils/logger/iLogger.php";require_once CURRENT_WORKING_DIR . "/classes/system/utils/logger/logger.php";if (!DEBUG_SHOW_BACKTRACE && $ve1671797c52e15f763380b45e841ec32 instanceof Exception && get_class($ve1671797c52e15f763380b45e841ec32) == 'databaseException') {$ve1671797c52e15f763380b45e841ec32 = new Exception('Произошла критическая ошибка. Скорее всего, потребуется участие разработчиков.  Подробности по ссылке <a title="" target="_blank" href="http://errors.umi-cms.ru/17000/">17000</a>', 17000, $ve1671797c52e15f763380b45e841ec32);}if (!headers_sent()) {header("HTTP/1.1 500 Internal Server Error");header("Content-type: text/html; charset=utf-8");header("Status: 500 Internal Server Error");}self::printTemplate($ve1671797c52e15f763380b45e841ec32);self::createCrashReport($ve1671797c52e15f763380b45e841ec32->getMessage(), $ve1671797c52e15f763380b45e841ec32->getTraceAsString());exit();}public static function outputBufferHandler($v7f2db423a49b305459147332fb01cf87) {if( isset($v406baa482a63f95c711e0d4ef080b1da['memoryReserve']) ) {unset($v406baa482a63f95c711e0d4ef080b1da['memoryReserve']);}$v07213a0161f52846ab198be103b5ab43 = Array('Fatal', 'Parse');foreach($v07213a0161f52846ab198be103b5ab43 as $vcb5e100e5a9a3e7f6d1fd97512215282) {if(strstr($v7f2db423a49b305459147332fb01cf87, "<br />\n<b>{$vcb5e100e5a9a3e7f6d1fd97512215282} error</b>:") !== false) {throw new coreException(      substr(       trim(strip_tags($v7f2db423a49b305459147332fb01cf87)),       strlen($vcb5e100e5a9a3e7f6d1fd97512215282) + 9      )     );}}return $v7f2db423a49b305459147332fb01cf87;}}if (!defined('CRON')) {if (getRequest("xmlMode") == 'force') {$v66f6181bcb4cff4cd38fbc804a036db6 = SYS_ERRORS_PATH."exception.xml.php";}elseif (getRequest("jsonMode") == 'force') {$v66f6181bcb4cff4cd38fbc804a036db6 = SYS_ERRORS_PATH."exception.json.php";}else {$v66f6181bcb4cff4cd38fbc804a036db6 = SYS_ERRORS_PATH."exception.html.php";}umiExceptionHandler::set("base", $v66f6181bcb4cff4cd38fbc804a036db6);}$v406baa482a63f95c711e0d4ef080b1da['memoryReserve'] = str_repeat(" ", 1024);if(!defined("DEBUG") && function_exists("libxml_use_internal_errors")) {libxml_use_internal_errors(true);}function checkXmlError($vdd988cfd769c9f7fbd795a0f5da8e751) {if ( !defined("DEBUG") && function_exists("libxml_get_last_error") && $vdd988cfd769c9f7fbd795a0f5da8e751 === false ) {$vcb5e100e5a9a3e7f6d1fd97512215282 = libxml_get_last_error();libxml_clear_errors();throw new libXMLErrorException($vcb5e100e5a9a3e7f6d1fd97512215282);}}function criticalErrorsBufferHandler($v7f2db423a49b305459147332fb01cf87) {return umiExceptionHandler::outputBufferHandler($v7f2db423a49b305459147332fb01cf87);}function xsltErrorsHandler($v70106d0d821513f45702b7d25664ab7c, $v809b1abe3f111fd3bb1a54c62706129f, $v1407f5af8e27ad3df1c3300918c80813, $vc2d4b0be0178288d69e1fbfd34098cc3, $ve1671797c52e15f763380b45e841ec32) {if( defined("DEBUG") ||   !function_exists("libxml_get_last_error") ||   $vc2d4b0be0178288d69e1fbfd34098cc3 != 0 ||   $v70106d0d821513f45702b7d25664ab7c != 2  ) return;throw new xlsTemplateException(libxml_get_errors());}function errorsXsltListen() {if ( !defined("DEBUG") ) {set_error_handler("xsltErrorsHandler");return error_reporting(~E_STRICT);}return false;}function errorsXsltCheck($v818f9c45cfa30eeff277ef38bcbe9910) {if(!defined("DEBUG")) {error_reporting($v818f9c45cfa30eeff277ef38bcbe9910);return restore_error_handler();}return false;}function traceException($ve1671797c52e15f763380b45e841ec32) {umiExceptionHandler::baseHandler($ve1671797c52e15f763380b45e841ec32);}function system_is_allowed($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce = false, $v7057e8409c7c531a1a6e9ac3df4ed549 = false) {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();static $ve8701ad48ba05a91604e480dd60899a3 = false;if($ve8701ad48ba05a91604e480dd60899a3 == false) {$va178a6b6ad454764f5d724e7f96e75b7 = cmsController::getInstance()->getModule("users");if($va178a6b6ad454764f5d724e7f96e75b7) {$ve8701ad48ba05a91604e480dd60899a3 = $va178a6b6ad454764f5d724e7f96e75b7->user_id;}}$vd5a5b3dd1ccb90d30360f0c068fd43fc = md5($v22884db148f0ffb0d830ba431102b0b5 . $vea9f6aca279138c58f705c8d4cb4b8ce . $v7057e8409c7c531a1a6e9ac3df4ed549);if(array_key_exists($vd5a5b3dd1ccb90d30360f0c068fd43fc, $v0fea6a13c52b4d4725368f24b045ca84)) return $v0fea6a13c52b4d4725368f24b045ca84[$vd5a5b3dd1ccb90d30360f0c068fd43fc];$vbc54f4d60f1cec0f9a6cb70e13f2127a = permissionsCollection::getInstance();$v834239295ea6020233dda11b3d85af21 = $vbc54f4d60f1cec0f9a6cb70e13f2127a->isSv($ve8701ad48ba05a91604e480dd60899a3);if($v834239295ea6020233dda11b3d85af21) {return $v0fea6a13c52b4d4725368f24b045ca84[$vd5a5b3dd1ccb90d30360f0c068fd43fc] = true;}if($vea9f6aca279138c58f705c8d4cb4b8ce == "config" || ($v22884db148f0ffb0d830ba431102b0b5 == "config" && $vea9f6aca279138c58f705c8d4cb4b8ce == false)) {return false;}if($v7057e8409c7c531a1a6e9ac3df4ed549 !== false && $v7057e8409c7c531a1a6e9ac3df4ed549 !== 0 && !is_null($v7057e8409c7c531a1a6e9ac3df4ed549)) {list($v4b43b0aee35624cd95b910189b3dc231, $vf1290186a5d0b1ceab27f4e77c0c5d68) = $vbc54f4d60f1cec0f9a6cb70e13f2127a->isAllowedObject($ve8701ad48ba05a91604e480dd60899a3, $v7057e8409c7c531a1a6e9ac3df4ed549);if(strstr($vea9f6aca279138c58f705c8d4cb4b8ce, "edit") !== false) {return $v0fea6a13c52b4d4725368f24b045ca84[$vd5a5b3dd1ccb90d30360f0c068fd43fc] = $vf1290186a5d0b1ceab27f4e77c0c5d68;}else {return $v0fea6a13c52b4d4725368f24b045ca84[$vd5a5b3dd1ccb90d30360f0c068fd43fc] = $v4b43b0aee35624cd95b910189b3dc231;}}if($vea9f6aca279138c58f705c8d4cb4b8ce !== false && $vea9f6aca279138c58f705c8d4cb4b8ce) {if($v22884db148f0ffb0d830ba431102b0b5 == "system" || $v22884db148f0ffb0d830ba431102b0b5 == "core" || $v22884db148f0ffb0d830ba431102b0b5 == "custom") return $v0fea6a13c52b4d4725368f24b045ca84[$vd5a5b3dd1ccb90d30360f0c068fd43fc] = true;return $v0fea6a13c52b4d4725368f24b045ca84[$vd5a5b3dd1ccb90d30360f0c068fd43fc] = $vbc54f4d60f1cec0f9a6cb70e13f2127a->isAllowedMethod($ve8701ad48ba05a91604e480dd60899a3, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);}if($v22884db148f0ffb0d830ba431102b0b5 !== false) {return $v0fea6a13c52b4d4725368f24b045ca84[$vd5a5b3dd1ccb90d30360f0c068fd43fc] = $vbc54f4d60f1cec0f9a6cb70e13f2127a->isAllowedModule($ve8701ad48ba05a91604e480dd60899a3, $v22884db148f0ffb0d830ba431102b0b5);}}function system_get_tpl($v15d61712450a686a7f365adf4fef581f = 'default') {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();showWorkTime("system mainconfig init");$v594c103f2c6e04c3d8ab059f031e0c1a = cmsController::getInstance();showWorkTime("system cmscontroller init");$v74c17e3010c33af858d215cfc3552b04 = '';$v5b063e275d506f65ebf1b02d926f19a4 = '';$v47826cacc65c665212b821e6ff80b9b0 = '';if ($v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentMode() == 'admin' && $v15d61712450a686a7f365adf4fef581f == 'current') {$v599dcce2998a6b40b1e38e8c6006cb0a = 'xslt';$v6f66e878c62db60568a3487869695820 = 'xslAdminTemplater';$v5b063e275d506f65ebf1b02d926f19a4 = 'main.xsl';$v74c17e3010c33af858d215cfc3552b04 = $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.skins', array('skin' => system_get_skinName()));$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $v41275a535677f79ff347e01bc530c176->getUserId();$vca02d1555c813b1b1ad637654c0fe111 = $v41275a535677f79ff347e01bc530c176->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentModule(), $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentMethod());if((!$v41275a535677f79ff347e01bc530c176->isAdmin() || !$vca02d1555c813b1b1ad637654c0fe111) && file_exists($v74c17e3010c33af858d215cfc3552b04 . 'main_login.xsl')) {if($v41275a535677f79ff347e01bc530c176->isAuth()) {$v90f805bfcba6ab75df4ad6da8e6afd9b = "owner_id = {$v8e44f0089b076e18a718eb9ca3d94674}";$v8e59688c095c0b0bad04d8476df25db3 = umiObjectsCollection::getInstance()->getObject($v8e44f0089b076e18a718eb9ca3d94674)->getValue('groups');foreach ($v8e59688c095c0b0bad04d8476df25db3 as $vf2f5fbe4a9d4cc9a39e7a62a513580e9) {$v90f805bfcba6ab75df4ad6da8e6afd9b .= " or owner_id = {$vf2f5fbe4a9d4cc9a39e7a62a513580e9}";}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `module` FROM cms_permissions WHERE (" . $v90f805bfcba6ab75df4ad6da8e6afd9b . ") and (method = '' or method is null)";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if (mysql_num_rows($result) !==0) {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result)){$v22884db148f0ffb0d830ba431102b0b5 = $vf1965a857bc285d26fe22023aa5ab50d[0];$vea9f6aca279138c58f705c8d4cb4b8ce = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/{$v22884db148f0ffb0d830ba431102b0b5}/default_method_admin");if ($v41275a535677f79ff347e01bc530c176->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce)) {def_module::redirect('http://' . $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentDomain()->getHost() . '/admin/'. $v22884db148f0ffb0d830ba431102b0b5 . '/' . $vea9f6aca279138c58f705c8d4cb4b8ce);break;}}}}$v5b063e275d506f65ebf1b02d926f19a4 = 'main_login.xsl';}$v47826cacc65c665212b821e6ff80b9b0 = $v74c17e3010c33af858d215cfc3552b04 . $v5b063e275d506f65ebf1b02d926f19a4;}else {$v4091345e6f9742cda418c2e209b8a18c = templatesCollection::getInstance();$v4f2afc9c4099ee1f39c9f551123e54bd = false;if ($v74f5356453a69e438e0f58ef93103cc0 = getRequest('template_id')) {$v4f2afc9c4099ee1f39c9f551123e54bd = $v4091345e6f9742cda418c2e209b8a18c->getTemplate($v74f5356453a69e438e0f58ef93103cc0);}if (!$v4f2afc9c4099ee1f39c9f551123e54bd instanceof template) {$v4f2afc9c4099ee1f39c9f551123e54bd = ($v15d61712450a686a7f365adf4fef581f == 'current') ? $v4091345e6f9742cda418c2e209b8a18c->getCurrentTemplate() : $v4091345e6f9742cda418c2e209b8a18c->getDefaultTemplate();}if ($v4f2afc9c4099ee1f39c9f551123e54bd instanceof template) {$v5b063e275d506f65ebf1b02d926f19a4 = $v4f2afc9c4099ee1f39c9f551123e54bd->getFilename();$v918d83c715c19dd93ff49f87e2fae0b3 = $v4f2afc9c4099ee1f39c9f551123e54bd->getName();$v599dcce2998a6b40b1e38e8c6006cb0a = $v4f2afc9c4099ee1f39c9f551123e54bd->getType();if (!$v599dcce2998a6b40b1e38e8c6006cb0a) {switch (array_pop(explode('.', $v5b063e275d506f65ebf1b02d926f19a4))) {case "xsl":$v599dcce2998a6b40b1e38e8c6006cb0a = 'xslt';break;case "tpl":$v599dcce2998a6b40b1e38e8c6006cb0a = 'tpls';break;}}$v0e2d056dfa17731ff69524908f6ad7df = CURRENT_WORKING_DIR . '/templates/'.$v918d83c715c19dd93ff49f87e2fae0b3.'/'.$v599dcce2998a6b40b1e38e8c6006cb0a.'/';switch ($v599dcce2998a6b40b1e38e8c6006cb0a) {case "xslt":      $v74c17e3010c33af858d215cfc3552b04 = (file_exists($v0e2d056dfa17731ff69524908f6ad7df . $v5b063e275d506f65ebf1b02d926f19a4)) ? $v0e2d056dfa17731ff69524908f6ad7df : $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.xsl');$v6f66e878c62db60568a3487869695820 = 'xslTemplater';break;case "tpls":      $v74c17e3010c33af858d215cfc3552b04 = (file_exists($v0e2d056dfa17731ff69524908f6ad7df . 'content/' . $v5b063e275d506f65ebf1b02d926f19a4)) ? $v0e2d056dfa17731ff69524908f6ad7df : $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.tpl');$v6f66e878c62db60568a3487869695820 = 'tplTemplater';break;default :      $v74c17e3010c33af858d215cfc3552b04 = (file_exists($v0e2d056dfa17731ff69524908f6ad7df . $v5b063e275d506f65ebf1b02d926f19a4)) ? $v0e2d056dfa17731ff69524908f6ad7df : '';$v6f66e878c62db60568a3487869695820 = (file_exists(dirname(__FILE__) . '/' . $v599dcce2998a6b40b1e38e8c6006cb0a . '/' . $v599dcce2998a6b40b1e38e8c6006cb0a . 'Templater.php')) ? $v599dcce2998a6b40b1e38e8c6006cb0a . 'Templater' : '';}if ($v15d61712450a686a7f365adf4fef581f == 'streams') {$v6f66e878c62db60568a3487869695820 = 'xslTemplater';$v599dcce2998a6b40b1e38e8c6006cb0a      = 'xslt';$v74c17e3010c33af858d215cfc3552b04   = $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.xsl');$v5b063e275d506f65ebf1b02d926f19a4  = 'sample.xsl';}if (system_is_mobile() && file_exists($v74c17e3010c33af858d215cfc3552b04 . 'mobile/' . $v5b063e275d506f65ebf1b02d926f19a4)) {$v74c17e3010c33af858d215cfc3552b04 = $v74c17e3010c33af858d215cfc3552b04 . 'mobile/';}$v47826cacc65c665212b821e6ff80b9b0 = $v74c17e3010c33af858d215cfc3552b04 . ($v599dcce2998a6b40b1e38e8c6006cb0a == 'tpls' ? 'content/' : '') . $v5b063e275d506f65ebf1b02d926f19a4;}else if ($v15d61712450a686a7f365adf4fef581f == 'default' || $v15d61712450a686a7f365adf4fef581f == 'streams') {$v6f66e878c62db60568a3487869695820 = 'xslTemplater';$v599dcce2998a6b40b1e38e8c6006cb0a      = 'xslt';$v74c17e3010c33af858d215cfc3552b04   = $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.xsl');$v47826cacc65c665212b821e6ff80b9b0  = $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.xsl') . 'sample.xsl';}else {$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v7f2db423a49b305459147332fb01cf87->clear();$v7f2db423a49b305459147332fb01cf87->push(file_get_contents(SYS_ERRORS_PATH . 'no_design_template.html'));$v7f2db423a49b305459147332fb01cf87->end();}}$v21ffce5b8a6cc8cc6a41448dd69623c9 = array(   'class_name' => $v6f66e878c62db60568a3487869695820,   'type'       => $v599dcce2998a6b40b1e38e8c6006cb0a,   'dir_path'   => $v74c17e3010c33af858d215cfc3552b04,   'file_path'  => $v47826cacc65c665212b821e6ff80b9b0  );return $v21ffce5b8a6cc8cc6a41448dd69623c9;}function system_get_skinName() {static $vc4e10f4477cadef194adfceb6031a35c;if ($vc4e10f4477cadef194adfceb6031a35c) return $vc4e10f4477cadef194adfceb6031a35c;$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$v594c103f2c6e04c3d8ab059f031e0c1a = cmsController::getInstance();$v9ae27e53b3777ca1a186c1b6e7480b88 = $v2245023265ae4cf87d02c8b6ba991139->getList('casual-skins');$vddaa6e8c8c412299272e183087b8f7b6 = $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentModule() . '::' . $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentMethod();foreach($v9ae27e53b3777ca1a186c1b6e7480b88 as $v98ea47e4311222ae5ccb6b11855b8968) {if(in_array($vddaa6e8c8c412299272e183087b8f7b6, $v2245023265ae4cf87d02c8b6ba991139->get('casual-skins', $v98ea47e4311222ae5ccb6b11855b8968))) {return $vc4e10f4477cadef194adfceb6031a35c = $v98ea47e4311222ae5ccb6b11855b8968;}}$vada1fd05db818d2ce8b75dcbcfbc5efd = $v2245023265ae4cf87d02c8b6ba991139->get('system', 'skins');if(isset($_GET['skin_sel']) || isset($_POST['skin_sel'])) {if(is_null($vb75604f619867058aa706f3a1dc5bd34 = getArrayKey($_GET, 'skin_sel'))) {$vb75604f619867058aa706f3a1dc5bd34 = getArrayKey($_POST, 'skin_sel');}setcookie('skin_sel', $vb75604f619867058aa706f3a1dc5bd34, time() + 3600*24*365, '/');if(in_array($vc4e10f4477cadef194adfceb6031a35c, $vada1fd05db818d2ce8b75dcbcfbc5efd)) {return $vc4e10f4477cadef194adfceb6031a35c = $vb75604f619867058aa706f3a1dc5bd34;}}if(getCookie('skin_sel')) {if(in_array(getCookie('skin_sel'), $vada1fd05db818d2ce8b75dcbcfbc5efd)) {return $vc4e10f4477cadef194adfceb6031a35c = getCookie('skin_sel');}}return $vc4e10f4477cadef194adfceb6031a35c = $v2245023265ae4cf87d02c8b6ba991139->get('system', 'default-skin');}function system_buildin_load($v52a43e48ec4649dee819dadabcab1bde) {static $vd6fd0924e324f50669ae0295adf59567 = Array();if(isset($vd6fd0924e324f50669ae0295adf59567[$v52a43e48ec4649dee819dadabcab1bde])) {return $vd6fd0924e324f50669ae0295adf59567[$v52a43e48ec4649dee819dadabcab1bde];}$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$vc22d45567638173f6f7c953f54077fbd = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.virtual-modules') . $v52a43e48ec4649dee819dadabcab1bde . ".php";if(file_exists($vc22d45567638173f6f7c953f54077fbd)) {require $vc22d45567638173f6f7c953f54077fbd;if(class_exists($v52a43e48ec4649dee819dadabcab1bde)) {return $vd6fd0924e324f50669ae0295adf59567[$v52a43e48ec4649dee819dadabcab1bde] = new $v52a43e48ec4649dee819dadabcab1bde;}}return false;}function system_remove_cache($v34823136d0dd91d0f5d22db740f7679c) {$v7f6a05a4bb9b16a1f4b36e9000d1bc3c = ini_get('include_path') . "cache";$v2b185f4da957c7d76b574a32e8b7d55e = md5($v34823136d0dd91d0f5d22db740f7679c);$v87a0860e170e57ac18a827962ccd6816 = $this->cacheFolder . "/" . $this->cacheFileName;if(file_exists($v87a0860e170e57ac18a827962ccd6816))   return unlink(md5($v87a0860e170e57ac18a827962ccd6816));else   return false;}function system_checkSession() {return is_array($_COOKIE) && array_key_exists("umicms_session", $_COOKIE);}function system_setSession() {$vd06f6e6e9128a2393b7358ff70124550 = md5(time());setcookie("umicms_session", $vd06f6e6e9128a2393b7358ff70124550, 0, "/");return $vd06f6e6e9128a2393b7358ff70124550;}function system_removeSession() {setcookie("umicms_session", null, time() - 3600, "/");}function system_getSession() {return getCookie("umicms_session");}function system_runSession() {if(!system_checkSession())   return system_setSession();else   return system_getSession();}function system_gen_password($v2fa47f7c65fec19cc163b195725e3844 = 12, $ve600074f5086bdfc5c11f7728f7d67f0 = "\$#@^&!1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM") {$vb5997cee0d1ef3e5f3f6dc7a8b3ad7d7 = "";for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v2fa47f7c65fec19cc163b195725e3844;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vb5997cee0d1ef3e5f3f6dc7a8b3ad7d7 .= $ve600074f5086bdfc5c11f7728f7d67f0[rand(0, strlen($ve600074f5086bdfc5c11f7728f7d67f0)-1)];}return $vb5997cee0d1ef3e5f3f6dc7a8b3ad7d7;}function truncStr($v0b9f441f569478ce6777af257c2d5290, $vebb9639568218ed404aa24c55d7510c2="50", $v95dcc3576ee8f381b2683b15c126e9de="...", $v6bd0a84f7fc8978ff8ae76426b1a9034 = false) {$vdccc8c8d061984a56d899361b4934477 = $v0b9f441f569478ce6777af257c2d5290;if ($v6bd0a84f7fc8978ff8ae76426b1a9034) {$vdccc8c8d061984a56d899361b4934477 = html_entity_decode(strip_tags($vdccc8c8d061984a56d899361b4934477), ENT_QUOTES, "UTF-8");}if ($vebb9639568218ed404aa24c55d7510c2<=0) return '';if (wa_strlen($v0b9f441f569478ce6777af257c2d5290) > $vebb9639568218ed404aa24c55d7510c2) {$vebb9639568218ed404aa24c55d7510c2 -= wa_strlen($v95dcc3576ee8f381b2683b15c126e9de);$vdccc8c8d061984a56d899361b4934477 = wa_substr($vdccc8c8d061984a56d899361b4934477, 0, $vebb9639568218ed404aa24c55d7510c2+1);$vdccc8c8d061984a56d899361b4934477 = preg_replace('/\s+([^\s]+)?$/i', '', $vdccc8c8d061984a56d899361b4934477) . $v95dcc3576ee8f381b2683b15c126e9de;}return $vdccc8c8d061984a56d899361b4934477;}function toTimeStamp($v522748524ad010358705b6852b81be4c) {if(is_numeric($v522748524ad010358705b6852b81be4c)) return $v522748524ad010358705b6852b81be4c;$v628b7db04235f228d40adc671413a8c8 = "";$v7436f942d5ea836cb84f1bb2527d8286 = "";$v84cdc76cabf41bd7c961f6ab12f117d8 = "";$v73cdddd7730abfc13a55efb9f5685a3b = "";$v1442a7b6e2c20b27775175eecba84dac = "";$v522748524ad010358705b6852b81be4c = trim($v522748524ad010358705b6852b81be4c);if($v522748524ad010358705b6852b81be4c == "сейчас") {return time();}$v03c7c0ace395d80182db07ae2c30f034 = "[ \.\-\/\\\\]{1,10}";$v522748524ad010358705b6852b81be4c = str_replace("-", " ", $v522748524ad010358705b6852b81be4c);$v522748524ad010358705b6852b81be4c = str_replace(",", " ", $v522748524ad010358705b6852b81be4c);$v522748524ad010358705b6852b81be4c = str_replace("\\'", " ", $v522748524ad010358705b6852b81be4c);if(preg_match("/\d{2}\:\d{2}/", $v522748524ad010358705b6852b81be4c, $v3d801aa532c1cec3ee82d87a99fdf63f)) {$vee33e909372d935d190f4fcb2a92d542 = $v3d801aa532c1cec3ee82d87a99fdf63f[0];preg_replace("/\d{2}\:\d{2}/", "", $v522748524ad010358705b6852b81be4c);list($v73cdddd7730abfc13a55efb9f5685a3b, $v1442a7b6e2c20b27775175eecba84dac) = explode(":", $vee33e909372d935d190f4fcb2a92d542);}$v522748524ad010358705b6852b81be4c = preg_replace("/(\d{4})$v03c7c0ace395d80182db07ae2c30f034(\d{2})$v03c7c0ace395d80182db07ae2c30f034(\d{2})/im", "^\\3^ !\\2! ?\\1?", $v522748524ad010358705b6852b81be4c);$v522748524ad010358705b6852b81be4c = preg_replace("/(\d{1,2})$v03c7c0ace395d80182db07ae2c30f034(\d{1,2})$v03c7c0ace395d80182db07ae2c30f034(\d{2,4})/im", "^\\1^ !\\2! ?\\3?", $v522748524ad010358705b6852b81be4c);$v44fdec47036f482b68b748f9d786801b = Array(    'понедельник',    'вторник',    'среда',    'четверг',    'пятница',    'суббота',    'воскресенье'    );$vda36cfaf48b9e19896e23e1207040d1e = Array(    'январь',    'февраль',    'март',    'апрель',    'май',    'июнь',    'июль',    'август',    'сентябрь',    'октябрь',    'ноябрь',    'декабрь'    );$v89f9be9bb8d51a581889396a09f0fa23 = Array(    'января',    'февраля',    'марта',    'апреля',    'мая',    'июня',    'июля',    'августа',    'сентября',    'октября',    'ноября',    'декабря'    );$v4268edd30720dc59622c77e8031974bf = Array(    'янв',    'фев',    'мар',    'апр',    'май',    'июн',    'июл',    'авг',    'сен',    'окт',    'ноя',    'дек'    );$vf9cf10c5294f20d13f6bb53be58ef693 = Array(    '01',    '02',    '03',    '04',    '05',    '06',    '07',    '08',    '09',    '10',    '11',    '12'    );foreach($vda36cfaf48b9e19896e23e1207040d1e as $v8ce4b16b22b58894aa86c421e8759df3 => $v9e3669d19b675bd57058fd4664205d2a)   $vda36cfaf48b9e19896e23e1207040d1e[$v8ce4b16b22b58894aa86c421e8759df3] = "/" . $v9e3669d19b675bd57058fd4664205d2a . "/i";foreach($v89f9be9bb8d51a581889396a09f0fa23 as $v8ce4b16b22b58894aa86c421e8759df3 => $v9e3669d19b675bd57058fd4664205d2a)   $v89f9be9bb8d51a581889396a09f0fa23[$v8ce4b16b22b58894aa86c421e8759df3] = "/" . $v9e3669d19b675bd57058fd4664205d2a . "/i";foreach($v4268edd30720dc59622c77e8031974bf as $v8ce4b16b22b58894aa86c421e8759df3 => $v9e3669d19b675bd57058fd4664205d2a)   $v4268edd30720dc59622c77e8031974bf[$v8ce4b16b22b58894aa86c421e8759df3] = "/" . $v9e3669d19b675bd57058fd4664205d2a . "/i";foreach($vf9cf10c5294f20d13f6bb53be58ef693 as $v8ce4b16b22b58894aa86c421e8759df3 => $v9e3669d19b675bd57058fd4664205d2a) {$vf9cf10c5294f20d13f6bb53be58ef693[$v8ce4b16b22b58894aa86c421e8759df3] = " !" . $v9e3669d19b675bd57058fd4664205d2a . "! ";}$v522748524ad010358705b6852b81be4c = preg_replace($vda36cfaf48b9e19896e23e1207040d1e, $vf9cf10c5294f20d13f6bb53be58ef693, $v522748524ad010358705b6852b81be4c);$v522748524ad010358705b6852b81be4c = preg_replace($v89f9be9bb8d51a581889396a09f0fa23, $vf9cf10c5294f20d13f6bb53be58ef693, $v522748524ad010358705b6852b81be4c);$v522748524ad010358705b6852b81be4c = preg_replace($v4268edd30720dc59622c77e8031974bf, $vf9cf10c5294f20d13f6bb53be58ef693, $v522748524ad010358705b6852b81be4c);$v75aeb98e5241592ad6a6c2c4c78a16ef = Array(    '/(\d{2,4})[ ]*года/i',    '/(\d{2,4})[ ]*год/i',    '/(\d{2,4})[ ]*г/i',    '/(\d{4})/i',    );$v522748524ad010358705b6852b81be4c = preg_replace($v75aeb98e5241592ad6a6c2c4c78a16ef, "?\\1?", $v522748524ad010358705b6852b81be4c);$v522748524ad010358705b6852b81be4c = preg_replace("/[^!^\?^\d](\d{1,2})[^!^\?^\d]/i", "^\\1^", " ".$v522748524ad010358705b6852b81be4c." ");if(preg_match("/\^(\d{1,2})\^/", $v522748524ad010358705b6852b81be4c, $v710998fd1b7c0235170265650770a4b1)) {$v628b7db04235f228d40adc671413a8c8 = $v710998fd1b7c0235170265650770a4b1[1];if(strlen($v628b7db04235f228d40adc671413a8c8) == 1)    $v628b7db04235f228d40adc671413a8c8 = "0" . $v628b7db04235f228d40adc671413a8c8;}if(preg_match("/!(\d{1,2})!/", $v522748524ad010358705b6852b81be4c, $v710998fd1b7c0235170265650770a4b1)) {$v7436f942d5ea836cb84f1bb2527d8286 = $v710998fd1b7c0235170265650770a4b1[1];if(strlen($v7436f942d5ea836cb84f1bb2527d8286) == 1)    $v7436f942d5ea836cb84f1bb2527d8286 = "0" . $v7436f942d5ea836cb84f1bb2527d8286;}if(preg_match("/\?(\d{2,4})\?/", $v522748524ad010358705b6852b81be4c, $v710998fd1b7c0235170265650770a4b1)) {$v84cdc76cabf41bd7c961f6ab12f117d8 = $v710998fd1b7c0235170265650770a4b1[1];if(strlen($v84cdc76cabf41bd7c961f6ab12f117d8) == 2) {$v3691308f2a4c2f6983f2880d32e29c84 = (int) substr($v84cdc76cabf41bd7c961f6ab12f117d8, 0, 1);if( ($v3691308f2a4c2f6983f2880d32e29c84 >= 0 && $v3691308f2a4c2f6983f2880d32e29c84 <= 4))     $v84cdc76cabf41bd7c961f6ab12f117d8 = "20" . $v84cdc76cabf41bd7c961f6ab12f117d8;else     $v84cdc76cabf41bd7c961f6ab12f117d8 = "19" . $v84cdc76cabf41bd7c961f6ab12f117d8;}}if($v628b7db04235f228d40adc671413a8c8 > 31) {$ve358efa489f58062f10dd7316b65649e = $v84cdc76cabf41bd7c961f6ab12f117d8;$v84cdc76cabf41bd7c961f6ab12f117d8 = $v628b7db04235f228d40adc671413a8c8;$v628b7db04235f228d40adc671413a8c8 = $ve358efa489f58062f10dd7316b65649e;}if($v7436f942d5ea836cb84f1bb2527d8286 > 12) {$ve358efa489f58062f10dd7316b65649e = $v7436f942d5ea836cb84f1bb2527d8286;$v7436f942d5ea836cb84f1bb2527d8286 = $v628b7db04235f228d40adc671413a8c8;$v628b7db04235f228d40adc671413a8c8 = $ve358efa489f58062f10dd7316b65649e;unset($ve358efa489f58062f10dd7316b65649e);}$v3b84f8cfd144e7211160037ebacbf0e7 = trim(strtolower($v522748524ad010358705b6852b81be4c));switch($v3b84f8cfd144e7211160037ebacbf0e7) {case "сегодня":     $v4d682ec4eed27c53849758bc13b6e179 = time();$v84cdc76cabf41bd7c961f6ab12f117d8 = date("Y", $v4d682ec4eed27c53849758bc13b6e179);$v7436f942d5ea836cb84f1bb2527d8286 = date("m", $v4d682ec4eed27c53849758bc13b6e179);$v628b7db04235f228d40adc671413a8c8 = date("d", $v4d682ec4eed27c53849758bc13b6e179);break;case "завтра":     $v4d682ec4eed27c53849758bc13b6e179 = time() + (3600*24);$v84cdc76cabf41bd7c961f6ab12f117d8 = date("Y", $v4d682ec4eed27c53849758bc13b6e179);$v7436f942d5ea836cb84f1bb2527d8286 = date("m", $v4d682ec4eed27c53849758bc13b6e179);$v628b7db04235f228d40adc671413a8c8 = date("d", $v4d682ec4eed27c53849758bc13b6e179);break;case "вчера":     $v4d682ec4eed27c53849758bc13b6e179 = time() - (3600*24);$v84cdc76cabf41bd7c961f6ab12f117d8 = date("Y", $v4d682ec4eed27c53849758bc13b6e179);$v7436f942d5ea836cb84f1bb2527d8286 = date("m", $v4d682ec4eed27c53849758bc13b6e179);$v628b7db04235f228d40adc671413a8c8 = date("d", $v4d682ec4eed27c53849758bc13b6e179);break;case "послезавтра":     $v4d682ec4eed27c53849758bc13b6e179 = time() + (3600*48);$v84cdc76cabf41bd7c961f6ab12f117d8 = date("Y", $v4d682ec4eed27c53849758bc13b6e179);$v7436f942d5ea836cb84f1bb2527d8286 = date("m", $v4d682ec4eed27c53849758bc13b6e179);$v628b7db04235f228d40adc671413a8c8 = date("d", $v4d682ec4eed27c53849758bc13b6e179);break;case "позавчера":     $v4d682ec4eed27c53849758bc13b6e179 = time() - (3600*48);$v84cdc76cabf41bd7c961f6ab12f117d8 = date("Y", $v4d682ec4eed27c53849758bc13b6e179);$v7436f942d5ea836cb84f1bb2527d8286 = date("m", $v4d682ec4eed27c53849758bc13b6e179);$v628b7db04235f228d40adc671413a8c8 = date("d", $v4d682ec4eed27c53849758bc13b6e179);break;}if(!$v628b7db04235f228d40adc671413a8c8) {$v3b84f8cfd144e7211160037ebacbf0e7 = str_replace(Array($v84cdc76cabf41bd7c961f6ab12f117d8, $v7436f942d5ea836cb84f1bb2527d8286), "", $v522748524ad010358705b6852b81be4c);preg_match("/(\d{1,2})/", $v3b84f8cfd144e7211160037ebacbf0e7, $vfa816edb83e95bf0c8da580bdfd491ef);$v628b7db04235f228d40adc671413a8c8 = isset($vfa816edb83e95bf0c8da580bdfd491ef[1]) ? $vfa816edb83e95bf0c8da580bdfd491ef[1] : NULL;}if(!$v7436f942d5ea836cb84f1bb2527d8286 && !$v628b7db04235f228d40adc671413a8c8 && !$v84cdc76cabf41bd7c961f6ab12f117d8) return 0;if($v628b7db04235f228d40adc671413a8c8 && !$v7436f942d5ea836cb84f1bb2527d8286) {$v7436f942d5ea836cb84f1bb2527d8286 = $v628b7db04235f228d40adc671413a8c8;$v628b7db04235f228d40adc671413a8c8 = 0;}return $vd7e6d55ba379a13d08c25d15faf2a23b = mktime((int) $v73cdddd7730abfc13a55efb9f5685a3b, (int) $v1442a7b6e2c20b27775175eecba84dac, 0, (int) $v7436f942d5ea836cb84f1bb2527d8286, (int) $v628b7db04235f228d40adc671413a8c8, (int) $v84cdc76cabf41bd7c961f6ab12f117d8);}function translit($va43c1b0aa53a0c908810c06ab1ff3967, $v15d61712450a686a7f365adf4fef581f = "R_TO_E") {$v3e396061ea36cab13a403292255e37d6 = Array( "Э", "Ч", "Ш", "Ё", "Ё", "Ж", "Ю", "Ю", "\Я", "\Я", "А", "Б", "В", "Г", "Д", "Е", "З", "И", "Й", "К", "Л", "М", "Н", "О", "П", "Р", "С", "Т", "У", "Ф", "Х", "Ц", "Щ", "Ъ", "Ы", "Ь");$v91e9f0f521a498732fab5a0eeb8d79d1 = Array("э", "ч", "ш", "ё", "ё","ж", "ю", "ю", "я", "я", "а", "б", "в", "г", "д", "е", "з", "и", "й", "к", "л", "м", "н", "о", "п", "р", "с", "т", "у", "ф", "х", "ц", "щ", "ъ", "ы", "ь" );$v09b8f6492e17d9711ec6394f19b427d5 = Array("E\'", "CH", "SH", "YO", "JO", "ZH", "YU", "JU", "YA", "JA", "A","B","V","G","D","E", "Z","I","J","K","L","M","N","O","P","R","S","T","U","F","H","C", "W","~","Y", "\'");$v149cee0bb60980822dd1146be382d6eb = Array("e\'", "ch", "sh", "yo", "jo", "zh", "yu", "ju", "ya", "ja", "a", "b", "v", "g", "d", "e", "z", "i", "j", "k", "l", "m", "n", "o", "p", "r", "s",  "t", "u", "f", "h", "c", "w", "~", "y", "\'");$v26918d22023967c71dc711b48689bcee = Array("Э", "Ч", "Ш", "Ё", "Ё", "Ж", "Ю", "Ю", "Я", "Я", "А", "Б", "В", "Г", "Д", "Е", "З", "И", "Й", "К", "Л", "М", "Н", "О", "П", "Р", "С", "Т", "У", "Ф", "Х", "Ц", "Щ", "Ъ", "Ы", "Ь");$vc2ed3225ce8d87037c449d861b2a9a72 = Array("э", "ч", "ш", "ё", "ё", "ж", "ю", "ю", "я", "я", "а", "б", "в", "г", "д", "е", "з", "и", "й", "к", "л", "м", "н", "о", "п", "р", "с", "т", "у", "ф", "х", "ц", "щ", "ъ", "ы", "ь");$v4805086766da260241b1809e47c4ae1b = Array("E'", "CH", "SH", "YO", "JO", "ZH", "YU", "JU", "YA", "JA", "A", "B", "V", "", "D", "E", "Z", "I", "J", "K", "L", "M", "N", "O", "P", "R", "S", "T", "U", "F", "H", "C", "W", "~", "Y", "'");$v70a71974615f1ab10ed02e2553a4dcf1 = Array("e'", "ch", "sh", "yo", "jo", "zh", "yu", "ju", "ya", "ja", "a", "b", "v", "", "d", "e", "z", "i", "j", "k", "l", "m", "n", "o", "p", "r", "s", "t", "u", "f", "h", "c", "w", "~", "y", "'");$va24b64420eae7ee592a5d87ce7c1c42a = $va43c1b0aa53a0c908810c06ab1ff3967;$v9b207167e5381c47682c6b4f58a623fb = $va43c1b0aa53a0c908810c06ab1ff3967;if($v15d61712450a686a7f365adf4fef581f == "E_TO_R") {if ($va24b64420eae7ee592a5d87ce7c1c42a) {for ($v865c0c0b4ab0e063e5caa3387c1a8741=0;$v865c0c0b4ab0e063e5caa3387c1a8741<sizeof($v70a71974615f1ab10ed02e2553a4dcf1);$v865c0c0b4ab0e063e5caa3387c1a8741++) {$va24b64420eae7ee592a5d87ce7c1c42a = str_replace($v70a71974615f1ab10ed02e2553a4dcf1[$v865c0c0b4ab0e063e5caa3387c1a8741], $v91e9f0f521a498732fab5a0eeb8d79d1[$v865c0c0b4ab0e063e5caa3387c1a8741], $va24b64420eae7ee592a5d87ce7c1c42a);}for ($v865c0c0b4ab0e063e5caa3387c1a8741=0;$v865c0c0b4ab0e063e5caa3387c1a8741<sizeof($v4805086766da260241b1809e47c4ae1b);$v865c0c0b4ab0e063e5caa3387c1a8741++) {$va24b64420eae7ee592a5d87ce7c1c42a = str_replace($v4805086766da260241b1809e47c4ae1b[$v865c0c0b4ab0e063e5caa3387c1a8741], $v3e396061ea36cab13a403292255e37d6[$v865c0c0b4ab0e063e5caa3387c1a8741], $va24b64420eae7ee592a5d87ce7c1c42a);$va24b64420eae7ee592a5d87ce7c1c42a = str_replace($v4805086766da260241b1809e47c4ae1b[$v865c0c0b4ab0e063e5caa3387c1a8741], $v3e396061ea36cab13a403292255e37d6[$v865c0c0b4ab0e063e5caa3387c1a8741], $va24b64420eae7ee592a5d87ce7c1c42a);}$v9b207167e5381c47682c6b4f58a623fb = $va24b64420eae7ee592a5d87ce7c1c42a;}}if($v15d61712450a686a7f365adf4fef581f == "R_TO_E") {if ($va24b64420eae7ee592a5d87ce7c1c42a) {$va24b64420eae7ee592a5d87ce7c1c42a = str_replace($vc2ed3225ce8d87037c449d861b2a9a72, $v149cee0bb60980822dd1146be382d6eb, $va24b64420eae7ee592a5d87ce7c1c42a);$va24b64420eae7ee592a5d87ce7c1c42a = str_replace($v26918d22023967c71dc711b48689bcee, $v149cee0bb60980822dd1146be382d6eb, $va24b64420eae7ee592a5d87ce7c1c42a);$v9b207167e5381c47682c6b4f58a623fb = strtolower($va24b64420eae7ee592a5d87ce7c1c42a);}}$vd98a07f84921b24ee30f86fd8cd85c3c = Array("/", "\\", "'", "\t", "\r\n", "\n", "\"", " ", "?", ".");$v01b6e20344b68835c5ed1ddedf20d531 = Array("", "", "", "", "", "", "", "_", "", "");$v9b207167e5381c47682c6b4f58a623fb = str_replace($vd98a07f84921b24ee30f86fd8cd85c3c, $v01b6e20344b68835c5ed1ddedf20d531, $v9b207167e5381c47682c6b4f58a623fb);$v9b207167e5381c47682c6b4f58a623fb = preg_replace("/[ ]+/", "_", $v9b207167e5381c47682c6b4f58a623fb);return $v9b207167e5381c47682c6b4f58a623fb;}function system_parse_short_calls($v9b207167e5381c47682c6b4f58a623fb, $v7057e8409c7c531a1a6e9ac3df4ed549 = false, $vaf31437ce61345f416579830a98c91e5 = false, $vf7c0b9f29873bcb1daa361baa7a89b38 = array()) {if(!is_string($v9b207167e5381c47682c6b4f58a623fb) || (strpos($v9b207167e5381c47682c6b4f58a623fb, "%") === false)) return $v9b207167e5381c47682c6b4f58a623fb;$v594c103f2c6e04c3d8ab059f031e0c1a = cmsController::getInstance();$vaff82898df44626b45c1db972ca61d6e = umiObjectsCollection::getInstance();$v7eac10e56aecdee23bcc96aa52972dde = (strpos($v9b207167e5381c47682c6b4f58a623fb, "%scope%") !== false);$v8e2dcfd7e7e24b1ca76c1193f645902b = NULL;$va8cfde6331bd59eb2ac96f8911c4b666 = NULL;if($v7057e8409c7c531a1a6e9ac3df4ed549 === false && $vaf31437ce61345f416579830a98c91e5 === false) {$v7057e8409c7c531a1a6e9ac3df4ed549 = $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentElementId();}if(strpos($v9b207167e5381c47682c6b4f58a623fb, "id%") !== false) {$v9b207167e5381c47682c6b4f58a623fb = str_replace("%id%", $v7057e8409c7c531a1a6e9ac3df4ed549, $v9b207167e5381c47682c6b4f58a623fb);$v9b207167e5381c47682c6b4f58a623fb = str_replace("%pid%", $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentElementId(), $v9b207167e5381c47682c6b4f58a623fb);}if($v7057e8409c7c531a1a6e9ac3df4ed549 !== false) {if(!($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549))) {return $v9b207167e5381c47682c6b4f58a623fb;}else {$va8cfde6331bd59eb2ac96f8911c4b666 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();}}if($vaf31437ce61345f416579830a98c91e5 !== false) {if(!($va8cfde6331bd59eb2ac96f8911c4b666 = $vaff82898df44626b45c1db972ca61d6e->getObject($vaf31437ce61345f416579830a98c91e5))) {return $v9b207167e5381c47682c6b4f58a623fb;}}if(!$va8cfde6331bd59eb2ac96f8911c4b666) return $v9b207167e5381c47682c6b4f58a623fb;$v87306dd4235ed712ebc07fe169b76f83 = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();$v7ae7003da59ae71dcc9f8638ef50593d = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);if($v7eac10e56aecdee23bcc96aa52972dde) {$vd05b6ed7d2345020440df396d6da7f73 = $v7ae7003da59ae71dcc9f8638ef50593d->getAllFields();foreach($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {$vb068931cc450442b63f5b3d276ea4297 = $v06e3d36fa30cea095545139854ad1fb9->getName();$vf7c0b9f29873bcb1daa361baa7a89b38[$vb068931cc450442b63f5b3d276ea4297] = $va8cfde6331bd59eb2ac96f8911c4b666->getValue($vb068931cc450442b63f5b3d276ea4297);}$v9b207167e5381c47682c6b4f58a623fb = str_replace("%scope%", system_print_template_scope($vf7c0b9f29873bcb1daa361baa7a89b38), $v9b207167e5381c47682c6b4f58a623fb);}if(preg_match_all("/%([A-z0-9\-_]*)%/", $v9b207167e5381c47682c6b4f58a623fb, $vc68271a63ddbc431c307beb7d2918275)) {foreach($vc68271a63ddbc431c307beb7d2918275[1] as $vfdb247e9e403c4f538e0942a2dac7d4c) {if($v7ae7003da59ae71dcc9f8638ef50593d->getFieldId($vfdb247e9e403c4f538e0942a2dac7d4c) != false) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $va8cfde6331bd59eb2ac96f8911c4b666->getValue($vfdb247e9e403c4f538e0942a2dac7d4c);if(is_object($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {if($v3a6d0284e743dc4a9b86f97d6dd1a3bf instanceof umiDate) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v3a6d0284e743dc4a9b86f97d6dd1a3bf->getFormattedDate("U");}if($v3a6d0284e743dc4a9b86f97d6dd1a3bf instanceof umiFile) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v3a6d0284e743dc4a9b86f97d6dd1a3bf->getFilePath(true);}if($v3a6d0284e743dc4a9b86f97d6dd1a3bf instanceof umiHierarchy) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v3a6d0284e743dc4a9b86f97d6dd1a3bf->getName();}}if(is_array($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {$v2063c1608d6e0baf80249c42e2be5804 = "";$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v3a6d0284e743dc4a9b86f97d6dd1a3bf);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vf19e92e810d08b6cf2d0265b779064d9 = $v3a6d0284e743dc4a9b86f97d6dd1a3bf[$v865c0c0b4ab0e063e5caa3387c1a8741];if(is_numeric($vf19e92e810d08b6cf2d0265b779064d9)) {if($vbe8f80182e0c983916da7338c2c1c040 = $vaff82898df44626b45c1db972ca61d6e->getObject($vf19e92e810d08b6cf2d0265b779064d9)) {$vf19e92e810d08b6cf2d0265b779064d9 = $vbe8f80182e0c983916da7338c2c1c040->getName();unset($vbe8f80182e0c983916da7338c2c1c040);}else continue;}if($vf19e92e810d08b6cf2d0265b779064d9 instanceof umiHierarchyElement) {$vf19e92e810d08b6cf2d0265b779064d9 = $vf19e92e810d08b6cf2d0265b779064d9->getName();}$v2063c1608d6e0baf80249c42e2be5804 .= $vf19e92e810d08b6cf2d0265b779064d9;if($v865c0c0b4ab0e063e5caa3387c1a8741 < ($v7dabf5c198b0bab2eaa42bb03a113e55 - 1)) $v2063c1608d6e0baf80249c42e2be5804 .= ", ";}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v2063c1608d6e0baf80249c42e2be5804;}if(strpos($v3a6d0284e743dc4a9b86f97d6dd1a3bf, "%") !== false ) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = templater::getInstance()->parseInput($v3a6d0284e743dc4a9b86f97d6dd1a3bf);}$v9b207167e5381c47682c6b4f58a623fb = str_replace("%" . $vfdb247e9e403c4f538e0942a2dac7d4c . "%", $v3a6d0284e743dc4a9b86f97d6dd1a3bf, $v9b207167e5381c47682c6b4f58a623fb);}}}if(strpos($v9b207167e5381c47682c6b4f58a623fb, "id%") !== false) {$v9b207167e5381c47682c6b4f58a623fb = str_replace("%id%", $v7057e8409c7c531a1a6e9ac3df4ed549, $v9b207167e5381c47682c6b4f58a623fb);$v9b207167e5381c47682c6b4f58a623fb = str_replace("%pid%", $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentElementId(), $v9b207167e5381c47682c6b4f58a623fb);}return $v9b207167e5381c47682c6b4f58a623fb;}function system_print_template_scope($vf7c0b9f29873bcb1daa361baa7a89b38, $v77abb8285d9109fa3adaa962b1d8312f = false) {list($v14511f2f5564650d129ca7cabc333278, $v6f493ab3d3cafc90de6606e1d559cb97, $vae044de305b3ae44fc378dfe0e95b101) = def_module::loadTemplates("system/reflection", "scope_dump_block", "scope_dump_line_variable", "scope_dump_line_macro");$v8c872b0c9f80fb4709c8e137d5d2191a = "";foreach($vf7c0b9f29873bcb1daa361baa7a89b38 as $vb068931cc450442b63f5b3d276ea4297 => $v2063c1608d6e0baf80249c42e2be5804) {if($vb068931cc450442b63f5b3d276ea4297 == "#meta") continue;if(is_array($v2063c1608d6e0baf80249c42e2be5804)) {$vfa816edb83e95bf0c8da580bdfd491ef = str_replace("%name%", $vb068931cc450442b63f5b3d276ea4297, $vae044de305b3ae44fc378dfe0e95b101);}else {$vfa816edb83e95bf0c8da580bdfd491ef = $v6f493ab3d3cafc90de6606e1d559cb97;$vfa816edb83e95bf0c8da580bdfd491ef = str_replace("%name%", $vb068931cc450442b63f5b3d276ea4297, $vfa816edb83e95bf0c8da580bdfd491ef);$vfa816edb83e95bf0c8da580bdfd491ef = str_replace("%type%", gettype($v2063c1608d6e0baf80249c42e2be5804), $vfa816edb83e95bf0c8da580bdfd491ef);$vfa816edb83e95bf0c8da580bdfd491ef = str_replace("%value%", htmlspecialchars($v2063c1608d6e0baf80249c42e2be5804), $vfa816edb83e95bf0c8da580bdfd491ef);}$v8c872b0c9f80fb4709c8e137d5d2191a .= $vfa816edb83e95bf0c8da580bdfd491ef;}if(isset($vf7c0b9f29873bcb1daa361baa7a89b38["#meta"])) {$v77abb8285d9109fa3adaa962b1d8312f = isset($vf7c0b9f29873bcb1daa361baa7a89b38["#meta"]["name"]) ? $vf7c0b9f29873bcb1daa361baa7a89b38["#meta"]["name"] : "";$vf6b5fef6cb1ab808d349cc3bd4e14816 = isset($vf7c0b9f29873bcb1daa361baa7a89b38["#meta"]["file"]) ? $vf7c0b9f29873bcb1daa361baa7a89b38["#meta"]["file"] : "";}else {$v77abb8285d9109fa3adaa962b1d8312f = "";$vf6b5fef6cb1ab808d349cc3bd4e14816 = "";}$v14511f2f5564650d129ca7cabc333278 = str_replace("%lines%", $v8c872b0c9f80fb4709c8e137d5d2191a, $v14511f2f5564650d129ca7cabc333278);$v14511f2f5564650d129ca7cabc333278 = str_replace("%block_name%", $v77abb8285d9109fa3adaa962b1d8312f, $v14511f2f5564650d129ca7cabc333278);$v14511f2f5564650d129ca7cabc333278 = str_replace("%block_file%", $vf6b5fef6cb1ab808d349cc3bd4e14816, $v14511f2f5564650d129ca7cabc333278);$v14511f2f5564650d129ca7cabc333278 = preg_replace("/%[A-z0-9_]+%/i", "", $v14511f2f5564650d129ca7cabc333278);return $v14511f2f5564650d129ca7cabc333278;}function getPrintableTpl($_sTplName) {if(!isset($_GET['print'])) {return $_sTplName;}$vf604cb7936b847e102de8bf7396a80e2 = substr($vf9bdb7221804d6d17b654ec67c5a0735, 0, strrpos($vf9bdb7221804d6d17b654ec67c5a0735, '.')) . '.print.tpl';return (file_exists('tpls/content/'.$vf604cb7936b847e102de8bf7396a80e2)) ? $vf604cb7936b847e102de8bf7396a80e2 : $_sTplName;}function is_demo() {return defined('CURRENT_VERSION_LINE') and strtolower(CURRENT_VERSION_LINE) == 'demo';}function detectCharset($v19a97ad5524a2d14e58b104936effbde) {if (preg_match("/[\x{0000}-\x{FFFF}]+/u", $v19a97ad5524a2d14e58b104936effbde)) return 'UTF-8';$va985177e18afdab154ab615657ef1514 = 'CP1251';if (!function_exists('iconv')) return $va985177e18afdab154ab615657ef1514;$vc8a02849a395786b0162365c9c8e285d = array(   'CP1251',   'ISO-8859-5',   'KOI8-R',   'UTF-8',   'CP866'  );if(function_exists("mb_detect_encoding")) {return mb_detect_encoding($v19a97ad5524a2d14e58b104936effbde, implode(", ",$vc8a02849a395786b0162365c9c8e285d));}else {return "UTF-8";}}function checkAllowedDiskSize($v4b3a6218bb3e3a7303e8a171a60fcf92=false, $v33030abc929f083da5f6c3f755b46034 = array('/images', '/files')) {if ($v4b3a6218bb3e3a7303e8a171a60fcf92==false) {return false;}$v4290bf7e707d9552c735e5bcc4a8edb3 = mainConfiguration::getInstance()->get('system', 'quota-files-and-images');if ($v4290bf7e707d9552c735e5bcc4a8edb3==0) {return true;}$v4290bf7e707d9552c735e5bcc4a8edb3 = getBytesFromString($v4290bf7e707d9552c735e5bcc4a8edb3);$v1105d5ffdd5622b43f4a0b16afb0e886 = getBusyDiskSize($v33030abc929f083da5f6c3f755b46034);return $v4290bf7e707d9552c735e5bcc4a8edb3>=$v1105d5ffdd5622b43f4a0b16afb0e886+$v4b3a6218bb3e3a7303e8a171a60fcf92;}function getBusyDiskSize($v33030abc929f083da5f6c3f755b46034 = array('/images', '/files')) {clearstatcache();$v1105d5ffdd5622b43f4a0b16afb0e886 = 0;foreach($v33030abc929f083da5f6c3f755b46034 as $v736007832d2167baaae763fd3a3f3cf1) {$v1105d5ffdd5622b43f4a0b16afb0e886 += getDirSize(CURRENT_WORKING_DIR.$v736007832d2167baaae763fd3a3f3cf1);}return $v1105d5ffdd5622b43f4a0b16afb0e886;}function getBytesFromString($v341be97d9aff90c9978347f66f945b77) {if(empty($v341be97d9aff90c9978347f66f945b77)) return 0;$v341be97d9aff90c9978347f66f945b77 = str_replace(' ', '', strtolower($v341be97d9aff90c9978347f66f945b77));$v4b3a6218bb3e3a7303e8a171a60fcf92 = $v341be97d9aff90c9978347f66f945b77;if( strpos( $v341be97d9aff90c9978347f66f945b77, 'kb') ) {$v4b3a6218bb3e3a7303e8a171a60fcf92 = (int) str_replace( 'kb', '', $v341be97d9aff90c9978347f66f945b77) * 1024;}if( strpos( $v341be97d9aff90c9978347f66f945b77, 'k') ) {$v4b3a6218bb3e3a7303e8a171a60fcf92 = (int) str_replace( 'k', '', $v341be97d9aff90c9978347f66f945b77) * 1024;}if( strpos( $v341be97d9aff90c9978347f66f945b77, 'mb') ) {$v4b3a6218bb3e3a7303e8a171a60fcf92 = (int) str_replace( 'mb', '', $v341be97d9aff90c9978347f66f945b77) * 1024 * 1024;}if( strpos( $v341be97d9aff90c9978347f66f945b77, 'm') ) {$v4b3a6218bb3e3a7303e8a171a60fcf92 = (int) str_replace( 'm', '', $v341be97d9aff90c9978347f66f945b77) * 1024 * 1024;}if( strpos( $v341be97d9aff90c9978347f66f945b77, 'gb') ) {$v4b3a6218bb3e3a7303e8a171a60fcf92 = (int) str_replace( 'gb', '', $v341be97d9aff90c9978347f66f945b77) * 1024 * 1024 * 1024;}if( strpos( $v341be97d9aff90c9978347f66f945b77, 'g') ) {$v4b3a6218bb3e3a7303e8a171a60fcf92 = (int) str_replace( 'g', '', $v341be97d9aff90c9978347f66f945b77) * 1024 * 1024 * 1024;}return $v4b3a6218bb3e3a7303e8a171a60fcf92;}function getDirSize($vd6fe1d0be6347b8ef2427fa629c04485) {$vf7bd60b75b29d79b660a2859395c1a24 = 0;if (substr($vd6fe1d0be6347b8ef2427fa629c04485, -1, 1) !== DIRECTORY_SEPARATOR) {$vd6fe1d0be6347b8ef2427fa629c04485 .= DIRECTORY_SEPARATOR;}if (is_file($vd6fe1d0be6347b8ef2427fa629c04485)) {return filesize($vd6fe1d0be6347b8ef2427fa629c04485);}elseif (!is_dir($vd6fe1d0be6347b8ef2427fa629c04485)) {return false;}$va9d1cbf71942327e98b40cf5ef38a960 = array($vd6fe1d0be6347b8ef2427fa629c04485);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0, $v363b122c528f54df4a0446b6bab05515 = count($va9d1cbf71942327e98b40cf5ef38a960);$v865c0c0b4ab0e063e5caa3387c1a8741 < $v363b122c528f54df4a0446b6bab05515;++$v865c0c0b4ab0e063e5caa3387c1a8741)  {$vd0e45878043844ffc41aac437e86b602 = $v865c0c0b4ab0e063e5caa3387c1a8741;if (is_dir($va9d1cbf71942327e98b40cf5ef38a960[$v865c0c0b4ab0e063e5caa3387c1a8741]) && $v736007832d2167baaae763fd3a3f3cf1 = @dir($va9d1cbf71942327e98b40cf5ef38a960[$v865c0c0b4ab0e063e5caa3387c1a8741])) {$vb984798e3539eb1bfe8eaa2096ce4d12 = array();while (false !== ($v1043bfc77febe75fafec0c4309faccf1 = $v736007832d2167baaae763fd3a3f3cf1->read())) {if ($v1043bfc77febe75fafec0c4309faccf1 == '.' || $v1043bfc77febe75fafec0c4309faccf1 == '..') {continue;}$vd6fe1d0be6347b8ef2427fa629c04485 = $va9d1cbf71942327e98b40cf5ef38a960[$v865c0c0b4ab0e063e5caa3387c1a8741] . $v1043bfc77febe75fafec0c4309faccf1;if (is_dir($vd6fe1d0be6347b8ef2427fa629c04485)) {$vd6fe1d0be6347b8ef2427fa629c04485 .= DIRECTORY_SEPARATOR;$vb984798e3539eb1bfe8eaa2096ce4d12[] = $vd6fe1d0be6347b8ef2427fa629c04485;}elseif (is_file($vd6fe1d0be6347b8ef2427fa629c04485)) {$vf7bd60b75b29d79b660a2859395c1a24 += filesize($vd6fe1d0be6347b8ef2427fa629c04485);}}unset($va9d1cbf71942327e98b40cf5ef38a960[0]);$va9d1cbf71942327e98b40cf5ef38a960 = array_merge($vb984798e3539eb1bfe8eaa2096ce4d12, $va9d1cbf71942327e98b40cf5ef38a960);$v865c0c0b4ab0e063e5caa3387c1a8741 = -1;$v363b122c528f54df4a0446b6bab05515 = count($va9d1cbf71942327e98b40cf5ef38a960);$v736007832d2167baaae763fd3a3f3cf1->close();unset($v736007832d2167baaae763fd3a3f3cf1);}}return $vf7bd60b75b29d79b660a2859395c1a24;}function checkFileForReading($vd6fe1d0be6347b8ef2427fa629c04485, $vd49d3d4a895e455aa4c77af5377559dd = array()) {$vd6fe1d0be6347b8ef2427fa629c04485 = realpath($vd6fe1d0be6347b8ef2427fa629c04485);if( !file_exists($vd6fe1d0be6347b8ef2427fa629c04485) ) {return false;}$vd6fe1d0be6347b8ef2427fa629c04485 = str_replace("\\", "/", $vd6fe1d0be6347b8ef2427fa629c04485);$va93b85dcfbb9969f5bb3c6be71737ed5 = pathinfo($vd6fe1d0be6347b8ef2427fa629c04485);if(strpos ($vd6fe1d0be6347b8ef2427fa629c04485, CURRENT_WORKING_DIR) !== 0 ) {return false;}if( $va93b85dcfbb9969f5bb3c6be71737ed5['filename'] == '.htaccess' || $va93b85dcfbb9969f5bb3c6be71737ed5['filename'] == '.htpasswd') {return false;}if( sizeof($vd49d3d4a895e455aa4c77af5377559dd) && !in_array($va93b85dcfbb9969f5bb3c6be71737ed5['extension'],$vd49d3d4a895e455aa4c77af5377559dd)) {return false;}return true;}function system_is_mobile() {if (isset($_COOKIE['is_mobile'])) {return getCookie('is_mobile');}$v33c0ee425e2c0efe834afc1aa1e33a4c = "/(windows\sce|android|symbian|series60|ip[ao]d|phone" .   "|blackberry|opera\sm[io][nb]i|netfront|obigo|maemo|[pc].brow" .   "|up\.link|wap|^noki|^htc|^mot|ericsson|samsu|psp|ppc)/i";switch (false) {case (is_null(getServer('HTTP_PROFILE'))) : return true;case (is_null(getServer('HTTP_X_WAP_PROFILE'))) : return true;case (strpos(getServer('HTTP_ACCEPT'), 'vnd.wap') == false) : return true;case (preg_match($v33c0ee425e2c0efe834afc1aa1e33a4c, getServer('HTTP_USER_AGENT')) == false) : return true;default : return false;}}function macros_content() {static $v9b207167e5381c47682c6b4f58a623fb;if(!is_null($v9b207167e5381c47682c6b4f58a623fb)) return $v9b207167e5381c47682c6b4f58a623fb;$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v7abdda3251de25a51bf5fb15d7c3391d = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentModule();$vdb206b4902d295196025b8e70cbb0896 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentMethod();$v7865662652a92be56e59db026567a8bb = $v8b1dc169bf460ee884fceef66c6607d6->isContentMode;$v8b1dc169bf460ee884fceef66c6607d6->isContentMode = true;if($v22884db148f0ffb0d830ba431102b0b5 = $v8b1dc169bf460ee884fceef66c6607d6->getModule($v7abdda3251de25a51bf5fb15d7c3391d)) {$v0db3209e1adc6d67be435a81baf9a66e = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentElementId();$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$v640eac53ad75db5c49a9ec86390d8530 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentTemplater();$v5fdedfe381eef204ab3354d244885a40 = $v41275a535677f79ff347e01bc530c176->isAdmin();if($v0db3209e1adc6d67be435a81baf9a66e) {list($v4b43b0aee35624cd95b910189b3dc231, $vf1290186a5d0b1ceab27f4e77c0c5d68) = $v41275a535677f79ff347e01bc530c176->isAllowedObject($v41275a535677f79ff347e01bc530c176->getUserId(), $v0db3209e1adc6d67be435a81baf9a66e);if($v4b43b0aee35624cd95b910189b3dc231) {$v370c1d74e32be1f53b02d1ffc5baeb16 = true;}else {$v370c1d74e32be1f53b02d1ffc5baeb16 = false;}}else {$v370c1d74e32be1f53b02d1ffc5baeb16 = true;}if(system_is_allowed($v7abdda3251de25a51bf5fb15d7c3391d, $vdb206b4902d295196025b8e70cbb0896) && ($v370c1d74e32be1f53b02d1ffc5baeb16)) {if($vac7e245e9def337ebb3d4fb5196b418c = $v8b1dc169bf460ee884fceef66c6607d6->parsedContent) {return $vac7e245e9def337ebb3d4fb5196b418c;}if($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() == "admin") {try {if (!$v640eac53ad75db5c49a9ec86390d8530->getIsInited()) {$v9b207167e5381c47682c6b4f58a623fb = $v22884db148f0ffb0d830ba431102b0b5->cms_callMethod($vdb206b4902d295196025b8e70cbb0896, NULL);}}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$v640eac53ad75db5c49a9ec86390d8530->setDataSet($ve1671797c52e15f763380b45e841ec32);return $v9b207167e5381c47682c6b4f58a623fb = false;}}else {try {$v9b207167e5381c47682c6b4f58a623fb = $v22884db148f0ffb0d830ba431102b0b5->cms_callMethod($vdb206b4902d295196025b8e70cbb0896, NULL);}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$v9b207167e5381c47682c6b4f58a623fb = $ve1671797c52e15f763380b45e841ec32->getMessage();}$v9b207167e5381c47682c6b4f58a623fb = system_parse_short_calls($v9b207167e5381c47682c6b4f58a623fb);$v9b207167e5381c47682c6b4f58a623fb = str_replace("%content%", "%content ", $v9b207167e5381c47682c6b4f58a623fb);$v9b207167e5381c47682c6b4f58a623fb = templater::getInstance()->parseInput($v9b207167e5381c47682c6b4f58a623fb);$v9b207167e5381c47682c6b4f58a623fb = system_parse_short_calls($v9b207167e5381c47682c6b4f58a623fb);}if($v9b207167e5381c47682c6b4f58a623fb !== false && is_array($v9b207167e5381c47682c6b4f58a623fb) == false) {if($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() != "admin" && stripos($v9b207167e5381c47682c6b4f58a623fb, "%cut%") !== false) {if(array_key_exists("cut", $_REQUEST)) {if($_REQUEST['cut'] == "all") {$_REQUEST['cut_pages'] = 0;return str_ireplace("%cut%", "", $v9b207167e5381c47682c6b4f58a623fb);}$vfe47aa7c733c490d36e80508d5dc4019 = (int) $_REQUEST['cut'];}else $vfe47aa7c733c490d36e80508d5dc4019 = 0;$ve78bd891e50bac12839668749181a546 = spliti("%cut%", $v9b207167e5381c47682c6b4f58a623fb);if($vfe47aa7c733c490d36e80508d5dc4019 > (sizeof($ve78bd891e50bac12839668749181a546) - 1))       $vfe47aa7c733c490d36e80508d5dc4019 = sizeof($ve78bd891e50bac12839668749181a546) - 1;if($vfe47aa7c733c490d36e80508d5dc4019 < 0)       $vfe47aa7c733c490d36e80508d5dc4019 = 0;$_REQUEST['cut_pages'] = sizeof($ve78bd891e50bac12839668749181a546);$_REQUEST['cut_curr_page'] = $vfe47aa7c733c490d36e80508d5dc4019;$v9b207167e5381c47682c6b4f58a623fb = $ve78bd891e50bac12839668749181a546[$vfe47aa7c733c490d36e80508d5dc4019];}$v4d424a5679c0aa6e84a0235ec1949c43 = $v8b1dc169bf460ee884fceef66c6607d6;$v4d424a5679c0aa6e84a0235ec1949c43->parsedContent = $v9b207167e5381c47682c6b4f58a623fb;$v8b1dc169bf460ee884fceef66c6607d6->isContentMode = $v7865662652a92be56e59db026567a8bb;return $v9b207167e5381c47682c6b4f58a623fb;}else {$v8b1dc169bf460ee884fceef66c6607d6->isContentMode = $v7865662652a92be56e59db026567a8bb;return $v9b207167e5381c47682c6b4f58a623fb = '<notice>%core_templater% %core_error_nullvalue%</notice>';}}else {if($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() == "admin" && $v5fdedfe381eef204ab3354d244885a40) {if($v7abdda3251de25a51bf5fb15d7c3391d == "content" && $vdb206b4902d295196025b8e70cbb0896 == "sitetree") {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v0eb9b3af2e4a00837a1b1a854c9ea18c = $vb1444fb0c07653567ad325aa25d4e37a->getList("//modules");foreach($v0eb9b3af2e4a00837a1b1a854c9ea18c as $v447b7147e84be512208dcc0995d67ebc) {list($v22884db148f0ffb0d830ba431102b0b5) = $v447b7147e84be512208dcc0995d67ebc;if(system_is_allowed($v22884db148f0ffb0d830ba431102b0b5) && $v22884db148f0ffb0d830ba431102b0b5 != 'content') {$v47a12618c9a47b69a3050e6b9313a351 = $v8b1dc169bf460ee884fceef66c6607d6->getModule($v22884db148f0ffb0d830ba431102b0b5);$v572d4e421e5e6b9bc11d815e8a027112 = $v47a12618c9a47b69a3050e6b9313a351->pre_lang . "/admin/" . $v22884db148f0ffb0d830ba431102b0b5 . "/";$v47a12618c9a47b69a3050e6b9313a351->redirect($v572d4e421e5e6b9bc11d815e8a027112);}}}}if($v22884db148f0ffb0d830ba431102b0b5 = $v8b1dc169bf460ee884fceef66c6607d6->getModule("users")) {header("Status: 401 Unauthorized");$v8b1dc169bf460ee884fceef66c6607d6->setCurrentModule("users");$v8b1dc169bf460ee884fceef66c6607d6->setCurrentMethod("login");$v8b1dc169bf460ee884fceef66c6607d6->isContentMode = $v7865662652a92be56e59db026567a8bb;if($v5fdedfe381eef204ab3354d244885a40) {$v22884db148f0ffb0d830ba431102b0b5 = $v8b1dc169bf460ee884fceef66c6607d6->getModule($v7abdda3251de25a51bf5fb15d7c3391d);if($v22884db148f0ffb0d830ba431102b0b5->isMethodExists($vdb206b4902d295196025b8e70cbb0896) == false) {$v572d4e421e5e6b9bc11d815e8a027112 = $v47a12618c9a47b69a3050e6b9313a351->pre_lang . "/admin/content/sitetree/";$v22884db148f0ffb0d830ba431102b0b5->redirect($v572d4e421e5e6b9bc11d815e8a027112);}if($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() == "admin") {$ve1671797c52e15f763380b45e841ec32 = new requreMoreAdminPermissionsException(getLabel("error-require-more-permissions"));$v640eac53ad75db5c49a9ec86390d8530->setDataSet($ve1671797c52e15f763380b45e841ec32);}return $v9b207167e5381c47682c6b4f58a623fb = "<p><warning>%core_error_nopermission%</warning></p>" . $v22884db148f0ffb0d830ba431102b0b5->login();}else {if ($v640eac53ad75db5c49a9ec86390d8530 instanceof xslAdminTemplater && $v640eac53ad75db5c49a9ec86390d8530->getParsed()) {throw new requireAdminPermissionsException("No permissions");}return $v9b207167e5381c47682c6b4f58a623fb = $v22884db148f0ffb0d830ba431102b0b5->login();}}return $v9b207167e5381c47682c6b4f58a623fb = '<warning>%core_templater% %core_error_nullvalue% %core_error_nopermission%</warning>';}}$v8b1dc169bf460ee884fceef66c6607d6->isContentMode = $v7865662652a92be56e59db026567a8bb;return $v9b207167e5381c47682c6b4f58a623fb = '%core_templater% %core_error_unknown%';}function macros_title() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();if($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() == "") {if($v7552cd149af7495ee7d8225974e50f80 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentElementId()) {if($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80)) {if($vd5d3db1765287eef77d7927cc956f50a = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue("title")) {return $vd5d3db1765287eef77d7927cc956f50a;}}}}if($v8b1dc169bf460ee884fceef66c6607d6->currentTitle) {return $v8b1dc169bf460ee884fceef66c6607d6->currentTitle;}$v72ee76c5c29383b7c9f9225c1fa4d10b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();$vf585b7f018bb4ced15a03683a733e50b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();$vee83f3e0a5d4553600d456d781380b7a = trim($vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/title_prefix/" . $vf585b7f018bb4ced15a03683a733e50b . "/" . $v72ee76c5c29383b7c9f9225c1fa4d10b));if (strpos($vee83f3e0a5d4553600d456d781380b7a, "%title_string%") !== false) {return str_replace("%title_string%", macros_header(), $vee83f3e0a5d4553600d456d781380b7a);}$vd5d3db1765287eef77d7927cc956f50a = strlen($vee83f3e0a5d4553600d456d781380b7a) ? $vee83f3e0a5d4553600d456d781380b7a . ' ' . macros_header() : macros_header();return $vd5d3db1765287eef77d7927cc956f50a;}function macros_sitename() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v72ee76c5c29383b7c9f9225c1fa4d10b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();$vf585b7f018bb4ced15a03683a733e50b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$vf418892c852ccf5c86998e89045e8063 = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/site_name/{$v72ee76c5c29383b7c9f9225c1fa4d10b}/{$vf585b7f018bb4ced15a03683a733e50b}") ? $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/site_name/{$v72ee76c5c29383b7c9f9225c1fa4d10b}/{$vf585b7f018bb4ced15a03683a733e50b}") : $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/site_name");return $vf418892c852ccf5c86998e89045e8063;}function macros_header() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();if($v8b1dc169bf460ee884fceef66c6607d6->currentHeader) {return $v8b1dc169bf460ee884fceef66c6607d6->currentHeader;}if($v7552cd149af7495ee7d8225974e50f80 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentElementId()) {if($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80)) {$v099fb995346f31c749f6e40db0f395e3 = ($vfa816edb83e95bf0c8da580bdfd491ef = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue("h1")) ? $vfa816edb83e95bf0c8da580bdfd491ef : "";return $v099fb995346f31c749f6e40db0f395e3;}}$v7b975dff6c0134c6f231fd13895c2349 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentModule();$vb6ad8768e9a35023e3d824c5057699d1 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentMethod();if(isset($v8b1dc169bf460ee884fceef66c6607d6->langs[$v7b975dff6c0134c6f231fd13895c2349][$vb6ad8768e9a35023e3d824c5057699d1])) {return $v8b1dc169bf460ee884fceef66c6607d6->langs[$v7b975dff6c0134c6f231fd13895c2349][$vb6ad8768e9a35023e3d824c5057699d1];}else {return false;}}function macros_systemBuild() {return regedit::getInstance()->getVal('//modules/autoupdate/system_build');;}function macros_menu() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vd34fec3e69adc884a61c941174d12dc0 = $v8b1dc169bf460ee884fceef66c6607d6->getModule('content');return ($vd34fec3e69adc884a61c941174d12dc0 instanceof def_module) ? $vd34fec3e69adc884a61c941174d12dc0->menu() : "";}function macros_describtion() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v72ee76c5c29383b7c9f9225c1fa4d10b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();$vf585b7f018bb4ced15a03683a733e50b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();$v67daf92c833c41c95db874e18fcb2786 = "";if($v7552cd149af7495ee7d8225974e50f80 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentElementId()) {if($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80)) {$v67daf92c833c41c95db874e18fcb2786 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue("meta_descriptions");}}if(!$v67daf92c833c41c95db874e18fcb2786) {$v67daf92c833c41c95db874e18fcb2786 = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/meta_description/" . $vf585b7f018bb4ced15a03683a733e50b . "/" . $v72ee76c5c29383b7c9f9225c1fa4d10b);}return $v67daf92c833c41c95db874e18fcb2786;}function macros_keywords() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v72ee76c5c29383b7c9f9225c1fa4d10b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();$vf585b7f018bb4ced15a03683a733e50b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();$v59aeb2c9970b7b25be2fab2317e31fcb = "";if($v7552cd149af7495ee7d8225974e50f80 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentElementId()) {if($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80)) {$v59aeb2c9970b7b25be2fab2317e31fcb = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue("meta_keywords");}}if(!$v59aeb2c9970b7b25be2fab2317e31fcb) {$v59aeb2c9970b7b25be2fab2317e31fcb = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/meta_keywords/" . $vf585b7f018bb4ced15a03683a733e50b . "/" . $v72ee76c5c29383b7c9f9225c1fa4d10b);}return $v59aeb2c9970b7b25be2fab2317e31fcb;}function macros_returnPid() {return cmsController::getInstance()->getCurrentElementId();}function macros_returnPreLang() {return cmsController::getInstance()->pre_lang;}function macros_returnDomain() {return getServer('HTTP_HOST');}function macros_returnDomainFloated() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() == "") {return getServer('HTTP_HOST');}else {$v47c80780ab608cc046f2a6e6f071feb6 = Array();if(is_numeric(getRequest('param0'))) {$v47c80780ab608cc046f2a6e6f071feb6[] = getRequest('param0');}if(is_numeric(getRequest('param1'))) {$v47c80780ab608cc046f2a6e6f071feb6[] = getRequest('param1');}if(getRequest('parent')) {$v47c80780ab608cc046f2a6e6f071feb6[] = getRequest('parent');}foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v4a8a08f09d37b73795649038408b5f33) {if(is_numeric($v4a8a08f09d37b73795649038408b5f33)) {try {if($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v4a8a08f09d37b73795649038408b5f33)) {$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();if($vad5f82e879a9c5d6b5b442eb37e50551 = domainsCollection::getInstance()->getDomain($v662cbf1253ac7d8750ed9190c52163e5)) {return $vad5f82e879a9c5d6b5b442eb37e50551->getHost();}}}catch (baseException $ve1671797c52e15f763380b45e841ec32) {}}if(is_string($v4a8a08f09d37b73795649038408b5f33)) {if($v662cbf1253ac7d8750ed9190c52163e5 = domainsCollection::getInstance()->getDomainId($v4a8a08f09d37b73795649038408b5f33)) {if($vad5f82e879a9c5d6b5b442eb37e50551 = domainsCollection::getInstance()->getDomain($v662cbf1253ac7d8750ed9190c52163e5)) {return $vad5f82e879a9c5d6b5b442eb37e50551->getHost();}}}}return getServer('HTTP_HOST');}}function macros_curr_time() {return time();}function macros_skin_path() {if(getRequest('skin_sel')) return getRequest('skin_sel');return (getCookie('skin')) ? getCookie('skin') : regedit::getInstance()->getVal("//skins");}function macros_current_user_id() {return permissionsCollection::getInstance()->getUserId();}function macros_current_version_line() {if(defined("CURRENT_VERSION_LINE")) {return CURRENT_VERSION_LINE;}else {return "pro";}}function macros_catched_errors() {$v9b207167e5381c47682c6b4f58a623fb = "";foreach(baseException::$vae949adfa9e9068e5e694bc023174c0f as $v42552b1f133f9f8eb406d4f306ea9fd1) {$v9b207167e5381c47682c6b4f58a623fb .= "<p>" . $v42552b1f133f9f8eb406d4f306ea9fd1->getMessage() . "</p>";}return $v9b207167e5381c47682c6b4f58a623fb;}function macros_current_alt_name() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if($v7057e8409c7c531a1a6e9ac3df4ed549 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentElementId()) {if($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549)) {return $v8e2dcfd7e7e24b1ca76c1193f645902b->getAltName();}else {return "";}}else {return "";}}function macros_returnParentId() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if($v7057e8409c7c531a1a6e9ac3df4ed549 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentElementId()) {if($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549)) {return $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();}else {return "";}}else {return "";}}interface iUmiField {public function getName();public function setName($vb068931cc450442b63f5b3d276ea4297);public function getTitle();public function setTitle($vd5d3db1765287eef77d7927cc956f50a);public function getIsLocked();public function setIsLocked($v73b8754d45983f35756b157ea439de8c);public function getIsInheritable();public function setIsInheritable($v55e0eccc570671ca7ba7f5ef4ded0b96);public function getIsVisible();public function setIsVisible($v19fad0416b4b101ab72faccf4c323024);public function getFieldTypeId();public function setFieldTypeId($ve2aeb4e882d60b1eb4b7c8cd97986a28);public function getFieldType();public function getGuideId();public function setGuideId($v52eb29c6d8ea0d3a5bb3654f49bbd7c7);public function getIsInSearch();public function setIsInSearch($va757dc717a4486487d21b4aba6f32740);public function getIsInFilter();public function setIsInFilter($v9a4b912ee7e6ea85cbecbe8fe5994ea2);public function getTip();public function setTip($v6a2139364f96787c8ce1bbb0070b898c);public function getIsRequired();public function setIsRequired($v2a9d32d17ad47ac15c87d2e7c96d0e69 = false);public function getIsSortable();public function setIsSortable($v23aec26e2b521c0e5f1061b3d04983a5 = false);public function getRestrictionId();public function setRestrictionId($v6b1a57fa235477758817df3c91158006 = false);public function getIsSystem();public function setIsSystem($v03c1f379372e00d33098fed2f34f423a = false);public function getDataType();};interface iUmiFieldType {public function getName();public function setName($vb068931cc450442b63f5b3d276ea4297);public function getIsMultiple();public function setIsMultiple($v09ec737a9ab66d1d796304239d3f8a86);public function getIsUnsigned();public function setIsUnsigned($va4e397efa082dcccc62563f1f2d9513b);public function getDataType();public function setDataType($v81a1cd8f514ff6c93ddd4c3cb201130e);public static function getDataTypes();public static function getDataTypeDB($v870b60148237c1452dfb337fdd19c314);public static function isValidDataType($v81a1cd8f514ff6c93ddd4c3cb201130e);};interface iUmiFieldTypesCollection {public function addFieldType($vb068931cc450442b63f5b3d276ea4297, $v870b60148237c1452dfb337fdd19c314 = "string", $v09ec737a9ab66d1d796304239d3f8a86 = false, $va4e397efa082dcccc62563f1f2d9513b = false);public function delFieldType($ve2aeb4e882d60b1eb4b7c8cd97986a28);public function getFieldType($ve2aeb4e882d60b1eb4b7c8cd97986a28);public function getFieldTypesList();};interface iUmiFieldsCollection {public function addField($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $ve2aeb4e882d60b1eb4b7c8cd97986a28, $v19fad0416b4b101ab72faccf4c323024 = true, $v73b8754d45983f35756b157ea439de8c = false, $v55e0eccc570671ca7ba7f5ef4ded0b96 = false);public function delField($v3aabf39f2d943fa886d86dcbbee4d910);public function getField($v945100186b119048837b9859c2c46410);};interface iUmiFieldsGroup {public function getName();public function setName($vb068931cc450442b63f5b3d276ea4297);public function getTitle();public function setTitle($vd5d3db1765287eef77d7927cc956f50a);public function getTypeId();public function setTypeId($v5f694956811487225d15e973ca38fbab);public function getOrd();public function setOrd($v8bef1cc20ada3bef55fdf132cb2a1cb9);public function getIsActive();public function setIsActive($v367e854225a0810977297b3bedb2f309);public function getIsVisible();public function setIsVisible($v19fad0416b4b101ab72faccf4c323024);public function getIsLocked();public function setIsLocked($v73b8754d45983f35756b157ea439de8c);public function getFields();public function attachField($v945100186b119048837b9859c2c46410);public function detachField($v945100186b119048837b9859c2c46410);public function moveFieldAfter($v945100186b119048837b9859c2c46410, $v7107894721f4771e44b220bc8ab81811, $v0e939a4ffd3aacd724dd3b50147b4353, $v3f84b203eef48e9862ac1ffbe344dffe);public static function getAllGroupsByName($v972bf3f05d14ffbdb817bef60638ff00);};interface iUmiObject {public function getName();public function setName($vb068931cc450442b63f5b3d276ea4297);public function getIsLocked();public function setIsLocked($v73b8754d45983f35756b157ea439de8c);public function getTypeId();public function getTypeGUID();public function setTypeId($v5f694956811487225d15e973ca38fbab);public function getPropGroupId($va2b861d0e7719d9108522aacfd4181bc);public function getPropGroupByName($va2b861d0e7719d9108522aacfd4181bc);public function getPropGroupById($v47db2588331bbe530c80dd001fc60aed);public function getPropByName($v46b9e6004c49d9cc040029c197cab278);public function getPropById($vdfcdd018a7fc531ad77b18e3534bf4ae);public function isPropertyExists($vb80bb7740288fda1f201890375a60c8f);public function isFilled();public function getValue($v46b9e6004c49d9cc040029c197cab278);public function setValue($v46b9e6004c49d9cc040029c197cab278, $vafd40dce490ea113be83c89ca7f3052d);public function setOwnerId($vb0ab4f7791b60b1e8ea01057b77873b0);public function getOwnerId();};interface iUmiObjectProperty {public function getValue();public function setValue($v2063c1608d6e0baf80249c42e2be5804);public function resetValue();public function getName();public function getTitle();public function getIsMultiple();public function getIsUnsigned();public function getDataType();public function getIsLocked();public function getIsInheritable();public function getIsVisible();public static function filterOutputString($vb45cffe084dd3d20d928bee85e7b0f21);public static function filterCDATA($vb45cffe084dd3d20d928bee85e7b0f21);public function getObject();public function getField();};interface iUmiObjectType {public function addFieldsGroup($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v367e854225a0810977297b3bedb2f309 = true, $v19fad0416b4b101ab72faccf4c323024 = true);public function delFieldsGroup($v3fdcf94940aa24dc024a819904427035);public function getFieldsGroupByName($v120aafc4d1ddeda208736bcfa6be14cb);public function getFieldsGroup($v3fdcf94940aa24dc024a819904427035);public function getFieldsGroupsList($v370a5fabf1a6ce8eea9597760df7de41 = false);public function getName();public function setName($vb068931cc450442b63f5b3d276ea4297);public function setIsLocked($v73b8754d45983f35756b157ea439de8c);public function getIsLocked();public function setIsGuidable($va8d6fa79ab1177f254f679f9fe648a3e);public function getIsGuidable();public function setIsPublic($v16995eef256269cfe8804ffaf770cb4b);public function getIsPublic();public function setHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631);public function getHierarchyTypeId();public function getParentId();public function setFieldGroupOrd($v47db2588331bbe530c80dd001fc60aed, $v8437225ef7c926cdd9bc4b9783a3be54, $v4bd439a3ff0fb0e318264d9f579f15f9);public function getFieldId($v972bf3f05d14ffbdb817bef60638ff00);public function getAllFields($v33a8421fb9f5a2636cefaed92ae056c3 = false);public function getModule();public function getMethod();};interface iUmiObjectTypesCollection {public function addType($vbfa030fe63bacd523dd70a76cfaed98a, $vb068931cc450442b63f5b3d276ea4297, $v73b8754d45983f35756b157ea439de8c = false);public function delType($v5f694956811487225d15e973ca38fbab);public function getType($v5f694956811487225d15e973ca38fbab);public function getSubTypesList($v5f694956811487225d15e973ca38fbab);public function getParentClassId($v5f694956811487225d15e973ca38fbab);public function getChildClasses($v5f694956811487225d15e973ca38fbab);public function getGuidesList($v848510e91f02f04fc5edf94f85f248d8 = false);public function getTypesByHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631, $v35507ea46d2c0b049d7ed968c449223d = false);public function getTypeByHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631, $v35507ea46d2c0b049d7ed968c449223d = false);public function getBaseType($v84aa805a9d919179ab8f8b24376e2ed7, $v4c2f1ec2014300ad2af17410a4adc3e1 = "");};interface iUmiObjectsCollection {public function getObject($v16b2b26000987faccb260b9d39df1269);public function addObject($vb068931cc450442b63f5b3d276ea4297, $v5f694956811487225d15e973ca38fbab, $v73b8754d45983f35756b157ea439de8c = false);public function delObject($v16b2b26000987faccb260b9d39df1269);public function cloneObject($va77b1053cb200e022574f213c7553d88);public function getGuidedItems($v52eb29c6d8ea0d3a5bb3654f49bbd7c7);public function unloadObject($v16b2b26000987faccb260b9d39df1269);};interface iDomain {public function getIsDefault();public function setIsDefault($ve558e63f3083922542d8745224a66eea);public function addMirrow($vbe5301edeed9917bd552fa98fa1c1766);public function delMirrow($vb240b3b51bcbee2838ac4e9835f9ef51);public function getMirrowId($vbe5301edeed9917bd552fa98fa1c1766);public function getMirrow($vb240b3b51bcbee2838ac4e9835f9ef51);public function getMirrowsList();public function delAllMirrows();public function isMirrowExists($vb240b3b51bcbee2838ac4e9835f9ef51);public function getDefaultLangId();public function setDefaultLangId($vf585b7f018bb4ced15a03683a733e50b);};interface iDomainMirrow {public function getHost();public function setHost($v67b3dba8bc6778101892eb77249db32e);};interface iDomainsCollection {public function addDomain($v67b3dba8bc6778101892eb77249db32e, $va840f33f4bf1f6686232b6ca1c12384e, $ve558e63f3083922542d8745224a66eea = false);public function delDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);public function getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);public function getDefaultDomain();public function setDefaultDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);public function getDomainId($v67b3dba8bc6778101892eb77249db32e, $vaa852eb4a7729f6a309496b84a01631b = true);public function getList();};interface iLang {public function getTitle();public function setTitle($vd5d3db1765287eef77d7927cc956f50a);public function getPrefix();public function setPrefix($v851f5ac9941d720844d143ed9cfcf60a);public function getIsDefault();public function setIsDefault($ve558e63f3083922542d8745224a66eea);};interface iLangsCollection {public function addLang($v851f5ac9941d720844d143ed9cfcf60a, $vd5d3db1765287eef77d7927cc956f50a, $ve558e63f3083922542d8745224a66eea = false);public function delLang($vf585b7f018bb4ced15a03683a733e50b);public function getDefaultLang();public function setDefault($vf585b7f018bb4ced15a03683a733e50b);public function getLangId($v851f5ac9941d720844d143ed9cfcf60a);public function getLang($vf585b7f018bb4ced15a03683a733e50b);public function getList();public function getAssocArray();};interface iTemplate {public function getResourcesDirectory();public function getFilePath();public function getFilename();public function setFilename($v435ed7e9f07f740abf511a62c00eef6e);public function getTitle();public function setTitle($vd5d3db1765287eef77d7927cc956f50a);public function getDomainId();public function setDomainId($v72ee76c5c29383b7c9f9225c1fa4d10b);public function getLangId();public function setLangId($vf585b7f018bb4ced15a03683a733e50b);public function getIsDefault();public function setIsDefault($ve558e63f3083922542d8745224a66eea);public function getUsedPages();public function setUsedPages($v70cc97e695e61c16cbbc6297b3865289);};interface iTemplatesCollection {public function addTemplate($v435ed7e9f07f740abf511a62c00eef6e, $vd5d3db1765287eef77d7927cc956f50a, $v72ee76c5c29383b7c9f9225c1fa4d10b = false, $vf585b7f018bb4ced15a03683a733e50b = false, $ve558e63f3083922542d8745224a66eea = false);public function delTemplate($v3200a31fc05da4e9d5a0465c36822e2f);public function getDefaultTemplate($v662cbf1253ac7d8750ed9190c52163e5 = false, $v78e6dd7a49f5b0cb2106a3a434dd5c86 = false);public function setDefaultTemplate($v74f5356453a69e438e0f58ef93103cc0, $v662cbf1253ac7d8750ed9190c52163e5 = false, $v78e6dd7a49f5b0cb2106a3a434dd5c86 = false);public function getTemplatesList($v72ee76c5c29383b7c9f9225c1fa4d10b, $vf585b7f018bb4ced15a03683a733e50b);public function getTemplate($v3200a31fc05da4e9d5a0465c36822e2f);};interface iUmiHierarchy {public function addElement($va722790b49e8eb1f37a1c672326ec501, $vacf567c9c3d6cf7c6e2cc0ce108e0631, $vb068931cc450442b63f5b3d276ea4297, $vd84ff935144e00c3e1d395c2379aca47, $v6301cee35ea764a1e241978f93f01069 = false, $v72ee76c5c29383b7c9f9225c1fa4d10b = false, $vf585b7f018bb4ced15a03683a733e50b = false, $v3200a31fc05da4e9d5a0465c36822e2f = false);public function getElement($v7552cd149af7495ee7d8225974e50f80, $ve70325c72e806c33fd52022dd9c07eb2 = false, $vbeaf7e25161be5ef9784e550ab4fc891 = false);public function delElement($v7552cd149af7495ee7d8225974e50f80);public function copyElement($v7552cd149af7495ee7d8225974e50f80, $v05ea772b3414e6a459bc1b52cc830436, $v5972c4d2dc988e33130281251a6f282a = false);public function cloneElement($v7552cd149af7495ee7d8225974e50f80, $v05ea772b3414e6a459bc1b52cc830436, $v5972c4d2dc988e33130281251a6f282a = false);public function getDeletedList();public function restoreElement($v7552cd149af7495ee7d8225974e50f80);public function removeDeletedElement($v7552cd149af7495ee7d8225974e50f80);public function removeDeletedAll();public function getParent($v7552cd149af7495ee7d8225974e50f80);public function getAllParents($v970489db8d4f274439de776cfb2f36c2, $vd990c45185b59769adb599de6227718d = false);public function getChilds($v7552cd149af7495ee7d8225974e50f80, $v6ca4142a47386791b174d9cd8d1841ee = true, $vbc8c7a7f95968293eac2b176cc1a21b5 = true, $v12a055bf01a31369fe81ac35d85c7bc1 = 0, $vacf567c9c3d6cf7c6e2cc0ce108e0631 = false, $v72ee76c5c29383b7c9f9225c1fa4d10b = false);public function getChildsCount($v7552cd149af7495ee7d8225974e50f80, $v6ca4142a47386791b174d9cd8d1841ee = true, $vbc8c7a7f95968293eac2b176cc1a21b5 = true, $v12a055bf01a31369fe81ac35d85c7bc1 = 0, $vacf567c9c3d6cf7c6e2cc0ce108e0631 = false, $v72ee76c5c29383b7c9f9225c1fa4d10b = false);public function getPathById($v7552cd149af7495ee7d8225974e50f80, $v5cd943c36b800237522c35155d898244 = false, $vbc9ecd0be77ceffa51fc6918c714e5d3 = false);public function getIdByPath($v4a20784bb5bad10b0f5c941a900f0c04, $v4ee7832bcc23d41fa74f84e483f1859e = false, &$v5f51e765b4dc9821bb184fe18370ab8d = 0);public static function compareStrings($v34b577be20fbc15477aadb9a08101ff9, $v91c0c59c8f6fc9aa2dc99a89f2fd0ab5);public static function convertAltName($vd84ff935144e00c3e1d395c2379aca47, $va0f0bc95016c862498bbad29d1f4d9d4 = false);public static function getTimeStamp();public function getDefaultElementId($vf585b7f018bb4ced15a03683a733e50b = false, $v72ee76c5c29383b7c9f9225c1fa4d10b = false);public function moveBefore($v7552cd149af7495ee7d8225974e50f80, $va722790b49e8eb1f37a1c672326ec501, $v2862c7667bfa3eb6b4c6fa1de2bd8826 = false);public function moveFirst($v7552cd149af7495ee7d8225974e50f80, $va722790b49e8eb1f37a1c672326ec501);public function getDominantTypeId($v7552cd149af7495ee7d8225974e50f80);public function addUpdatedElementId($v7552cd149af7495ee7d8225974e50f80);public function getUpdatedElements();public function unloadElement($v7552cd149af7495ee7d8225974e50f80);public function getElementsCount($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce = "");public function forceAbsolutePath($vf9448cc5666e281bc210298b60567801 = true);public function getObjectInstances($v16b2b26000987faccb260b9d39df1269, $vfc9bd216c399e5612672290fa3f0cbe2 = false, $v1200c36ada21fb70df10f131f49eaf3d = false, $v7cdb97c18de62c6e81d975cdf168b225 = false);public function getLastUpdatedElements($vaa9f73eea60a006820d0f8768bc8a3fc, $v9a5e73d67afbd1b69ff848efe5e73442 = 0);public function checkIsVirtual($v8e67e94f87e92070a0874d1de3ff8f6a);};interface iUmiHierarchyElement {public function getIsDeleted();public function setIsDeleted($va18b1057c4327b9cc46abc9fcf952bd8 = false);public function getIsActive();public function setIsActive($v367e854225a0810977297b3bedb2f309 = true);public function getIsVisible();public function setIsVisible($v19fad0416b4b101ab72faccf4c323024 = true);public function getTypeId();public function setTypeId($v5f694956811487225d15e973ca38fbab);public function getLangId();public function setLangId($vf585b7f018bb4ced15a03683a733e50b);public function getTplId();public function setTplId($vdfae309a35c166d21d4a1ab377b78a47);public function getDomainId();public function setDomainId($v72ee76c5c29383b7c9f9225c1fa4d10b);public function getUpdateTime();public function setUpdateTime($v87a3cb5c3554b2d9d8a1a773ad0936be = 0);public function getOrd();public function setOrd($v8bef1cc20ada3bef55fdf132cb2a1cb9);public function getRel();public function setRel($vd5d4bb9b2c282937ee64b1fb0495ef08);public function getObject();public function setObject(umiObject $va8cfde6331bd59eb2ac96f8911c4b666);public function setAltName($v0330da281541887f65b0a60066351c91, $v9081405e153955c7c08554c483e264cb = true);public function getAltName();public function setIsDefault($ve558e63f3083922542d8745224a66eea = true);public function getIsDefault();public function getParentId();public function getValue($v46b9e6004c49d9cc040029c197cab278, $v21ffce5b8a6cc8cc6a41448dd69623c9 = NULL);public function setValue($v46b9e6004c49d9cc040029c197cab278, $vafd40dce490ea113be83c89ca7f3052d);public function getFieldId($vc5b8d76e52be996ffe6ea3b9a19f1fed);public function getName();public function setName($vb068931cc450442b63f5b3d276ea4297);public function getObjectTypeId();public function getHierarchyType();public function getObjectId();public function getModule();public function getMethod();};interface iUmiHierarchyType {public function getName();public function setName($vb068931cc450442b63f5b3d276ea4297);public function getTitle();public function setTitle($vd5d3db1765287eef77d7927cc956f50a);public function getExt();public function setExt($vabf77184f55403d75b9d51d79162a7ca);};interface iUmiHierarchyTypesCollection {public function addType($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $vabf77184f55403d75b9d51d79162a7ca = "");public function getType($v5f694956811487225d15e973ca38fbab);public function delType($v5f694956811487225d15e973ca38fbab);public function getTypeByName($v84aa805a9d919179ab8f8b24376e2ed7, $va93d60b62600196e433071e75061f398 = false);public function getTypesList();};interface iXmlTranslator {public function __construct(DOMDocument $vdd988cfd769c9f7fbd795a0f5da8e751);public function translateToXml(DOMElement $v173a1756d2d82394cb803161f70f9a38, $v56491f2e1c74898e18bb6e47d2425b19);public static function getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d);public static function getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d);};interface iOutputBuffer {static public function current($v50536bb7b5aa9e0965e3d4c4a421a74a = false);public function push($v8d777f385d3dfec8815d20f7496026dc);public function calltime();public function content();public function length();public function clear();public function send();public function end();public static function contentGenerator($ve491ffdb30ee3d133975aa05783917b1 = null);};abstract class outputBuffer implements iOutputBuffer {private static $buffers = array(), $current = false;final static public function current($v50536bb7b5aa9e0965e3d4c4a421a74a = false) {showWorkTime("buffer current init",2);$v4d293ef273d93a5411725a8223efc83e = &self::$buffers;showWorkTime("buffer current self done",2);if(!$v50536bb7b5aa9e0965e3d4c4a421a74a) {if(self::$current) {$v50536bb7b5aa9e0965e3d4c4a421a74a = self::$current;}else {throw new coreException('No output buffer selected');}}showWorkTime("buffer not exists class",2);self::$current = $v50536bb7b5aa9e0965e3d4c4a421a74a;showWorkTime("buffer self current initiated",2);if(isset($v4d293ef273d93a5411725a8223efc83e[$v50536bb7b5aa9e0965e3d4c4a421a74a]) == false) {if(class_exists($v50536bb7b5aa9e0965e3d4c4a421a74a)) {$v7f2db423a49b305459147332fb01cf87 = new $v50536bb7b5aa9e0965e3d4c4a421a74a;showWorkTime("buffer new bufferClassName initiated",2);if($v7f2db423a49b305459147332fb01cf87 instanceof iOutputBuffer) {$v4d293ef273d93a5411725a8223efc83e[$v50536bb7b5aa9e0965e3d4c4a421a74a] = $v7f2db423a49b305459147332fb01cf87;showWorkTime("buffers array element initiated",2);}else {throw new coreException("Output buffer class \"{$v50536bb7b5aa9e0965e3d4c4a421a74a}\" must implement iOutputBuffer");}}else {throw new coreException("Output buffer of class \"{$v50536bb7b5aa9e0965e3d4c4a421a74a}\" not found");}}showWorkTime("buffer current end",2);return $v4d293ef273d93a5411725a8223efc83e[$v50536bb7b5aa9e0965e3d4c4a421a74a];}protected $buffer = "", $invokeTime;public function __construct() {$this->invokeTime = microtime(true);}public function clear() {$this->buffer = "";}public function length() {return strlen($this->buffer);}public function content() {return $this->buffer;}public function push($v8d777f385d3dfec8815d20f7496026dc) {$this->buffer .= $v8d777f385d3dfec8815d20f7496026dc;}public function end() {$this->send();}public function calltime() {return round(microtime(true) - $this->invokeTime, 6);}public function __call($vea9f6aca279138c58f705c8d4cb4b8ce, $v21ffce5b8a6cc8cc6a41448dd69623c9) {return null;}public function redirect($v572d4e421e5e6b9bc11d815e8a027112, $v9acb44549b41563697bb490144ec6258 = '301 Moved Permanently') {}public static function contentGenerator($ve491ffdb30ee3d133975aa05783917b1 = null) {static $v36750de19bed237506726986ae09e0c9 = null;if (is_null($ve491ffdb30ee3d133975aa05783917b1)) {return $v36750de19bed237506726986ae09e0c9;}return $v36750de19bed237506726986ae09e0c9 = $ve491ffdb30ee3d133975aa05783917b1;}public function __destruct() {$this->send();}};abstract class baseException extends Exception {protected $strcode, $id;public static $catchedExceptions = Array();public function __construct ($v78e731027d8fd50ed642340b7c9a63b3, $vc13367945d5d4c91047b3b50234aa7ab = 0, $vd6ccd2379d1965a49b998d0f4207337d = "") {baseException::$catchedExceptions[$this->getId()] = $this;$this->strcode = $vd6ccd2379d1965a49b998d0f4207337d;$v78e731027d8fd50ed642340b7c9a63b3 = def_module::parseTPLMacroses($v78e731027d8fd50ed642340b7c9a63b3);parent::__construct($v78e731027d8fd50ed642340b7c9a63b3, $vc13367945d5d4c91047b3b50234aa7ab);}public function getStrCode() {return (string) $this->strcode;}public function unregister() {$vb5245bc6f6b6a1e85f4ea02a8f6ef4f6 = baseException::$catchedExceptions;$vb80bb7740288fda1f201890375a60c8f = $this->getId();if(isset($vb5245bc6f6b6a1e85f4ea02a8f6ef4f6[$vb80bb7740288fda1f201890375a60c8f])) {unset($vb5245bc6f6b6a1e85f4ea02a8f6ef4f6[$vb80bb7740288fda1f201890375a60c8f]);}}protected function getId() {static $vb80bb7740288fda1f201890375a60c8f = 0;if(is_null($this->id))  {$this->id = $vb80bb7740288fda1f201890375a60c8f++;}return $this->id;}};class coreException extends baseException {};class coreBreakEventsException extends coreException {};class selectorException extends coreException {};class libXMLErrorException extends coreException  {public function __construct($v11a5b091e0140c519d8d5a323427a5da) {$this->code  = $v11a5b091e0140c519d8d5a323427a5da->code;$this->message  = $v11a5b091e0140c519d8d5a323427a5da->message;$this->line  = $v11a5b091e0140c519d8d5a323427a5da->line;$this->file  = $v11a5b091e0140c519d8d5a323427a5da->file;}}class databaseException extends coreException {};class privateException extends baseException {};class wrongParamException extends privateException {};class errorPanicException extends Exception {};class breakException extends Exception {};abstract class fieldRestrictionException extends privateException {};class wrongValueException extends fieldRestrictionException {};class valueRequiredException extends fieldRestrictionException {};class publicException extends baseException {};class publicAdminException extends publicException {};class expectElementException extends publicAdminException {};class expectObjectException extends publicAdminException {};class expectObjectTypeException extends publicAdminException {};class requireAdminPermissionsException extends publicAdminException {};class requreMoreAdminPermissionsException extends publicAdminException {};class requireAdminParamException extends publicAdminException {};class wrongElementTypeAdminException extends publicAdminException {};class publicAdminPageLimitException extends publicAdminException {};class publicAdminLicenseLimitException extends publicAdminException {};class maxIterationsExeededException extends publicException {};class umiRemoteFileGetterException extends publicException {};class xsltOnlyException extends publicException {public function __construct ($v78e731027d8fd50ed642340b7c9a63b3 = "", $vc13367945d5d4c91047b3b50234aa7ab = 0, $vd6ccd2379d1965a49b998d0f4207337d = "") {parent::__construct(getLabel('error-only-xslt-method'));}};class tplOnlyException extends publicException {public function __construct ($v78e731027d8fd50ed642340b7c9a63b3 = "", $vc13367945d5d4c91047b3b50234aa7ab = 0, $vd6ccd2379d1965a49b998d0f4207337d = "") {parent::__construct(getLabel('error-only-tpl-method'));}};interface iRegedit {public function getKey($vd4c18838d606531e28b9f694e066b003, $v5809e03a3657bacd238321e736b9e85d = 0);public function getVal($vd4c18838d606531e28b9f694e066b003);public function setVar($vd4c18838d606531e28b9f694e066b003, $v2063c1608d6e0baf80249c42e2be5804);public function setVal($vd4c18838d606531e28b9f694e066b003, $v2063c1608d6e0baf80249c42e2be5804);public function delVar($vd4c18838d606531e28b9f694e066b003);public function getList($vd4c18838d606531e28b9f694e066b003);};class regedit extends singleton implements iRegedit {protected $cacheFilePath, $cache = Array(), $cacheSaved = false;public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function getKey($vd6fe1d0be6347b8ef2427fa629c04485, $v5809e03a3657bacd238321e736b9e85d = 0) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();$vd6fe1d0be6347b8ef2427fa629c04485 = trim($vd6fe1d0be6347b8ef2427fa629c04485, "/");if(isset($this->cache['keys'][$vd6fe1d0be6347b8ef2427fa629c04485])) {return $this->cache['keys'][$vd6fe1d0be6347b8ef2427fa629c04485];}$vbb90bf734107ea3b2f4c14a5d4bc4f91 = 0;$ve030113b0d5493f188b4b49370f633b3 = array();foreach(explode("/", $vd6fe1d0be6347b8ef2427fa629c04485) as $v3c6e0b8a9c15224a8228b9a98ca1531d) {$v3c6e0b8a9c15224a8228b9a98ca1531d = l_mysql_real_escape_string($v3c6e0b8a9c15224a8228b9a98ca1531d);$ve030113b0d5493f188b4b49370f633b3[] = $v3c6e0b8a9c15224a8228b9a98ca1531d;$vfab0f4eae0e259eb1421e3cc7acca9b1 = implode('/', $ve030113b0d5493f188b4b49370f633b3);if(isset($v0fea6a13c52b4d4725368f24b045ca84[$vfab0f4eae0e259eb1421e3cc7acca9b1])) {$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $v0fea6a13c52b4d4725368f24b045ca84[$vfab0f4eae0e259eb1421e3cc7acca9b1];continue;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms_reg WHERE rel = '$vbb90bf734107ea3b2f4c14a5d4bc4f91' AND var = '{$v3c6e0b8a9c15224a8228b9a98ca1531d}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(mysql_num_rows($result)) {list($vbb90bf734107ea3b2f4c14a5d4bc4f91) = mysql_fetch_row($result);$v0fea6a13c52b4d4725368f24b045ca84[$vfab0f4eae0e259eb1421e3cc7acca9b1] = $vbb90bf734107ea3b2f4c14a5d4bc4f91;}else {return $this->cache['keys'][$vd6fe1d0be6347b8ef2427fa629c04485] = false;}}return $this->cache['keys'][$vd6fe1d0be6347b8ef2427fa629c04485] = (int) $vbb90bf734107ea3b2f4c14a5d4bc4f91;}public function getVal($vd6fe1d0be6347b8ef2427fa629c04485) {$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vd6fe1d0be6347b8ef2427fa629c04485);if(isset($this->cache['values'][$vd6fe1d0be6347b8ef2427fa629c04485])) {return $this->cache['values'][$vd6fe1d0be6347b8ef2427fa629c04485];}if($vbb90bf734107ea3b2f4c14a5d4bc4f91) {if(isset($this->cache['values'][$vbb90bf734107ea3b2f4c14a5d4bc4f91])) {return $this->cache['values'][$vbb90bf734107ea3b2f4c14a5d4bc4f91];}$this->cacheSaved = false;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT val FROM cms_reg WHERE id = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($v2063c1608d6e0baf80249c42e2be5804) = mysql_fetch_row($result);return $this->cache['values'][$vbb90bf734107ea3b2f4c14a5d4bc4f91] = $v2063c1608d6e0baf80249c42e2be5804;}else {return $this->cache['values'][$vd6fe1d0be6347b8ef2427fa629c04485] = false;}}public function setVar($vd6fe1d0be6347b8ef2427fa629c04485, $v2063c1608d6e0baf80249c42e2be5804) {return $this->setVal($vd6fe1d0be6347b8ef2427fa629c04485, $v2063c1608d6e0baf80249c42e2be5804);}public function setVal($vd6fe1d0be6347b8ef2427fa629c04485, $v2063c1608d6e0baf80249c42e2be5804) {if(defined('CURRENT_VERSION_LINE') && CURRENT_VERSION_LINE == 'demo') {return false;}$this->resetCache();$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vd6fe1d0be6347b8ef2427fa629c04485);if($vbb90bf734107ea3b2f4c14a5d4bc4f91 == false) {$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->createKey($vd6fe1d0be6347b8ef2427fa629c04485);}$v2063c1608d6e0baf80249c42e2be5804 = l_mysql_real_escape_string($v2063c1608d6e0baf80249c42e2be5804);$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms_reg SET val = '{$v2063c1608d6e0baf80249c42e2be5804}' WHERE id = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$this->resetCache();return true;}public function delVar($vd6fe1d0be6347b8ef2427fa629c04485) {if(defined('CURRENT_VERSION_LINE') && CURRENT_VERSION_LINE == 'demo') {return false;}$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vd6fe1d0be6347b8ef2427fa629c04485);if($vbb90bf734107ea3b2f4c14a5d4bc4f91) {$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms_reg WHERE rel = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}' OR id = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$this->resetCache();return true;}else {return false;}}public function getList($vd6fe1d0be6347b8ef2427fa629c04485) {if(isset($this->cache['lists'][$vd6fe1d0be6347b8ef2427fa629c04485])) {return $this->cache['lists'][$vd6fe1d0be6347b8ef2427fa629c04485];}$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vd6fe1d0be6347b8ef2427fa629c04485);if($vd6fe1d0be6347b8ef2427fa629c04485 == "//") {$vbb90bf734107ea3b2f4c14a5d4bc4f91 = 0;}if($vbb90bf734107ea3b2f4c14a5d4bc4f91 || $vd6fe1d0be6347b8ef2427fa629c04485 == "//") {if(isset($this->cache['lists'][$vbb90bf734107ea3b2f4c14a5d4bc4f91])) {return $this->cache['lists'][$vbb90bf734107ea3b2f4c14a5d4bc4f91];}$this->cacheSaved = false;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, var, val FROM cms_reg WHERE rel = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}' ORDER BY id ASC";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$vf09cc7ee3a9a93273f4b80601cafb00c = Array();while(list(, $vb2145aac704ce76dbe1ac7adac535b23, $v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_array($result)) {$vf09cc7ee3a9a93273f4b80601cafb00c[] = Array($vb2145aac704ce76dbe1ac7adac535b23, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $this->cache['lists'][$vbb90bf734107ea3b2f4c14a5d4bc4f91] = $vf09cc7ee3a9a93273f4b80601cafb00c;}else {return $this->cache['lists'][$vd6fe1d0be6347b8ef2427fa629c04485] = false;}}final public static function checkSomething($v0cc175b9c0f1b6a831c399e269772661, $v92eb5ffee6ae2fec3ad71c777531578f, $ve70c4df10ef0983b9c8c31bd06b2a2c3=false) {$v5be98dd7e06f372f5de05104c7cb0bcc = 3600*24*30;if(array_search($_SERVER['HTTP_HOST'], array('localhost', 'subdomain.localhost')) !== false && $_SERVER['SERVER_ADDR'] == '127.0.0.1') {return true;}$v03355d867dcc3a38043185573f43b600 = self::getInstance()->getVal("//modules/autoupdate/system_edition") == 'commerce_enc';foreach ($v92eb5ffee6ae2fec3ad71c777531578f as $vc65f234fae60d823c1f1bf00566248a0 => $v0a3d72134fb3d6c024db4c510bc1605b) {$vce74825b5a01c99b06af231de0bd667d = (substr($v0cc175b9c0f1b6a831c399e269772661, 12, strlen($v0cc175b9c0f1b6a831c399e269772661) - 12) == $v0a3d72134fb3d6c024db4c510bc1605b);if ($vce74825b5a01c99b06af231de0bd667d === true) {if (!defined('CURRENT_VERSION_LINE')) {define("CURRENT_VERSION_LINE", $vc65f234fae60d823c1f1bf00566248a0);}if ($vc65f234fae60d823c1f1bf00566248a0 == "trial" || $v03355d867dcc3a38043185573f43b600) {if (file_exists(SYS_CACHE_RUNTIME . "trash")) {unlink(SYS_CACHE_RUNTIME . "trash");}$v1ed2e1b19b6e55d52d2473be17a4afd9 = filectime(__FILE__);$v59014f3a655d50ab70a71206fb9aff27 = time();if (($v59014f3a655d50ab70a71206fb9aff27 - $v1ed2e1b19b6e55d52d2473be17a4afd9) > $v5be98dd7e06f372f5de05104c7cb0bcc) {if ($ve70c4df10ef0983b9c8c31bd06b2a2c3) {return false;}else {include CURRENT_WORKING_DIR . "/errors/trial_expired.html";exit();}}}return true;}}return false;}final public function checkSelfKeycode() {$v1a54c1036ccb10069e9c06281d52007a = $this->getVal("//settings/keycode");if (strlen($v1a54c1036ccb10069e9c06281d52007a)==0) {return false;}$v903931b3a9d25a70683f51ab9d363d2e = $this->getVal("//settings/system_edition");$v1f0f70bf2b5ad94c7387e64c16dc455a = array('commerce', 'business', 'corporate', 'commerce_enc', 'business_enc', 'corporate_enc');$v45cee5e0fe2cae080c44e7a4ffc70361 = in_array($v903931b3a9d25a70683f51ab9d363d2e, $v1f0f70bf2b5ad94c7387e64c16dc455a) ? 'pro' : $v903931b3a9d25a70683f51ab9d363d2e;$v92eb5ffee6ae2fec3ad71c777531578f = array($v45cee5e0fe2cae080c44e7a4ffc70361 => umiTemplater::getSomething($v45cee5e0fe2cae080c44e7a4ffc70361));return self::checkSomething($v1a54c1036ccb10069e9c06281d52007a, $v92eb5ffee6ae2fec3ad71c777531578f, true);}public function getDaysLeft() {return 30 - floor((time() - filectime(__FILE__)) / (3600*24));}protected function __construct() {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$this->cacheFilePath = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.runtime-cache') . 'registry';$this->loadCache();}public function __destruct() {if(!$this->cacheSaved) {$this->saveCache();}}protected function loadCache() {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();if($vb99eb979e6f6efabc396f777b503f7e7->getIsConnected()) {if($v0fea6a13c52b4d4725368f24b045ca84 = $vb99eb979e6f6efabc396f777b503f7e7->loadSql("registry")) {$this->cache = unserialize($v0fea6a13c52b4d4725368f24b045ca84);$this->cacheSaved = true;return;}}if(file_exists($this->cacheFilePath)) {$v0fea6a13c52b4d4725368f24b045ca84 = unserialize(file_get_contents($this->cacheFilePath));if(is_array($v0fea6a13c52b4d4725368f24b045ca84)) {$this->cacheSaved = true;$this->cache = $v0fea6a13c52b4d4725368f24b045ca84;}}}protected function saveCache() {if(is_array($this->cache)) {if(is_dir(dirname($this->cacheFilePath))) {file_put_contents($this->cacheFilePath, serialize($this->cache));}if(cacheFrontend::getInstance()->getIsConnected()) {cacheFrontend::getInstance()->saveSql("registry", serialize($this->cache));}}$this->cacheSaved = true;}protected function createKey($vd6fe1d0be6347b8ef2427fa629c04485) {$vd6fe1d0be6347b8ef2427fa629c04485 = trim($vd6fe1d0be6347b8ef2427fa629c04485, "/");$vf961aedab905271a350c4e6eb6d7b6b9 = "//";$va722790b49e8eb1f37a1c672326ec501 = 0;$vbb90bf734107ea3b2f4c14a5d4bc4f91 = null;foreach(explode("/", $vd6fe1d0be6347b8ef2427fa629c04485) as $v3c6e0b8a9c15224a8228b9a98ca1531d) {$v3c6e0b8a9c15224a8228b9a98ca1531d = l_mysql_real_escape_string($v3c6e0b8a9c15224a8228b9a98ca1531d);$vf961aedab905271a350c4e6eb6d7b6b9 .= $v3c6e0b8a9c15224a8228b9a98ca1531d . "/";if($vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vf961aedab905271a350c4e6eb6d7b6b9)) {$va722790b49e8eb1f37a1c672326ec501 = $vbb90bf734107ea3b2f4c14a5d4bc4f91;}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms_reg (rel, var, val) VALUES ('{$va722790b49e8eb1f37a1c672326ec501}', '{$v3c6e0b8a9c15224a8228b9a98ca1531d}', '')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$va722790b49e8eb1f37a1c672326ec501 = $vbb90bf734107ea3b2f4c14a5d4bc4f91 = (int) l_mysql_insert_id();}}return $vbb90bf734107ea3b2f4c14a5d4bc4f91;}protected function resetCache($v14f802e1fba977727845e8872c1743a7 = false) {if(is_array($v14f802e1fba977727845e8872c1743a7)) {foreach($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) {if(isset($this->cache[$v3c6e0b8a9c15224a8228b9a98ca1531d])) {unset($this->cache[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}}}else {$this->cache = Array();}$this->saveCache();}};interface iSearchModel {public function runSearch($v597a51f04d341eba4ca965899acc10b3, $vb393233f792f2e0472c964ea8ddbd1f5 = NULL);public function getContext($v7552cd149af7495ee7d8225974e50f80, $v597a51f04d341eba4ca965899acc10b3);public function getIndexPages();public function getAllIndexablePages();public function getIndexWords();public function getIndexWordsUniq();public function getIndexLast();public function truncate_index();public function index_all($vaa9f73eea60a006820d0f8768bc8a3fc = false);public function index_item($v7552cd149af7495ee7d8225974e50f80);public function index_items($v7552cd149af7495ee7d8225974e50f80);public function unindex_items($v7552cd149af7495ee7d8225974e50f80);public function suggestions($vb45cffe084dd3d20d928bee85e7b0f21, $vaa9f73eea60a006820d0f8768bc8a3fc = 10);};class searchModel extends singleton implements iSingleton, iSearchModel {public function __construct() {}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function index_all($vaa9f73eea60a006820d0f8768bc8a3fc = false, $ve4f9a63df3b81b4ed1a414f12da04a6e = 0) {$vfbb44b4487415b134bce9c790a27fe5e = 0;$ve4f9a63df3b81b4ed1a414f12da04a6e = (int) $ve4f9a63df3b81b4ed1a414f12da04a6e;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, updatetime FROM cms3_hierarchy WHERE is_deleted = '0' AND is_active = '1' AND id > '{$ve4f9a63df3b81b4ed1a414f12da04a6e}' ORDER BY id LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while(list($v7057e8409c7c531a1a6e9ac3df4ed549, $v3e04dc2abd929a9d02e2e0fa41d24bf9) = mysql_fetch_row($result)) {++$vfbb44b4487415b134bce9c790a27fe5e;$ve4f9a63df3b81b4ed1a414f12da04a6e = $v7057e8409c7c531a1a6e9ac3df4ed549;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, updatetime FROM cms3_hierarchy WHERE is_deleted = '0' AND is_active = '1' and id > '{$v7057e8409c7c531a1a6e9ac3df4ed549}' ORDER BY id LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(!$this->elementIsReindexed($v7057e8409c7c531a1a6e9ac3df4ed549, $v3e04dc2abd929a9d02e2e0fa41d24bf9)) {$vd30305c13d0f42414482bf155bd13041 = $this->index_item($v7057e8409c7c531a1a6e9ac3df4ed549, true);}if (($vaa9f73eea60a006820d0f8768bc8a3fc !== false) && (--$vaa9f73eea60a006820d0f8768bc8a3fc == 0)) {break;}}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM `cms3_search` LIMIT 1";$v43b5c9175984c071f30b873fdce0a000 = mysql_result(l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true), 0);return array("current"=>$v43b5c9175984c071f30b873fdce0a000, "lastId"=>$ve4f9a63df3b81b4ed1a414f12da04a6e);}public function index_item($v7057e8409c7c531a1a6e9ac3df4ed549, $v887c6b9b516fdd344e1f03a0786c90e8 = false) {if(defined("UMICMS_CLI_MODE") || defined("DISABLE_SEARCH_REINDEX")) {return false;}l_mysql_query("START TRANSACTION /* Reindexing element #{$v7057e8409c7c531a1a6e9ac3df4ed549} */", true);$vec5463c0e508eaa43548444d87ab2e83 = $this->parseItem($v7057e8409c7c531a1a6e9ac3df4ed549);l_mysql_query("COMMIT", true);return $vec5463c0e508eaa43548444d87ab2e83;}public function elementIsReindexed($v7057e8409c7c531a1a6e9ac3df4ed549, $v3e04dc2abd929a9d02e2e0fa41d24bf9) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$v3e04dc2abd929a9d02e2e0fa41d24bf9 = (int) $v3e04dc2abd929a9d02e2e0fa41d24bf9;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_search WHERE rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}' AND indextime > '{$v3e04dc2abd929a9d02e2e0fa41d24bf9}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result);return (bool) $v4a8a08f09d37b73795649038408b5f33;}public function parseItem($v7057e8409c7c531a1a6e9ac3df4ed549) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;if (!($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true, true))) {return false;}if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getValue("is_unindexed")) {$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();$v94757cae63fd3e398c0811a976dd6bbe = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_search WHERE rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row(l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true));if (!$v4a8a08f09d37b73795649038408b5f33) {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_search (rel_id, domain_id, lang_id, type_id) VALUES('{$v7057e8409c7c531a1a6e9ac3df4ed549}', '{$v662cbf1253ac7d8750ed9190c52163e5}', '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}', '{$v94757cae63fd3e398c0811a976dd6bbe}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);}return false;}$v9d1be7b20c9b43741bbda33a93ae2597 = Array();$v94757cae63fd3e398c0811a976dd6bbe = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getTypeId();$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);$vb308737ea9e2bcc45fd2bf20dc6c7d45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroupsList();foreach($vb308737ea9e2bcc45fd2bf20dc6c7d45 as $v6c26c1979a522c2dd7e76e527aa69ca5 => $v38f582e54454005ec0664831734e1152) {foreach($v38f582e54454005ec0664831734e1152->getFields() as $v3aabf39f2d943fa886d86dcbbee4d910 => $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getIsInSearch() == false) continue;$v73f329f154a663bfda020aadcdd0b775 = $v06e3d36fa30cea095545139854ad1fb9->getName();$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue($v73f329f154a663bfda020aadcdd0b775);$v17f71d965fe9589ddbd11caf7182243e = $v06e3d36fa30cea095545139854ad1fb9->getFieldType()->getDataType();if ($v17f71d965fe9589ddbd11caf7182243e) {if (is_array($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {if ($v17f71d965fe9589ddbd11caf7182243e == 'relation') {foreach ($v3a6d0284e743dc4a9b86f97d6dd1a3bf as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if ($v447b7147e84be512208dcc0995d67ebc = selector::get('object')->id($v9e3669d19b675bd57058fd4664205d2a)) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf[$v865c0c0b4ab0e063e5caa3387c1a8741] = $v447b7147e84be512208dcc0995d67ebc->name;unset($v447b7147e84be512208dcc0995d67ebc);}}}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = implode(' ', $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}else {if(is_object($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {continue;}if($v17f71d965fe9589ddbd11caf7182243e == 'relation') {if($v447b7147e84be512208dcc0995d67ebc = selector::get('object')->id($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v447b7147e84be512208dcc0995d67ebc->name;}}}}if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf) || !$v3a6d0284e743dc4a9b86f97d6dd1a3bf) continue;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = preg_replace("/%([A-z_]*)%/m", "", $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v3a6d0284e743dc4a9b86f97d6dd1a3bf = preg_replace("/%([A-zЂ-пРђ-СЏ \/\._\-\(\)0-9%:<>,!@\|'&=;\?\+#]*)%/m", "", $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v9d1be7b20c9b43741bbda33a93ae2597[$v73f329f154a663bfda020aadcdd0b775] = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}}$v9f1c8757350ffe06fffc7cc4b03150af = $this->buildIndexImage($v9d1be7b20c9b43741bbda33a93ae2597);$this->updateSearchIndex($v7057e8409c7c531a1a6e9ac3df4ed549, $v9f1c8757350ffe06fffc7cc4b03150af);}public function buildIndexImage($v5308cca1be08c0bdbdfd06290ce5bed2) {$vb798abe6e1b1318ee36b0dcb3fb9e4d3 = Array();$v63f4f1e9b725370f459720575cd5f953 = Array(    'h1' => 5,    'title' => 5,    'meta_keywords' => 3,    'meta_descriptions' => 3,    'tags' => 3   );foreach ($v5308cca1be08c0bdbdfd06290ce5bed2 as $v972bf3f05d14ffbdb817bef60638ff00 => $v341be97d9aff90c9978347f66f945b77) {$v47c80780ab608cc046f2a6e6f071feb6 = $this->splitString($v341be97d9aff90c9978347f66f945b77);if (isset($v63f4f1e9b725370f459720575cd5f953[$v972bf3f05d14ffbdb817bef60638ff00])) {$v7edabf994b76a00cbc60c95af337db8f = (int) $v63f4f1e9b725370f459720575cd5f953[$v972bf3f05d14ffbdb817bef60638ff00];}else {$v7edabf994b76a00cbc60c95af337db8f = 1;}foreach ($v47c80780ab608cc046f2a6e6f071feb6 as $vc47d187067c6cf953245f128b5fde62a)  {if (array_key_exists($vc47d187067c6cf953245f128b5fde62a, $vb798abe6e1b1318ee36b0dcb3fb9e4d3)) {$vb798abe6e1b1318ee36b0dcb3fb9e4d3[$vc47d187067c6cf953245f128b5fde62a] += $v7edabf994b76a00cbc60c95af337db8f;}else {$vb798abe6e1b1318ee36b0dcb3fb9e4d3[$vc47d187067c6cf953245f128b5fde62a] = $v7edabf994b76a00cbc60c95af337db8f;}}}return $vb798abe6e1b1318ee36b0dcb3fb9e4d3;}public static function splitString($v341be97d9aff90c9978347f66f945b77) {if(is_object($v341be97d9aff90c9978347f66f945b77)) {return NULL;}$v29a6859860d0f35ec9a976557ce6923c = Array("&nbsp;", "&quote;", ". ", ", ", " .", " ,", "?", ":", ";", "%", ")", "(", "/", "<", ">", "- ", " -", "«", "»");$v341be97d9aff90c9978347f66f945b77 = str_replace(">", "> ", $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = str_replace("\"", " ", $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = strip_tags($v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = str_replace($v29a6859860d0f35ec9a976557ce6923c, " ", $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = preg_replace("/([ \t\r\n]{1-100})/u", " ", $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = wa_strtolower($v341be97d9aff90c9978347f66f945b77);$vfa816edb83e95bf0c8da580bdfd491ef = explode(" ", $v341be97d9aff90c9978347f66f945b77);$v9b207167e5381c47682c6b4f58a623fb = Array();foreach ($vfa816edb83e95bf0c8da580bdfd491ef as $v9e3669d19b675bd57058fd4664205d2a) {$v9e3669d19b675bd57058fd4664205d2a = trim($v9e3669d19b675bd57058fd4664205d2a);if (wa_strlen($v9e3669d19b675bd57058fd4664205d2a) <= 2) continue;$v9b207167e5381c47682c6b4f58a623fb[] = $v9e3669d19b675bd57058fd4664205d2a;}return $v9b207167e5381c47682c6b4f58a623fb;}public function updateSearchIndex($v7057e8409c7c531a1a6e9ac3df4ed549, $v9f1c8757350ffe06fffc7cc4b03150af) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true);if (!$v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiEntinty) return false;$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();$v94757cae63fd3e398c0811a976dd6bbe = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_search WHERE rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row(l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true));if(!$v4a8a08f09d37b73795649038408b5f33) {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_search (rel_id, domain_id, lang_id, type_id) VALUES('{$v7057e8409c7c531a1a6e9ac3df4ed549}', '{$v662cbf1253ac7d8750ed9190c52163e5}', '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}', '{$v94757cae63fd3e398c0811a976dd6bbe}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);}$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_search_index WHERE rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_search_index (rel_id, weight, word_id, tf) VALUES ";$v7b8b965ad4bca0e41ab51de7b31363a1 = 0;$vb29c3fd06b2e60bd082b5378410d9171 = array_sum($v9f1c8757350ffe06fffc7cc4b03150af);foreach($v9f1c8757350ffe06fffc7cc4b03150af as $vc47d187067c6cf953245f128b5fde62a => $v7edabf994b76a00cbc60c95af337db8f) {if(($v83ca49d02d735958e354492a19f076b0 = $this->getWordId($vc47d187067c6cf953245f128b5fde62a)) == false) continue;$vc3ee2af7ca7bbe492f11cf36a6a7cea7 = $v7edabf994b76a00cbc60c95af337db8f / $vb29c3fd06b2e60bd082b5378410d9171;$vac5c74b64b4b8352ef2f181affb5ac2a .= "('{$v7057e8409c7c531a1a6e9ac3df4ed549}', '{$v7edabf994b76a00cbc60c95af337db8f}', '{$v83ca49d02d735958e354492a19f076b0}', '{$vc3ee2af7ca7bbe492f11cf36a6a7cea7}'), ";++$v7b8b965ad4bca0e41ab51de7b31363a1;}if($v7b8b965ad4bca0e41ab51de7b31363a1) {$vac5c74b64b4b8352ef2f181affb5ac2a = substr($vac5c74b64b4b8352ef2f181affb5ac2a, 0, wa_strlen($vac5c74b64b4b8352ef2f181affb5ac2a) - 2);l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);}$v07cc694b9b3fc636710fa08b6922c42b = time();$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_search SET indextime = '{$v07cc694b9b3fc636710fa08b6922c42b}' WHERE rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);umiHierarchy::getInstance()->unloadElement($v7057e8409c7c531a1a6e9ac3df4ed549);return true;}public static function getWordId($vc47d187067c6cf953245f128b5fde62a) {$vc47d187067c6cf953245f128b5fde62a = str_replace("037", "", $vc47d187067c6cf953245f128b5fde62a);$vc47d187067c6cf953245f128b5fde62a = trim($vc47d187067c6cf953245f128b5fde62a, "\r\n\t? ;.,!@#$%^&*()_+-=\\/:<>{}[]'\"`~|");$vc47d187067c6cf953245f128b5fde62a = wa_strtolower($vc47d187067c6cf953245f128b5fde62a);if (wa_strlen($vc47d187067c6cf953245f128b5fde62a) < 3) {return false;}$vc47d187067c6cf953245f128b5fde62a = l_mysql_real_escape_string($vc47d187067c6cf953245f128b5fde62a);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_search_index_words WHERE word = '{$vc47d187067c6cf953245f128b5fde62a}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if (list($v83ca49d02d735958e354492a19f076b0) = mysql_fetch_row($result)) {return $v83ca49d02d735958e354492a19f076b0;}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_search_index_words (word) VALUES('{$vc47d187067c6cf953245f128b5fde62a}')";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);return (int) l_mysql_insert_id();}}public function getIndexPages() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT SQL_SMALL_RESULT COUNT(*) FROM cms3_search";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result);return (int) $v4a8a08f09d37b73795649038408b5f33;}public function getAllIndexablePages() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_hierarchy WHERE is_deleted = '0' AND is_active = '1' ORDER BY id LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result);return (int) $v4a8a08f09d37b73795649038408b5f33;}public function getIndexWords() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT SQL_SMALL_RESULT SUM(weight) FROM cms3_search_index";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result);return (int) $v4a8a08f09d37b73795649038408b5f33;}public function getIndexWordsUniq() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT SQL_SMALL_RESULT COUNT(*) FROM cms3_search_index_words";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result);return (int) $v4a8a08f09d37b73795649038408b5f33;}public function getIndexLast() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT SQL_SMALL_RESULT indextime FROM cms3_search ORDER BY indextime DESC LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result);return (int) $v4a8a08f09d37b73795649038408b5f33;}public function truncate_index () {$vac5c74b64b4b8352ef2f181affb5ac2a = "TRUNCATE TABLE cms3_search_index_words";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$vac5c74b64b4b8352ef2f181affb5ac2a = "TRUNCATE TABLE cms3_search_index";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$vac5c74b64b4b8352ef2f181affb5ac2a = "TRUNCATE TABLE cms3_search";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);return true;}public function runSearch($v341be97d9aff90c9978347f66f945b77, $vb934cdf74d9a078a5654bd8b129741d9 = NULL, $v06eba0c81e2c853a3850d7d920570edb = NULL, $vae1d6a6518a73b480c52bcf30553f9f8 = false) {$v2574a7edd9f928bdb2eb29959e4e1797 = $this->splitString($v341be97d9aff90c9978347f66f945b77);$v89759e1284e2479b991d2669de104942 = Array();foreach ($v2574a7edd9f928bdb2eb29959e4e1797 as $vc47d187067c6cf953245f128b5fde62a) {if (wa_strlen($vc47d187067c6cf953245f128b5fde62a) >= 3) {$v89759e1284e2479b991d2669de104942[] = $vc47d187067c6cf953245f128b5fde62a;}}$v6a7f245843454cf4f28ad7c5e2572aa2 = $this->buildQueries($v89759e1284e2479b991d2669de104942, $vb934cdf74d9a078a5654bd8b129741d9, $v06eba0c81e2c853a3850d7d920570edb, $vae1d6a6518a73b480c52bcf30553f9f8);return $v6a7f245843454cf4f28ad7c5e2572aa2;}public function buildQueries($v89759e1284e2479b991d2669de104942, $vb934cdf74d9a078a5654bd8b129741d9 = NULL, $v06eba0c81e2c853a3850d7d920570edb = NULL, $vae1d6a6518a73b480c52bcf30553f9f8 = false) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$v662cbf1253ac7d8750ed9190c52163e5 = cmsController::getInstance()->getCurrentDomain()->getId();$vf363554fffcbe5ed0107628b8a7452ba = mainConfiguration::getInstance()->get('system','search-morph-disabled');$v721023118cca90897209b50c681b3160 = Array();$v4a0dbe074c347d5e9cc1702047836766 = Array();foreach ($v89759e1284e2479b991d2669de104942 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $vc47d187067c6cf953245f128b5fde62a) {if (wa_strlen($vc47d187067c6cf953245f128b5fde62a) < 3) {unset($v89759e1284e2479b991d2669de104942[$v865c0c0b4ab0e063e5caa3387c1a8741]);continue;}$vc47d187067c6cf953245f128b5fde62a = l_mysql_real_escape_string($vc47d187067c6cf953245f128b5fde62a);$vc47d187067c6cf953245f128b5fde62a = str_replace(Array("%", "_"), Array("\\%", "\\_"), $vc47d187067c6cf953245f128b5fde62a);$v1c8b3a3ca57a0beda8c7653fd724183d = "siw.word LIKE '{$vc47d187067c6cf953245f128b5fde62a}%' ";if (!$vf363554fffcbe5ed0107628b8a7452ba)  {$v76f3c2687c1bc668f07f87b8e760cad7 = language_morph::get_word_base($vc47d187067c6cf953245f128b5fde62a);if ((wa_strlen($v76f3c2687c1bc668f07f87b8e760cad7) >= 3) && ($v76f3c2687c1bc668f07f87b8e760cad7 != $vc47d187067c6cf953245f128b5fde62a) ) {$v76f3c2687c1bc668f07f87b8e760cad7 = l_mysql_real_escape_string($v76f3c2687c1bc668f07f87b8e760cad7);$v1c8b3a3ca57a0beda8c7653fd724183d .= " OR siw.word LIKE '{$v76f3c2687c1bc668f07f87b8e760cad7}%'";}}$v721023118cca90897209b50c681b3160[] = "(" . $v1c8b3a3ca57a0beda8c7653fd724183d . ")";$v4a0dbe074c347d5e9cc1702047836766[] = " WHEN (" . $v1c8b3a3ca57a0beda8c7653fd724183d . ") THEN '{$vc47d187067c6cf953245f128b5fde62a}'";}$v03ed04426fc17f79e0b77603ce6c81d3 = implode(" OR ", $v721023118cca90897209b50c681b3160);$vb0beec004a403620a08891be2d959fcd = "(CASE" . implode($v4a0dbe074c347d5e9cc1702047836766) . " END) as search_word";if ($v03ed04426fc17f79e0b77603ce6c81d3 == false) {return Array();}$v538df8a817542c341fb29adc5c5b165d = "";$v7b3d2a2630466b55db035bc4adc620b4 = "";if (!permissionsCollection::getInstance()->isSv()) {$v9bc65c2abec141778ffaa729489f3e87 = cmsController::getInstance()->getModule("users");$ve8701ad48ba05a91604e480dd60899a3 = $v9bc65c2abec141778ffaa729489f3e87->user_id;$vee11cbb19052e40b07aac0ca060c23ee = umiObjectsCollection::getInstance()->getObject($ve8701ad48ba05a91604e480dd60899a3);$v1471e4e05a4db95d353cc867fe317314 = $vee11cbb19052e40b07aac0ca060c23ee->getValue("groups");$v1471e4e05a4db95d353cc867fe317314[] = $ve8701ad48ba05a91604e480dd60899a3;$v1471e4e05a4db95d353cc867fe317314[] = regedit::getInstance()->getVal("//modules/users/guest_id");$v1471e4e05a4db95d353cc867fe317314 = array_extract_values($v1471e4e05a4db95d353cc867fe317314);$v1471e4e05a4db95d353cc867fe317314 = implode(', ', $v1471e4e05a4db95d353cc867fe317314);$v538df8a817542c341fb29adc5c5b165d = " AND c3p.level >= 1 AND c3p.owner_id IN({$v1471e4e05a4db95d353cc867fe317314})";$v7b3d2a2630466b55db035bc4adc620b4 = "INNER JOIN cms3_permissions as  `c3p` ON c3p.rel_id = s.rel_id";}$v6c666917ae648d1e7ec45408bf54efc6 = "";if (is_array($vb934cdf74d9a078a5654bd8b129741d9)) {if (sizeof($vb934cdf74d9a078a5654bd8b129741d9)) {if ($vb934cdf74d9a078a5654bd8b129741d9 && $vb934cdf74d9a078a5654bd8b129741d9[0]) {$v6c666917ae648d1e7ec45408bf54efc6 = " AND s.type_id IN (" . l_mysql_real_escape_string(implode(", ", $vb934cdf74d9a078a5654bd8b129741d9)) . ")";}}}$va9e49c488dc6a07200de31dbd512d69a = "";if (is_array($v06eba0c81e2c853a3850d7d920570edb) && count($v06eba0c81e2c853a3850d7d920570edb)) {$va9e49c488dc6a07200de31dbd512d69a = " AND h.rel IN (" . l_mysql_real_escape_string(implode(", ", $v06eba0c81e2c853a3850d7d920570edb)) . ")";}l_mysql_query("CREATE TEMPORARY TABLE temp_search (rel_id int unsigned, tf float, word varchar(64), search_word varchar(64))");$vac5c74b64b4b8352ef2f181affb5ac2a = <<<EOF
				INSERT INTO temp_search SELECT SQL_SMALL_RESULT HIGH_PRIORITY
					s.rel_id,
					si.weight,
					siw.word,
					$vb0beec004a403620a08891be2d959fcd
				FROM cms3_search_index_words as `siw`
					INNER JOIN cms3_search_index as `si` ON si.word_id = siw.id
					INNER JOIN cms3_search as `s` ON s.rel_id = si.rel_id
					INNER JOIN cms3_hierarchy as  `h` ON h.id = s.rel_id
					{$v7b3d2a2630466b55db035bc4adc620b4}

				WHERE
					({$v03ed04426fc17f79e0b77603ce6c81d3}) AND
					s.domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}' AND
					s.lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND
					h.is_deleted = '0' AND
					h.is_active = '1'
					{$v6c666917ae648d1e7ec45408bf54efc6}
					{$va9e49c488dc6a07200de31dbd512d69a}
					{$v538df8a817542c341fb29adc5c5b165d}
				GROUP BY s.rel_id, si.weight, search_word


EOF;   $v9b207167e5381c47682c6b4f58a623fb = Array();l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($vae1d6a6518a73b480c52bcf30553f9f8) {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT rel_id, SUM(tf) AS x
	FROM temp_search
		GROUP BY rel_id
			ORDER BY x DESC
SQL;   }else {$vdb9d5968645f90092f4b913cf77a9af7 = sizeof($v89759e1284e2479b991d2669de104942);$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT rel_id, SUM(tf) AS x, COUNT(word) AS wc
	FROM temp_search
		GROUP BY rel_id
			HAVING wc >= '{$vdb9d5968645f90092f4b913cf77a9af7}'
				ORDER BY x DESC
SQL;   }$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v7057e8409c7c531a1a6e9ac3df4ed549) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[] = $v7057e8409c7c531a1a6e9ac3df4ed549;}l_mysql_query("DROP TEMPORARY TABLE IF EXISTS temp_search");return $v9b207167e5381c47682c6b4f58a623fb;}public function prepareContext($v7057e8409c7c531a1a6e9ac3df4ed549, $vcc475582f6f7e3f30f5a46236d75b6c5 = false) {if (!($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549))) {return false;}if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getValue("is_unindexed")) return false;$v5c18ef72771564b7f43c497dc507aeab = Array();$v94757cae63fd3e398c0811a976dd6bbe = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getTypeId();$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);$vb308737ea9e2bcc45fd2bf20dc6c7d45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroupsList();foreach($vb308737ea9e2bcc45fd2bf20dc6c7d45 as $v6c26c1979a522c2dd7e76e527aa69ca5 => $v38f582e54454005ec0664831734e1152) {foreach($v38f582e54454005ec0664831734e1152->getFields() as $v3aabf39f2d943fa886d86dcbbee4d910 => $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getIsInSearch() == false) continue;$v73f329f154a663bfda020aadcdd0b775 = $v06e3d36fa30cea095545139854ad1fb9->getName();$v17f71d965fe9589ddbd11caf7182243e = $v06e3d36fa30cea095545139854ad1fb9->getFieldType()->getDataType();$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue($v73f329f154a663bfda020aadcdd0b775);if ($v17f71d965fe9589ddbd11caf7182243e == 'relation') {if (!is_array($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = array($v3a6d0284e743dc4a9b86f97d6dd1a3bf);}foreach ($v3a6d0284e743dc4a9b86f97d6dd1a3bf as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if ($v447b7147e84be512208dcc0995d67ebc = selector::get('object')->id($v9e3669d19b675bd57058fd4664205d2a)) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf[$v865c0c0b4ab0e063e5caa3387c1a8741] = $v447b7147e84be512208dcc0995d67ebc->name;}}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = implode(' ', $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf) || !$v3a6d0284e743dc4a9b86f97d6dd1a3bf) continue;if(is_object($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {continue;}$v5c18ef72771564b7f43c497dc507aeab[] = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}}if ($vcc475582f6f7e3f30f5a46236d75b6c5) {$v5c18ef72771564b7f43c497dc507aeab = array_unique($v5c18ef72771564b7f43c497dc507aeab);}$v9b207167e5381c47682c6b4f58a623fb = "";foreach ($v5c18ef72771564b7f43c497dc507aeab as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if(is_array($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {continue;}$v9b207167e5381c47682c6b4f58a623fb .= $v3a6d0284e743dc4a9b86f97d6dd1a3bf . " ";}$v9b207167e5381c47682c6b4f58a623fb = preg_replace("/%[A-z0-9_]+ [A-z0-9_]+\([^\)]+\)%/im", "", $v9b207167e5381c47682c6b4f58a623fb);$v9b207167e5381c47682c6b4f58a623fb = str_replace("%", "&#037", $v9b207167e5381c47682c6b4f58a623fb);return $v9b207167e5381c47682c6b4f58a623fb;}public function getContext($v7057e8409c7c531a1a6e9ac3df4ed549, $va3dbaf37ab12f39c3cd19c0f04a360a0) {$v9a0364b9e99bb480dd25e1f0284c8555 = $this->prepareContext($v7057e8409c7c531a1a6e9ac3df4ed549, true);$v9a0364b9e99bb480dd25e1f0284c8555 = preg_replace("/%content redirect\((.*)\)%/im", "::CONTENT_REDIRECT::\\1::", $v9a0364b9e99bb480dd25e1f0284c8555);$v9a0364b9e99bb480dd25e1f0284c8555 = preg_replace("/(%|&#037)[A-z0-9]+ [A-z0-9]+\((.*)\)(%|&#037)/im", "", $v9a0364b9e99bb480dd25e1f0284c8555);$v6920626369b1f05844f5e3d6f93b5f6e = "<b>";$v4de1b7a4dc53e4a84c25ffb7cdb580ee = "</b>";$v8836d156dbd01a6c0776b086b0ff3b83 = explode(" ", $va3dbaf37ab12f39c3cd19c0f04a360a0);$v9a0364b9e99bb480dd25e1f0284c8555 = preg_replace("/([A-zА-я0-9])\.([A-zА-я0-9])/im", "\\1&#46;\\2", $v9a0364b9e99bb480dd25e1f0284c8555);$v5c18ef72771564b7f43c497dc507aeab = str_replace(">", "> ", $v9a0364b9e99bb480dd25e1f0284c8555);$v5c18ef72771564b7f43c497dc507aeab = str_replace("<br>", " ", $v5c18ef72771564b7f43c497dc507aeab);$v5c18ef72771564b7f43c497dc507aeab = str_replace("&nbsp;", " ", $v5c18ef72771564b7f43c497dc507aeab);$v5c18ef72771564b7f43c497dc507aeab = str_replace("\n", " ", $v5c18ef72771564b7f43c497dc507aeab);$v5c18ef72771564b7f43c497dc507aeab = strip_tags($v5c18ef72771564b7f43c497dc507aeab);if (preg_match_all("/::CONTENT_REDIRECT::(.*)::/i", $v5c18ef72771564b7f43c497dc507aeab, $v3d801aa532c1cec3ee82d87a99fdf63f)) {$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v3d801aa532c1cec3ee82d87a99fdf63f[1]);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {if (is_numeric($v3d801aa532c1cec3ee82d87a99fdf63f[1][$v865c0c0b4ab0e063e5caa3387c1a8741])) {$v4a0dc59dd475d7fbeadc872e24f24dd0 = cmsController::getInstance()->getModule('content')->get_page_url($v3d801aa532c1cec3ee82d87a99fdf63f[1][$v865c0c0b4ab0e063e5caa3387c1a8741]);$v4a0dc59dd475d7fbeadc872e24f24dd0 = umiHierarchy::getInstance()->getPathById($v3d801aa532c1cec3ee82d87a99fdf63f[1][$v865c0c0b4ab0e063e5caa3387c1a8741]);$v4a0dc59dd475d7fbeadc872e24f24dd0 = trim($v4a0dc59dd475d7fbeadc872e24f24dd0, "'");$v9b207167e5381c47682c6b4f58a623fb = str_replace($v3d801aa532c1cec3ee82d87a99fdf63f[0][$v865c0c0b4ab0e063e5caa3387c1a8741], "<p>%search_redirect_text% \"<a href='$v4a0dc59dd475d7fbeadc872e24f24dd0'>$v4a0dc59dd475d7fbeadc872e24f24dd0</a>\"</p>", $v5c18ef72771564b7f43c497dc507aeab);}else {$v4a0dc59dd475d7fbeadc872e24f24dd0 = strip_tags($v3d801aa532c1cec3ee82d87a99fdf63f[1][$v865c0c0b4ab0e063e5caa3387c1a8741]);$v4a0dc59dd475d7fbeadc872e24f24dd0 = trim($v4a0dc59dd475d7fbeadc872e24f24dd0, "'");$v5c18ef72771564b7f43c497dc507aeab = str_replace($v3d801aa532c1cec3ee82d87a99fdf63f[0][$v865c0c0b4ab0e063e5caa3387c1a8741], "<p>%search_redirect_text% <a href=\"" . $v4a0dc59dd475d7fbeadc872e24f24dd0 . "\">" . $v4a0dc59dd475d7fbeadc872e24f24dd0 . "</a></p>", $v5c18ef72771564b7f43c497dc507aeab);}}}$v5c18ef72771564b7f43c497dc507aeab .= "\n";$vcb114fb1f5594c74601a4d8a142d932d = "";$v980da98409d058c365664ff7ea33dd6b = Array();foreach ($v8836d156dbd01a6c0776b086b0ff3b83 as $v350e6018b5636ab1e90720fed9694ccf) {if (wa_strlen($v350e6018b5636ab1e90720fed9694ccf) <= 1) continue;$v1798c7d9bd5a5d637ead47154f0d36e3 = $v5c18ef72771564b7f43c497dc507aeab;$vf3b462d93b24cb0538f5d864546bc3e0 = language_morph::get_word_base($v350e6018b5636ab1e90720fed9694ccf);$vf3b462d93b24cb0538f5d864546bc3e0 = preg_quote($vf3b462d93b24cb0538f5d864546bc3e0, '/');$vd6f81d33de1672f67ef047aa89b6848b = "/([^\.^\?^!^<^>.]*)$vf3b462d93b24cb0538f5d864546bc3e0([^\.^\?^!^<^>.]*)[!\.\?\n]/imu";$v1dcb47f8fb7fc589f094bc7707d8ffa7 = "/([^ ^[\.[ ]*]^!^\?^\(^\).]*)($vf3b462d93b24cb0538f5d864546bc3e0)([^ ^\.^!^\?^\(^\).]*)/imu";if (preg_match($vd6f81d33de1672f67ef047aa89b6848b, $v1798c7d9bd5a5d637ead47154f0d36e3, $v1798c7d9bd5a5d637ead47154f0d36e3)) {$v980da98409d058c365664ff7ea33dd6b[] = $v1798c7d9bd5a5d637ead47154f0d36e3[0];}}$v980da98409d058c365664ff7ea33dd6b = array_unique($v980da98409d058c365664ff7ea33dd6b);$vcb114fb1f5594c74601a4d8a142d932d = "";foreach ($v980da98409d058c365664ff7ea33dd6b as $v6438c669e0d0de98e6929c2cc0fac474) {foreach ($v8836d156dbd01a6c0776b086b0ff3b83 as $v350e6018b5636ab1e90720fed9694ccf) {$vf3b462d93b24cb0538f5d864546bc3e0 = language_morph::get_word_base($v350e6018b5636ab1e90720fed9694ccf);$vf3b462d93b24cb0538f5d864546bc3e0 = preg_quote($vf3b462d93b24cb0538f5d864546bc3e0, '/');$v1dcb47f8fb7fc589f094bc7707d8ffa7 = "/([^ ^.^!^\?.]*)($vf3b462d93b24cb0538f5d864546bc3e0)([^ ^.^!^\?.]*)/imu";$v6438c669e0d0de98e6929c2cc0fac474 = preg_replace($v1dcb47f8fb7fc589f094bc7707d8ffa7, $v6920626369b1f05844f5e3d6f93b5f6e . "\\1\\2\\3" . $v4de1b7a4dc53e4a84c25ffb7cdb580ee, $v6438c669e0d0de98e6929c2cc0fac474);}if ($v6438c669e0d0de98e6929c2cc0fac474) {$vcb114fb1f5594c74601a4d8a142d932d .= "<p>" . $v6438c669e0d0de98e6929c2cc0fac474 . "</p>";}}if (!$vcb114fb1f5594c74601a4d8a142d932d) {preg_match("/([^\.^!^\?.]*)([\.!\?]*)/im", $v5c18ef72771564b7f43c497dc507aeab, $vcb114fb1f5594c74601a4d8a142d932d);$vcb114fb1f5594c74601a4d8a142d932d = $vcb114fb1f5594c74601a4d8a142d932d[0];$vcb114fb1f5594c74601a4d8a142d932d = "<p></p>";}return $vcb114fb1f5594c74601a4d8a142d932d;}public function unindex_items($v7057e8409c7c531a1a6e9ac3df4ed549) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_search WHERE rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_search_index WHERE rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);return true;}public function index_items($v7057e8409c7c531a1a6e9ac3df4ed549) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$vadce578d04ed03c31f6ac59451fcf8e4 = $vb81ca7c0ccaa77e7aa91936ab0070695->getChilds($v7057e8409c7c531a1a6e9ac3df4ed549, true, true, 99);$v6a7f245843454cf4f28ad7c5e2572aa2 = array($v7057e8409c7c531a1a6e9ac3df4ed549);$this->expandArray($vadce578d04ed03c31f6ac59451fcf8e4, $v6a7f245843454cf4f28ad7c5e2572aa2);foreach($v6a7f245843454cf4f28ad7c5e2572aa2 as $v7057e8409c7c531a1a6e9ac3df4ed549) {$this->index_item($v7057e8409c7c531a1a6e9ac3df4ed549);}}public function calculateIDF($vd1f5ee0092ec47708f200415f2a89717) {static $vf68d7efaad2efd0f8c0c965a34fbe5e1 = false;$vd1f5ee0092ec47708f200415f2a89717 = (int) $vd1f5ee0092ec47708f200415f2a89717;if ($vf68d7efaad2efd0f8c0c965a34fbe5e1 === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_search";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($v8277e0910d750195b448797616e091ad) = mysql_fetch_row($result);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_search_index WHERE word_id = {$vd1f5ee0092ec47708f200415f2a89717}";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($v1aabac6d068eef6a7bad3fdf50a05cc8) = mysql_fetch_row($result);$vf68d7efaad2efd0f8c0c965a34fbe5e1 = log($v8277e0910d750195b448797616e091ad / $v1aabac6d068eef6a7bad3fdf50a05cc8);}return $vf68d7efaad2efd0f8c0c965a34fbe5e1;}public function suggestions($vb45cffe084dd3d20d928bee85e7b0f21, $vaa9f73eea60a006820d0f8768bc8a3fc = 10) {$vb45cffe084dd3d20d928bee85e7b0f21 = trim($vb45cffe084dd3d20d928bee85e7b0f21);if (!$vb45cffe084dd3d20d928bee85e7b0f21) return false;$vb45cffe084dd3d20d928bee85e7b0f21 = wa_strtolower($vb45cffe084dd3d20d928bee85e7b0f21);$va04202c712aa415f47dbacb817a60397 = str_split('йцукенгшщзхъфывапролджэячсмитьбю');$v74e6a8b111ea7da1a7d0a596f4c35208 = str_split('qwertyuiop[]asdfghjkl;\'zxcvbnm,.');$v9c1b200500ea38c658ac7c81b10e85d2 = iconv("UTF-8", "CP1251", $vb45cffe084dd3d20d928bee85e7b0f21);$ve39cf8a95dc90270161317376387b25a = iconv("CP1251", "UTF-8", str_replace($va04202c712aa415f47dbacb817a60397, $v74e6a8b111ea7da1a7d0a596f4c35208, $v9c1b200500ea38c658ac7c81b10e85d2));$v67ae3d093b55e92227d0861222db0c6d = iconv("CP1251", "UTF-8", str_replace($v74e6a8b111ea7da1a7d0a596f4c35208, $va04202c712aa415f47dbacb817a60397, $v9c1b200500ea38c658ac7c81b10e85d2));$vd0c03a4c136b717b6ebc603966e26755 = ($ve39cf8a95dc90270161317376387b25a != $vb45cffe084dd3d20d928bee85e7b0f21) ? $ve39cf8a95dc90270161317376387b25a : $v67ae3d093b55e92227d0861222db0c6d;$vb45cffe084dd3d20d928bee85e7b0f21 = l_mysql_real_escape_string($vb45cffe084dd3d20d928bee85e7b0f21);$vd0c03a4c136b717b6ebc603966e26755 = l_mysql_real_escape_string($vd0c03a4c136b717b6ebc603966e26755);$vaa9f73eea60a006820d0f8768bc8a3fc = (int) $vaa9f73eea60a006820d0f8768bc8a3fc;$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT `siw`.`word` as `word`, COUNT(`si`.`word_id`) AS `cnt`
	FROM
		`cms3_search_index_words` `siw`,
		`cms3_search_index` `si`
	WHERE
		(
			`siw`.`word` LIKE '{$vb45cffe084dd3d20d928bee85e7b0f21}%' OR
			`siw`.`word` LIKE '{$vd0c03a4c136b717b6ebc603966e26755}%'
		) AND
		`si`.`word_id` = `siw`.`id`
	GROUP BY
		`siw`.`id`
	ORDER BY SUM(`si`.`tf`) DESC
	LIMIT {$vaa9f73eea60a006820d0f8768bc8a3fc}
SQL;   $v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection('search');return $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);}private function expandArray($v47c80780ab608cc046f2a6e6f071feb6, &$result) {if (is_null($result)) $result = array();foreach ($v47c80780ab608cc046f2a6e6f071feb6 as $vb80bb7740288fda1f201890375a60c8f => $vadce578d04ed03c31f6ac59451fcf8e4) {$result[] = $vb80bb7740288fda1f201890375a60c8f;$this->expandArray($vadce578d04ed03c31f6ac59451fcf8e4, $result);}}};interface iPermissionsCollection {public function getOwnerType($vb0ab4f7791b60b1e8ea01057b77873b0);public function makeSqlWhere($vb0ab4f7791b60b1e8ea01057b77873b0);public function isAllowedModule($vb0ab4f7791b60b1e8ea01057b77873b0, $v22884db148f0ffb0d830ba431102b0b5);public function isAllowedMethod($vb0ab4f7791b60b1e8ea01057b77873b0, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);public function isAllowedObject($vb0ab4f7791b60b1e8ea01057b77873b0, $v16b2b26000987faccb260b9d39df1269);public function isSv($v8e44f0089b076e18a718eb9ca3d94674 = false);public function isAdmin($v8e44f0089b076e18a718eb9ca3d94674 = false);public function isOwnerOfObject($v16b2b26000987faccb260b9d39df1269, $v8e44f0089b076e18a718eb9ca3d94674 = false);public function resetElementPermissions($v7552cd149af7495ee7d8225974e50f80, $vb0ab4f7791b60b1e8ea01057b77873b0 = false);public function resetModulesPermissions($vb0ab4f7791b60b1e8ea01057b77873b0);public function setElementPermissions($vb0ab4f7791b60b1e8ea01057b77873b0, $v7552cd149af7495ee7d8225974e50f80, $vc9e9a848920877e76685b2e4e76de38d);public function setModulesPermissions($vb0ab4f7791b60b1e8ea01057b77873b0, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce = false);public function setDefaultPermissions($v7552cd149af7495ee7d8225974e50f80);public function hasUserPermissions($vb0ab4f7791b60b1e8ea01057b77873b0);public function copyHierarchyPermissions($vd716f7168cd6371e0d98414d7951f602, $v804b661fe297600e2dbf54048bc56753);public function getUserId();public function setAllElementsDefaultPermissions($vb0ab4f7791b60b1e8ea01057b77873b0);public function getUsersByElementPermissions($v7552cd149af7495ee7d8225974e50f80, $vc9e9a848920877e76685b2e4e76de38d = 1);public function pushElementPermissions($v7552cd149af7495ee7d8225974e50f80, $vc9e9a848920877e76685b2e4e76de38d = 1);public function cleanupBasePermissions();public function isAuth();};class permissionsCollection extends singleton implements iSingleton, iPermissionsCollection {protected $methodsPermissions = array(), $user_id = 0, $tempElementPermissions = array();protected $elementsCache = array();const E_READ_ALLOWED   = 0;const E_EDIT_ALLOWED   = 1;const E_CREATE_ALLOWED = 2;const E_DELETE_ALLOWED = 3;const E_MOVE_ALLOWED   = 4;const E_READ_ALLOWED_BIT   = 1;const E_EDIT_ALLOWED_BIT   = 2;const E_CREATE_ALLOWED_BIT = 4;const E_DELETE_ALLOWED_BIT = 8;const E_MOVE_ALLOWED_BIT   = 16;public function __construct() {if(is_null(getRequest('guest-mode')) == false) {$this->user_id = self::getGuestId();return;}$v9bc65c2abec141778ffaa729489f3e87 = cmsController::getInstance()->getModule("users");if($v9bc65c2abec141778ffaa729489f3e87 instanceof def_module) {$this->user_id = $v9bc65c2abec141778ffaa729489f3e87->user_id;if($this->isAllowedMethod($this->user_id, "content", "sitetree")){$_SESSION['_umi_opaf_disabled_html']=1;}else{$_SESSION['_umi_opaf_disabled_html']=0;}}}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function getOwnerType($v5e7b19364b8de2dedd3aa48cf62706e3) {if($v41064781857b29db62b319b579676852 = umiObjectsCollection::getInstance()->getObject($v5e7b19364b8de2dedd3aa48cf62706e3)) {if($v1471e4e05a4db95d353cc867fe317314 = $v41064781857b29db62b319b579676852->getPropByName("groups")) {return $v1471e4e05a4db95d353cc867fe317314->getValue();}else {return $v5e7b19364b8de2dedd3aa48cf62706e3;}}else {return false;}}public function makeSqlWhere($v5e7b19364b8de2dedd3aa48cf62706e3, $v8a7ee68c0472cf0cf8e3f2cba2134c27 = false) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();if(isset($v0fea6a13c52b4d4725368f24b045ca84[$v5e7b19364b8de2dedd3aa48cf62706e3])) return $v0fea6a13c52b4d4725368f24b045ca84[$v5e7b19364b8de2dedd3aa48cf62706e3];$v72122ce96bfec66e2396d2e25225d70a = $this->getOwnerType($v5e7b19364b8de2dedd3aa48cf62706e3);if(is_numeric($v72122ce96bfec66e2396d2e25225d70a)) {$v72122ce96bfec66e2396d2e25225d70a = array();}if($v5e7b19364b8de2dedd3aa48cf62706e3) {$v72122ce96bfec66e2396d2e25225d70a[] = $v5e7b19364b8de2dedd3aa48cf62706e3;}$v72122ce96bfec66e2396d2e25225d70a[] = self::getGuestId();$v72122ce96bfec66e2396d2e25225d70a = array_unique($v72122ce96bfec66e2396d2e25225d70a);if(sizeof($v72122ce96bfec66e2396d2e25225d70a) > 2) {foreach($v72122ce96bfec66e2396d2e25225d70a as $v865c0c0b4ab0e063e5caa3387c1a8741 => $vb80bb7740288fda1f201890375a60c8f) {if($vb80bb7740288fda1f201890375a60c8f == $v5e7b19364b8de2dedd3aa48cf62706e3 && $v8a7ee68c0472cf0cf8e3f2cba2134c27) {unset($v72122ce96bfec66e2396d2e25225d70a[$v865c0c0b4ab0e063e5caa3387c1a8741]);}}$v72122ce96bfec66e2396d2e25225d70a = array_unique($v72122ce96bfec66e2396d2e25225d70a);sort($v72122ce96bfec66e2396d2e25225d70a);}$vac5c74b64b4b8352ef2f181affb5ac2a = "";$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v72122ce96bfec66e2396d2e25225d70a);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vac5c74b64b4b8352ef2f181affb5ac2a .= "cp.owner_id = '{$v72122ce96bfec66e2396d2e25225d70a[$v865c0c0b4ab0e063e5caa3387c1a8741]}'";if($v865c0c0b4ab0e063e5caa3387c1a8741 < ($v7dabf5c198b0bab2eaa42bb03a113e55 - 1)) {$vac5c74b64b4b8352ef2f181affb5ac2a .= " OR ";}}$vac5c74b64b4b8352ef2f181affb5ac2a = "({$vac5c74b64b4b8352ef2f181affb5ac2a})";return $v0fea6a13c52b4d4725368f24b045ca84[$v5e7b19364b8de2dedd3aa48cf62706e3] = $vac5c74b64b4b8352ef2f181affb5ac2a;}public function isAllowedModule($v5e7b19364b8de2dedd3aa48cf62706e3, $v22884db148f0ffb0d830ba431102b0b5) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();if($v5e7b19364b8de2dedd3aa48cf62706e3 == false) {$v5e7b19364b8de2dedd3aa48cf62706e3 = $this->getUserId();}if($this->isSv($v5e7b19364b8de2dedd3aa48cf62706e3)) return true;if(isset($v0fea6a13c52b4d4725368f24b045ca84[$v5e7b19364b8de2dedd3aa48cf62706e3][$v22884db148f0ffb0d830ba431102b0b5])) {return $v0fea6a13c52b4d4725368f24b045ca84[$v5e7b19364b8de2dedd3aa48cf62706e3][$v22884db148f0ffb0d830ba431102b0b5];}$v7a310d89a58d8189e31d766fb1fb745a = $this->makeSqlWhere($v5e7b19364b8de2dedd3aa48cf62706e3);$v22884db148f0ffb0d830ba431102b0b5 = l_mysql_real_escape_string($v22884db148f0ffb0d830ba431102b0b5);if(substr($v22884db148f0ffb0d830ba431102b0b5, 0, 7) == "macros_") return false;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT module, MAX(cp.allow) FROM cms_permissions cp WHERE method IS NULL AND {$v7a310d89a58d8189e31d766fb1fb745a} GROUP BY module";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v6f8f57715090da2632453988d9a1501b, $vb394126a0e52e75f1e3d535d0fb0d33c) = mysql_fetch_row($result)) {$v0fea6a13c52b4d4725368f24b045ca84[$v5e7b19364b8de2dedd3aa48cf62706e3][$v6f8f57715090da2632453988d9a1501b] = $vb394126a0e52e75f1e3d535d0fb0d33c;}return isset($v0fea6a13c52b4d4725368f24b045ca84[$v5e7b19364b8de2dedd3aa48cf62706e3][$v22884db148f0ffb0d830ba431102b0b5]) ? (bool) $v0fea6a13c52b4d4725368f24b045ca84[$v5e7b19364b8de2dedd3aa48cf62706e3][$v22884db148f0ffb0d830ba431102b0b5] : false;}public function isAllowedMethod($v5e7b19364b8de2dedd3aa48cf62706e3, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $v8a7ee68c0472cf0cf8e3f2cba2134c27 = false) {$v22884db148f0ffb0d830ba431102b0b5 = l_mysql_real_escape_string($v22884db148f0ffb0d830ba431102b0b5);$v5e7b19364b8de2dedd3aa48cf62706e3 = (int) $v5e7b19364b8de2dedd3aa48cf62706e3;if($v22884db148f0ffb0d830ba431102b0b5 == "content" && !strlen($vea9f6aca279138c58f705c8d4cb4b8ce)) return 1;if($v22884db148f0ffb0d830ba431102b0b5 == "config" && $vea9f6aca279138c58f705c8d4cb4b8ce == "menu") return 1;if($v22884db148f0ffb0d830ba431102b0b5 == "eshop" && $vea9f6aca279138c58f705c8d4cb4b8ce == "makeRealDivide") return 1;if($this->isAdmin($v5e7b19364b8de2dedd3aa48cf62706e3)) {if($this->isAdminAllowedMethod($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce)) {return 1;}}if($this->isSv($v5e7b19364b8de2dedd3aa48cf62706e3)) return true;if(!$v22884db148f0ffb0d830ba431102b0b5) return false;$vea9f6aca279138c58f705c8d4cb4b8ce = $this->getBaseMethodName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);$vcb69789460f93042a787f8d250ca26dc = &$this->methodsPermissions;if(!isset($vcb69789460f93042a787f8d250ca26dc[$v5e7b19364b8de2dedd3aa48cf62706e3]) || !is_array($vcb69789460f93042a787f8d250ca26dc[$v5e7b19364b8de2dedd3aa48cf62706e3])) {$vcb69789460f93042a787f8d250ca26dc[$v5e7b19364b8de2dedd3aa48cf62706e3] = array();}$v0fea6a13c52b4d4725368f24b045ca84 = &$vcb69789460f93042a787f8d250ca26dc[$v5e7b19364b8de2dedd3aa48cf62706e3];$v7a310d89a58d8189e31d766fb1fb745a = $this->makeSqlWhere($v5e7b19364b8de2dedd3aa48cf62706e3, $v8a7ee68c0472cf0cf8e3f2cba2134c27);if($v22884db148f0ffb0d830ba431102b0b5 == "backup" && $vea9f6aca279138c58f705c8d4cb4b8ce == "rollback") return true;if($v22884db148f0ffb0d830ba431102b0b5 == "autoupdate" && $vea9f6aca279138c58f705c8d4cb4b8ce == "service") return true;if($v22884db148f0ffb0d830ba431102b0b5 == "config" && ($vea9f6aca279138c58f705c8d4cb4b8ce == "lang_list" || $vea9f6aca279138c58f705c8d4cb4b8ce == "lang_phrases")) return true;if($v22884db148f0ffb0d830ba431102b0b5 == "users" && ($vea9f6aca279138c58f705c8d4cb4b8ce == "auth" || $vea9f6aca279138c58f705c8d4cb4b8ce == "login_do" || $vea9f6aca279138c58f705c8d4cb4b8ce == "login")) return true;$v0a42907b589a309ad94f8874eacbc63f = $v22884db148f0ffb0d830ba431102b0b5;if(!array_key_exists($v0a42907b589a309ad94f8874eacbc63f, $v0fea6a13c52b4d4725368f24b045ca84)) {$v248064bbf6355f96570c9a17b0b1f781 = cacheFrontend::getInstance()->loadData('module_perms_' . $v5e7b19364b8de2dedd3aa48cf62706e3 . '_' . $v0a42907b589a309ad94f8874eacbc63f);if(is_array($v248064bbf6355f96570c9a17b0b1f781)) {$v0fea6a13c52b4d4725368f24b045ca84[$v22884db148f0ffb0d830ba431102b0b5] = $v248064bbf6355f96570c9a17b0b1f781;}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT cp.method, MAX(cp.allow) FROM cms_permissions cp WHERE module = '{$v22884db148f0ffb0d830ba431102b0b5}' AND {$v7a310d89a58d8189e31d766fb1fb745a} GROUP BY module, method";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v0fea6a13c52b4d4725368f24b045ca84[$v22884db148f0ffb0d830ba431102b0b5] = array();while(list($v05dd82e678780573a4af462d35d7f06d) = mysql_fetch_row($result)) {$v0fea6a13c52b4d4725368f24b045ca84[$v0a42907b589a309ad94f8874eacbc63f][] = $v05dd82e678780573a4af462d35d7f06d;}cacheFrontend::getInstance()->saveData('module_perms_' . $v5e7b19364b8de2dedd3aa48cf62706e3 . '_' . $v0a42907b589a309ad94f8874eacbc63f, $v0fea6a13c52b4d4725368f24b045ca84[$v22884db148f0ffb0d830ba431102b0b5], 3600);}}if (in_array($vea9f6aca279138c58f705c8d4cb4b8ce, $v0fea6a13c52b4d4725368f24b045ca84[$v0a42907b589a309ad94f8874eacbc63f]) || in_array(strtolower($vea9f6aca279138c58f705c8d4cb4b8ce), $v0fea6a13c52b4d4725368f24b045ca84[$v0a42907b589a309ad94f8874eacbc63f])) {return true;}else {return false;}}public function isAllowedObject($v5e7b19364b8de2dedd3aa48cf62706e3, $vaf31437ce61345f416579830a98c91e5, $vbd354405a20aa635025421c9edb5d41d = false) {$vaf31437ce61345f416579830a98c91e5 = (int) $vaf31437ce61345f416579830a98c91e5;if($vaf31437ce61345f416579830a98c91e5 == 0) return array(false, false, false, false, false);if($this->isSv($v5e7b19364b8de2dedd3aa48cf62706e3)) {return array(true, true, true, true, true);}if(array_key_exists($vaf31437ce61345f416579830a98c91e5, $this->tempElementPermissions)) {$vc9e9a848920877e76685b2e4e76de38d = $this->tempElementPermissions[$vaf31437ce61345f416579830a98c91e5];return array((bool)($vc9e9a848920877e76685b2e4e76de38d&1), (bool)($vc9e9a848920877e76685b2e4e76de38d&2), (bool)($vc9e9a848920877e76685b2e4e76de38d&4), (bool)($vc9e9a848920877e76685b2e4e76de38d&8), (bool)($vc9e9a848920877e76685b2e4e76de38d&16) );}$v0fea6a13c52b4d4725368f24b045ca84 = &$this->elementsCache;if(!$vbd354405a20aa635025421c9edb5d41d && isset($v0fea6a13c52b4d4725368f24b045ca84[$vaf31437ce61345f416579830a98c91e5]) && isset($v0fea6a13c52b4d4725368f24b045ca84[$vaf31437ce61345f416579830a98c91e5][$v5e7b19364b8de2dedd3aa48cf62706e3])) {return $v0fea6a13c52b4d4725368f24b045ca84[$vaf31437ce61345f416579830a98c91e5][$v5e7b19364b8de2dedd3aa48cf62706e3];}$v7a310d89a58d8189e31d766fb1fb745a = $this->makeSqlWhere($v5e7b19364b8de2dedd3aa48cf62706e3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT BIT_OR(cp.level) FROM cms3_permissions cp WHERE rel_id = '{$vaf31437ce61345f416579830a98c91e5}' AND {$v7a310d89a58d8189e31d766fb1fb745a}";$vc9e9a848920877e76685b2e4e76de38d = false;cacheFrontend::getInstance()->loadSql($vac5c74b64b4b8352ef2f181affb5ac2a);if(!$vc9e9a848920877e76685b2e4e76de38d || $vbd354405a20aa635025421c9edb5d41d) {$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($vc9e9a848920877e76685b2e4e76de38d) = mysql_fetch_row($result);$vc9e9a848920877e76685b2e4e76de38d = array((bool)($vc9e9a848920877e76685b2e4e76de38d&1), (bool)($vc9e9a848920877e76685b2e4e76de38d&2), (bool)($vc9e9a848920877e76685b2e4e76de38d&4), (bool)($vc9e9a848920877e76685b2e4e76de38d&8), (bool)($vc9e9a848920877e76685b2e4e76de38d&16) );}if($vc9e9a848920877e76685b2e4e76de38d) {cacheFrontend::getInstance()->saveSql($vac5c74b64b4b8352ef2f181affb5ac2a, $vc9e9a848920877e76685b2e4e76de38d, 600);}if(!isset($v0fea6a13c52b4d4725368f24b045ca84[$vaf31437ce61345f416579830a98c91e5])) $v0fea6a13c52b4d4725368f24b045ca84[$vaf31437ce61345f416579830a98c91e5] = array();$v0fea6a13c52b4d4725368f24b045ca84[$vaf31437ce61345f416579830a98c91e5][$v5e7b19364b8de2dedd3aa48cf62706e3] = $vc9e9a848920877e76685b2e4e76de38d;return $vc9e9a848920877e76685b2e4e76de38d;}public function isSv($ve8701ad48ba05a91604e480dd60899a3 = false) {static $v1b747442de0fb075fcdc59af978fa41b = array();if($ve8701ad48ba05a91604e480dd60899a3 === false) {$ve8701ad48ba05a91604e480dd60899a3 = $this->getUserId();}if(isset($v1b747442de0fb075fcdc59af978fa41b[$ve8701ad48ba05a91604e480dd60899a3])) {return $v1b747442de0fb075fcdc59af978fa41b[$ve8701ad48ba05a91604e480dd60899a3];}if(is_null(getRequest('guest-mode')) == false) {return $v1b747442de0fb075fcdc59af978fa41b[$ve8701ad48ba05a91604e480dd60899a3] = false;}$v46e34ffe2f2112ff0633f37597e600b2 = umiObjectsCollection::getInstance()->getObjectIdByGUID('users-users-15');if($vee11cbb19052e40b07aac0ca060c23ee = umiObjectsCollection::getInstance()->getObject($ve8701ad48ba05a91604e480dd60899a3)) {$va1ca70124e53a4f2847d6d1c34844be4 = $vee11cbb19052e40b07aac0ca060c23ee->getValue('groups');if((is_array($va1ca70124e53a4f2847d6d1c34844be4) && in_array($v46e34ffe2f2112ff0633f37597e600b2, $va1ca70124e53a4f2847d6d1c34844be4)) || $ve8701ad48ba05a91604e480dd60899a3 == $v46e34ffe2f2112ff0633f37597e600b2) {return $v1b747442de0fb075fcdc59af978fa41b[$ve8701ad48ba05a91604e480dd60899a3] = true;}}return $v1b747442de0fb075fcdc59af978fa41b[$ve8701ad48ba05a91604e480dd60899a3] = false;}public function isAdmin($ve8701ad48ba05a91604e480dd60899a3 = false, $vece42746c2b3aa1e585809fa739602ae = false) {static $vc60879c6b41321704ee88fbc7b9a73e4 = array();if($ve8701ad48ba05a91604e480dd60899a3 === false) $ve8701ad48ba05a91604e480dd60899a3 = $this->getUserId();if(isset($vc60879c6b41321704ee88fbc7b9a73e4[$ve8701ad48ba05a91604e480dd60899a3])) return $vc60879c6b41321704ee88fbc7b9a73e4[$ve8701ad48ba05a91604e480dd60899a3];if($this->isSv($ve8701ad48ba05a91604e480dd60899a3)) return $vc60879c6b41321704ee88fbc7b9a73e4[$ve8701ad48ba05a91604e480dd60899a3] = true;if(!$vece42746c2b3aa1e585809fa739602ae && is_array(getSession('is_admin'))) {$vc60879c6b41321704ee88fbc7b9a73e4 = getSession('is_admin');if(isset($vc60879c6b41321704ee88fbc7b9a73e4[$ve8701ad48ba05a91604e480dd60899a3])) return $vc60879c6b41321704ee88fbc7b9a73e4[$ve8701ad48ba05a91604e480dd60899a3];}$v7a310d89a58d8189e31d766fb1fb745a = $this->makeSqlWhere($ve8701ad48ba05a91604e480dd60899a3);$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT COUNT(cp.allow)
	FROM cms_permissions cp
	WHERE method IS NULL AND {$v7a310d89a58d8189e31d766fb1fb745a} AND cp.allow IN (1, 2) GROUP BY module
SQL;   $result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($v2817f701d5e1a1181e657251363295fd) = mysql_fetch_row($result);$vc60879c6b41321704ee88fbc7b9a73e4[$ve8701ad48ba05a91604e480dd60899a3] = (bool) $v2817f701d5e1a1181e657251363295fd;$_SESSION['is_admin'] = $vc60879c6b41321704ee88fbc7b9a73e4;return $vc60879c6b41321704ee88fbc7b9a73e4[$ve8701ad48ba05a91604e480dd60899a3];}public function isOwnerOfObject($vaf31437ce61345f416579830a98c91e5, $ve8701ad48ba05a91604e480dd60899a3 = false) {if($ve8701ad48ba05a91604e480dd60899a3 == false) {$ve8701ad48ba05a91604e480dd60899a3 = $this->getUserId();}if($ve8701ad48ba05a91604e480dd60899a3 == $vaf31437ce61345f416579830a98c91e5) {return true;}else {$va8cfde6331bd59eb2ac96f8911c4b666 = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) {$v5e7b19364b8de2dedd3aa48cf62706e3 = $va8cfde6331bd59eb2ac96f8911c4b666->getOwnerId();}else {$v5e7b19364b8de2dedd3aa48cf62706e3 = false;}if($v5e7b19364b8de2dedd3aa48cf62706e3 === false || $v5e7b19364b8de2dedd3aa48cf62706e3 == $ve8701ad48ba05a91604e480dd60899a3) {return true;}else {$v92ad7554e2e0d208f33729db6d54b59b = umiObjectsCollection::getInstance()->getObjectIdByGUID('system-guest');if($v5e7b19364b8de2dedd3aa48cf62706e3 == $v92ad7554e2e0d208f33729db6d54b59b && class_exists('customer')) {$v91ec1f9324753048c0096d036a694f86 = customer::get();if($v91ec1f9324753048c0096d036a694f86 && ($v91ec1f9324753048c0096d036a694f86->id == $v5e7b19364b8de2dedd3aa48cf62706e3)) {return true;}}return false;}}}public function setDefaultPermissions($v7057e8409c7c531a1a6e9ac3df4ed549) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;if(!umiHierarchy::getInstance()->isExists($v7057e8409c7c531a1a6e9ac3df4ed549)) {return false;}l_mysql_query("START TRANSACTION");$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_permissions WHERE rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true, true);$v0715f6d9497f93911417c9c324265771 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId();$vb946c44d711ade3b061653732977d043 = umiHierarchyTypesCollection::getInstance()->getType($v0715f6d9497f93911417c9c324265771);$v22884db148f0ffb0d830ba431102b0b5 = $vb946c44d711ade3b061653732977d043->getName();$vea9f6aca279138c58f705c8d4cb4b8ce = $vb946c44d711ade3b061653732977d043->getExt();$v94757cae63fd3e398c0811a976dd6bbe = umiObjectTypesCollection::getInstance()->getBaseType("users", "user");$v8be74552df93e31bbdd6b36ed74bdb6a = new umiSelection;$v8be74552df93e31bbdd6b36ed74bdb6a->setObjectTypeFilter();$v8be74552df93e31bbdd6b36ed74bdb6a->addObjectType($v94757cae63fd3e398c0811a976dd6bbe);$v31b536969506cd993ffe6c80f210b435 = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe)->getFieldId("groups");$v8be74552df93e31bbdd6b36ed74bdb6a->setPropertyFilter();$v8be74552df93e31bbdd6b36ed74bdb6a->addPropertyFilterIsNull($v31b536969506cd993ffe6c80f210b435);$v9bc65c2abec141778ffaa729489f3e87 = umiSelectionsParser::runSelection($v8be74552df93e31bbdd6b36ed74bdb6a);$v87306dd4235ed712ebc07fe169b76f83 = umiObjectTypesCollection::getInstance()->getBaseType("users", "users");$v8be74552df93e31bbdd6b36ed74bdb6a = new umiSelection;$v8be74552df93e31bbdd6b36ed74bdb6a->setObjectTypeFilter();$v8be74552df93e31bbdd6b36ed74bdb6a->addObjectType($v87306dd4235ed712ebc07fe169b76f83);$v1471e4e05a4db95d353cc867fe317314 = umiSelectionsParser::runSelection($v8be74552df93e31bbdd6b36ed74bdb6a);$v5891da2d64975cae48d175d1e001f5da = array_merge($v9bc65c2abec141778ffaa729489f3e87, $v1471e4e05a4db95d353cc867fe317314);$v5e7b19364b8de2dedd3aa48cf62706e3 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getOwnerId();if($v72122ce96bfec66e2396d2e25225d70a = umiObjectsCollection::getInstance()->getObject($v5e7b19364b8de2dedd3aa48cf62706e3)) {if($va8ba6ec990d9c7eeadb629f342dbab1e = $v72122ce96bfec66e2396d2e25225d70a->getValue("groups")) {$vd7be1bb48db472fbda8dbc2e05e98083 = $va8ba6ec990d9c7eeadb629f342dbab1e;}else {$vd7be1bb48db472fbda8dbc2e05e98083 = array($v5e7b19364b8de2dedd3aa48cf62706e3);}}else {$vd7be1bb48db472fbda8dbc2e05e98083 = array();}foreach($v5891da2d64975cae48d175d1e001f5da as $v8a0462e9b477e23253ef0cd29b0e7ab7) {if($v8a0462e9b477e23253ef0cd29b0e7ab7 == SV_GROUP_ID) continue;if($v22884db148f0ffb0d830ba431102b0b5 == "content") $vea9f6aca279138c58f705c8d4cb4b8ce == "page";if($this->isAllowedMethod($v8a0462e9b477e23253ef0cd29b0e7ab7, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce)) {if(in_array($v8a0462e9b477e23253ef0cd29b0e7ab7, $vd7be1bb48db472fbda8dbc2e05e98083) || $v8a0462e9b477e23253ef0cd29b0e7ab7 == SV_GROUP_ID || $this->isAllowedMethod($v8a0462e9b477e23253ef0cd29b0e7ab7, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce . ".edit")) {$vc9e9a848920877e76685b2e4e76de38d = permissionsCollection::E_READ_ALLOWED_BIT +         permissionsCollection::E_EDIT_ALLOWED_BIT +         permissionsCollection::E_CREATE_ALLOWED_BIT +         permissionsCollection::E_DELETE_ALLOWED_BIT +         permissionsCollection::E_MOVE_ALLOWED_BIT;}else {$vc9e9a848920877e76685b2e4e76de38d = permissionsCollection::E_READ_ALLOWED_BIT;}$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_permissions (rel_id, owner_id, level) VALUES('{$v7057e8409c7c531a1a6e9ac3df4ed549}', '{$v8a0462e9b477e23253ef0cd29b0e7ab7}', '{$vc9e9a848920877e76685b2e4e76de38d}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}}l_mysql_query("COMMIT");l_mysql_query("SET AUTOCOMMIT=1");$this->cleanupElementPermissions($v7057e8409c7c531a1a6e9ac3df4ed549);if(isset($this->elementsCache[$v7057e8409c7c531a1a6e9ac3df4ed549])) unset($this->elementsCache[$v7057e8409c7c531a1a6e9ac3df4ed549]);$v0a42907b589a309ad94f8874eacbc63f = $this->getUserId() . "." . $v7057e8409c7c531a1a6e9ac3df4ed549;cacheFrontend::getInstance()->saveSql($v0a42907b589a309ad94f8874eacbc63f, array(true, true));}public function setInheritedPermissions($v7552cd149af7495ee7d8225974e50f80) {$v7552cd149af7495ee7d8225974e50f80 = (int) $v7552cd149af7495ee7d8225974e50f80;$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$vbfa030fe63bacd523dd70a76cfaed98a = false;if($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80, true)) {$vbfa030fe63bacd523dd70a76cfaed98a = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();}if($vbfa030fe63bacd523dd70a76cfaed98a) {$v6e52c40bb8fc91ff39ee5c79b4211f67 = $this->getRecordedPermissions($vbfa030fe63bacd523dd70a76cfaed98a);$vf09cc7ee3a9a93273f4b80601cafb00c  = array();foreach($v6e52c40bb8fc91ff39ee5c79b4211f67 as $vb0ab4f7791b60b1e8ea01057b77873b0 => $vc9e9a848920877e76685b2e4e76de38d) {$vf09cc7ee3a9a93273f4b80601cafb00c[] = "('{$v7552cd149af7495ee7d8225974e50f80}', '{$vb0ab4f7791b60b1e8ea01057b77873b0}', '{$vc9e9a848920877e76685b2e4e76de38d}')";}if(empty($vf09cc7ee3a9a93273f4b80601cafb00c)) return;l_mysql_query("START TRANSACTION");$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_permissions WHERE rel_id = '{$v7552cd149af7495ee7d8225974e50f80}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_permissions (rel_id, owner_id, level) VALUES ".implode(", ", $vf09cc7ee3a9a93273f4b80601cafb00c);l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);l_mysql_query("COMMIT");l_mysql_query("SET AUTOCOMMIT=1");return true;}else {return $this->setDefaultPermissions($v7552cd149af7495ee7d8225974e50f80);}}public function resetElementPermissions($v7552cd149af7495ee7d8225974e50f80, $vb0ab4f7791b60b1e8ea01057b77873b0 = false) {$v7552cd149af7495ee7d8225974e50f80 = (int) $v7552cd149af7495ee7d8225974e50f80;if($vb0ab4f7791b60b1e8ea01057b77873b0 === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_permissions WHERE rel_id = '{$v7552cd149af7495ee7d8225974e50f80}'";if(isset($this->elementsCache[$v7552cd149af7495ee7d8225974e50f80]))     unset($this->elementsCache[$v7552cd149af7495ee7d8225974e50f80]);}else {$vb0ab4f7791b60b1e8ea01057b77873b0 = (int) $vb0ab4f7791b60b1e8ea01057b77873b0;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_permissions WHERE owner_id = '{$vb0ab4f7791b60b1e8ea01057b77873b0}' AND rel_id = '{$v7552cd149af7495ee7d8225974e50f80}'";if(isset($this->elementsCache[$v7552cd149af7495ee7d8225974e50f80]) && isset($this->elementsCache[$v7552cd149af7495ee7d8225974e50f80][$vb0ab4f7791b60b1e8ea01057b77873b0]) )     unset($this->elementsCache[$v7552cd149af7495ee7d8225974e50f80][$vb0ab4f7791b60b1e8ea01057b77873b0]);}l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function resetModulesPermissions($vb0ab4f7791b60b1e8ea01057b77873b0, $v0eb9b3af2e4a00837a1b1a854c9ea18c = NULL) {$vb0ab4f7791b60b1e8ea01057b77873b0 = (int) $vb0ab4f7791b60b1e8ea01057b77873b0;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms_permissions WHERE owner_id = '{$vb0ab4f7791b60b1e8ea01057b77873b0}'";if(is_array($v0eb9b3af2e4a00837a1b1a854c9ea18c)) {if(sizeof($v0eb9b3af2e4a00837a1b1a854c9ea18c)) {$v0eb9b3af2e4a00837a1b1a854c9ea18c = array_map('l_mysql_real_escape_string', $v0eb9b3af2e4a00837a1b1a854c9ea18c);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms_permissions WHERE owner_id = '{$vb0ab4f7791b60b1e8ea01057b77873b0}' AND module IN ('" . implode("', '", $v0eb9b3af2e4a00837a1b1a854c9ea18c) . "')";}}l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();foreach($v0eb9b3af2e4a00837a1b1a854c9ea18c as $v22884db148f0ffb0d830ba431102b0b5) {$vb99eb979e6f6efabc396f777b503f7e7->deleteKey('module_perms_' . $vb0ab4f7791b60b1e8ea01057b77873b0 . '_' . $v22884db148f0ffb0d830ba431102b0b5, true);}return true;}public function setElementPermissions($vb0ab4f7791b60b1e8ea01057b77873b0, $v7552cd149af7495ee7d8225974e50f80, $vc9e9a848920877e76685b2e4e76de38d) {$vb0ab4f7791b60b1e8ea01057b77873b0 = (int) $vb0ab4f7791b60b1e8ea01057b77873b0;$v7552cd149af7495ee7d8225974e50f80 = (int) $v7552cd149af7495ee7d8225974e50f80;$vc9e9a848920877e76685b2e4e76de38d = (int) $vc9e9a848920877e76685b2e4e76de38d;if($v7552cd149af7495ee7d8225974e50f80 == 0 || $vb0ab4f7791b60b1e8ea01057b77873b0 == 0) {return false;}if(isset($this->elementsCache[$v7552cd149af7495ee7d8225974e50f80]) && isset($this->elementsCache[$v7552cd149af7495ee7d8225974e50f80][$vb0ab4f7791b60b1e8ea01057b77873b0])) {unset($this->elementsCache[$v7552cd149af7495ee7d8225974e50f80][$vb0ab4f7791b60b1e8ea01057b77873b0]);}$v6a7f46dad32f8b8b17febd2ac9dca521 = "DELETE FROM cms3_permissions WHERE owner_id = '".$vb0ab4f7791b60b1e8ea01057b77873b0."' AND rel_id = '".$v7552cd149af7495ee7d8225974e50f80."'";l_mysql_query($v6a7f46dad32f8b8b17febd2ac9dca521);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_permissions (owner_id, rel_id, level) VALUES('{$vb0ab4f7791b60b1e8ea01057b77873b0}', '{$v7552cd149af7495ee7d8225974e50f80}', '{$vc9e9a848920877e76685b2e4e76de38d}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$this->cleanupElementPermissions($v7552cd149af7495ee7d8225974e50f80);$this->isAllowedObject($vb0ab4f7791b60b1e8ea01057b77873b0, $v7552cd149af7495ee7d8225974e50f80, true);return true;}public function setModulesPermissions($vb0ab4f7791b60b1e8ea01057b77873b0, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce = false, $v75a2a330879d5ddd5512ff17851f0061 = true) {$vb0ab4f7791b60b1e8ea01057b77873b0 = (int) $vb0ab4f7791b60b1e8ea01057b77873b0;$v22884db148f0ffb0d830ba431102b0b5 = l_mysql_real_escape_string($v22884db148f0ffb0d830ba431102b0b5);if($vea9f6aca279138c58f705c8d4cb4b8ce !== false) {return $this->setMethodPermissions($vb0ab4f7791b60b1e8ea01057b77873b0, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms_permissions (owner_id, module, method, allow) VALUES('{$vb0ab4f7791b60b1e8ea01057b77873b0}', '{$v22884db148f0ffb0d830ba431102b0b5}', NULL, '1')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v75a2a330879d5ddd5512ff17851f0061) $this->cleanupBasePermissions();return true;}}protected function setMethodPermissions($vb0ab4f7791b60b1e8ea01057b77873b0, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $v75a2a330879d5ddd5512ff17851f0061 = true) {$vea9f6aca279138c58f705c8d4cb4b8ce = l_mysql_real_escape_string($vea9f6aca279138c58f705c8d4cb4b8ce);$v22884db148f0ffb0d830ba431102b0b5 = l_mysql_real_escape_string($v22884db148f0ffb0d830ba431102b0b5);$vb0ab4f7791b60b1e8ea01057b77873b0 = (int) $vb0ab4f7791b60b1e8ea01057b77873b0;$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms_permissions (owner_id, module, method, allow) VALUES('{$vb0ab4f7791b60b1e8ea01057b77873b0}', '{$v22884db148f0ffb0d830ba431102b0b5}', '{$vea9f6aca279138c58f705c8d4cb4b8ce}', '1')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$this->methodsPermissions[$vb0ab4f7791b60b1e8ea01057b77873b0][$v22884db148f0ffb0d830ba431102b0b5][] = $vea9f6aca279138c58f705c8d4cb4b8ce;if($v75a2a330879d5ddd5512ff17851f0061) $this->cleanupBasePermissions();return true;}public function hasUserPermissions($vb0ab4f7791b60b1e8ea01057b77873b0) {$vb0ab4f7791b60b1e8ea01057b77873b0 = (int) $vb0ab4f7791b60b1e8ea01057b77873b0;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_permissions WHERE owner_id = '{$vb0ab4f7791b60b1e8ea01057b77873b0}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($v2817f701d5e1a1181e657251363295fd) = mysql_fetch_row($result);return $v2817f701d5e1a1181e657251363295fd;}public function copyHierarchyPermissions($v1fa96cda79d6a13e7abbc85448084fcf, $v3504006854d4e51b5c97e94f19baba29) {if($v1fa96cda79d6a13e7abbc85448084fcf == self::getGuestId()) {return false;}$v1fa96cda79d6a13e7abbc85448084fcf = (int) $v1fa96cda79d6a13e7abbc85448084fcf;$v3504006854d4e51b5c97e94f19baba29 = (int) $v3504006854d4e51b5c97e94f19baba29;$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_permissions (level, rel_id, owner_id) SELECT level, rel_id, '{$v3504006854d4e51b5c97e94f19baba29}' FROM cms3_permissions WHERE owner_id = '{$v1fa96cda79d6a13e7abbc85448084fcf}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getStaticPermissions($v22884db148f0ffb0d830ba431102b0b5, $v640eac53ad75db5c49a9ec86390d8530 = false) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();if (isset($v0fea6a13c52b4d4725368f24b045ca84[$v22884db148f0ffb0d830ba431102b0b5]) && !$v640eac53ad75db5c49a9ec86390d8530) {return $v0fea6a13c52b4d4725368f24b045ca84[$v22884db148f0ffb0d830ba431102b0b5];}$v8e0891fe51dd9fe334c902144be6bd90 = CURRENT_WORKING_DIR . "/classes/modules/" . $v22884db148f0ffb0d830ba431102b0b5 . "/permissions.php";if(file_exists($v8e0891fe51dd9fe334c902144be6bd90)) {require $v8e0891fe51dd9fe334c902144be6bd90;if(isset($v41275a535677f79ff347e01bc530c176)) {$v31bdd6780dad16b675b3e57ffb3f2272 = $v41275a535677f79ff347e01bc530c176;$v9645b439bd2d770beb425162e180d91c = CURRENT_WORKING_DIR . "/classes/modules/" . $v22884db148f0ffb0d830ba431102b0b5 . "/permissions.custom.php";if(file_exists($v9645b439bd2d770beb425162e180d91c)) {unset($v41275a535677f79ff347e01bc530c176);require $v9645b439bd2d770beb425162e180d91c;if(isset($v41275a535677f79ff347e01bc530c176)) {$v31bdd6780dad16b675b3e57ffb3f2272 = array_merge_recursive($v31bdd6780dad16b675b3e57ffb3f2272, $v41275a535677f79ff347e01bc530c176);}}if ($v6829cdfdefd69b947abedd8fa2c4bcc7 = cmsController::getInstance()->getResourcesDirectory()) {$v9645b439bd2d770beb425162e180d91c = $v6829cdfdefd69b947abedd8fa2c4bcc7 . '/classes/modules/' . $v22884db148f0ffb0d830ba431102b0b5 . "/permissions.php";if (file_exists($v9645b439bd2d770beb425162e180d91c)) {unset($v41275a535677f79ff347e01bc530c176);require $v9645b439bd2d770beb425162e180d91c;if(isset($v41275a535677f79ff347e01bc530c176)) {$v31bdd6780dad16b675b3e57ffb3f2272 = array_merge_recursive($v31bdd6780dad16b675b3e57ffb3f2272, $v41275a535677f79ff347e01bc530c176);}}}$v0fea6a13c52b4d4725368f24b045ca84[$v22884db148f0ffb0d830ba431102b0b5] = $v31bdd6780dad16b675b3e57ffb3f2272;unset($v31bdd6780dad16b675b3e57ffb3f2272);unset($v41275a535677f79ff347e01bc530c176);}else $v0fea6a13c52b4d4725368f24b045ca84[$v22884db148f0ffb0d830ba431102b0b5] = array();}else $v0fea6a13c52b4d4725368f24b045ca84[$v22884db148f0ffb0d830ba431102b0b5] = array();return $v0fea6a13c52b4d4725368f24b045ca84[$v22884db148f0ffb0d830ba431102b0b5];}protected function getBaseMethodName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce) {$va9ac5a6cc3cbe84f9c18323af2b9007f = $this->getStaticPermissions($v22884db148f0ffb0d830ba431102b0b5);if($vea9f6aca279138c58f705c8d4cb4b8ce && is_array($va9ac5a6cc3cbe84f9c18323af2b9007f)) {if(array_key_exists($vea9f6aca279138c58f705c8d4cb4b8ce, $va9ac5a6cc3cbe84f9c18323af2b9007f)) {return $vea9f6aca279138c58f705c8d4cb4b8ce;}else {foreach($va9ac5a6cc3cbe84f9c18323af2b9007f as $va85c62c99bf80aeffb74914fb56a1942 => $v568356dafd7353c803edafa5eb5d438f) {if(is_array($v568356dafd7353c803edafa5eb5d438f)) {if(in_array($vea9f6aca279138c58f705c8d4cb4b8ce, $v568356dafd7353c803edafa5eb5d438f) || in_array(strtolower($vea9f6aca279138c58f705c8d4cb4b8ce), $v568356dafd7353c803edafa5eb5d438f)) {return $va85c62c99bf80aeffb74914fb56a1942;}}}return $vea9f6aca279138c58f705c8d4cb4b8ce;}}else {return $vea9f6aca279138c58f705c8d4cb4b8ce;}}public function getUserId() {return $this->user_id;}public function cleanupBasePermissions() {$v92ad7554e2e0d208f33729db6d54b59b = self::getGuestId();$vac5c74b64b4b8352ef2f181affb5ac2a    = "SELECT module, method FROM cms_permissions WHERE owner_id = '{$v92ad7554e2e0d208f33729db6d54b59b}' AND allow = 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = array();while(list($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce) = mysql_fetch_row($result)) {if($vea9f6aca279138c58f705c8d4cb4b8ce) {$vac5c74b64b4b8352ef2f181affb5ac2a[] = "(module = '{$v22884db148f0ffb0d830ba431102b0b5}' AND method = '{$vea9f6aca279138c58f705c8d4cb4b8ce}')";}else {$vac5c74b64b4b8352ef2f181affb5ac2a[] = "(module = '{$v22884db148f0ffb0d830ba431102b0b5}' AND method IS NULL)";}}if(!empty($vac5c74b64b4b8352ef2f181affb5ac2a))    l_mysql_query("DELETE FROM cms_permissions WHERE owner_id != '{$v92ad7554e2e0d208f33729db6d54b59b}' AND (" . implode(' OR ', $vac5c74b64b4b8352ef2f181affb5ac2a) . ")");}protected function cleanupElementPermissions($vd5d4bb9b2c282937ee64b1fb0495ef08) {$vd5d4bb9b2c282937ee64b1fb0495ef08 = (int) $vd5d4bb9b2c282937ee64b1fb0495ef08;$v92ad7554e2e0d208f33729db6d54b59b = self::getGuestId();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT level FROM cms3_permissions WHERE owner_id = '{$v92ad7554e2e0d208f33729db6d54b59b}' AND rel_id = {$vd5d4bb9b2c282937ee64b1fb0495ef08}";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v075d12d847ab6a1266bae1458b09cfc0 = 0;while(list($vc9e9a848920877e76685b2e4e76de38d) = mysql_fetch_row($result)) {if($vc9e9a848920877e76685b2e4e76de38d>$v075d12d847ab6a1266bae1458b09cfc0) $v075d12d847ab6a1266bae1458b09cfc0 = $vc9e9a848920877e76685b2e4e76de38d;}l_mysql_query("DELETE FROM cms3_permissions WHERE owner_id != '{$v92ad7554e2e0d208f33729db6d54b59b}' AND level <= {$v075d12d847ab6a1266bae1458b09cfc0} AND rel_id = {$vd5d4bb9b2c282937ee64b1fb0495ef08}");}public function isAllowedDomain($v5e7b19364b8de2dedd3aa48cf62706e3, $v662cbf1253ac7d8750ed9190c52163e5) {$v5e7b19364b8de2dedd3aa48cf62706e3 = (int) $v5e7b19364b8de2dedd3aa48cf62706e3;$v662cbf1253ac7d8750ed9190c52163e5 = (int) $v662cbf1253ac7d8750ed9190c52163e5;if($this->isSv($v5e7b19364b8de2dedd3aa48cf62706e3)) {return 1;}$v877a071b41344936293b7b8e9922d1ef = $this->makeSqlWhere($v5e7b19364b8de2dedd3aa48cf62706e3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT MAX(cp.allow) FROM cms_permissions cp WHERE cp.module = 'domain' AND cp.method = '{$v662cbf1253ac7d8750ed9190c52163e5}' AND " . $v877a071b41344936293b7b8e9922d1ef;$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {list($vc9e9a848920877e76685b2e4e76de38d) = $vf1965a857bc285d26fe22023aa5ab50d;return (int) $vc9e9a848920877e76685b2e4e76de38d;}else return 0;}public function setAllowedDomain($v5e7b19364b8de2dedd3aa48cf62706e3, $v662cbf1253ac7d8750ed9190c52163e5, $vb394126a0e52e75f1e3d535d0fb0d33c = 1) {$v5e7b19364b8de2dedd3aa48cf62706e3 = (int) $v5e7b19364b8de2dedd3aa48cf62706e3;$v662cbf1253ac7d8750ed9190c52163e5 = (int) $v662cbf1253ac7d8750ed9190c52163e5;$vb394126a0e52e75f1e3d535d0fb0d33c = (int) $vb394126a0e52e75f1e3d535d0fb0d33c;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms_permissions WHERE module = 'domain' AND method = '{$v662cbf1253ac7d8750ed9190c52163e5}' AND owner_id = '{$v5e7b19364b8de2dedd3aa48cf62706e3}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms_permissions (module, method, owner_id, allow) VALUES('domain', '{$v662cbf1253ac7d8750ed9190c52163e5}', '{$v5e7b19364b8de2dedd3aa48cf62706e3}', '{$vb394126a0e52e75f1e3d535d0fb0d33c}')";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function setDefaultElementPermissions(iUmiHierarchyElement $v8e2dcfd7e7e24b1ca76c1193f645902b, $v5e7b19364b8de2dedd3aa48cf62706e3) {$v22884db148f0ffb0d830ba431102b0b5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getModule();$vea9f6aca279138c58f705c8d4cb4b8ce = $v8e2dcfd7e7e24b1ca76c1193f645902b->getMethod();$vc9e9a848920877e76685b2e4e76de38d = 0;if($this->isAllowedMethod($v5e7b19364b8de2dedd3aa48cf62706e3, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, true)) {$vc9e9a848920877e76685b2e4e76de38d = permissionsCollection::E_READ_ALLOWED_BIT;}if($this->isAllowedMethod($v5e7b19364b8de2dedd3aa48cf62706e3, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce . ".edit", true)) {$vc9e9a848920877e76685b2e4e76de38d = permissionsCollection::E_READ_ALLOWED_BIT +       permissionsCollection::E_EDIT_ALLOWED_BIT +       permissionsCollection::E_CREATE_ALLOWED_BIT +       permissionsCollection::E_DELETE_ALLOWED_BIT +       permissionsCollection::E_MOVE_ALLOWED_BIT;}$this->setElementPermissions($v5e7b19364b8de2dedd3aa48cf62706e3, $v8e2dcfd7e7e24b1ca76c1193f645902b->getId(), $vc9e9a848920877e76685b2e4e76de38d);return $vc9e9a848920877e76685b2e4e76de38d;}public function setAllElementsDefaultPermissions($v5e7b19364b8de2dedd3aa48cf62706e3) {$v5e7b19364b8de2dedd3aa48cf62706e3 = (int) $v5e7b19364b8de2dedd3aa48cf62706e3;$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();$this->elementsCache = array();$v72122ce96bfec66e2396d2e25225d70a = $this->getOwnerType($v5e7b19364b8de2dedd3aa48cf62706e3);if(is_numeric($v72122ce96bfec66e2396d2e25225d70a)) {$v72122ce96bfec66e2396d2e25225d70a = array();}$v72122ce96bfec66e2396d2e25225d70a[] = self::getGuestId();$v72122ce96bfec66e2396d2e25225d70a = array_unique($v72122ce96bfec66e2396d2e25225d70a);l_mysql_query("START TRANSACTION");$vecae13117d6f0584c25a9da6c8f8415e = array();$vefb2a684e4afb7d55e6147fbe5a332ee = array();foreach($v6942e8fa62b3cc9d93881a58210e2fd7->getTypesList() as $v89b0b9deff65f8b9cd1f71bc74ce36ba) {$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getName();$vea9f6aca279138c58f705c8d4cb4b8ce = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getExt();if($this->isAllowedMethod($v5e7b19364b8de2dedd3aa48cf62706e3, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce . ".edit", true)) {foreach($v72122ce96bfec66e2396d2e25225d70a as $v2d53a8fb7abf5be7f4a3cf4b565cc75c) {if($this->isAllowedMethod($v2d53a8fb7abf5be7f4a3cf4b565cc75c, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce . ".edit", true)) {continue 2;}}$vefb2a684e4afb7d55e6147fbe5a332ee[] = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getId();$vc9e9a848920877e76685b2e4e76de38d = 2;}else if($this->isAllowedMethod($v5e7b19364b8de2dedd3aa48cf62706e3, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, true)) {foreach($v72122ce96bfec66e2396d2e25225d70a as $v2d53a8fb7abf5be7f4a3cf4b565cc75c) {if($this->isAllowedMethod($v2d53a8fb7abf5be7f4a3cf4b565cc75c, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, true)) {continue 2;}}$vecae13117d6f0584c25a9da6c8f8415e[] = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getId();$vc9e9a848920877e76685b2e4e76de38d = 1;}else {$vc9e9a848920877e76685b2e4e76de38d = 0;}}if(sizeof($vecae13117d6f0584c25a9da6c8f8415e)) {$vd14a8022b085f9ef19d479cbdd581127 = implode(", ", $vecae13117d6f0584c25a9da6c8f8415e);$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO cms3_permissions (level, owner_id, rel_id)
	SELECT 1, '{$v5e7b19364b8de2dedd3aa48cf62706e3}', id FROM cms3_hierarchy WHERE type_id IN ({$vd14a8022b085f9ef19d479cbdd581127})
SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}if(sizeof($vefb2a684e4afb7d55e6147fbe5a332ee)) {$vd14a8022b085f9ef19d479cbdd581127 = implode(", ", $vefb2a684e4afb7d55e6147fbe5a332ee);$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO cms3_permissions (level, owner_id, rel_id)
	SELECT 31, '{$v5e7b19364b8de2dedd3aa48cf62706e3}', id FROM cms3_hierarchy WHERE type_id IN ({$vd14a8022b085f9ef19d479cbdd581127})
SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}l_mysql_query("COMMIT");}public function getUsersByElementPermissions($v7552cd149af7495ee7d8225974e50f80, $vc9e9a848920877e76685b2e4e76de38d = 1) {$v7552cd149af7495ee7d8225974e50f80 = (int) $v7552cd149af7495ee7d8225974e50f80;$vc9e9a848920877e76685b2e4e76de38d = (int) $vc9e9a848920877e76685b2e4e76de38d;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT owner_id FROM cms3_permissions WHERE rel_id = '{$v7552cd149af7495ee7d8225974e50f80}' AND level >= '{$vc9e9a848920877e76685b2e4e76de38d}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vb132392a317588e56460e77a8fd74229 = array();while(list($vb0ab4f7791b60b1e8ea01057b77873b0) = mysql_fetch_row($result)) {$vb132392a317588e56460e77a8fd74229[] = (int) $vb0ab4f7791b60b1e8ea01057b77873b0;}return $vb132392a317588e56460e77a8fd74229;}public function getRecordedPermissions($v7552cd149af7495ee7d8225974e50f80) {$v7552cd149af7495ee7d8225974e50f80 = (int) $v7552cd149af7495ee7d8225974e50f80;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT owner_id, level FROM cms3_permissions WHERE rel_id = '{$v7552cd149af7495ee7d8225974e50f80}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v6e52c40bb8fc91ff39ee5c79b4211f67 = array();while(list($vb0ab4f7791b60b1e8ea01057b77873b0, $vc9e9a848920877e76685b2e4e76de38d) = mysql_fetch_row($result)) {$v6e52c40bb8fc91ff39ee5c79b4211f67[$vb0ab4f7791b60b1e8ea01057b77873b0] = (int) $vc9e9a848920877e76685b2e4e76de38d;}return $v6e52c40bb8fc91ff39ee5c79b4211f67;}public function pushElementPermissions($v7552cd149af7495ee7d8225974e50f80, $vc9e9a848920877e76685b2e4e76de38d = 1) {$this->tempElementPermissions[$v7552cd149af7495ee7d8225974e50f80] = (int) $vc9e9a848920877e76685b2e4e76de38d;}public function isAuth() {return ($this->getUserId() != self::getGuestId());}public static function getGuestId() {static $v92ad7554e2e0d208f33729db6d54b59b;if(!$v92ad7554e2e0d208f33729db6d54b59b) {$v92ad7554e2e0d208f33729db6d54b59b = (int) umiObjectsCollection::getInstance()->getObjectIdByGUID('system-guest');}return $v92ad7554e2e0d208f33729db6d54b59b;}public function loginAsUser($v8e44f0089b076e18a718eb9ca3d94674) {if(is_null($v8e44f0089b076e18a718eb9ca3d94674)) {return false;}if(is_array($v8e44f0089b076e18a718eb9ca3d94674) && sizeof($v8e44f0089b076e18a718eb9ca3d94674)) {list($v8e44f0089b076e18a718eb9ca3d94674) = $v8e44f0089b076e18a718eb9ca3d94674;}if($v8e44f0089b076e18a718eb9ca3d94674 instanceof iUmiObject) {$vee11cbb19052e40b07aac0ca060c23ee = $v8e44f0089b076e18a718eb9ca3d94674;$v8e44f0089b076e18a718eb9ca3d94674 = $vee11cbb19052e40b07aac0ca060c23ee->id;}else {$vee11cbb19052e40b07aac0ca060c23ee = selector::get('object')->id($v8e44f0089b076e18a718eb9ca3d94674);}$this->user_id = $v8e44f0089b076e18a718eb9ca3d94674;$vd56b699830e77ba53855679cb1d252da = $vee11cbb19052e40b07aac0ca060c23ee->login;$v1c29135e8dc2245721632ee1f5adb22e = $vee11cbb19052e40b07aac0ca060c23ee->password;if(getRequest('u-login-store')) {$v07cc694b9b3fc636710fa08b6922c42b = time() + 31536000;setcookie("u-login", $vee11cbb19052e40b07aac0ca060c23ee->login, $v07cc694b9b3fc636710fa08b6922c42b, "/");setcookie("u-password-md5", $v1c29135e8dc2245721632ee1f5adb22e, $v07cc694b9b3fc636710fa08b6922c42b, "/");}$v21d6f40cfb511982e4424e0e250a9557 = session::recreateInstance();$v21d6f40cfb511982e4424e0e250a9557->set('cms_login', $vd56b699830e77ba53855679cb1d252da);$v21d6f40cfb511982e4424e0e250a9557->set('cms_pass', $v1c29135e8dc2245721632ee1f5adb22e);$v21d6f40cfb511982e4424e0e250a9557->set('user_id', $v8e44f0089b076e18a718eb9ca3d94674);return true;}public function checkLogin($vd56b699830e77ba53855679cb1d252da, $v5f4dcc3b5aa765d61d8327deb882cf99) {$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('objects');$v8be74552df93e31bbdd6b36ed74bdb6a->types('object-type')->name('users', 'user');$v8be74552df93e31bbdd6b36ed74bdb6a->where('login')->equals($vd56b699830e77ba53855679cb1d252da);$v8be74552df93e31bbdd6b36ed74bdb6a->where('password')->equals(md5($v5f4dcc3b5aa765d61d8327deb882cf99));$v8be74552df93e31bbdd6b36ed74bdb6a->where('is_activated')->equals(true);if ($v8be74552df93e31bbdd6b36ed74bdb6a->first) return $v8be74552df93e31bbdd6b36ed74bdb6a->first;$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('objects');$v8be74552df93e31bbdd6b36ed74bdb6a->types('object-type')->name('users', 'user');$v8be74552df93e31bbdd6b36ed74bdb6a->where('e-mail')->equals($vd56b699830e77ba53855679cb1d252da);$v8be74552df93e31bbdd6b36ed74bdb6a->where('password')->equals(md5($v5f4dcc3b5aa765d61d8327deb882cf99));$v8be74552df93e31bbdd6b36ed74bdb6a->where('is_activated')->equals(true);return $v8be74552df93e31bbdd6b36ed74bdb6a->first;}public function getPrivileged($v58f57b98cc8cfb81907179e9b4635762) {if(!sizeof($v58f57b98cc8cfb81907179e9b4635762)) return array();$vac5c74b64b4b8352ef2f181affb5ac2a = 'SELECT owner_id FROM cms_permissions WHERE ';$v59f8ce5cb01404063bd7eb308df3b7dc = array();foreach($v58f57b98cc8cfb81907179e9b4635762 as $vca659200663cf654dc4410ed494451ee) {$v22884db148f0ffb0d830ba431102b0b5 = l_mysql_real_escape_string(getArrayKey($vca659200663cf654dc4410ed494451ee, 0));$vea9f6aca279138c58f705c8d4cb4b8ce = l_mysql_real_escape_string($this->getBaseMethodName($v22884db148f0ffb0d830ba431102b0b5, getArrayKey($vca659200663cf654dc4410ed494451ee, 1)));$v59f8ce5cb01404063bd7eb308df3b7dc[] = "(module = '{$v22884db148f0ffb0d830ba431102b0b5}' AND method = '{$vea9f6aca279138c58f705c8d4cb4b8ce}')";}$vac5c74b64b4b8352ef2f181affb5ac2a .= implode(' OR ', $v59f8ce5cb01404063bd7eb308df3b7dc);$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vb132392a317588e56460e77a8fd74229 = array();while(list($vb0ab4f7791b60b1e8ea01057b77873b0) = mysql_fetch_row($result)) {$vb132392a317588e56460e77a8fd74229[] = $vb0ab4f7791b60b1e8ea01057b77873b0;}$vb132392a317588e56460e77a8fd74229 = array_unique($vb132392a317588e56460e77a8fd74229);return $vb132392a317588e56460e77a8fd74229;}protected function isAdminAllowedMethod($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce) {$va9ac5a6cc3cbe84f9c18323af2b9007f = array(   'content' =>    array('json_mini_browser', 'old_json_load_files', 'json_load_files',       'json_load_zip_folder', 'load_tree_node', 'get_editable_region',       'save_editable_region', 'widget_create', 'widget_delete',       'getObjectsByTypeList', 'getObjectsByBaseTypeList',       'json_get_images_panel', 'json_create_imanager_object',       'domainTemplates', 'json_unlock_page', 'tree_unlock_page'),   'backup' =>     array('backup_panel'),   'data'   =>     array('guide_items', 'guide_items_all', 'json_load_hierarchy_level'),   'webo' => array('show'),   'users'  => array('getFavourites', 'json_change_dock', 'saveUserSettings', 'loadUserSettings'),   '*'   =>  array('dataset_config')   );if(isset($va9ac5a6cc3cbe84f9c18323af2b9007f[$v22884db148f0ffb0d830ba431102b0b5])) {if(in_array($vea9f6aca279138c58f705c8d4cb4b8ce, $va9ac5a6cc3cbe84f9c18323af2b9007f[$v22884db148f0ffb0d830ba431102b0b5])) {return true;}}if(isset($va9ac5a6cc3cbe84f9c18323af2b9007f['*'])) {if(in_array($vea9f6aca279138c58f705c8d4cb4b8ce, $va9ac5a6cc3cbe84f9c18323af2b9007f['*'])) {return true;}}return false;}public function clearCache() {$this->elementsCache = array();$this->methodsPermissions = array();}};interface iAdminModuleTabs {public function __construct($v599dcce2998a6b40b1e38e8c6006cb0a = 'common');public function add($vddaa6e8c8c412299272e183087b8f7b6, $v9299da2529c98fccce0e32b476ba3266 = NULL);public function get($vddaa6e8c8c412299272e183087b8f7b6);public function getTabNameByAlias($v936f2c128d76b35569cff20ee7e04ed4);public function remove($vddaa6e8c8c412299272e183087b8f7b6);public function getAll();};class adminModuleTabs implements iAdminModuleTabs {private $type;private $tabs = array();public function __construct($v599dcce2998a6b40b1e38e8c6006cb0a = 'common') {if ($v599dcce2998a6b40b1e38e8c6006cb0a == 'common' || $v599dcce2998a6b40b1e38e8c6006cb0a == 'config') {$this->type = $v599dcce2998a6b40b1e38e8c6006cb0a;}else {throw new coreException("Tabs type \"{$v599dcce2998a6b40b1e38e8c6006cb0a}\" is unknown.");}}public function add($vddaa6e8c8c412299272e183087b8f7b6, $v9299da2529c98fccce0e32b476ba3266 = array()) {$this->tabs[$vddaa6e8c8c412299272e183087b8f7b6] = $v9299da2529c98fccce0e32b476ba3266;}public function get($vddaa6e8c8c412299272e183087b8f7b6) {if (isset($this->tabs[$vddaa6e8c8c412299272e183087b8f7b6])) {return $this->tabs[$vddaa6e8c8c412299272e183087b8f7b6];}return false;}public function getTabNameByAlias($vea9f6aca279138c58f705c8d4cb4b8ce) {if (isset($this->tabs[$vea9f6aca279138c58f705c8d4cb4b8ce])) return $vea9f6aca279138c58f705c8d4cb4b8ce;foreach ($this->tabs as $v0db3fbcce639f7d6f75a8f42d981861b => $v9299da2529c98fccce0e32b476ba3266) {if (in_array($vea9f6aca279138c58f705c8d4cb4b8ce, $v9299da2529c98fccce0e32b476ba3266)) return $v0db3fbcce639f7d6f75a8f42d981861b;}return false;}public function remove($vddaa6e8c8c412299272e183087b8f7b6) {if (isset($this->tabs[$vddaa6e8c8c412299272e183087b8f7b6])) {unset($this->tabs[$vddaa6e8c8c412299272e183087b8f7b6]);return true;}return false;}public function getAll() {return (sizeof($this->tabs) > 1) ? $this->tabs : array();}};interface iTranslit {public static function convert($vb45cffe084dd3d20d928bee85e7b0f21);}class translit implements iTranslit {public static $fromUpper = Array("Э", "Ч", "Ш", "Ё", "Ё", "Ж", "Ю", "Ю", "Я", "Я", "А", "Б", "В", "Г", "Д", "Е", "З", "И", "Й", "К", "Л", "М", "Н", "О", "П", "Р", "С", "Т", "У", "Ф", "Х", "Ц", "Щ", "Ъ", "Ы", "Ь");public static $fromLower = Array("э", "ч", "ш", "ё", "ё", "ж", "ю", "ю", "я", "я", "а", "б", "в", "г", "д", "е", "з", "и", "й", "к", "л", "м", "н", "о", "п", "р", "с", "т", "у", "ф", "х", "ц", "щ", "ъ", "ы", "ь");public static $toLower = Array("e", "ch", "sh", "yo", "jo", "zh", "yu", "ju", "ya", "ja", "a", "b", "v", "g", "d", "e", "z", "i", "j", "k", "l", "m", "n", "o", "p", "r", "s", "t", "u", "f", "h", "c", "w", "~", "y", "\'");public static function convert($v341be97d9aff90c9978347f66f945b77, $va0f0bc95016c862498bbad29d1f4d9d4 = '_') {$va0f0bc95016c862498bbad29d1f4d9d4 = $va0f0bc95016c862498bbad29d1f4d9d4 ? addcslashes($va0f0bc95016c862498bbad29d1f4d9d4, ']/\$') : '_';$v341be97d9aff90c9978347f66f945b77 = umiObjectProperty::filterInputString($v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = str_replace(self::$fromLower, self::$toLower, $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = str_replace(self::$fromUpper, self::$toLower, $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = strtolower($v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = preg_replace("/([^A-z0-9_\-]+)/", $va0f0bc95016c862498bbad29d1f4d9d4, $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = preg_replace("/[\/\\\',\t`\^\[\]]*/", "", $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = str_replace(chr(8470), "", $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = preg_replace("/[ \.]+/", $va0f0bc95016c862498bbad29d1f4d9d4, $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = preg_replace("/([" . $va0f0bc95016c862498bbad29d1f4d9d4 . "]+)/", $va0f0bc95016c862498bbad29d1f4d9d4, $v341be97d9aff90c9978347f66f945b77);$v341be97d9aff90c9978347f66f945b77 = trim(trim($v341be97d9aff90c9978347f66f945b77), $va0f0bc95016c862498bbad29d1f4d9d4);return $v341be97d9aff90c9978347f66f945b77;}}interface iUmiTemplater {public function setScope($v7552cd149af7495ee7d8225974e50f80, $v16b2b26000987faccb260b9d39df1269 = false);public static function loadTemplates($v9cd3487945daada914909f0b525e1284);public static function getTemplates($v9cd3487945daada914909f0b525e1284);}abstract class umiTemplater implements iUmiTemplater {protected $templatesSource;protected $scopeElementId = false, $scopeObjectId = false, $scopeObject = false;protected static $callStackEnabled = false;protected static $commentsStack = array();abstract public function parse($v87cd8b8808600624d8c590cfc2e6e94b, $v9a0364b9e99bb480dd25e1f0284c8555 = null);protected function replaceCommentsBeforeParse($v9a0364b9e99bb480dd25e1f0284c8555) {if (strpos($v9a0364b9e99bb480dd25e1f0284c8555, '<!--') === false || (int) mainConfiguration::getInstance()->get('system', 'parse-macroses-in-comments')) {return $v9a0364b9e99bb480dd25e1f0284c8555;}if (preg_match_all("/<!--.*?-->/mu", $v9a0364b9e99bb480dd25e1f0284c8555, $v9c28d32df234037773be184dbdafc274)) {$va5d491060952aa8ad5fdee071be752de = array_unique($v9c28d32df234037773be184dbdafc274[0]);foreach($va5d491060952aa8ad5fdee071be752de as $v06d4cd63bde972fc66a0aed41d2f5c51) {$vdd395d6201581ad212d782d571f0ad64 = '[hc_' . md5($v06d4cd63bde972fc66a0aed41d2f5c51) . ']';if ( !isset(self::$commentsStack[$vdd395d6201581ad212d782d571f0ad64]) ) {self::$commentsStack[$vdd395d6201581ad212d782d571f0ad64] = $v06d4cd63bde972fc66a0aed41d2f5c51;}$v9a0364b9e99bb480dd25e1f0284c8555 = str_replace($v06d4cd63bde972fc66a0aed41d2f5c51, $vdd395d6201581ad212d782d571f0ad64, $v9a0364b9e99bb480dd25e1f0284c8555);}}return $v9a0364b9e99bb480dd25e1f0284c8555;}public function replaceCommentsAfterParse($v9a0364b9e99bb480dd25e1f0284c8555) {return str_replace(array_keys(self::$commentsStack), array_values(self::$commentsStack), $v9a0364b9e99bb480dd25e1f0284c8555);}public function __construct($v9cd3487945daada914909f0b525e1284) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$this->templatesSource = $v9cd3487945daada914909f0b525e1284;}public function setScope($v7552cd149af7495ee7d8225974e50f80, $v16b2b26000987faccb260b9d39df1269 = false) {$this->scopeElementId = $v7552cd149af7495ee7d8225974e50f80;$this->scopeObjectId = $v16b2b26000987faccb260b9d39df1269;$this->scopeObject = false;}public function getScopeObject() {if ($this->scopeObject !== false) return $this->scopeObject;if($this->scopeElementId === false && $this->scopeObjectId === false) {return $this->scopeObject = null;}$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();if ($this->scopeElementId && ($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($this->scopeElementId))) {return $this->scopeObject = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();}if ($this->scopeObjectId && ($va8cfde6331bd59eb2ac96f8911c4b666 = $v5891da2d64975cae48d175d1e001f5da->getObject($this->scopeObjectId))) {return $this->scopeObject = $va8cfde6331bd59eb2ac96f8911c4b666;}return $this->scopeObject = null;}public function cleanup($v9a0364b9e99bb480dd25e1f0284c8555) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if (!$v41275a535677f79ff347e01bc530c176->isAdmin() && (int) $v2245023265ae4cf87d02c8b6ba991139->get('system', 'clean-eip-attributes')) {$v9a0364b9e99bb480dd25e1f0284c8555 = $this->cleanEIPAttributes($v9a0364b9e99bb480dd25e1f0284c8555);}if (!intval($v2245023265ae4cf87d02c8b6ba991139->get("kernel", "show-broken-macro"))) {$v9a0364b9e99bb480dd25e1f0284c8555 = $this->cleanBrokenMacro($v9a0364b9e99bb480dd25e1f0284c8555);}$v9a0364b9e99bb480dd25e1f0284c8555 = $this->replaceCommentsAfterParse($v9a0364b9e99bb480dd25e1f0284c8555);$v9a0364b9e99bb480dd25e1f0284c8555 = str_replace(array("&amp;#37;"), "%", $v9a0364b9e99bb480dd25e1f0284c8555);return $v9a0364b9e99bb480dd25e1f0284c8555;}public static final function create($v599dcce2998a6b40b1e38e8c6006cb0a, $v9cd3487945daada914909f0b525e1284 = null) {$v599dcce2998a6b40b1e38e8c6006cb0a = strtoupper($v599dcce2998a6b40b1e38e8c6006cb0a);if (!strlen($v599dcce2998a6b40b1e38e8c6006cb0a)) {throw new coreException("Templater type required for create instance.");}$v6f66e878c62db60568a3487869695820 = __CLASS__ . $v599dcce2998a6b40b1e38e8c6006cb0a;if (!class_exists($v6f66e878c62db60568a3487869695820)) {$v47826cacc65c665212b821e6ff80b9b0 =  dirname(__FILE__) . '/types/' . $v6f66e878c62db60568a3487869695820 . '.php';if (!is_file($v47826cacc65c665212b821e6ff80b9b0)) {throw new coreException("Can't load templater implemantation \"{$v47826cacc65c665212b821e6ff80b9b0}\".");}require_once $v47826cacc65c665212b821e6ff80b9b0;}if (!class_exists($v6f66e878c62db60568a3487869695820)) {throw new coreException("Templater class \"{$v6f66e878c62db60568a3487869695820}\" not found");}$v640eac53ad75db5c49a9ec86390d8530 = new $v6f66e878c62db60568a3487869695820($v9cd3487945daada914909f0b525e1284);if (!$v640eac53ad75db5c49a9ec86390d8530 instanceof umiTemplater) {throw new coreException("Templater class \"{$v6f66e878c62db60568a3487869695820}\" should be instance of " . __CLASS__);}return $v640eac53ad75db5c49a9ec86390d8530;}public function getTemplatesSource() {return $this->templatesSource;}public function setFilePath($v47826cacc65c665212b821e6ff80b9b0) {$this->templatesSource = $v47826cacc65c665212b821e6ff80b9b0;}public static $blocks = Array();public static function pushEditable($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb80bb7740288fda1f201890375a60c8f) {if($v22884db148f0ffb0d830ba431102b0b5 === false && $vea9f6aca279138c58f705c8d4cb4b8ce === false) {if($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($vb80bb7740288fda1f201890375a60c8f)) {$v94efb9bd8805ffa2a3d248cbe836b6ef = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId();if($v481a5f16b24d461e31d85aba607238b8 = umiObjectTypesCollection::getInstance()->getType($v94efb9bd8805ffa2a3d248cbe836b6ef)) {$v09f4280d9972439d11df682357c4b807 = $v481a5f16b24d461e31d85aba607238b8->getHierarchyTypeId();if($v5f8d8192d2d4ff7e065aaf1958d15913 = umiHierarchyTypesCollection::getInstance()->getType($v09f4280d9972439d11df682357c4b807)) {$v22884db148f0ffb0d830ba431102b0b5 = $v5f8d8192d2d4ff7e065aaf1958d15913->getName();$vea9f6aca279138c58f705c8d4cb4b8ce = $v5f8d8192d2d4ff7e065aaf1958d15913->getExt();}else {return false;}}}}self::$blocks[] = array($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb80bb7740288fda1f201890375a60c8f);return true;}public static function prepareQuickEdit() {$v5e72c7891093d301b60783c6a47f7aa0 = self::$blocks;if(sizeof($v5e72c7891093d301b60783c6a47f7aa0) == 0) return;$v3c6e0b8a9c15224a8228b9a98ca1531d = md5(getServerProtocol() . "://" . getServer('HTTP_HOST') . getServer('REQUEST_URI'));$_SESSION[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v5e72c7891093d301b60783c6a47f7aa0;}final public static function getSomething($vc65f234fae60d823c1f1bf00566248a0 = "pro", $v67b3dba8bc6778101892eb77249db32e = null) {$v836c673259e51101a01e755a34f97359 = getServer('SERVER_ADDR');if (is_null($v67b3dba8bc6778101892eb77249db32e)) {$v9d6e24ec78d309695833f4c9f8310d7a = domainsCollection::getInstance()->getDefaultDomain();$v67b3dba8bc6778101892eb77249db32e = $v9d6e24ec78d309695833f4c9f8310d7a->getHost();}$v43c8ce94d81492e62c60092a3664a65f = $v836c673259e51101a01e755a34f97359 ? md5($v836c673259e51101a01e755a34f97359) : md5(str_replace("\\", "", getServer('DOCUMENT_ROOT')));$v834c51a71b8c3cca066197db43bb209d = '';switch ($vc65f234fae60d823c1f1bf00566248a0) {case "pro":     $v834c51a71b8c3cca066197db43bb209d = md5(md5(md5(md5(md5(md5(md5(md5(md5(md5($v67b3dba8bc6778101892eb77249db32e))))))))));break;case "shop":     $v834c51a71b8c3cca066197db43bb209d =  md5(md5($v67b3dba8bc6778101892eb77249db32e . "shop"));break;case "lite":     $v834c51a71b8c3cca066197db43bb209d = md5(md5(md5(md5(md5($v67b3dba8bc6778101892eb77249db32e)))));break;case "start":     $v834c51a71b8c3cca066197db43bb209d = md5(md5(md5($v67b3dba8bc6778101892eb77249db32e)));break;case "trial":     $v834c51a71b8c3cca066197db43bb209d = md5(md5(md5(md5(md5(md5($v67b3dba8bc6778101892eb77249db32e))))));break;}return strtoupper(substr($v43c8ce94d81492e62c60092a3664a65f, 0, 11) . "-" . substr($v834c51a71b8c3cca066197db43bb209d, 0, 11));}protected function cleanEIPAttributes($v9a0364b9e99bb480dd25e1f0284c8555) {return preg_replace('/[\s+]umi\:[^=\'"]+=["\'][^"\']*["\']/i', '', $v9a0364b9e99bb480dd25e1f0284c8555);}protected function cleanBrokenMacro($v9a0364b9e99bb480dd25e1f0284c8555) {$v9a0364b9e99bb480dd25e1f0284c8555 = preg_replace("/%(?!cut%)([A-z_]{3,})%/m", "", $v9a0364b9e99bb480dd25e1f0284c8555);$v9a0364b9e99bb480dd25e1f0284c8555 = preg_replace("/%([A-zА-Яа-я0-9]+\s+[A-zА-Яа-я0-9_]+\([A-zА-Яа-я \/\._\-\(\)0-9%:<>,!@\|'&=;\?\+#]*\))%/mu", "", $v9a0364b9e99bb480dd25e1f0284c8555);return $v9a0364b9e99bb480dd25e1f0284c8555;}public static function setEnabledCallStack($va10311459433adf322f2590a4987c423 = true) {return self::$callStackEnabled = $va10311459433adf322f2590a4987c423;}public static function isEnabledCallStack() {return self::$callStackEnabled;}public function getCallStackXML() {if (self::isEnabledCallStack()) {return umiBaseStream::getCalledStreams();}return $this->disabledCallStackError();}protected function disabledCallStackError() {$vdd988cfd769c9f7fbd795a0f5da8e751 = new DOMDocument('1.0', 'utf-8');$vdd988cfd769c9f7fbd795a0f5da8e751->appendChild($vdd988cfd769c9f7fbd795a0f5da8e751->createElement('error', 'Call stack disabled.'));return $vdd988cfd769c9f7fbd795a0f5da8e751->saveXML();}public function putLangs($v9a0364b9e99bb480dd25e1f0284c8555) {return def_module::parseTPLMacroses($v9a0364b9e99bb480dd25e1f0284c8555);}public function parseInput($va43c1b0aa53a0c908810c06ab1ff3967, $vc9e9a848920877e76685b2e4e76de38d = 1) {return def_module::parseTPLMacroses($va43c1b0aa53a0c908810c06ab1ff3967);}public function init() {}public function getIsInited() {return def_module::isXSLTResultMode();}public function setIsInited($v22af645d1859cb5ca6da0c484f1f37ea) {return def_module::isXSLTResultMode($v22af645d1859cb5ca6da0c484f1f37ea);}public function parseResult() {return $this->parse(array(), null);}}class umiTemplaterTPL extends umiTemplater {protected static $templatesCache = array();protected static $callStack;protected static $currentCallStackNode;protected static $callStackMaxStringLength = 100;protected $parseLevel = 0;protected static $maxParseLevel = 4;protected $executeOnlyAllowedMacroses;protected static $msResultStack = array();protected static $shortAliases = array(   '%menu%'                => array('macros_menu'),   '%header%'              => array('macros_header'),   '%pid%'                 => array('macros_returnPid'),   '%parent_id%'           => array('macros_returnParentId'),   '%pre_lang%'            => array('macros_returnPreLang'),   '%curr_time%'           => array('macros_curr_time'),   '%domain%'              => array('macros_returnDomain'),   '%domain_floated%'      => array('macros_returnDomainFloated'),   '%system_build%'        => array('macros_systemBuild'),   '%title%'               => array('macros_title'),   '%sitename%'            => array('macros_sitename'),   '%keywords%'            => array('macros_keywords'),   '%describtion%'         => array('macros_describtion'),   '%description%'         => array('macros_describtion'),   '%adm_menu%'            => array('macros_adm_menu'),   '%adm_navibar%'         => array('macros_adm_navibar'),   '%skin_path%'           => array('macros_skin_path'),   '%ico_ext%'             => array('macros_ico_ext'),   '%current_user_id%'     => array('macros_current_user_id'),   '%current_version_line%'=> array('macros_current_version_line'),   '%context_help%'        => array('macros_help'),   '%current_alt_name%'    => array('macros_current_alt_name')  );private function prepareVariableForCallStack($v2063c1608d6e0baf80249c42e2be5804) {if (!is_scalar($v2063c1608d6e0baf80249c42e2be5804)) {return gettype($v2063c1608d6e0baf80249c42e2be5804);}elseif (is_string($v2063c1608d6e0baf80249c42e2be5804) && strlen($v2063c1608d6e0baf80249c42e2be5804) > self::$callStackMaxStringLength) {return mb_substr($v2063c1608d6e0baf80249c42e2be5804, 0, self::$callStackMaxStringLength). "...";}return $v2063c1608d6e0baf80249c42e2be5804;}private function startParseCallReport($v87cd8b8808600624d8c590cfc2e6e94b, $v9a0364b9e99bb480dd25e1f0284c8555) {if (!self::isEnabledCallStack()) return null;$v0b849ae205d413040ca9469a29d2d056 = $this->getCallStack();$v9a0364b9e99bb480dd25e1f0284c8555 = $this->prepareVariableForCallStack($v9a0364b9e99bb480dd25e1f0284c8555);$v031162dfa4ba07c7379009026922ac7a = $v0b849ae205d413040ca9469a29d2d056->createElement('parse-block');$ve0425f780a08ffd49f24dd0659f2d49d = $v0b849ae205d413040ca9469a29d2d056->createElement('parsed-content');$ve0425f780a08ffd49f24dd0659f2d49d->appendChild($v0b849ae205d413040ca9469a29d2d056->createCDATASection($v9a0364b9e99bb480dd25e1f0284c8555));$v031162dfa4ba07c7379009026922ac7a->appendChild($ve0425f780a08ffd49f24dd0659f2d49d);$v007c80fea02d524c4bdafe8a1390da1c = $v0b849ae205d413040ca9469a29d2d056->createElement('scope');foreach ($v87cd8b8808600624d8c590cfc2e6e94b as $vb2145aac704ce76dbe1ac7adac535b23 => $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $this->prepareVariableForCallStack($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v7d299ed43e6effe263c261993df8e1ca = $v0b849ae205d413040ca9469a29d2d056->createElement('var');$v7d299ed43e6effe263c261993df8e1ca->setAttribute('name', $vb2145aac704ce76dbe1ac7adac535b23);$v7d299ed43e6effe263c261993df8e1ca->setAttribute('type', gettype($v3a6d0284e743dc4a9b86f97d6dd1a3bf));$v7d299ed43e6effe263c261993df8e1ca->appendChild($v0b849ae205d413040ca9469a29d2d056->createCDATASection($v3a6d0284e743dc4a9b86f97d6dd1a3bf));$v007c80fea02d524c4bdafe8a1390da1c->appendChild($v7d299ed43e6effe263c261993df8e1ca);}$v031162dfa4ba07c7379009026922ac7a->appendChild($v007c80fea02d524c4bdafe8a1390da1c);$v031162dfa4ba07c7379009026922ac7a->setAttribute('start', microtime(true));if (!$veab961ca44248a99862858f58e1a5a4f = self::$currentCallStackNode) {$veab961ca44248a99862858f58e1a5a4f = $v0b849ae205d413040ca9469a29d2d056->documentElement;}return self::$currentCallStackNode = $veab961ca44248a99862858f58e1a5a4f->appendChild($v031162dfa4ba07c7379009026922ac7a);}private function stopCallReport($v031162dfa4ba07c7379009026922ac7a) {if (!self::isEnabledCallStack()) return null;if (!$v031162dfa4ba07c7379009026922ac7a instanceof DOMElement) return null;if ($v5b2a579f62087d17d79ce59f3de5f6d1 = $v031162dfa4ba07c7379009026922ac7a->getAttribute('start')) {$v5b2a579f62087d17d79ce59f3de5f6d1 = floatval($v5b2a579f62087d17d79ce59f3de5f6d1);$v031162dfa4ba07c7379009026922ac7a->setAttribute('call-time', number_format(microtime(true) - $v5b2a579f62087d17d79ce59f3de5f6d1, 5));}self::$currentCallStackNode = $v031162dfa4ba07c7379009026922ac7a->parentNode;return $v031162dfa4ba07c7379009026922ac7a;}private function startMacrosExecuteCallReport($v264a818e305e0550c3ee63761dd3d911) {if (!self::isEnabledCallStack()) return null;$v0b849ae205d413040ca9469a29d2d056 = $this->getCallStack();$v031162dfa4ba07c7379009026922ac7a = $v0b849ae205d413040ca9469a29d2d056->createElement('macros');$v031162dfa4ba07c7379009026922ac7a->setAttribute('name', $v264a818e305e0550c3ee63761dd3d911);$v031162dfa4ba07c7379009026922ac7a->setAttribute('start', microtime(true));if (!$veab961ca44248a99862858f58e1a5a4f = self::$currentCallStackNode) {$veab961ca44248a99862858f58e1a5a4f = $v0b849ae205d413040ca9469a29d2d056->documentElement;}return self::$currentCallStackNode = $veab961ca44248a99862858f58e1a5a4f->appendChild($v031162dfa4ba07c7379009026922ac7a);}public function executeOnlyAllowedMacroses($v5b941405fb0695d016279f31c89b5c54) {$this->executeOnlyAllowedMacroses = $v5b941405fb0695d016279f31c89b5c54;}private function isExecuteMacrosAllowed($vef3acbd635931ab4874da3b58b3e62cf) {if (!is_array($this->executeOnlyAllowedMacroses) || !count($this->executeOnlyAllowedMacroses)) {return true;}return in_array($vef3acbd635931ab4874da3b58b3e62cf, $this->executeOnlyAllowedMacroses);}public function parse($v87cd8b8808600624d8c590cfc2e6e94b, $v9a0364b9e99bb480dd25e1f0284c8555 = null) {if (empty($v9a0364b9e99bb480dd25e1f0284c8555)) return strval($v9a0364b9e99bb480dd25e1f0284c8555);if (strpos($v9a0364b9e99bb480dd25e1f0284c8555, '%') === false && strpos($v9a0364b9e99bb480dd25e1f0284c8555, '[ms_') === false) return $v9a0364b9e99bb480dd25e1f0284c8555;$v031162dfa4ba07c7379009026922ac7a = $this->startParseCallReport($v87cd8b8808600624d8c590cfc2e6e94b, $v9a0364b9e99bb480dd25e1f0284c8555);if ($this->parseLevel > self::$maxParseLevel) {return $v9a0364b9e99bb480dd25e1f0284c8555;}$v4a4342178dad007c454130c4dd77d9e4 = def_module::isXSLTResultMode(false);$v63fb636909f1ebad67110e49117e6de4 = $v9a0364b9e99bb480dd25e1f0284c8555;$v9a0364b9e99bb480dd25e1f0284c8555 = $this->replaceCommentsBeforeParse($v9a0364b9e99bb480dd25e1f0284c8555);if ($this->scopeElementId) {$v9a0364b9e99bb480dd25e1f0284c8555 = str_replace('%id%', $this->scopeElementId, $v9a0364b9e99bb480dd25e1f0284c8555);}$v9a0364b9e99bb480dd25e1f0284c8555 = $this->parseShortMacroses($v9a0364b9e99bb480dd25e1f0284c8555, $v87cd8b8808600624d8c590cfc2e6e94b);$v9a0364b9e99bb480dd25e1f0284c8555 = $this->parseCompleteMacroses($v9a0364b9e99bb480dd25e1f0284c8555, $v87cd8b8808600624d8c590cfc2e6e94b);def_module::isXSLTResultMode($v4a4342178dad007c454130c4dd77d9e4);if ($v63fb636909f1ebad67110e49117e6de4 === $v9a0364b9e99bb480dd25e1f0284c8555) {$this->stopCallReport($v031162dfa4ba07c7379009026922ac7a);return $v9a0364b9e99bb480dd25e1f0284c8555;}if (strpos($v9a0364b9e99bb480dd25e1f0284c8555, '[ms_') !== false) {$v9a0364b9e99bb480dd25e1f0284c8555 = str_replace(array_keys(self::$msResultStack), array_values(self::$msResultStack), $v9a0364b9e99bb480dd25e1f0284c8555);}if (strpos($v9a0364b9e99bb480dd25e1f0284c8555, '%') !== false) {$this->parseLevel++;$v9a0364b9e99bb480dd25e1f0284c8555 = $this->parse($v87cd8b8808600624d8c590cfc2e6e94b, $v9a0364b9e99bb480dd25e1f0284c8555);}$this->stopCallReport($v031162dfa4ba07c7379009026922ac7a);return $v9a0364b9e99bb480dd25e1f0284c8555;}public static function getTemplates($v9cd3487945daada914909f0b525e1284) {$result = array();$vfed36e93a0509e20f2dc96cbbd85b678 = func_get_args();unset($vfed36e93a0509e20f2dc96cbbd85b678[0]);$vc9e402eeb4a6f8efbcbe436daba0ccd8 = self::loadTemplates($v9cd3487945daada914909f0b525e1284);if (!count($vfed36e93a0509e20f2dc96cbbd85b678)) return $vc9e402eeb4a6f8efbcbe436daba0ccd8;foreach ($vfed36e93a0509e20f2dc96cbbd85b678 as $vb068931cc450442b63f5b3d276ea4297) {$result[] = isset($vc9e402eeb4a6f8efbcbe436daba0ccd8[$vb068931cc450442b63f5b3d276ea4297]) ? $vc9e402eeb4a6f8efbcbe436daba0ccd8[$vb068931cc450442b63f5b3d276ea4297] : "";}return $result;}public static function loadTemplates($v9cd3487945daada914909f0b525e1284) {if (empty($v9cd3487945daada914909f0b525e1284)) return array();$v6d92ba33a14649f2a6f698b128302ad7 = realpath($v9cd3487945daada914909f0b525e1284);$v0800fc577294c34e0b28ad2839435945 = md5($v6d92ba33a14649f2a6f698b128302ad7);if (isset(self::$templatesCache[$v0800fc577294c34e0b28ad2839435945])) return self::$templatesCache[$v0800fc577294c34e0b28ad2839435945];if (!is_file($v6d92ba33a14649f2a6f698b128302ad7)) {throw new publicException("Не найден шаблон {$v9cd3487945daada914909f0b525e1284}", 2);}$FORMS = array();ob_start();include $v6d92ba33a14649f2a6f698b128302ad7;$v0333a2bd4a6440b31d249df558b2b2c7 = ob_get_clean();if (!count($FORMS) && strlen($v0333a2bd4a6440b31d249df558b2b2c7)) {$FORMS['common'] = $v0333a2bd4a6440b31d249df558b2b2c7;}return self::$templatesCache[$v0800fc577294c34e0b28ad2839435945] = $FORMS;}protected function parseShortMacroses($v9a0364b9e99bb480dd25e1f0284c8555, array $v87cd8b8808600624d8c590cfc2e6e94b) {if (strpos($v9a0364b9e99bb480dd25e1f0284c8555, '%') === false) return $v9a0364b9e99bb480dd25e1f0284c8555;if(preg_match_all("/%[A-z0-9][A-z0-9_-]{1,}%/m", $v9a0364b9e99bb480dd25e1f0284c8555, $v9c28d32df234037773be184dbdafc274)) {$v3b6168bd7ad383c4e2ece12a10bd00db = array_unique($v9c28d32df234037773be184dbdafc274[0]);$v57cfc11faf7476ccae9a7fbf83da0c5d = array();$vf3243048a04708ab2a053cef9543f555 = array();foreach ($v3b6168bd7ad383c4e2ece12a10bd00db as $v264a818e305e0550c3ee63761dd3d911) {if (!$this->isExecuteMacrosAllowed(trim($v264a818e305e0550c3ee63761dd3d911, "%"))) continue;$vf5e638cc78dd325906c1298a0c21fb6b = rtrim($v264a818e305e0550c3ee63761dd3d911, '%');if (wa_strlen($vf5e638cc78dd325906c1298a0c21fb6b) == 3 && urldecode($vf5e638cc78dd325906c1298a0c21fb6b) !== $vf5e638cc78dd325906c1298a0c21fb6b) continue;$v57cfc11faf7476ccae9a7fbf83da0c5d[] = $v264a818e305e0550c3ee63761dd3d911;$vf3243048a04708ab2a053cef9543f555[] = $this->executeShortMacros($v264a818e305e0550c3ee63761dd3d911, $v87cd8b8808600624d8c590cfc2e6e94b);}$v9a0364b9e99bb480dd25e1f0284c8555 = str_replace($v57cfc11faf7476ccae9a7fbf83da0c5d, $vf3243048a04708ab2a053cef9543f555, $v9a0364b9e99bb480dd25e1f0284c8555);}return $v9a0364b9e99bb480dd25e1f0284c8555;}protected function generateMSResultUID() {static $v0326f7482268be288eb9847a5027fd57 = 0;return '[ms_' . ++$v0326f7482268be288eb9847a5027fd57 . ']';}protected function setMSResult($v7d059d8ffac0a3914b296af280c6194e, $result) {self::$msResultStack[$v7d059d8ffac0a3914b296af280c6194e] = $result;}protected function printScopeVariables(array $v87cd8b8808600624d8c590cfc2e6e94b) {if ($v3b58d9b65bede8bee9c92ba91b7915c9 = $this->getScopeObject()) {$vfd1750b405e8a8bea55ca064a9983d5e = $v3b58d9b65bede8bee9c92ba91b7915c9->getType()->getAllFields();foreach ($vfd1750b405e8a8bea55ca064a9983d5e as $v06e3d36fa30cea095545139854ad1fb9) {$vb068931cc450442b63f5b3d276ea4297 = $v06e3d36fa30cea095545139854ad1fb9->getName();if (!isset($v87cd8b8808600624d8c590cfc2e6e94b[$vb068931cc450442b63f5b3d276ea4297])) {$v87cd8b8808600624d8c590cfc2e6e94b[$vb068931cc450442b63f5b3d276ea4297] = $v3b58d9b65bede8bee9c92ba91b7915c9->getValue($vb068931cc450442b63f5b3d276ea4297);}}}if ($v6829cdfdefd69b947abedd8fa2c4bcc7 = cmsController::getInstance()->getResourcesDirectory()) {$v5f4e8166653b82a3be0b701212383ef9 = $v6829cdfdefd69b947abedd8fa2c4bcc7 . "tpls/system/reflection.tpl";}if (!isset($v5f4e8166653b82a3be0b701212383ef9) || !file_exists($v5f4e8166653b82a3be0b701212383ef9)) {$v5f4e8166653b82a3be0b701212383ef9 = CURRENT_WORKING_DIR . "/tpls/system/reflection.tpl";}list($v14511f2f5564650d129ca7cabc333278, $v6f493ab3d3cafc90de6606e1d559cb97, $vae044de305b3ae44fc378dfe0e95b101) = $this->getTemplates($v5f4e8166653b82a3be0b701212383ef9, "scope_dump_block", "scope_dump_line_variable", "scope_dump_line_macro");$v8c872b0c9f80fb4709c8e137d5d2191a = "";foreach($v87cd8b8808600624d8c590cfc2e6e94b as $vb068931cc450442b63f5b3d276ea4297 => $v2063c1608d6e0baf80249c42e2be5804) {if($vb068931cc450442b63f5b3d276ea4297 == "#meta") continue;if(is_array($v2063c1608d6e0baf80249c42e2be5804)) {$vfa816edb83e95bf0c8da580bdfd491ef = str_replace("%name%", $vb068931cc450442b63f5b3d276ea4297, $vae044de305b3ae44fc378dfe0e95b101);}else {$vfa816edb83e95bf0c8da580bdfd491ef = $v6f493ab3d3cafc90de6606e1d559cb97;$vfa816edb83e95bf0c8da580bdfd491ef = str_replace("%name%", $vb068931cc450442b63f5b3d276ea4297, $vfa816edb83e95bf0c8da580bdfd491ef);$vfa816edb83e95bf0c8da580bdfd491ef = str_replace("%type%", gettype($v2063c1608d6e0baf80249c42e2be5804), $vfa816edb83e95bf0c8da580bdfd491ef);$vfa816edb83e95bf0c8da580bdfd491ef = str_replace("%value%", htmlspecialchars($v2063c1608d6e0baf80249c42e2be5804), $vfa816edb83e95bf0c8da580bdfd491ef);}$v8c872b0c9f80fb4709c8e137d5d2191a .= $vfa816edb83e95bf0c8da580bdfd491ef;}if(isset($vf7c0b9f29873bcb1daa361baa7a89b38["#meta"])) {$v77abb8285d9109fa3adaa962b1d8312f = isset($vf7c0b9f29873bcb1daa361baa7a89b38["#meta"]["name"]) ? $vf7c0b9f29873bcb1daa361baa7a89b38["#meta"]["name"] : "";$vf6b5fef6cb1ab808d349cc3bd4e14816 = isset($vf7c0b9f29873bcb1daa361baa7a89b38["#meta"]["file"]) ? $vf7c0b9f29873bcb1daa361baa7a89b38["#meta"]["file"] : "";}else {$v77abb8285d9109fa3adaa962b1d8312f = "";$vf6b5fef6cb1ab808d349cc3bd4e14816 = "";}$v14511f2f5564650d129ca7cabc333278 = str_replace("%lines%", $v8c872b0c9f80fb4709c8e137d5d2191a, $v14511f2f5564650d129ca7cabc333278);$v14511f2f5564650d129ca7cabc333278 = str_replace("%block_name%", $v77abb8285d9109fa3adaa962b1d8312f, $v14511f2f5564650d129ca7cabc333278);$v14511f2f5564650d129ca7cabc333278 = str_replace("%block_file%", $vf6b5fef6cb1ab808d349cc3bd4e14816, $v14511f2f5564650d129ca7cabc333278);$v14511f2f5564650d129ca7cabc333278 = preg_replace("/%[A-z0-9_]+%/i", "", $v14511f2f5564650d129ca7cabc333278);return $v14511f2f5564650d129ca7cabc333278;}protected function executeShortMacros($v264a818e305e0550c3ee63761dd3d911, array $v87cd8b8808600624d8c590cfc2e6e94b) {$vb2145aac704ce76dbe1ac7adac535b23 = trim($v264a818e305e0550c3ee63761dd3d911, '%');$v79e333907d62f2b72da57dda128668fd = $v264a818e305e0550c3ee63761dd3d911;if ($v264a818e305e0550c3ee63761dd3d911 == '%template_resources%') {return cmsController::getInstance()->getResourcesDirectory(true);}elseif ($v264a818e305e0550c3ee63761dd3d911 == '%template_name%') {if ($v66f6181bcb4cff4cd38fbc804a036db6 = cmsController::getInstance()->detectCurrentDesignTemplate()) {return $v66f6181bcb4cff4cd38fbc804a036db6->getName();}return "";}elseif ($v264a818e305e0550c3ee63761dd3d911 == '%scope%') {return $this->printScopeVariables($v87cd8b8808600624d8c590cfc2e6e94b);}elseif (array_key_exists($vb2145aac704ce76dbe1ac7adac535b23, $v87cd8b8808600624d8c590cfc2e6e94b) && !is_array($v87cd8b8808600624d8c590cfc2e6e94b[$vb2145aac704ce76dbe1ac7adac535b23])) {$v79e333907d62f2b72da57dda128668fd = strval($v87cd8b8808600624d8c590cfc2e6e94b[$vb2145aac704ce76dbe1ac7adac535b23]);}elseif (array_key_exists($vb2145aac704ce76dbe1ac7adac535b23, cmsController::getInstance()->langs) && !is_array(cmsController::getInstance()->langs[$vb2145aac704ce76dbe1ac7adac535b23])) {$v79e333907d62f2b72da57dda128668fd = cmsController::getInstance()->langs[$vb2145aac704ce76dbe1ac7adac535b23];}elseif (isset(self::$shortAliases[$v264a818e305e0550c3ee63761dd3d911])) {$v8bea8b92f33b6d0d1a0b2f50bdb9f55d = self::$shortAliases[$v264a818e305e0550c3ee63761dd3d911];if (isset($v8bea8b92f33b6d0d1a0b2f50bdb9f55d[0])) {$v22884db148f0ffb0d830ba431102b0b5 = $v8bea8b92f33b6d0d1a0b2f50bdb9f55d[0];$vea9f6aca279138c58f705c8d4cb4b8ce = isset($v8bea8b92f33b6d0d1a0b2f50bdb9f55d[1]) ? $v8bea8b92f33b6d0d1a0b2f50bdb9f55d[1] : null;$vb9272c822c7e9b0a0c46e61fd66807a2 = (isset($v8bea8b92f33b6d0d1a0b2f50bdb9f55d[2]) && is_array($v8bea8b92f33b6d0d1a0b2f50bdb9f55d[2])) ? $v8bea8b92f33b6d0d1a0b2f50bdb9f55d[2] : array();return $v7d059d8ffac0a3914b296af280c6194e = $this->executeCompleteMacros($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb9272c822c7e9b0a0c46e61fd66807a2, $v87cd8b8808600624d8c590cfc2e6e94b);}}elseif (($v3b58d9b65bede8bee9c92ba91b7915c9 = $this->getScopeObject()) instanceof umiObject) {if ($vb2145aac704ce76dbe1ac7adac535b23 == 'block-element-id') {$v79e333907d62f2b72da57dda128668fd = $this->scopeElementId > 0 ? $this->scopeElementId : cmsController::getInstance()->getCurrentElementId();}elseif ($vb2145aac704ce76dbe1ac7adac535b23 == 'block-object-id') {$v79e333907d62f2b72da57dda128668fd = $this->scopeObjectId;}elseif ($v3b58d9b65bede8bee9c92ba91b7915c9->getPropByName($vb2145aac704ce76dbe1ac7adac535b23) instanceof umiObjectProperty) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v3b58d9b65bede8bee9c92ba91b7915c9->getValue($vb2145aac704ce76dbe1ac7adac535b23);if(is_object($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {switch (true) {case $v3a6d0284e743dc4a9b86f97d6dd1a3bf instanceof iUmiDate :        $v79e333907d62f2b72da57dda128668fd = $v3a6d0284e743dc4a9b86f97d6dd1a3bf->getFormattedDate("U");break;case $v3a6d0284e743dc4a9b86f97d6dd1a3bf instanceof iUmiFile :        $v79e333907d62f2b72da57dda128668fd = $v3a6d0284e743dc4a9b86f97d6dd1a3bf->getFilePath(true);break;case $v3a6d0284e743dc4a9b86f97d6dd1a3bf instanceof iUmiObject:       case $v3a6d0284e743dc4a9b86f97d6dd1a3bf instanceof iUmiHierarchyElement:        $v79e333907d62f2b72da57dda128668fd = $v3a6d0284e743dc4a9b86f97d6dd1a3bf->getName();break;}}elseif (is_array($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v79e333907d62f2b72da57dda128668fd = "";for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vf19e92e810d08b6cf2d0265b779064d9 = $v3a6d0284e743dc4a9b86f97d6dd1a3bf[$v865c0c0b4ab0e063e5caa3387c1a8741];if(is_numeric($vf19e92e810d08b6cf2d0265b779064d9)) {if($vbe8f80182e0c983916da7338c2c1c040 = umiObjectsCollection::getInstance()->getObject($vf19e92e810d08b6cf2d0265b779064d9)) {$vf19e92e810d08b6cf2d0265b779064d9 = $vbe8f80182e0c983916da7338c2c1c040->getName();}else continue;}if($vf19e92e810d08b6cf2d0265b779064d9 instanceof umiHierarchyElement) {$vf19e92e810d08b6cf2d0265b779064d9 = $vf19e92e810d08b6cf2d0265b779064d9->getName();}$v79e333907d62f2b72da57dda128668fd .= $vf19e92e810d08b6cf2d0265b779064d9;if($v865c0c0b4ab0e063e5caa3387c1a8741 < ($v7dabf5c198b0bab2eaa42bb03a113e55 - 1)) $v79e333907d62f2b72da57dda128668fd .= ", ";}}else {$v79e333907d62f2b72da57dda128668fd = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}}}if ($v79e333907d62f2b72da57dda128668fd === $v264a818e305e0550c3ee63761dd3d911) {return $v264a818e305e0550c3ee63761dd3d911;}$this->parseLevel++;$v79e333907d62f2b72da57dda128668fd = $this->parse($v87cd8b8808600624d8c590cfc2e6e94b, $v79e333907d62f2b72da57dda128668fd);$this->parseLevel--;$v7d059d8ffac0a3914b296af280c6194e = $this->generateMSResultUID();$this->setMSResult($v7d059d8ffac0a3914b296af280c6194e, $v79e333907d62f2b72da57dda128668fd);return $v7d059d8ffac0a3914b296af280c6194e;}protected function executeCompleteMacros($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce = null, $args = array(), array $v87cd8b8808600624d8c590cfc2e6e94b) {$v594c103f2c6e04c3d8ab059f031e0c1a = cmsController::getInstance();$v7d059d8ffac0a3914b296af280c6194e = $this->generateMSResultUID();$v79e333907d62f2b72da57dda128668fd = "%" . $v22884db148f0ffb0d830ba431102b0b5 . " " . $vea9f6aca279138c58f705c8d4cb4b8ce . "(" . implode("," , $args) .")%";$vb439a0ec6d69c6153eb9fd03e39b7216 = count($args);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $vb439a0ec6d69c6153eb9fd03e39b7216;$v865c0c0b4ab0e063e5caa3387c1a8741++) {if (isset(self::$msResultStack[$args[$v865c0c0b4ab0e063e5caa3387c1a8741]])) {$args[$v865c0c0b4ab0e063e5caa3387c1a8741] = self::$msResultStack[$args[$v865c0c0b4ab0e063e5caa3387c1a8741]];}elseif (strpos($args[$v865c0c0b4ab0e063e5caa3387c1a8741], '[ms_') !== false) {$args[$v865c0c0b4ab0e063e5caa3387c1a8741] = str_replace(array_keys(self::$msResultStack), array_values(self::$msResultStack), $args[$v865c0c0b4ab0e063e5caa3387c1a8741]);}}if (is_null($vea9f6aca279138c58f705c8d4cb4b8ce) && is_callable($v22884db148f0ffb0d830ba431102b0b5)) {$v79e333907d62f2b72da57dda128668fd = $v22884db148f0ffb0d830ba431102b0b5($args);}else {$vd8c56561cee88453daa5db9a9ab5354c = null;if ($v22884db148f0ffb0d830ba431102b0b5 == "core" || $v22884db148f0ffb0d830ba431102b0b5 == "system" || $v22884db148f0ffb0d830ba431102b0b5 == "custom") {$vd8c56561cee88453daa5db9a9ab5354c = &system_buildin_load($v22884db148f0ffb0d830ba431102b0b5);}elseif (system_is_allowed($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce)) {$vd8c56561cee88453daa5db9a9ab5354c = $v594c103f2c6e04c3d8ab059f031e0c1a->getModule($v22884db148f0ffb0d830ba431102b0b5);}elseif (defined('DEBUG') && DEBUG) {$v79e333907d62f2b72da57dda128668fd = "You are not allowed to execute {$v22884db148f0ffb0d830ba431102b0b5}/{$vea9f6aca279138c58f705c8d4cb4b8ce}";}else {$v79e333907d62f2b72da57dda128668fd = "";}if ($vd8c56561cee88453daa5db9a9ab5354c) {try {$v79e333907d62f2b72da57dda128668fd = $vd8c56561cee88453daa5db9a9ab5354c->cms_callMethod($vea9f6aca279138c58f705c8d4cb4b8ce, $args);}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$v79e333907d62f2b72da57dda128668fd = $ve1671797c52e15f763380b45e841ec32->getMessage();}}}$this->parseLevel++;$v79e333907d62f2b72da57dda128668fd = $this->parse($v87cd8b8808600624d8c590cfc2e6e94b, $v79e333907d62f2b72da57dda128668fd);$this->parseLevel--;$this->setMSResult($v7d059d8ffac0a3914b296af280c6194e, $v79e333907d62f2b72da57dda128668fd);return $v7d059d8ffac0a3914b296af280c6194e;}protected function parseCompleteMacroses($v9a0364b9e99bb480dd25e1f0284c8555, array $v87cd8b8808600624d8c590cfc2e6e94b) {if (strpos($v9a0364b9e99bb480dd25e1f0284c8555, '%') === false) return $v9a0364b9e99bb480dd25e1f0284c8555;if (preg_match_all("/%([A-z0-9]+)\s+([A-z0-9_]+)\s*\(([^%]*)\)%/mu", $v9a0364b9e99bb480dd25e1f0284c8555, $v9c28d32df234037773be184dbdafc274, PREG_SET_ORDER)) {$va6a909b556f8a04c052735ed46ad70da = array();foreach ($v9c28d32df234037773be184dbdafc274 as $v8bea8b92f33b6d0d1a0b2f50bdb9f55d) {$v264a818e305e0550c3ee63761dd3d911 = $v8bea8b92f33b6d0d1a0b2f50bdb9f55d[0];if (isset($va6a909b556f8a04c052735ed46ad70da[$v264a818e305e0550c3ee63761dd3d911])) continue;$v22884db148f0ffb0d830ba431102b0b5 = $v8bea8b92f33b6d0d1a0b2f50bdb9f55d[1];$vea9f6aca279138c58f705c8d4cb4b8ce = $v8bea8b92f33b6d0d1a0b2f50bdb9f55d[2];if (!$this->isExecuteMacrosAllowed($v22884db148f0ffb0d830ba431102b0b5 . "/" . $vea9f6aca279138c58f705c8d4cb4b8ce)) continue;$args = trim($v8bea8b92f33b6d0d1a0b2f50bdb9f55d[3]);$args = strlen($args) ? explode(",", $args) : array();$vb439a0ec6d69c6153eb9fd03e39b7216 = count($args);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $vb439a0ec6d69c6153eb9fd03e39b7216;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$args[$v865c0c0b4ab0e063e5caa3387c1a8741] = trim($args[$v865c0c0b4ab0e063e5caa3387c1a8741], "'\" ");}$v031162dfa4ba07c7379009026922ac7a = $this->startMacrosExecuteCallReport($v264a818e305e0550c3ee63761dd3d911);$v7d059d8ffac0a3914b296af280c6194e = $this->executeCompleteMacros($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $args, $v87cd8b8808600624d8c590cfc2e6e94b);$this->stopCallReport($v031162dfa4ba07c7379009026922ac7a);$v9a0364b9e99bb480dd25e1f0284c8555 = str_replace($v264a818e305e0550c3ee63761dd3d911, $v7d059d8ffac0a3914b296af280c6194e, $v9a0364b9e99bb480dd25e1f0284c8555);$va6a909b556f8a04c052735ed46ad70da[$v264a818e305e0550c3ee63761dd3d911] = 1;}}return $v9a0364b9e99bb480dd25e1f0284c8555;}private function getCallStack() {if (!self::$callStack) {self::$callStack = new DOMDocument('1.0', 'utf-8');self::$callStack->formatOutput = XML_FORMAT_OUTPUT;self::$callStack->appendChild(self::$callStack->createElement('call-stack'));}return self::$callStack;}public function getCallStackXML() {if ($this->isEnabledCallStack()) {return $this->getCallStack()->saveXML();}return $this->disabledCallStackError();}}class umiTemplaterXSLT extends umiTemplater {private $domXSL;private $domXML;private $additionalVariables;public function parse($v87cd8b8808600624d8c590cfc2e6e94b, $v9a0364b9e99bb480dd25e1f0284c8555 = null) {if (is_null($this->domXSL)) {$this->domXSL = $this->prepareXSL($this->templatesSource);}$va3c3308ab3cad416697b6e49b5481ce2 = ($this->domXML instanceof DOMDocument) ? $this->domXML : $this->prepareXML($v87cd8b8808600624d8c590cfc2e6e94b);$v801f7201346b43f8ee8390a1ef20ddcd = new xsltProcessor;$v801f7201346b43f8ee8390a1ef20ddcd->registerPHPFunctions();if (defined("UMI_XSLT_PROFILER_LOG") && version_compare(PHP_VERSION,'5.3.0','>=')) {$v801f7201346b43f8ee8390a1ef20ddcd->setProfiling(UMI_XSLT_PROFILER_LOG);}if ( !defined("DEBUG") ) {set_error_handler(array(__CLASS__, "errorHandler"));$vffc6e7906299379b87dec3d49db4baed = error_reporting(~E_STRICT);}$v801f7201346b43f8ee8390a1ef20ddcd->importStyleSheet($this->domXSL);if ($va0f97308110b5ffc40d784efae2257bb = cmsController::getInstance()->detectCurrentDesignTemplate()) {$v40def08eb6011aefb2505a262252de92 = array(     'template-name' => $va0f97308110b5ffc40d784efae2257bb->getName(),     'template-resources' => $va0f97308110b5ffc40d784efae2257bb->getResourcesDirectory(true)    );$this->addRequestParams($v801f7201346b43f8ee8390a1ef20ddcd, $v40def08eb6011aefb2505a262252de92);}if (is_array($this->additionalVariables)) {$this->addRequestParams($v801f7201346b43f8ee8390a1ef20ddcd, $this->additionalVariables);}$this->addRequestParams($v801f7201346b43f8ee8390a1ef20ddcd, $_COOKIE);$this->addRequestParams($v801f7201346b43f8ee8390a1ef20ddcd, $_REQUEST);$this->addRequestParams($v801f7201346b43f8ee8390a1ef20ddcd, $_SERVER, "_");$v9b207167e5381c47682c6b4f58a623fb =  $v801f7201346b43f8ee8390a1ef20ddcd->transformToXML($va3c3308ab3cad416697b6e49b5481ce2);if(!defined("DEBUG")) {error_reporting($vffc6e7906299379b87dec3d49db4baed);return restore_error_handler();}return $v9b207167e5381c47682c6b4f58a623fb;}public function setAdditionalVariables(array $vb63119da730344b345cdc8f62a4711e9) {$this->additionalVariables = $vb63119da730344b345cdc8f62a4711e9;}public static function getTemplates($v9cd3487945daada914909f0b525e1284) {$args = func_get_args();unset($args[0]);$result = array();foreach ($args as $v61dd86c2dc75c3f569ec619bd283a33f) {$result[] = 'file://' . $v9cd3487945daada914909f0b525e1284 . "#" . $v61dd86c2dc75c3f569ec619bd283a33f;}return $result;}public static function loadTemplates($v9cd3487945daada914909f0b525e1284) {return array();}public function setXmlDocument(DOMDocument $v0959255e58deb48af99b55012796abd6) {$this->domXML = $v0959255e58deb48af99b55012796abd6;}protected function prepareXML($v87cd8b8808600624d8c590cfc2e6e94b) {if ($v87cd8b8808600624d8c590cfc2e6e94b instanceof DOMDocument) return $v87cd8b8808600624d8c590cfc2e6e94b;$va3c3308ab3cad416697b6e49b5481ce2 = new DOMDocument("1.0", "utf-8");$va3c3308ab3cad416697b6e49b5481ce2->formatOutput = XML_FORMAT_OUTPUT;$v173a1756d2d82394cb803161f70f9a38 = $va3c3308ab3cad416697b6e49b5481ce2->appendChild($va3c3308ab3cad416697b6e49b5481ce2->createElement("result"));$v173a1756d2d82394cb803161f70f9a38->setAttribute('xmlns:xlink', 'http://www.w3.org/TR/xlink');$v607f2f3099f2a347b327caa70e0be4b2 = new xmlTranslator($va3c3308ab3cad416697b6e49b5481ce2);$v607f2f3099f2a347b327caa70e0be4b2->translateToXml($v173a1756d2d82394cb803161f70f9a38, $v87cd8b8808600624d8c590cfc2e6e94b);return $va3c3308ab3cad416697b6e49b5481ce2;}protected function prepareXSL($v9cd3487945daada914909f0b525e1284) {if (!is_file($v9cd3487945daada914909f0b525e1284)) {throw new coreException('Not found template "' . $v9cd3487945daada914909f0b525e1284 . '".', 10004);}$v5b2c3a197b9a058bc3b5afd8120441d4 = new DOMDocument('1.0', 'utf-8');$v5b2c3a197b9a058bc3b5afd8120441d4->resolveExternals = true;$v5b2c3a197b9a058bc3b5afd8120441d4->substituteEntities = true;$v5b2c3a197b9a058bc3b5afd8120441d4->load($v9cd3487945daada914909f0b525e1284, DOM_LOAD_OPTIONS);return $v5b2c3a197b9a058bc3b5afd8120441d4;}protected function addRequestParams(xsltProcessor $v801f7201346b43f8ee8390a1ef20ddcd, $vf1f713c9e000f5d3f280adbd124df4f5, $v851f5ac9941d720844d143ed9cfcf60a = "") {foreach($vf1f713c9e000f5d3f280adbd124df4f5 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {$v3c6e0b8a9c15224a8228b9a98ca1531d = strtolower($v3c6e0b8a9c15224a8228b9a98ca1531d);if(!is_array($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {if(strpos($v3a6d0284e743dc4a9b86f97d6dd1a3bf, "'") !== false && strpos($v3a6d0284e743dc4a9b86f97d6dd1a3bf, "\"") !== false) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = str_replace("'", "\\\"", $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}$v3c6e0b8a9c15224a8228b9a98ca1531d = str_replace(array(':'), array(''), $v3c6e0b8a9c15224a8228b9a98ca1531d);$v801f7201346b43f8ee8390a1ef20ddcd->setParameter("", $v851f5ac9941d720844d143ed9cfcf60a . $v3c6e0b8a9c15224a8228b9a98ca1531d, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}else {$this->addRequestParams($v801f7201346b43f8ee8390a1ef20ddcd, $v3a6d0284e743dc4a9b86f97d6dd1a3bf, $v851f5ac9941d720844d143ed9cfcf60a . $v3c6e0b8a9c15224a8228b9a98ca1531d . ".");}}}public static function errorHandler($v70106d0d821513f45702b7d25664ab7c, $v809b1abe3f111fd3bb1a54c62706129f, $v1407f5af8e27ad3df1c3300918c80813, $vc2d4b0be0178288d69e1fbfd34098cc3, $ve1671797c52e15f763380b45e841ec32) {if( defined("DEBUG") ||    !function_exists("libxml_get_last_error") ||    $vc2d4b0be0178288d69e1fbfd34098cc3 != 0 ||    $v70106d0d821513f45702b7d25664ab7c != 2   ) return;throw new libXMLErrorException(libxml_get_last_error());}}interface iTemplater {public function init();public function loadLangs();public function putLangs($va43c1b0aa53a0c908810c06ab1ff3967);public function parseInput($va43c1b0aa53a0c908810c06ab1ff3967);public function parseResult();public function parseContent($v47c80780ab608cc046f2a6e6f071feb6, $v640eac53ad75db5c49a9ec86390d8530);public function loadTemplates($v6a2a431fe8b621037ea949531c28551d, $v4a8a08f09d37b73795649038408b5f33, $args);public function parseMacros($vdc3ef687d19cc2fb071d846f9360ecbe);public function executeMacros($v8ee1d4327d02df333859c8dd0101aae8);public static function pushEditable($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb80bb7740288fda1f201890375a60c8f);public function cleanUpResult($va43c1b0aa53a0c908810c06ab1ff3967);}class templater extends singleton {public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return cmsController::getInstance()->getCurrentTemplater();}protected function __construct() {}public function init() {}public function loadLangs() {}public function putLangs($va43c1b0aa53a0c908810c06ab1ff3967) {}public function parseInput($va43c1b0aa53a0c908810c06ab1ff3967) {}public function parseResult() {}public function parseContent($v47c80780ab608cc046f2a6e6f071feb6, $v640eac53ad75db5c49a9ec86390d8530) {}public function loadTemplates($v6a2a431fe8b621037ea949531c28551d, $v4a8a08f09d37b73795649038408b5f33, $args) {return array();}public function parseMacros($vdc3ef687d19cc2fb071d846f9360ecbe) {return def_module::parseTPLMacroses($vdc3ef687d19cc2fb071d846f9360ecbe);}public function executeMacros($v8ee1d4327d02df333859c8dd0101aae8) {}public static function pushEditable($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb80bb7740288fda1f201890375a60c8f) {return def_module::pushEditable($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb80bb7740288fda1f201890375a60c8f);}final public static function getSomething($v0f4153145310ca3a80263d772ccd01d4 = "pro", $v524605ba82e4bb94b84e3a394c2b5879 = null) {return umiTemplater::getSomething($v0f4153145310ca3a80263d772ccd01d4, $v524605ba82e4bb94b84e3a394c2b5879);}public function cleanUpResult($va43c1b0aa53a0c908810c06ab1ff3967) {}}class tplTemplater extends singleton {protected function __construct() {}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return umiTemplater::create('TPL', null);}}interface iCmsController {public function loadBuildInModule($v52a43e48ec4649dee819dadabcab1bde);public function getModule($v52a43e48ec4649dee819dadabcab1bde);public function installModule($v52a43e48ec4649dee819dadabcab1bde);public function getSkinPath();public function getCurrentModule();public function getCurrentMethod();public function getCurrentElementId();public function getCurrentMode();public function getCurrentDomain();public function getCurrentTemplater();public function getCurrentLang();public function getLang();public function setCurrentModule($v52a43e48ec4649dee819dadabcab1bde);public function setCurrentMethod($vddaa6e8c8c412299272e183087b8f7b6);public function getRequestId();public function getPreLang();public function calculateRefererUri();public function getCalculatedRefererUri();}class cmsController extends singleton implements iSingleton, iCmsController {public static $IGNORE_MICROCACHE = false;public $isContentMode = false;public $parsedContent = false;public $currentTitle = false;public $currentHeader = false;public $currentMetaKeywords = false;public $currentMetaDescription = false;public $currentEditElementId = false;public $langs = array();public $pre_lang = '';public $langs_export = array();public $errorUrl;public $headerLabel = false;protected $current_lang = false;protected $current_domain = false;protected $current_templater = false;protected $modules = array();protected $current_module = false;protected $current_method = false;protected $current_mode = false;protected $current_element_id = false;protected $calculated_referer_uri = false;protected $modulesPath;protected $url_prefix = '';protected $adminDataSet = array();private $skipExecuteMethods = array(   'eshop/compare',   'faq/question', 'faq/project', 'faq/category',   'blogs20/blog', 'blogs20/post', 'blogs20/postEdit',   'catalog/category', 'catalog/getObjectsList', 'catalog/object', 'catalog/viewObject', 'catalog/search',   'content/content', 'content/sitemap',   'dispatches/unsubscribe', 'dispatches/subscribe', 'dispatches/subscribe_do',   'emarket/compare', 'emarket/order', 'emarket/purchase',   'filemanager/shared_file',   'forum/confs_list', 'forum/conf', 'forum/topic', 'forum/topic_last_message', 'forum/conf_last_message',   'news/lastlist', 'news/rubric', 'news/view', 'news/related_links', 'news/item', 'news/listlents', 'news/lastlents',   'photoalbum/album', 'photoalbum/photo',   'search/search_do', 'search/suggestions',   'users/settings', 'users/registrate', 'users/registrate_done', 'users/activate', 'users/auth',   'vote/poll', 'vote/insertvote', 'vote/results',   'webforms/page', 'webforms/posted'  );protected function __construct() {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();showWorkTime("cmscontroller mainconfig init");$this->modulesPath = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.modules');showWorkTime("cmscontroller includeparam");$this->init();showWorkTime("cmscontroller init");}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function loadBuildInModule($v52a43e48ec4649dee819dadabcab1bde) {}public function getModule($v52a43e48ec4649dee819dadabcab1bde) {if (!$v52a43e48ec4649dee819dadabcab1bde) {return false;}if (array_key_exists($v52a43e48ec4649dee819dadabcab1bde, $this->modules)) {return $this->modules[$v52a43e48ec4649dee819dadabcab1bde];}else {return $this->loadModule($v52a43e48ec4649dee819dadabcab1bde);}}public function isModule($v52a43e48ec4649dee819dadabcab1bde) {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();if ($vb1444fb0c07653567ad325aa25d4e37a->getVal('//modules/' . $v52a43e48ec4649dee819dadabcab1bde)) {return true;}else {return false;}}public function installModule($v8e74155194666debb2f773d1de2ae7fe) {$INFO = array();$COMPONENTS = array();if (!file_exists($v8e74155194666debb2f773d1de2ae7fe)) {throw new publicAdminException(getLabel("label-errors-13052"), 13052);}require_once $v8e74155194666debb2f773d1de2ae7fe;$vab8a0f7d0c92ada791303247020c58dd = null;if (preg_match('|\/modules\/(\S+)\/|i', $v8e74155194666debb2f773d1de2ae7fe, $v9c28d32df234037773be184dbdafc274)) {$vab8a0f7d0c92ada791303247020c58dd = $v9c28d32df234037773be184dbdafc274[1];}if ($vab8a0f7d0c92ada791303247020c58dd != $INFO['name']) {throw new publicAdminException(getLabel("label-errors-13053"), 13053);}$this->checkModuleByName($vab8a0f7d0c92ada791303247020c58dd);$this->checkModuleComponents($COMPONENTS);def_module::install($INFO);}public function getSkinPath() {}public function getCurrentModule() {return $this->current_module;}public function getCurrentMethod() {return $this->current_method;}public function getCurrentElementId() {return $this->current_element_id;}public function getLang() {return $this->current_lang;}public function setLang($v7572559ca86e781ba8fe8073a0b725c6) {$this->current_lang = $v7572559ca86e781ba8fe8073a0b725c6;}public function getCurrentLang() {return $this->getLang();}public function getCurrentMode() {return $this->current_mode;}public function getCurrentDomain() {return $this->current_domain;}public function getCurrentTemplater() {if (!$this->current_templater instanceof umiTemplater) {$this->detectCurrentTemplater();}if (!$this->current_templater instanceof umiTemplater) {throw new coreException("Can't detect current templater.");}return $this->current_templater;}public function getResourcesDirectory($v64feae0988f5b61c96c305e3c3f04551 = false) {if ($this->getCurrentMode() == 'admin') {if (($v66f6181bcb4cff4cd38fbc804a036db6 = templatesCollection::getInstance()->getDefaultTemplate()) instanceof template) {return $v66f6181bcb4cff4cd38fbc804a036db6->getResourcesDirectory($v64feae0988f5b61c96c305e3c3f04551);}return false;}if (($v66f6181bcb4cff4cd38fbc804a036db6 = $this->detectCurrentDesignTemplate()) instanceof template) {return $v66f6181bcb4cff4cd38fbc804a036db6->getResourcesDirectory($v64feae0988f5b61c96c305e3c3f04551);}else {return false;}}public function getTemplatesDirectory() {if (($v66f6181bcb4cff4cd38fbc804a036db6 = $this->detectCurrentDesignTemplate()) instanceof template) {return $v66f6181bcb4cff4cd38fbc804a036db6->getTemplatesDirectory();}else {return CURRENT_WORKING_DIR . "xsltTpls/";}}public function setCurrentTemplater() {return $this->getCurrentTemplater();}public function getGlobalVariables($v2d4260a0fcf0c77266e1b8f41bd4080c = false) {static $v6d9fecd2868e8a635b6d088c3e8068c2;if (!$v2d4260a0fcf0c77266e1b8f41bd4080c && !is_null($v6d9fecd2868e8a635b6d088c3e8068c2)) return $v6d9fecd2868e8a635b6d088c3e8068c2;$v6d9fecd2868e8a635b6d088c3e8068c2 = array();if ($this->getCurrentMode() == 'admin') {return $v6d9fecd2868e8a635b6d088c3e8068c2 = $this->prepareAdminSideGlobalVariables();}if (def_module::isXSLTResultMode()) {return $v6d9fecd2868e8a635b6d088c3e8068c2 = $this->prepareClientSideGlobalVariablesForXSLT();}else {return $v6d9fecd2868e8a635b6d088c3e8068c2 = $this->prepareClientSideGlobalVariablesForTPL();}}public function executeStream($v9305b73d359bd06734fee0b3638079e1) {if (($v8d777f385d3dfec8815d20f7496026dc = @file_get_contents($v9305b73d359bd06734fee0b3638079e1)) === false) {$v9305b73d359bd06734fee0b3638079e1 .= (strpos($v9305b73d359bd06734fee0b3638079e1, "?") === false) ? '?r=' : '&r=';$v9305b73d359bd06734fee0b3638079e1 .= uniqid('');if (($v8d777f385d3dfec8815d20f7496026dc = @file_get_contents($v9305b73d359bd06734fee0b3638079e1)) === false) {throw new coreException("Failed to open udata:// stream");}}return $v8d777f385d3dfec8815d20f7496026dc;}public function isAllowedExecuteMethod($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce) {return !in_array($v22884db148f0ffb0d830ba431102b0b5 . '/' . $vea9f6aca279138c58f705c8d4cb4b8ce, $this->skipExecuteMethods);}public function detectCurrentDesignTemplate() {static $vb048e7dfca99df0ea367940c9e517f95 = null;if ($vb048e7dfca99df0ea367940c9e517f95 instanceof template) {return $vb048e7dfca99df0ea367940c9e517f95;}$vfed36e93a0509e20f2dc96cbbd85b678 = templatesCollection::getInstance();$v66f6181bcb4cff4cd38fbc804a036db6 = null;if ($v3200a31fc05da4e9d5a0465c36822e2f = getRequest('template_id')) {$v66f6181bcb4cff4cd38fbc804a036db6 = $vfed36e93a0509e20f2dc96cbbd85b678->getTemplate((int) $v3200a31fc05da4e9d5a0465c36822e2f);}if (!$v66f6181bcb4cff4cd38fbc804a036db6 instanceof template) {$v66f6181bcb4cff4cd38fbc804a036db6 = $vfed36e93a0509e20f2dc96cbbd85b678->getCurrentTemplate();}return $v66f6181bcb4cff4cd38fbc804a036db6;}public function analyzePath($v86266ee937d97f812a8e57d22b62ee29 = false) {showWorkTime("analyzePath started");$vd6fe1d0be6347b8ef2427fa629c04485 = trim(getRequest('path'), '/');if (!is_null(getRequest('scheme'))) {if (preg_replace('/[^\w]/im', "", getRequest('scheme')) == 'upage') {preg_match_all('/[\d]+/', $vd6fe1d0be6347b8ef2427fa629c04485, $v7552cd149af7495ee7d8225974e50f80);$this->current_element_id = $v7552cd149af7495ee7d8225974e50f80[0][0];}return;}showWorkTime("analyzePath something");$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();showWorkTime("analyzePath regedit init");$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();showWorkTime("analyzePath umiHierarchy init");$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();showWorkTime("analyzePath mainConfiguration init");$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();showWorkTime("analyzePath outputBuffer init");if ($v86266ee937d97f812a8e57d22b62ee29 === true) {$this->reset();}$v5f44c555cfb3ecb28f624fa95617f277 = $v2245023265ae4cf87d02c8b6ba991139->get('seo', 'url-suffix');$v5e0bdcbddccca4d66d74ba8c1cee1a68 = strrpos($vd6fe1d0be6347b8ef2427fa629c04485, $v5f44c555cfb3ecb28f624fa95617f277);if ($v5e0bdcbddccca4d66d74ba8c1cee1a68 && ($v5e0bdcbddccca4d66d74ba8c1cee1a68 + strlen($v5f44c555cfb3ecb28f624fa95617f277) == strlen($vd6fe1d0be6347b8ef2427fa629c04485))) {$vd6fe1d0be6347b8ef2427fa629c04485 = substr($vd6fe1d0be6347b8ef2427fa629c04485, 0, $v5e0bdcbddccca4d66d74ba8c1cee1a68);}if ($v2245023265ae4cf87d02c8b6ba991139->get('seo', 'url-suffix.add')) {def_module::requireSlashEnding();}if ($v2245023265ae4cf87d02c8b6ba991139->get('seo', 'watch-redirects-history')) {redirects::getInstance()->init();}$v1af4d7e444526825e8273a27c76ccc15 = $this->getPathArray();$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v1af4d7e444526825e8273a27c76ccc15);$vfbd6d3bc6d9b383e6f427016a01082cb = Array();$v83878c91171338902e0fe0fb97a8c47a = 0;for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v1634b7ef7a71f9ae79c4b3b3badd71a0 = $v1af4d7e444526825e8273a27c76ccc15[$v865c0c0b4ab0e063e5caa3387c1a8741];if ($v865c0c0b4ab0e063e5caa3387c1a8741 <= 1) {if (($v1634b7ef7a71f9ae79c4b3b3badd71a0 == $this->current_mode) || ($v1634b7ef7a71f9ae79c4b3b3badd71a0 == $this->current_lang->getPrefix())) {continue;}}$vfbd6d3bc6d9b383e6f427016a01082cb[] = $v1634b7ef7a71f9ae79c4b3b3badd71a0;$v1f43049ea0e20666083161da84dfb54e = $this->getSubPathType($v1634b7ef7a71f9ae79c4b3b3badd71a0);if ($v1f43049ea0e20666083161da84dfb54e == "PARAM") {$_REQUEST['param' . $v83878c91171338902e0fe0fb97a8c47a++] = $v1634b7ef7a71f9ae79c4b3b3badd71a0;}}if (!$this->current_module) {if ($this->current_mode == "admin") {if ($vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/default_module_admin_changed") || ! $v52a43e48ec4649dee819dadabcab1bde = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/events")) {$v52a43e48ec4649dee819dadabcab1bde = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/default_module_admin");}else {$v52a43e48ec4649dee819dadabcab1bde = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/events");}$this->autoRedirectToMethod($v52a43e48ec4649dee819dadabcab1bde);}else {$v52a43e48ec4649dee819dadabcab1bde = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/default_module");}$this->setCurrentModule($v52a43e48ec4649dee819dadabcab1bde);}if (!$this->current_method) {if ($this->current_mode == "admin") {return $this->autoRedirectToMethod($this->current_module);}else {$v2fa70149e2a7e75da2b0303d0a36a944 = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/" . $this->current_module . "/default_method");}$this->setCurrentMethod($v2fa70149e2a7e75da2b0303d0a36a944);}if ($this->getCurrentMode() == "admin") {return;}$v7552cd149af7495ee7d8225974e50f80 = false;$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($vfbd6d3bc6d9b383e6f427016a01082cb);$v1634b7ef7a71f9ae79c4b3b3badd71a0 = "";$v5f51e765b4dc9821bb184fe18370ab8d = 0;for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v1634b7ef7a71f9ae79c4b3b3badd71a0 .= "/" . $vfbd6d3bc6d9b383e6f427016a01082cb[$v865c0c0b4ab0e063e5caa3387c1a8741];if (!($vfa816edb83e95bf0c8da580bdfd491ef = $vb81ca7c0ccaa77e7aa91936ab0070695->getIdByPath($v1634b7ef7a71f9ae79c4b3b3badd71a0, false, $v5f51e765b4dc9821bb184fe18370ab8d))) {$v7552cd149af7495ee7d8225974e50f80 = false;break;}else {$v7552cd149af7495ee7d8225974e50f80 = $vfa816edb83e95bf0c8da580bdfd491ef;}}if ($v7552cd149af7495ee7d8225974e50f80) {if ($v5f51e765b4dc9821bb184fe18370ab8d > 0 && !defined("DISABLE_AUTOCORRECTION_REDIRECT")) {$vd6fe1d0be6347b8ef2427fa629c04485 = $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById($v7552cd149af7495ee7d8225974e50f80);if ($v865c0c0b4ab0e063e5caa3387c1a8741 == 0) {if ($this->isModule($vfbd6d3bc6d9b383e6f427016a01082cb[0])) {$v7552cd149af7495ee7d8225974e50f80 = false;}}$v7f2db423a49b305459147332fb01cf87->status('301 Moved Permanently');$v7f2db423a49b305459147332fb01cf87->redirect($vd6fe1d0be6347b8ef2427fa629c04485);}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsDefault()) {$vd6fe1d0be6347b8ef2427fa629c04485 = $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById($v7552cd149af7495ee7d8225974e50f80);$v7f2db423a49b305459147332fb01cf87->status('301 Moved Permanently');$v7f2db423a49b305459147332fb01cf87->redirect($vd6fe1d0be6347b8ef2427fa629c04485);}}}elseif (isset($vfbd6d3bc6d9b383e6f427016a01082cb[0])) {if ($this->isModule($vfbd6d3bc6d9b383e6f427016a01082cb[0])) {$v22884db148f0ffb0d830ba431102b0b5 = $this->getModule($vfbd6d3bc6d9b383e6f427016a01082cb[0]);if (isset($vfbd6d3bc6d9b383e6f427016a01082cb[1]) && !$v22884db148f0ffb0d830ba431102b0b5->isMethodExists($vfbd6d3bc6d9b383e6f427016a01082cb[1])) {$this->setCurrentModule('content');$this->setCurrentMethod('content');}}else {$this->setCurrentModule('content');$this->setCurrentMethod('content');}}if (($vd6fe1d0be6347b8ef2427fa629c04485 == "" || $vd6fe1d0be6347b8ef2427fa629c04485 == $this->current_lang->getPrefix() ) && $this->current_mode != "admin") {if($v7552cd149af7495ee7d8225974e50f80 = $vb81ca7c0ccaa77e7aa91936ab0070695->getDefaultElementId($this->getCurrentLang()->getId(), $this->getCurrentDomain()->getId())) {$this->current_element_id = $v7552cd149af7495ee7d8225974e50f80;}}if ($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80, true)) {$v599dcce2998a6b40b1e38e8c6006cb0a = umiHierarchyTypesCollection::getInstance()->getType($v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId());if (!$v599dcce2998a6b40b1e38e8c6006cb0a) {return false;}$this->current_module = $v599dcce2998a6b40b1e38e8c6006cb0a->getName();if ($vabf77184f55403d75b9d51d79162a7ca = $v599dcce2998a6b40b1e38e8c6006cb0a->getExt()) {$this->setCurrentMethod($vabf77184f55403d75b9d51d79162a7ca);}else {$this->setCurrentMethod("content");}$this->current_element_id = $v7552cd149af7495ee7d8225974e50f80;}if ($this->current_module == "content" && $this->current_method == "content" && !$v7552cd149af7495ee7d8225974e50f80) {redirects::getInstance()->redirectIfRequired($vd6fe1d0be6347b8ef2427fa629c04485);}}public function setCurrentModule($v854203cccade0bbe21be239a208aea49) {$this->current_module = $v854203cccade0bbe21be239a208aea49;}public function setCurrentMode($v15d61712450a686a7f365adf4fef581f) {$this->current_mode = $v15d61712450a686a7f365adf4fef581f;}public function setAdminDataSet($v181746b262df9e42f6016b8637fc8c52) {$this->adminDataSet = $v181746b262df9e42f6016b8637fc8c52;}public function setCurrentMethod($v2fa70149e2a7e75da2b0303d0a36a944) {$v2f3a4fccca6406e35bcf33e92dd93135 = array(    "__construct",    "__destruct",    "__call",    "__callStatic",    "__get",    "__set",    "__isset",    "__unset",    "__sleep",    "__wakeup",    "__toString",    "__invoke",    "__set_state",    "__clone"   );if (in_array($v2fa70149e2a7e75da2b0303d0a36a944, $v2f3a4fccca6406e35bcf33e92dd93135)) {$this->current_module = "content";$this->current_method = "notfound";return false;}$this->current_method = $v2fa70149e2a7e75da2b0303d0a36a944;}public function loadLangs() {showWorkTime("loadLangs started");$v0eb9b3af2e4a00837a1b1a854c9ea18c = regedit::getInstance()->getList("//modules");showWorkTime("loadLangs getList");foreach ($v0eb9b3af2e4a00837a1b1a854c9ea18c as $v22884db148f0ffb0d830ba431102b0b5) {$v52a43e48ec4649dee819dadabcab1bde = $v22884db148f0ffb0d830ba431102b0b5[0];$v44a27232cc56832b9ff4600733c80eba = CURRENT_WORKING_DIR . '/classes/modules/' . $v52a43e48ec4649dee819dadabcab1bde . '/lang.php';if (file_exists($v44a27232cc56832b9ff4600733c80eba)) {require $v44a27232cc56832b9ff4600733c80eba;}if (isset($C_LANG)) {if (is_array($C_LANG)) {$this->langs[$v52a43e48ec4649dee819dadabcab1bde] = $C_LANG;unset($C_LANG);}}if (isset($LANG_EXPORT)) {if (is_array($LANG_EXPORT)) {$this->langs = array_merge($this->langs, $LANG_EXPORT);unset($LANG_EXPORT);}}$v44a27232cc56832b9ff4600733c80eba = CURRENT_WORKING_DIR . '/classes/modules/' . $v52a43e48ec4649dee819dadabcab1bde . '/lang.' . $this->getCurrentLang()->getPrefix() .'.php';if (file_exists($v44a27232cc56832b9ff4600733c80eba)) {require $v44a27232cc56832b9ff4600733c80eba;if (isset($C_LANG) && is_array($C_LANG)) {$this->langs[$v52a43e48ec4649dee819dadabcab1bde] = $C_LANG;unset($C_LANG);}if (isset($LANG_EXPORT) && is_array($LANG_EXPORT)) {$this->langs = array_merge($this->langs, $LANG_EXPORT);unset($LANG_EXPORT);}}showWorkTime("loadLangs " . $v52a43e48ec4649dee819dadabcab1bde . " loaded", 1);}$v606d70ea1d6f03c2fc9b74fffa0648fd = CURRENT_WORKING_DIR . '/classes/modules/lang.' . $this->getLang()->getPrefix() . '.php';if (!file_exists($v606d70ea1d6f03c2fc9b74fffa0648fd)) {$v606d70ea1d6f03c2fc9b74fffa0648fd = CURRENT_WORKING_DIR . '/classes/modules/lang.php';}include_once $v606d70ea1d6f03c2fc9b74fffa0648fd;if (isset($LANG_EXPORT)) {$this->langs = array_merge($this->langs, $LANG_EXPORT);unset($LANG_EXPORT);}}public function getModulesList() {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v10ae9fc7d453b0dd525d0edf2ede7961 = $vb1444fb0c07653567ad325aa25d4e37a->getList('//modules');$result = array();foreach ($v10ae9fc7d453b0dd525d0edf2ede7961 as $v47c80780ab608cc046f2a6e6f071feb6) {$result[] = getArrayKey($v47c80780ab608cc046f2a6e6f071feb6, 0);}return $result;}public static function isCSRFTokenValid() {if (! mainConfiguration::getInstance()->get('kernel', 'csrf_protection')) {return true;}if (strlen(getRequest('csrf')) && strlen(getArrayKey($_SESSION, 'csrf_token')) && getRequest('csrf') == getArrayKey($_SESSION, 'csrf_token')) {return true;}return false;}public function getRequestId() {static $v510ff634fce407eea1763854519fd3ce = false;if ($v510ff634fce407eea1763854519fd3ce === false) {$v510ff634fce407eea1763854519fd3ce = time();}return $v510ff634fce407eea1763854519fd3ce;}public function getPreLang() {return $this->pre_lang;}public function calculateRefererUri() {if ($vc66c00ae9f18fc0c67d8973bd07dc4cd = getRequest('referer')) {$_SESSION['referer'] = $vc66c00ae9f18fc0c67d8973bd07dc4cd;}else {if ($vc66c00ae9f18fc0c67d8973bd07dc4cd = getSession('referer')) {unset($_SESSION['referer']);}else {$vc66c00ae9f18fc0c67d8973bd07dc4cd = getServer('HTTP_REFERER');}}$this->calculated_referer_uri = $vc66c00ae9f18fc0c67d8973bd07dc4cd;}public function getCalculatedRefererUri() {if ($this->calculated_referer_uri === false) {$this->calculateRefererUri();}return $this->calculated_referer_uri;}public function setUrlPrefix($v851f5ac9941d720844d143ed9cfcf60a = '') {$this->url_prefix = $v851f5ac9941d720844d143ed9cfcf60a;}public function getUrlPrefix(){return $this->url_prefix ? $this->url_prefix : '';}protected function autoRedirectToMethod($v22884db148f0ffb0d830ba431102b0b5) {$v62ea6f6afc97ea165e347bf07ad07e1c = $this->pre_lang;$vea9f6aca279138c58f705c8d4cb4b8ce = regedit::getInstance()->getVal("//modules/" . $v22884db148f0ffb0d830ba431102b0b5 . "/default_method_admin");$v572d4e421e5e6b9bc11d815e8a027112 = $v62ea6f6afc97ea165e347bf07ad07e1c . "/admin/" . $v22884db148f0ffb0d830ba431102b0b5 . "/" . $vea9f6aca279138c58f705c8d4cb4b8ce . "/";outputBuffer::current()->redirect($v572d4e421e5e6b9bc11d815e8a027112);}final private function doSomething () {return false;if (defined("CRON") && (constant('CRON') == 'CLI')) {return true;}if (defined("CURRENT_VERSION_LINE") && CURRENT_VERSION_LINE != "demo") {require CURRENT_WORKING_DIR . "/errors/invalid_license.html";exit();}if (!is_writable(SYS_CACHE_RUNTIME) || (file_exists(SYS_CACHE_RUNTIME.'registry') && !is_writable(SYS_CACHE_RUNTIME.'registry'))) {require CURRENT_WORKING_DIR . "/errors/invalid_permissions.html";exit();}$v1a54c1036ccb10069e9c06281d52007a = regedit::getInstance()->getVal("//settings/keycode");if($this->doStrangeThings($v1a54c1036ccb10069e9c06281d52007a)) {return true;}$vdff71ebdd1d2cd4cd12e2eea2893fd84 = array(    'pro' => umiTemplater::getSomething("pro"),    'shop' => umiTemplater::getSomething("shop"),    'lite' => umiTemplater::getSomething("lite"),    'start' => umiTemplater::getSomething("start"),    'trial' => umiTemplater::getSomething("trial")   );if (regedit::checkSomething($v1a54c1036ccb10069e9c06281d52007a, $vdff71ebdd1d2cd4cd12e2eea2893fd84)) {return true;}else {require CURRENT_WORKING_DIR . "/errors/invalid_license.html";exit();}}final private function doStrangeThings($v1a54c1036ccb10069e9c06281d52007a) {$v0a7c842c53a6565aeae98fb6ff6b5348 = SYS_CACHE_RUNTIME . 'trash';$vf8df9d3951d8908e1cd5866d10330542 = false;$vcd91e7679d575a2c548bd2c889c23b9e = 604800;if (file_exists($v0a7c842c53a6565aeae98fb6ff6b5348)) {if ((time() - filemtime($v0a7c842c53a6565aeae98fb6ff6b5348)) > $vcd91e7679d575a2c548bd2c889c23b9e) {$vf8df9d3951d8908e1cd5866d10330542 = base64_decode(file_get_contents($v0a7c842c53a6565aeae98fb6ff6b5348));}}else {file_put_contents($v0a7c842c53a6565aeae98fb6ff6b5348, base64_encode($v1a54c1036ccb10069e9c06281d52007a));}if ($vf8df9d3951d8908e1cd5866d10330542 !== false && $v1a54c1036ccb10069e9c06281d52007a) {if ($v1a54c1036ccb10069e9c06281d52007a === $vf8df9d3951d8908e1cd5866d10330542) {return true;}}return false;}private function loadModule($v52a43e48ec4649dee819dadabcab1bde) {if (!defined("CURRENT_VERSION_LINE")) {define("CURRENT_VERSION_LINE", "");}if (regedit::getInstance()->getVal("//modules/" . $v52a43e48ec4649dee819dadabcab1bde) != $v52a43e48ec4649dee819dadabcab1bde) {return false;}$vc22d45567638173f6f7c953f54077fbd = $this->modulesPath . $v52a43e48ec4649dee819dadabcab1bde . "/class.php";if (!file_exists($vc22d45567638173f6f7c953f54077fbd)) {return false;}if (!class_exists($v52a43e48ec4649dee819dadabcab1bde)) {require($vc22d45567638173f6f7c953f54077fbd);}$v22884db148f0ffb0d830ba431102b0b5 = new $v52a43e48ec4649dee819dadabcab1bde();$v22884db148f0ffb0d830ba431102b0b5->pre_lang = $this->pre_lang;$v22884db148f0ffb0d830ba431102b0b5->pid = $this->getCurrentElementId();$this->modules[$v52a43e48ec4649dee819dadabcab1bde] = $v22884db148f0ffb0d830ba431102b0b5;return $v22884db148f0ffb0d830ba431102b0b5;}private function checkModuleComponents($v4725dcf446a342f1473a8228e42dfa48) {if (!is_array($v4725dcf446a342f1473a8228e42dfa48)) {return false;}$v45b963397aa40d4a0063e0d85e4fe7a1 = array();foreach ($v4725dcf446a342f1473a8228e42dfa48 as $v700c216fb376666eaeda0c892e8bdc09) {$v8c7dd922ad47494fc02c388e12c00eac = preg_replace('/.\/(.+)/', CURRENT_WORKING_DIR . '/' . "$1", $v700c216fb376666eaeda0c892e8bdc09);if (!file_exists($v8c7dd922ad47494fc02c388e12c00eac) || !is_readable($v8c7dd922ad47494fc02c388e12c00eac)) {$v45b963397aa40d4a0063e0d85e4fe7a1[] = $v8c7dd922ad47494fc02c388e12c00eac;}}if (count($v45b963397aa40d4a0063e0d85e4fe7a1)) {$vcb5e100e5a9a3e7f6d1fd97512215282 = getLabel("label-errors-13058") . "\n";foreach ($v45b963397aa40d4a0063e0d85e4fe7a1 as $v8c7dd922ad47494fc02c388e12c00eac) {$vcb5e100e5a9a3e7f6d1fd97512215282 .= getLabel('error-file-does-not-exist', null, $v8c7dd922ad47494fc02c388e12c00eac) . "\n";}throw new coreException($vcb5e100e5a9a3e7f6d1fd97512215282);}return true;}private function checkModuleByName($v52a43e48ec4649dee819dadabcab1bde) {if (!defined("UPDATE_SERVER")) {define("UPDATE_SERVER", base64_decode('aHR0cDovL3VwZGF0ZXMudW1pLWNtcy5ydS91cGRhdGVzZXJ2ZXIv'));}$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v14a0ffee308315f250f040d5b4d48560 = domainsCollection::getInstance();$vcaf9b6b99962bf5c2264824231d7a40c = array(    'type' => 'get-modules-list',    'revision' => $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/autoupdate/system_build"),    'host' => $v14a0ffee308315f250f040d5b4d48560->getDefaultDomain()->getHost(),    'ip' => getServer('SERVER_ADDR'),    'key' => $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/keycode")   );$v572d4e421e5e6b9bc11d815e8a027112 = UPDATE_SERVER . "?" . http_build_query($vcaf9b6b99962bf5c2264824231d7a40c, '', '&');$result = $this->getFile($v572d4e421e5e6b9bc11d815e8a027112);if (!$result) {throw new publicAdminException(getLabel("label-errors-13054"), 13054);}$v0f635d0e0f3874fff8b581c132e6c7a7 = new DOMDocument();if (!$v0f635d0e0f3874fff8b581c132e6c7a7->loadXML($result)) {throw new publicAdminException(getLabel("label-errors-13055"), 13055);}$v3d788fa62d7c185a1bee4c9147ee1091 = new DOMXPath($v0f635d0e0f3874fff8b581c132e6c7a7);$v07213a0161f52846ab198be103b5ab43 = $v3d788fa62d7c185a1bee4c9147ee1091->query('error');if ($v07213a0161f52846ab198be103b5ab43->length != 0) {$vcb5e100e5a9a3e7f6d1fd97512215282 = $v07213a0161f52846ab198be103b5ab43->item(0);$vc13367945d5d4c91047b3b50234aa7ab = $vcb5e100e5a9a3e7f6d1fd97512215282->getAttribute("code");throw new publicAdminException(getLabel("label-errors-" . $vc13367945d5d4c91047b3b50234aa7ab), $vc13367945d5d4c91047b3b50234aa7ab);}$v0eb9b3af2e4a00837a1b1a854c9ea18c = $v3d788fa62d7c185a1bee4c9147ee1091->query("module");if ($v0eb9b3af2e4a00837a1b1a854c9ea18c->length==0) {throw new publicAdminException(getLabel("label-errors-13056"), 13056);}$v52a43e48ec4649dee819dadabcab1bde = strtolower($v52a43e48ec4649dee819dadabcab1bde);$v0eb9b3af2e4a00837a1b1a854c9ea18c = $v3d788fa62d7c185a1bee4c9147ee1091->query("module[@name='" . $v52a43e48ec4649dee819dadabcab1bde . "']");if ($v0eb9b3af2e4a00837a1b1a854c9ea18c->length != 0) {$v22884db148f0ffb0d830ba431102b0b5 = $v0eb9b3af2e4a00837a1b1a854c9ea18c->item(0);if ($v22884db148f0ffb0d830ba431102b0b5->getAttribute("active")!="1") {throw new publicAdminException(getLabel("label-errors-13057"), 13057);}}}private function getFile($v572d4e421e5e6b9bc11d815e8a027112) {try {return umiRemoteFileGetter::get($v572d4e421e5e6b9bc11d815e8a027112);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {throw new publicAdminException(getLabel("label-errors-13041"), 13041);}}private function isGateway() {$v88d2c32b8e12e4cadb0fdbf279a85d8d = array(    array('exchange', 'auto'),    array('exchange', 'export1C'),    array('users', 'login_do'),    array('photoalbum', 'picasa'),   );return array_search(    array($this->getCurrentModule(), $this->getCurrentMethod()),    $v88d2c32b8e12e4cadb0fdbf279a85d8d   ) !== false;}private function prepareAdminSideGlobalVariables() {if (!$this->isGateway() && strtoupper($_SERVER['REQUEST_METHOD']) == "POST") {if (!def_module::checkHTTPReferer()) {throw new coreException(getLabel('error-users-non-referer', 'users'));}if (!self::isCSRFTokenValid()) {throw new coreException('CSRF Protection');}}$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$ve4e46deb7f9cc58c7abfb32e5570b6f3 = domainsCollection::getInstance();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$result = array(    '@module' => $this->current_module,    '@method' => $this->current_method,    '@lang' => $this->current_lang->getPrefix(),    '@lang-id' => $this->current_lang->getId(),    '@pre-lang' => $this->pre_lang,    '@domain' => $this->current_domain->getHost(),    '@domain-id' => $this->current_domain->getId(),    '@session-lifetime' => defined('SESSION_LIFETIME') ? SESSION_LIFETIME : 0,    '@system-build' => $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/autoupdate/system_build"),    '@referer-uri' => $this->getCalculatedRefererUri(),    '@user-id' => $v41275a535677f79ff347e01bc530c176->getUserId(),    '@interface-lang' => ulangStream::getLangPrefix(),    '@csrf' => getArrayKey($_SESSION, 'csrf_token')   );if (defined('CURRENT_VERSION_LINE') && CURRENT_VERSION_LINE == 'demo') {$result['@demo'] = 1;}if ($vb6ee27ee7fe19b0c0dd907d5f947aa12 = getServer('REQUEST_URI')) {$vafbad9dc43d3b9eb8533cd54a4df6a87 = parse_url($vb6ee27ee7fe19b0c0dd907d5f947aa12);$vb6ee27ee7fe19b0c0dd907d5f947aa12 = getArrayKey($vafbad9dc43d3b9eb8533cd54a4df6a87, 'path');$vf7cc8e4882789cf3335d9ed97f208c6f = getArrayKey($vafbad9dc43d3b9eb8533cd54a4df6a87, 'query');if ($vf7cc8e4882789cf3335d9ed97f208c6f) {parse_str($vf7cc8e4882789cf3335d9ed97f208c6f, $v5ebb3c9d5620968cde8459888eff1702);if (isset($v5ebb3c9d5620968cde8459888eff1702['p'])) {unset($v5ebb3c9d5620968cde8459888eff1702['p']);}if (isset($v5ebb3c9d5620968cde8459888eff1702['xmlMode'])) {unset($v5ebb3c9d5620968cde8459888eff1702['xmlMode']);}$vf7cc8e4882789cf3335d9ed97f208c6f = http_build_query($v5ebb3c9d5620968cde8459888eff1702, '', '&');if ($vf7cc8e4882789cf3335d9ed97f208c6f) {$vb6ee27ee7fe19b0c0dd907d5f947aa12 .= '?' . $vf7cc8e4882789cf3335d9ed97f208c6f;}}$result['@request-uri'] = $vb6ee27ee7fe19b0c0dd907d5f947aa12;}$result['@edition'] = CURRENT_VERSION_LINE;$result['@disableTooManyChildsNotification'] = (int) mainConfiguration::getInstance()->get('system', 'disable-too-many-childs-notification');$va74846e5bcde649f23218b2e062c90a8 = $v41275a535677f79ff347e01bc530c176->isAdmin();if (system_is_allowed($this->current_module, $this->current_method)) {try {if ($v22884db148f0ffb0d830ba431102b0b5 = $this->getModule($this->current_module)) {$v22884db148f0ffb0d830ba431102b0b5->cms_callMethod($this->current_method, null);}$result['data'] = $this->adminDataSet;}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$result['data'] = $ve1671797c52e15f763380b45e841ec32;}}elseif ($va74846e5bcde649f23218b2e062c90a8) {$result['data'] = new requreMoreAdminPermissionsException(getLabel("error-require-more-permissions"));$v7f2db423a49b305459147332fb01cf87 = OutputBuffer::current('HTTPOutputBuffer');$v7f2db423a49b305459147332fb01cf87->status('403 Forbidden');}elseif ($this->current_module != 'events' && $this->current_method != 'last') {$v7f2db423a49b305459147332fb01cf87 = OutputBuffer::current('HTTPOutputBuffer');$v7f2db423a49b305459147332fb01cf87->status('403 Forbidden');}if (!is_null($ve1d832ee855bdce9643cc79275650e83 = getRequest('domain'))) {$result['@domain-floated'] = $ve1d832ee855bdce9643cc79275650e83;$result['@domain-floated-id'] = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomainId($ve1d832ee855bdce9643cc79275650e83);}else {if ($this->currentEditElementId) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($this->currentEditElementId);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$vad5f82e879a9c5d6b5b442eb37e50551 = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomain($v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId());if ($vad5f82e879a9c5d6b5b442eb37e50551 instanceof domain) {$result['@domain-floated'] = $ve1d832ee855bdce9643cc79275650e83 = $vad5f82e879a9c5d6b5b442eb37e50551->getHost();}}}else {$result['@domain-floated'] = $result['@domain'];}}return $result;}private function prepareClientSideGlobalVariablesForTPL() {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$v7b975dff6c0134c6f231fd13895c2349 = $this->getCurrentModule();$vb6ad8768e9a35023e3d824c5057699d1 = $this->getCurrentMethod();$v7552cd149af7495ee7d8225974e50f80 = $this->getCurrentElementId();$v8e44f0089b076e18a718eb9ca3d94674 = $v41275a535677f79ff347e01bc530c176->getUserId();$va5f3e7671419d689ba41872016aded04 = true;if ($v41275a535677f79ff347e01bc530c176->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v7b975dff6c0134c6f231fd13895c2349, $vb6ad8768e9a35023e3d824c5057699d1)) {$va5f3e7671419d689ba41872016aded04 = false;if ($v7552cd149af7495ee7d8225974e50f80) {list($v4b43b0aee35624cd95b910189b3dc231) = $v41275a535677f79ff347e01bc530c176->isAllowedObject($v8e44f0089b076e18a718eb9ca3d94674, $v7552cd149af7495ee7d8225974e50f80);$va5f3e7671419d689ba41872016aded04 = !$v4b43b0aee35624cd95b910189b3dc231;}}if ($va5f3e7671419d689ba41872016aded04) {header("Status: 401 Unauthorized");$this->setCurrentModule('users');$this->setCurrentMethod('login');if (!$vf1e554b2b6ec1274154d202f76bf0e74 = $this->getModule('users')) {throw new coreException('Module "users" not found.');}return array('content' => $vf1e554b2b6ec1274154d202f76bf0e74->login());}$v22884db148f0ffb0d830ba431102b0b5 = $this->getModule($v7b975dff6c0134c6f231fd13895c2349);try {$v9a0364b9e99bb480dd25e1f0284c8555 = $v22884db148f0ffb0d830ba431102b0b5->cms_callMethod($vb6ad8768e9a35023e3d824c5057699d1, array());}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$v9a0364b9e99bb480dd25e1f0284c8555 = $ve1671797c52e15f763380b45e841ec32->getMessage();}return array('content' => $v9a0364b9e99bb480dd25e1f0284c8555);}private function prepareClientSideGlobalVariablesForXSLT() {$v6d9fecd2868e8a635b6d088c3e8068c2 = array();$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v69ae498121c2d8e63f20c7144a0246d7 = umiObjectsCollection::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $v41275a535677f79ff347e01bc530c176->getUserId();$v7552cd149af7495ee7d8225974e50f80 = $this->getCurrentElementId();$v7b975dff6c0134c6f231fd13895c2349 = $this->getCurrentModule();$vb6ad8768e9a35023e3d824c5057699d1 = $this->getCurrentMethod();$va5f3e7671419d689ba41872016aded04 = true;if ($v41275a535677f79ff347e01bc530c176->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v7b975dff6c0134c6f231fd13895c2349, $vb6ad8768e9a35023e3d824c5057699d1)) {$va5f3e7671419d689ba41872016aded04 = false;if ($v7552cd149af7495ee7d8225974e50f80) {list($v4b43b0aee35624cd95b910189b3dc231) = $v41275a535677f79ff347e01bc530c176->isAllowedObject($v8e44f0089b076e18a718eb9ca3d94674, $v7552cd149af7495ee7d8225974e50f80);if (!$v4b43b0aee35624cd95b910189b3dc231) {$va5f3e7671419d689ba41872016aded04 = true;$v6d9fecd2868e8a635b6d088c3e8068c2['attribute:not-permitted'] = 1;}}}if ($va5f3e7671419d689ba41872016aded04) {$v7b975dff6c0134c6f231fd13895c2349 = "users";$vb6ad8768e9a35023e3d824c5057699d1 = "login";$this->setCurrentModule($v7b975dff6c0134c6f231fd13895c2349);$this->setCurrentMethod($vb6ad8768e9a35023e3d824c5057699d1);}$this->currentHeader = def_module::parseTPLMacroses(macros_header());$v6d9fecd2868e8a635b6d088c3e8068c2 += array(    '@module' => $v7b975dff6c0134c6f231fd13895c2349,    '@method' => $vb6ad8768e9a35023e3d824c5057699d1,    '@domain' =>  $this->getCurrentDomain()->getHost(),    '@system-build' => $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/autoupdate/system_build"),    '@lang' => $this->getCurrentLang()->getPrefix(),    '@pre-lang' => $this->pre_lang,    '@header' => $this->currentHeader,    '@title' =>  def_module::parseTPLMacroses(macros_title()),    '@site-name' =>  def_module::parseTPLMacroses(macros_sitename()),    'meta' => array(     'keywords' => macros_keywords(),     'description' => macros_describtion()    )   );if (defined('CURRENT_VERSION_LINE') and CURRENT_VERSION_LINE=='demo') {$v6d9fecd2868e8a635b6d088c3e8068c2['@demo'] = 1;}if (!is_null(getRequest('p'))) {$v6d9fecd2868e8a635b6d088c3e8068c2['@paging'] = "yes";}$v14e478589cc0c27c6e14f2eca7bc7ccd = cmsController::getInstance()->getModule("social_networks");if ($v14e478589cc0c27c6e14f2eca7bc7ccd && ($v32a2f74bd1a12b30d1879b4b0ab59d64 = $v14e478589cc0c27c6e14f2eca7bc7ccd->getCurrentSocial())) {$v6d9fecd2868e8a635b6d088c3e8068c2['@socialId'] = $v32a2f74bd1a12b30d1879b4b0ab59d64->getId();}if ($vb6ee27ee7fe19b0c0dd907d5f947aa12 = getServer('REQUEST_URI')) {$vafbad9dc43d3b9eb8533cd54a4df6a87 = @parse_url($vb6ee27ee7fe19b0c0dd907d5f947aa12);$vb6ee27ee7fe19b0c0dd907d5f947aa12 = getArrayKey($vafbad9dc43d3b9eb8533cd54a4df6a87, 'path');$vf7cc8e4882789cf3335d9ed97f208c6f = getArrayKey($vafbad9dc43d3b9eb8533cd54a4df6a87, 'query');if ($v14e478589cc0c27c6e14f2eca7bc7ccd && ($v32a2f74bd1a12b30d1879b4b0ab59d64 = $v14e478589cc0c27c6e14f2eca7bc7ccd->getCurrentSocial())) {$vf7cc8e4882789cf3335d9ed97f208c6f = '';}if ($vf7cc8e4882789cf3335d9ed97f208c6f) {parse_str($vf7cc8e4882789cf3335d9ed97f208c6f, $v5ebb3c9d5620968cde8459888eff1702);if(isset($v5ebb3c9d5620968cde8459888eff1702['p'])) unset($v5ebb3c9d5620968cde8459888eff1702['p']);if(isset($v5ebb3c9d5620968cde8459888eff1702['xmlMode'])) unset($v5ebb3c9d5620968cde8459888eff1702['xmlMode']);$vf7cc8e4882789cf3335d9ed97f208c6f = http_build_query($v5ebb3c9d5620968cde8459888eff1702, '', '&');if($vf7cc8e4882789cf3335d9ed97f208c6f) $vb6ee27ee7fe19b0c0dd907d5f947aa12 .= '?' . $vf7cc8e4882789cf3335d9ed97f208c6f;}$v6d9fecd2868e8a635b6d088c3e8068c2['@request-uri'] = $vb6ee27ee7fe19b0c0dd907d5f947aa12;}$v3edc9582209720439a73c7e107547d7b = $this->getModule('users');$v49f290d6e8459c53f31f97de37921086 = array();$v8e44f0089b076e18a718eb9ca3d94674 = $v3edc9582209720439a73c7e107547d7b->user_id;$v49f290d6e8459c53f31f97de37921086['@id'] = $v8e44f0089b076e18a718eb9ca3d94674;$v3d88fcbaa3581c4957147ef9ad47ec5e = 'guest';if ($v41275a535677f79ff347e01bc530c176->isAuth() && ($vee11cbb19052e40b07aac0ca060c23ee = $v69ae498121c2d8e63f20c7144a0246d7->getObject($v8e44f0089b076e18a718eb9ca3d94674))) {if (getRequest('mobile_application') == 'true') {if (! regedit::getInstance()->getVal('//modules/emarket/')) {$v6d9fecd2868e8a635b6d088c3e8068c2['data']['error'] = getLabel("error-module-emarket-absent");return $v6d9fecd2868e8a635b6d088c3e8068c2;}elseif (!$v41275a535677f79ff347e01bc530c176->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, 'emarket', 'mobile_application_get_data')) {$v6d9fecd2868e8a635b6d088c3e8068c2['data']['error'] = getLabel("error-mobile-application-not-allowed");return $v6d9fecd2868e8a635b6d088c3e8068c2;}}$v3d88fcbaa3581c4957147ef9ad47ec5e = 'user';$v49f290d6e8459c53f31f97de37921086['@status'] = 'auth';$v49f290d6e8459c53f31f97de37921086['@login'] = $vee11cbb19052e40b07aac0ca060c23ee->login;$v49f290d6e8459c53f31f97de37921086['xlink:href'] = $vee11cbb19052e40b07aac0ca060c23ee->xlink;if ($v41275a535677f79ff347e01bc530c176->isAdmin()) {$v3d88fcbaa3581c4957147ef9ad47ec5e = 'admin';if ($v41275a535677f79ff347e01bc530c176->isSv()) $v3d88fcbaa3581c4957147ef9ad47ec5e = 'sv';}}$v49f290d6e8459c53f31f97de37921086['@type'] = $v3d88fcbaa3581c4957147ef9ad47ec5e;if ($vabb341de59578cc2eefc8b95d451142b = $this->getModule("geoip")) {$vdfc4832c05a0296e4f53eff66626baec = $vabb341de59578cc2eefc8b95d451142b->lookupIp();if (!isset($vdfc4832c05a0296e4f53eff66626baec['special'])) {$v49f290d6e8459c53f31f97de37921086['geo'] = array(      'country' => $vdfc4832c05a0296e4f53eff66626baec['country'],      'region' => $vdfc4832c05a0296e4f53eff66626baec['region'],      'city'  => $vdfc4832c05a0296e4f53eff66626baec['city'],      'latitude' => $vdfc4832c05a0296e4f53eff66626baec['lat'],      'longitude' => $vdfc4832c05a0296e4f53eff66626baec['lon']     );}else {$v49f290d6e8459c53f31f97de37921086['geo'] = array('special' => $vdfc4832c05a0296e4f53eff66626baec['special']);}}$v6d9fecd2868e8a635b6d088c3e8068c2['user'] = $v49f290d6e8459c53f31f97de37921086;if ($v7552cd149af7495ee7d8225974e50f80 && ($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80))) {$v587a02d1eb09e2b2fd6514d36a7c3438 = $vb81ca7c0ccaa77e7aa91936ab0070695->getAllParents($v7552cd149af7495ee7d8225974e50f80);$v8e13d18cd44dd15da3533bd4db912ab8 = array();foreach ($v587a02d1eb09e2b2fd6514d36a7c3438 as $v72352a4d26581ef082a6d2243c5a6b88) {if ($v72352a4d26581ef082a6d2243c5a6b88 == 0) {continue;}if ($va4f09cfeea7392a1f6df6a3de5c3bc9e = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v72352a4d26581ef082a6d2243c5a6b88)) {$v8e13d18cd44dd15da3533bd4db912ab8[] = $va4f09cfeea7392a1f6df6a3de5c3bc9e;}}$v6d9fecd2868e8a635b6d088c3e8068c2 += array(     '@pageId' => $v7552cd149af7495ee7d8225974e50f80,     'parents' => array(      '+page' => $v8e13d18cd44dd15da3533bd4db912ab8     ),     'full:page' => $v8e2dcfd7e7e24b1ca76c1193f645902b    );def_module::pushEditable($v7b975dff6c0134c6f231fd13895c2349, $vb6ad8768e9a35023e3d824c5057699d1, $v7552cd149af7495ee7d8225974e50f80);}elseif ($v7b975dff6c0134c6f231fd13895c2349 == 'content' && $vb6ad8768e9a35023e3d824c5057699d1 == 'content') {$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v7f2db423a49b305459147332fb01cf87->status("404 Not Found");$v6d9fecd2868e8a635b6d088c3e8068c2['@method'] = "notfound";}elseif (!$va5f3e7671419d689ba41872016aded04 && $this->isAllowedExecuteMethod($v7b975dff6c0134c6f231fd13895c2349, $vb6ad8768e9a35023e3d824c5057699d1)) {try {$vd6fe1d0be6347b8ef2427fa629c04485 = getRequest('path');$v1bbcb648e0b1869444f3a2d344a5b3ac = explode("/", $vd6fe1d0be6347b8ef2427fa629c04485);if (isset($v1bbcb648e0b1869444f3a2d344a5b3ac[0]) && $v1bbcb648e0b1869444f3a2d344a5b3ac[0] == $this->current_lang->getPrefix()) {$v1bbcb648e0b1869444f3a2d344a5b3ac = array_slice($v1bbcb648e0b1869444f3a2d344a5b3ac, 1);}if (count($v1bbcb648e0b1869444f3a2d344a5b3ac) < 2) {throw new coreException("Invalid udata path");}$v1bbcb648e0b1869444f3a2d344a5b3ac[0] = $v7b975dff6c0134c6f231fd13895c2349;$v1bbcb648e0b1869444f3a2d344a5b3ac[1] = $vb6ad8768e9a35023e3d824c5057699d1;$vd6fe1d0be6347b8ef2427fa629c04485 = 'udata://' . implode("/", $v1bbcb648e0b1869444f3a2d344a5b3ac);$v6d9fecd2868e8a635b6d088c3e8068c2['xml:data'] = $this->executeStream($vd6fe1d0be6347b8ef2427fa629c04485);}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$v6d9fecd2868e8a635b6d088c3e8068c2['data'] = $ve1671797c52e15f763380b45e841ec32;}}return $v6d9fecd2868e8a635b6d088c3e8068c2;}private function init() {$this->detectMode();showWorkTime("cmscontroller detect mode");$this->detectDomain();showWorkTime("cmscontroller detect domain");$this->detectLang();showWorkTime("cmscontroller detect lang");$this->loadLangs();showWorkTime("cmscontroller load lang");cacheFrontend::$currentlangId = $this->getCurrentLang()->getId();cacheFrontend::$currentDomainId = $this->getCurrentDomain()->getId();$LANG_EXPORT = array();$v1a63fc9b67960ac99f609b95417c2d34 = CURRENT_WORKING_DIR . "/classes/modules/lang.php";if (file_exists($v1a63fc9b67960ac99f609b95417c2d34)) {require $v1a63fc9b67960ac99f609b95417c2d34;}$this->langs = array_merge($this->langs, $LANG_EXPORT);$v1b2c38000ce4861a9ba046bf4dc483a4 = CURRENT_WORKING_DIR . "/classes/modules/lang." . $this->getCurrentLang()->getPrefix() . ".php";if (file_exists($v1b2c38000ce4861a9ba046bf4dc483a4)) {require $v1b2c38000ce4861a9ba046bf4dc483a4;$this->langs = array_merge($this->langs, $LANG_EXPORT);}$this->errorUrl = getServer('HTTP_REFERER');$this->doSomething();$this->calculateRefererUri();}private function detectDomain() {$ve4e46deb7f9cc58c7abfb32e5570b6f3 = domainsCollection::getInstance();$v67b3dba8bc6778101892eb77249db32e = getServer('HTTP_HOST');$vfbe322a89bc0ba531c3f0050e3935f28 = false;if ($v662cbf1253ac7d8750ed9190c52163e5 = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomainId($v67b3dba8bc6778101892eb77249db32e)) {$vad5f82e879a9c5d6b5b442eb37e50551 = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomain($v662cbf1253ac7d8750ed9190c52163e5);$vfbe322a89bc0ba531c3f0050e3935f28 = true;}else {$vad5f82e879a9c5d6b5b442eb37e50551 = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDefaultDomain();if (!$vad5f82e879a9c5d6b5b442eb37e50551 instanceof domain) {throw new coreException("Default domain could not be found");}}if ($v67b3dba8bc6778101892eb77249db32e != $vad5f82e879a9c5d6b5b442eb37e50551->getHost()) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$vcd189c6b00df4debfabc5a0d23f7d8e4 = $v2245023265ae4cf87d02c8b6ba991139->get('seo', 'primary-domain-redirect');if ($vcd189c6b00df4debfabc5a0d23f7d8e4 == 1) {$v9305b73d359bd06734fee0b3638079e1 = 'http://' . $vad5f82e879a9c5d6b5b442eb37e50551->getHost() . getServer('REQUEST_URI');outputBuffer::current()->redirect($v9305b73d359bd06734fee0b3638079e1);}elseif ($vcd189c6b00df4debfabc5a0d23f7d8e4 == 2 && !$vfbe322a89bc0ba531c3f0050e3935f28) {$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v7f2db423a49b305459147332fb01cf87->status('404 Not Found');$v7f2db423a49b305459147332fb01cf87->option('generation-time', false);ob_start();require CURRENT_WORKING_DIR . "/errors/invalid_domain.html";$v9a0364b9e99bb480dd25e1f0284c8555 = ob_get_clean();$v7f2db423a49b305459147332fb01cf87->push($v9a0364b9e99bb480dd25e1f0284c8555);$v7f2db423a49b305459147332fb01cf87->end();}}if (is_object($vad5f82e879a9c5d6b5b442eb37e50551)) {$this->current_domain = $vad5f82e879a9c5d6b5b442eb37e50551;return true;}else {$vad5f82e879a9c5d6b5b442eb37e50551 = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDefaultDomain();if ($vad5f82e879a9c5d6b5b442eb37e50551 instanceof domain) {$this->current_domain = $vad5f82e879a9c5d6b5b442eb37e50551;$vad5f82e879a9c5d6b5b442eb37e50551->addMirrow($v67b3dba8bc6778101892eb77249db32e);return false;}else {throw new coreException("Current domain could not be found");}}}private function detectLang() {$vb24bcd6b7d395b852353e079beaec4f9 = getRequest('lang_id');$vf585b7f018bb4ced15a03683a733e50b = false;if ($vb24bcd6b7d395b852353e079beaec4f9 != null) {if (is_array($vb24bcd6b7d395b852353e079beaec4f9)) {list($vb24bcd6b7d395b852353e079beaec4f9) = $vb24bcd6b7d395b852353e079beaec4f9;}$vf585b7f018bb4ced15a03683a733e50b = intval($vb24bcd6b7d395b852353e079beaec4f9);}else if (!is_null(getRequest('links')) && is_array($v7ffc4d510260a8544e5550e62ec56bc1 = getRequest('rel'))) {if (sizeof($v7ffc4d510260a8544e5550e62ec56bc1) && ($v7552cd149af7495ee7d8225974e50f80 = array_pop($v7ffc4d510260a8544e5550e62ec56bc1))) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7552cd149af7495ee7d8225974e50f80, true);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$vf585b7f018bb4ced15a03683a733e50b = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();}}}else {list($vb31590b98760b74e7c4e1a809e43152d) = $this->getPathArray();$vf585b7f018bb4ced15a03683a733e50b = langsCollection::getInstance()->getLangId($vb31590b98760b74e7c4e1a809e43152d);}if (!langsCollection::getInstance()->getDefaultLang()) {throw new coreException('Cannot find default language');}if (($this->current_lang = langsCollection::getInstance()->getLang($vf585b7f018bb4ced15a03683a733e50b)) === false ) {if ($this->current_domain) {if ($vf585b7f018bb4ced15a03683a733e50b = $this->current_domain->getDefaultLangId()) {$this->current_lang = langsCollection::getInstance()->getLang($vf585b7f018bb4ced15a03683a733e50b);}else {$this->current_lang = langsCollection::getInstance()->getDefaultLang();}}else {$this->current_lang = langsCollection::getInstance()->getDefaultLang();}}if ($this->current_lang->getId() != $this->current_domain->getDefaultLangId()) {$this->pre_lang = "/" . $this->current_lang->getPrefix();$_REQUEST['pre_lang'] = $this->pre_lang;}}private function detectCurrentTemplater() {if (defined('VIA_HTTP_SCHEME') && VIA_HTTP_SCHEME) {return $this->current_templater = $this->initHTTPSchemeModeTemplater();}elseif ($this->current_mode == 'admin') {return $this->current_templater = $this->initAdminModeTemplater();}else {return $this->current_templater = $this->initSiteModeTemplater();}}private function initHTTPSchemeModeTemplater() {outputBuffer::contentGenerator('XSLT, HTTP SCHEME MODE');return umiTemplater::create('XSLT');}private function initSiteModeTemplater() {$v66f6181bcb4cff4cd38fbc804a036db6 = $this->detectCurrentDesignTemplate();if (!$v66f6181bcb4cff4cd38fbc804a036db6 instanceof template) {$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v7f2db423a49b305459147332fb01cf87->clear();$v7f2db423a49b305459147332fb01cf87->push(file_get_contents(SYS_ERRORS_PATH . 'no_design_template.html'));$v7f2db423a49b305459147332fb01cf87->end();}$va488c14d97fc1b1a156f093b14cbc607 = $v66f6181bcb4cff4cd38fbc804a036db6->getType();if ($va488c14d97fc1b1a156f093b14cbc607 == 'xsl') $va488c14d97fc1b1a156f093b14cbc607 = 'XSLT';if ($va488c14d97fc1b1a156f093b14cbc607 == 'tpls') $va488c14d97fc1b1a156f093b14cbc607 = 'TPL';$va488c14d97fc1b1a156f093b14cbc607 = strtoupper($va488c14d97fc1b1a156f093b14cbc607);outputBuffer::contentGenerator($va488c14d97fc1b1a156f093b14cbc607 . ', SITE MODE');return umiTemplater::create($va488c14d97fc1b1a156f093b14cbc607, $v66f6181bcb4cff4cd38fbc804a036db6->getFilePath());}private function initAdminModeTemplater() {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$vd0445781d0ea0874702f04eb72c588d5 = $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.skins', array('skin' => system_get_skinName()));$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $v41275a535677f79ff347e01bc530c176->getUserId();$vca02d1555c813b1b1ad637654c0fe111 = $v41275a535677f79ff347e01bc530c176->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $this->current_module, $this->current_method);$v5b063e275d506f65ebf1b02d926f19a4 = 'main.xsl';if (!$v41275a535677f79ff347e01bc530c176->isAdmin(false, true) || !$vca02d1555c813b1b1ad637654c0fe111) {if ($v41275a535677f79ff347e01bc530c176->isAuth()) {$v90f805bfcba6ab75df4ad6da8e6afd9b = "owner_id = {$v8e44f0089b076e18a718eb9ca3d94674}";$v8e59688c095c0b0bad04d8476df25db3 = umiObjectsCollection::getInstance()->getObject($v8e44f0089b076e18a718eb9ca3d94674)->getValue('groups');foreach ($v8e59688c095c0b0bad04d8476df25db3 as $vf2f5fbe4a9d4cc9a39e7a62a513580e9) {$v90f805bfcba6ab75df4ad6da8e6afd9b .= " or owner_id = {$vf2f5fbe4a9d4cc9a39e7a62a513580e9}";}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `module` FROM cms_permissions WHERE (" . $v90f805bfcba6ab75df4ad6da8e6afd9b . ") and (method = '' or method is null)";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if (mysql_num_rows($result) !== 0) {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result)){$v22884db148f0ffb0d830ba431102b0b5 = $vf1965a857bc285d26fe22023aa5ab50d[0];$vea9f6aca279138c58f705c8d4cb4b8ce = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/{$v22884db148f0ffb0d830ba431102b0b5}/default_method_admin");if ($v41275a535677f79ff347e01bc530c176->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce)) {def_module::redirect('http://' . $this->getCurrentDomain()->getHost() . '/admin/'. $v22884db148f0ffb0d830ba431102b0b5 . '/' . $vea9f6aca279138c58f705c8d4cb4b8ce . "/");break;}}}}$v5b063e275d506f65ebf1b02d926f19a4 = 'main_login.xsl';}$vfbf236c2ed0d94c877048bc5bb1db3d9 = $vd0445781d0ea0874702f04eb72c588d5 . $v5b063e275d506f65ebf1b02d926f19a4;if (!is_file($vfbf236c2ed0d94c877048bc5bb1db3d9)) {throw new coreException('Template "' . $vfbf236c2ed0d94c877048bc5bb1db3d9 . '" not found.');}outputBuffer::contentGenerator('XSLT, ADMIN MODE');return umiTemplater::create('XSLT', $vfbf236c2ed0d94c877048bc5bb1db3d9);}private function getPathArray() {$vd6fe1d0be6347b8ef2427fa629c04485 = getRequest('path');$vd6fe1d0be6347b8ef2427fa629c04485 = trim($vd6fe1d0be6347b8ef2427fa629c04485, "/");$v5f44c555cfb3ecb28f624fa95617f277 = mainConfiguration::getInstance()->get('seo', 'url-suffix');$v5e0bdcbddccca4d66d74ba8c1cee1a68 = strrpos($vd6fe1d0be6347b8ef2427fa629c04485, $v5f44c555cfb3ecb28f624fa95617f277);if ($v5e0bdcbddccca4d66d74ba8c1cee1a68 && ($v5e0bdcbddccca4d66d74ba8c1cee1a68 + strlen($v5f44c555cfb3ecb28f624fa95617f277) == strlen($vd6fe1d0be6347b8ef2427fa629c04485))) {$vd6fe1d0be6347b8ef2427fa629c04485 = substr($vd6fe1d0be6347b8ef2427fa629c04485, 0, $v5e0bdcbddccca4d66d74ba8c1cee1a68);}return explode("/", $vd6fe1d0be6347b8ef2427fa629c04485);}private function detectMode() {if (isset($_SERVER['argv']) && 1<=count($_SERVER['argv'])    && !(isset($_SERVER['QUERY_STRING']) && $_SERVER['argv'][0]==$_SERVER['QUERY_STRING'])) {$this->setCurrentMode("cli");cacheFrontend::$cacheMode = true;return;}$v32660e7b27600e0fde6ff1333c6c0568 = $this->getPathArray();if (sizeof($v32660e7b27600e0fde6ff1333c6c0568) < 2) {$v32660e7b27600e0fde6ff1333c6c0568[1] = NULL;}list($v9ea3ab74bc8133d47b81a107f1a1c585, $v394072637b008e3829968bb5109f17ac) = $v32660e7b27600e0fde6ff1333c6c0568;if ($v9ea3ab74bc8133d47b81a107f1a1c585 == "admin" || $v394072637b008e3829968bb5109f17ac == "admin") {$this->setCurrentMode("admin");cacheFrontend::$adminMode = true;}else {$this->setCurrentMode("");cacheFrontend::$cacheMode = true;cacheFrontend::$adminMode = false;}}private function getSubPathType($vb31590b98760b74e7c4e1a809e43152d) {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();if (!$this->current_module) {if ($vb31590b98760b74e7c4e1a809e43152d == "trash") {def_module::redirect($this->pre_lang . "/admin/data/trash/");}if ($vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/" . $vb31590b98760b74e7c4e1a809e43152d)) {$this->setCurrentModule($vb31590b98760b74e7c4e1a809e43152d);return "MODULE";}}if ($this->current_module && !$this->current_method) {$this->setCurrentMethod($vb31590b98760b74e7c4e1a809e43152d);return "METHOD";}if ($this->current_module && $this->current_method) {return "PARAM";}return "UNKNOWN";}private function reset() {$this->current_module = $this->current_method = '';for ($v865c0c0b4ab0e063e5caa3387c1a8741=0;$v865c0c0b4ab0e063e5caa3387c1a8741<10;$v865c0c0b4ab0e063e5caa3387c1a8741++) {if (isset($_REQUEST['param'.$v865c0c0b4ab0e063e5caa3387c1a8741])) {unset($_REQUEST['param'.$v865c0c0b4ab0e063e5caa3387c1a8741]);}else break;}}};interface iUmiDate {public function __construct($v87a3cb5c3554b2d9d8a1a773ad0936be = false);public function getFormattedDate($v3c64ab0a1c8c902a8cfc3bdeedccd50a = false);public function getCurrentTimeStamp();public function getDateTimeStamp();public function setDateByTimeStamp($v87a3cb5c3554b2d9d8a1a773ad0936be);public function setDateByString($ved2f216e8eb7276d3e828504ebdf5437);public static function getTimeStamp($ved2f216e8eb7276d3e828504ebdf5437);}class umiDate implements iUmiDate {public $timestamp;public static $defaultFormatString = DEFAULT_DATE_FORMAT;public function __construct($vd7e6d55ba379a13d08c25d15faf2a23b = false) {if($vd7e6d55ba379a13d08c25d15faf2a23b === false) {$vd7e6d55ba379a13d08c25d15faf2a23b = self::getCurrentTimeStamp();}$this->setDateByTimeStamp($vd7e6d55ba379a13d08c25d15faf2a23b);}public function getCurrentTimeStamp() {if (isset($_SERVER['REQUEST_TIME'])) {return $_SERVER['REQUEST_TIME'];}else {return time();}}public function getDateTimeStamp() {return intval($this->timestamp);}public function getFormattedDate($v3c64ab0a1c8c902a8cfc3bdeedccd50a = false) {if($v3c64ab0a1c8c902a8cfc3bdeedccd50a === false) {$v3c64ab0a1c8c902a8cfc3bdeedccd50a = self::$defaultFormatString;}return date($v3c64ab0a1c8c902a8cfc3bdeedccd50a, $this->timestamp);}public function setDateByTimeStamp($vd7e6d55ba379a13d08c25d15faf2a23b) {if(!is_numeric($vd7e6d55ba379a13d08c25d15faf2a23b)) {return false;}$this->timestamp = $vd7e6d55ba379a13d08c25d15faf2a23b;return true;}public function setDateByString($ved2f216e8eb7276d3e828504ebdf5437) {$ved2f216e8eb7276d3e828504ebdf5437 = umiObjectProperty::filterInputString($ved2f216e8eb7276d3e828504ebdf5437);$vd7e6d55ba379a13d08c25d15faf2a23b  = strlen($ved2f216e8eb7276d3e828504ebdf5437) ? self::getTimeStamp($ved2f216e8eb7276d3e828504ebdf5437) : 0;return $this->setDateByTimeStamp($vd7e6d55ba379a13d08c25d15faf2a23b);}public static function getTimeStamp($ved2f216e8eb7276d3e828504ebdf5437) {return toTimeStamp($ved2f216e8eb7276d3e828504ebdf5437);}public function __toString() {return $this->getFormattedDate();}}interface iUmiFile {public function __construct($v47826cacc65c665212b821e6ff80b9b0);public function delete();public static function upload($vace49b0950fb197bb64f2ffb6a715467, $v2eb515ec764b456f2b9e57c512233229, $v74fd4667ea41a65d884a6de38d24a946);public function getSize();public function getExt();public function getFileName();public function getDirName();public function getModifyTime();public function getFilePath($vb660cf7888d38578b005371413e1c0a6 = false);public function getIsBroken();public function __toString();public static function getUnconflictPath($vd6fe1d0be6347b8ef2427fa629c04485);public function download($v789726e10bf01b1777c5d2ae06bede3e = false);}class umiFile implements iUmiFile {protected $filepath,    $size, $ext, $name, $dirname, $modify_time,    $is_broken = false;public static $mask = 0777;protected static $class_name = 'umiFile';protected static $forbiddenFileTypes = array(   "php", "php3", "php4", "php5", "phtml"  );protected static $allowedFileTypes = array(   'txt', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'pps', 'ppsx',   'odt', 'sxw', 'ods', 'odg', 'pdf', 'csv',   'html', 'js', 'tpl', 'xsl', 'xml', 'css',   'zip', 'rar', '7z', 'tar', 'gz', 'tar.gz', 'exe', 'msi',   'rtf', 'chm', 'ico',   'psd', 'flv', 'mp4', 'swf', 'mp3', 'wav', 'wma', 'ogg', 'aac'  );protected static $allowedImageTypes = array('jpg', 'jpeg', 'gif', 'bmp', 'png');protected static $allowedUserFileTypes = null;protected static $addWaterMark = false;public function __construct($v6a2a431fe8b621037ea949531c28551d) {$v6a2a431fe8b621037ea949531c28551d = str_replace("//", "/", $v6a2a431fe8b621037ea949531c28551d);$v6a2a431fe8b621037ea949531c28551d = str_replace("\\\\", "\\", $v6a2a431fe8b621037ea949531c28551d);if (defined("CRON") && CRON === 'CLI') $v6a2a431fe8b621037ea949531c28551d = preg_replace("/^\.\//", CURRENT_WORKING_DIR . '/', $v6a2a431fe8b621037ea949531c28551d);if(!@is_file($v6a2a431fe8b621037ea949531c28551d)) {$this->is_broken = true;return false;}$this->filepath = $v6a2a431fe8b621037ea949531c28551d;$this->filepath = str_replace("\\", "/", $v6a2a431fe8b621037ea949531c28551d);$this->loadInfo();}public function delete() {if(is_writable($this->filepath)) {return unlink($this->filepath);}else {return false;}}public function download($v789726e10bf01b1777c5d2ae06bede3e = false) {while (@ob_end_clean());header('HTTP/1.1 200 OK');header("Cache-Control: public, must-revalidate");header("Pragma: no-cache");header("Content-type: application/force-download");header("Content-Length: " . $this->getSize());header('Accept-Ranges: bytes');header("Content-Encoding: None");header("Vary:");header('Content-Transfer-Encoding: Binary');header("Content-Disposition: attachment; filename=" . $this->getFileName());readfile(realpath($this->getFilePath()));if($v789726e10bf01b1777c5d2ae06bede3e) {$this->delete();}exit();}public static function isAllowedFileType($v566bbee0f961ad71b54c3c2fd36db053) {$v566bbee0f961ad71b54c3c2fd36db053 = strtolower($v566bbee0f961ad71b54c3c2fd36db053);if (in_array($v566bbee0f961ad71b54c3c2fd36db053, self::$forbiddenFileTypes)) {return false;}if (in_array($v566bbee0f961ad71b54c3c2fd36db053, self::$allowedFileTypes) || in_array($v566bbee0f961ad71b54c3c2fd36db053, self::$allowedImageTypes)) {return true;}if (is_null(self::$allowedUserFileTypes)) {$v8e44f0089b076e18a718eb9ca3d94674 = permissionsCollection::getInstance()->getUserId();$v23e91e891070db669547556402a176b5 = umiObjectsCollection::getInstance()->getObject($v8e44f0089b076e18a718eb9ca3d94674)->getValue('appended_file_extensions');self::$allowedUserFileTypes = array();foreach(explode(',', $v23e91e891070db669547556402a176b5) as $va175f0d82e080972dd2c0cf2c56450b3) {$va175f0d82e080972dd2c0cf2c56450b3 = strtolower(trim($va175f0d82e080972dd2c0cf2c56450b3));if (strlen($va175f0d82e080972dd2c0cf2c56450b3)) {self::$allowedUserFileTypes[] = $va175f0d82e080972dd2c0cf2c56450b3;}}}if (in_array($v566bbee0f961ad71b54c3c2fd36db053, self::$allowedUserFileTypes)) {return true;}return false;}public static function manualUpload($vb068931cc450442b63f5b3d276ea4297, $ve440be6a92dba11caa790215081671ae, $vf7bd60b75b29d79b660a2859395c1a24, $vb2ed5fc91c9760886b14c955ac6c82d7) {if(!$vf7bd60b75b29d79b660a2859395c1a24 || !$vb068931cc450442b63f5b3d276ea4297 || $vb068931cc450442b63f5b3d276ea4297 == ".htaccess" || !is_uploaded_file($ve440be6a92dba11caa790215081671ae)) return 1;$v566bbee0f961ad71b54c3c2fd36db053 = strtolower(substr($vb068931cc450442b63f5b3d276ea4297, strrpos($vb068931cc450442b63f5b3d276ea4297, '.') + 1));if ( !self::isAllowedFileType($v566bbee0f961ad71b54c3c2fd36db053)) {return 2;}$vb068931cc450442b63f5b3d276ea4297 = substr($vb068931cc450442b63f5b3d276ea4297, 0, strlen($vb068931cc450442b63f5b3d276ea4297) - strlen($v566bbee0f961ad71b54c3c2fd36db053) - 1);$vb068931cc450442b63f5b3d276ea4297 = translit::convert($vb068931cc450442b63f5b3d276ea4297);$vb068931cc450442b63f5b3d276ea4297 .= "." . $v566bbee0f961ad71b54c3c2fd36db053;$v9024b204fb4c4ffdd07ee631ed791f75 = $vb2ed5fc91c9760886b14c955ac6c82d7 . "/" . $vb068931cc450442b63f5b3d276ea4297;if($vb068931cc450442b63f5b3d276ea4297 == ".htaccess") {return 3;}if(is_uploaded_file($ve440be6a92dba11caa790215081671ae)) {$v9024b204fb4c4ffdd07ee631ed791f75 = umiFile::getUnconflictPath($v9024b204fb4c4ffdd07ee631ed791f75);if(move_uploaded_file($ve440be6a92dba11caa790215081671ae, $v9024b204fb4c4ffdd07ee631ed791f75)) {chmod($v9024b204fb4c4ffdd07ee631ed791f75, self::$mask);$v9024b204fb4c4ffdd07ee631ed791f75 = self::getRelPath($v9024b204fb4c4ffdd07ee631ed791f75);return new self::$class_name($v9024b204fb4c4ffdd07ee631ed791f75);}else {return 5;}}else {return 6;}}public static function upload($veeeb23fbd23e52a6a6ff78b9f18cbc4e, $v86536e21993c5a96a4d4c9c9afcc9b17, $vb2ed5fc91c9760886b14c955ac6c82d7, $vb80bb7740288fda1f201890375a60c8f = false) {$va1b423d9a2738b47df059a8a38abbd27 = $vb2ed5fc91c9760886b14c955ac6c82d7;if(substr($va1b423d9a2738b47df059a8a38abbd27, strlen($va1b423d9a2738b47df059a8a38abbd27) - 1, 1) != "/") $va1b423d9a2738b47df059a8a38abbd27 .= "/";$vb2ed5fc91c9760886b14c955ac6c82d7 = realpath($vb2ed5fc91c9760886b14c955ac6c82d7);if(!is_dir($vb2ed5fc91c9760886b14c955ac6c82d7)) {return false;}if(!is_writable($vb2ed5fc91c9760886b14c955ac6c82d7)) {return false;}if($veeeb23fbd23e52a6a6ff78b9f18cbc4e === false && $v86536e21993c5a96a4d4c9c9afcc9b17 === false) {$vb068931cc450442b63f5b3d276ea4297 = $_REQUEST['filename'];$v9a0364b9e99bb480dd25e1f0284c8555 = file_get_contents('php://input');$v566bbee0f961ad71b54c3c2fd36db053 = strtolower(substr($vb068931cc450442b63f5b3d276ea4297, strrpos($vb068931cc450442b63f5b3d276ea4297, '.') + 1));if (!self::isAllowedFileType($v566bbee0f961ad71b54c3c2fd36db053)) {return false;}$vb068931cc450442b63f5b3d276ea4297 = substr($vb068931cc450442b63f5b3d276ea4297, 0, strlen($vb068931cc450442b63f5b3d276ea4297) - strlen($v566bbee0f961ad71b54c3c2fd36db053) - 1);$vb068931cc450442b63f5b3d276ea4297 = translit::convert($vb068931cc450442b63f5b3d276ea4297);$vb068931cc450442b63f5b3d276ea4297 .= "." . $v566bbee0f961ad71b54c3c2fd36db053;if($vb068931cc450442b63f5b3d276ea4297 == ".htaccess") {return false;}$v9024b204fb4c4ffdd07ee631ed791f75 = $vb2ed5fc91c9760886b14c955ac6c82d7 . "/" . $vb068931cc450442b63f5b3d276ea4297;if(file_put_contents($v9024b204fb4c4ffdd07ee631ed791f75, $v9a0364b9e99bb480dd25e1f0284c8555) == 0) {return false;}chmod($v9024b204fb4c4ffdd07ee631ed791f75, self::$mask);$v9024b204fb4c4ffdd07ee631ed791f75 = self::getRelPath($v9024b204fb4c4ffdd07ee631ed791f75);return new self::$class_name($v9024b204fb4c4ffdd07ee631ed791f75);}else {global $_FILES;$ve067156fc3a90cfa942be4efa6f5bc7e = &$_FILES;if(!is_array($ve067156fc3a90cfa942be4efa6f5bc7e)) {return false;}if(!isset($ve067156fc3a90cfa942be4efa6f5bc7e[$veeeb23fbd23e52a6a6ff78b9f18cbc4e]) && isset($ve067156fc3a90cfa942be4efa6f5bc7e['pics'])) {$ve067156fc3a90cfa942be4efa6f5bc7e[$veeeb23fbd23e52a6a6ff78b9f18cbc4e] = $ve067156fc3a90cfa942be4efa6f5bc7e['pics'];$veeeb23fbd23e52a6a6ff78b9f18cbc4e = "pics";}if(array_key_exists($veeeb23fbd23e52a6a6ff78b9f18cbc4e, $ve067156fc3a90cfa942be4efa6f5bc7e)) {$v080505fba0c91df9d7cff41d972acaf1 = $ve067156fc3a90cfa942be4efa6f5bc7e[$veeeb23fbd23e52a6a6ff78b9f18cbc4e];if(isset($v080505fba0c91df9d7cff41d972acaf1['size'][$v86536e21993c5a96a4d4c9c9afcc9b17])) {$vb80bb7740288fda1f201890375a60c8f = false;}$vf7bd60b75b29d79b660a2859395c1a24 = ($vb80bb7740288fda1f201890375a60c8f === false) ?             (isset($v080505fba0c91df9d7cff41d972acaf1['size'][$v86536e21993c5a96a4d4c9c9afcc9b17])? $v080505fba0c91df9d7cff41d972acaf1['size'][$v86536e21993c5a96a4d4c9c9afcc9b17] : 0)               :             (isset($v080505fba0c91df9d7cff41d972acaf1['size'][$vb80bb7740288fda1f201890375a60c8f][$v86536e21993c5a96a4d4c9c9afcc9b17])? $v080505fba0c91df9d7cff41d972acaf1['size'][$vb80bb7740288fda1f201890375a60c8f][$v86536e21993c5a96a4d4c9c9afcc9b17] : 0);if($vf7bd60b75b29d79b660a2859395c1a24 == 0) {return false;}else {$ve440be6a92dba11caa790215081671ae = ($vb80bb7740288fda1f201890375a60c8f === false) ? $v080505fba0c91df9d7cff41d972acaf1['tmp_name'][$v86536e21993c5a96a4d4c9c9afcc9b17] : $v080505fba0c91df9d7cff41d972acaf1['tmp_name'][$vb80bb7740288fda1f201890375a60c8f][$v86536e21993c5a96a4d4c9c9afcc9b17];$vb068931cc450442b63f5b3d276ea4297 = ($vb80bb7740288fda1f201890375a60c8f === false) ? $v080505fba0c91df9d7cff41d972acaf1['name'][$v86536e21993c5a96a4d4c9c9afcc9b17] : $v080505fba0c91df9d7cff41d972acaf1['name'][$vb80bb7740288fda1f201890375a60c8f][$v86536e21993c5a96a4d4c9c9afcc9b17];$v566bbee0f961ad71b54c3c2fd36db053 = strtolower(substr($vb068931cc450442b63f5b3d276ea4297, strrpos($vb068931cc450442b63f5b3d276ea4297, '.') + 1));if( !self::isAllowedFileType($v566bbee0f961ad71b54c3c2fd36db053) ) {return false;}$vb068931cc450442b63f5b3d276ea4297 = substr($vb068931cc450442b63f5b3d276ea4297, 0, strlen($vb068931cc450442b63f5b3d276ea4297) - strlen($v566bbee0f961ad71b54c3c2fd36db053) - 1);$vb068931cc450442b63f5b3d276ea4297 = translit::convert($vb068931cc450442b63f5b3d276ea4297);$vb068931cc450442b63f5b3d276ea4297 .= "." . $v566bbee0f961ad71b54c3c2fd36db053;$v9024b204fb4c4ffdd07ee631ed791f75 = $vb2ed5fc91c9760886b14c955ac6c82d7 . "/" . $vb068931cc450442b63f5b3d276ea4297;if($vb068931cc450442b63f5b3d276ea4297 == ".htaccess") {return false;}if(is_uploaded_file($ve440be6a92dba11caa790215081671ae)) {$v9024b204fb4c4ffdd07ee631ed791f75 = umiFile::getUnconflictPath($v9024b204fb4c4ffdd07ee631ed791f75);if(move_uploaded_file($ve440be6a92dba11caa790215081671ae, $v9024b204fb4c4ffdd07ee631ed791f75)) {chmod($v9024b204fb4c4ffdd07ee631ed791f75, self::$mask);$v9024b204fb4c4ffdd07ee631ed791f75 = self::getRelPath($v9024b204fb4c4ffdd07ee631ed791f75);return new self::$class_name($v9024b204fb4c4ffdd07ee631ed791f75);}else {return false;}}else {return false;}}}else {return false;}}}public static function upload_zip ($v86536e21993c5a96a4d4c9c9afcc9b17, $v8c7dd922ad47494fc02c388e12c00eac = "", $v851148b4fd8fd7ae74bd9100c5c0c898 = "./images/cms/data/", $v043f01e8ecc376fc15ecb17504a1f05e = false)  {if ($v8c7dd922ad47494fc02c388e12c00eac == "") {$ve440be6a92dba11caa790215081671ae = $v86536e21993c5a96a4d4c9c9afcc9b17['tmp_name'];$vb068931cc450442b63f5b3d276ea4297 = $v86536e21993c5a96a4d4c9c9afcc9b17['name'];list(,, $v566bbee0f961ad71b54c3c2fd36db053) = array_values(getPathInfo($vb068931cc450442b63f5b3d276ea4297));$vb068931cc450442b63f5b3d276ea4297 = substr($vb068931cc450442b63f5b3d276ea4297, 0, strlen($vb068931cc450442b63f5b3d276ea4297) - strlen($v566bbee0f961ad71b54c3c2fd36db053));$vb068931cc450442b63f5b3d276ea4297 = translit::convert($vb068931cc450442b63f5b3d276ea4297);$vb068931cc450442b63f5b3d276ea4297 .= "." . $v566bbee0f961ad71b54c3c2fd36db053;$v9024b204fb4c4ffdd07ee631ed791f75 = $v851148b4fd8fd7ae74bd9100c5c0c898.$vb068931cc450442b63f5b3d276ea4297;$v51b7b5d0a5d6f26dc31ce613f4966356 = CURRENT_WORKING_DIR . "/sys-temp/uploads";if(!is_dir($v51b7b5d0a5d6f26dc31ce613f4966356)) {mkdir($v51b7b5d0a5d6f26dc31ce613f4966356);}$v3cc7992a6d5b20ce784f6169f4423048 = $v51b7b5d0a5d6f26dc31ce613f4966356.'/'.$vb068931cc450442b63f5b3d276ea4297;if ($v86536e21993c5a96a4d4c9c9afcc9b17['size'] == 0) {return false;}if(is_uploaded_file($ve440be6a92dba11caa790215081671ae)) {$v9024b204fb4c4ffdd07ee631ed791f75 = umiFile::getUnconflictPath($v9024b204fb4c4ffdd07ee631ed791f75);if(move_uploaded_file($ve440be6a92dba11caa790215081671ae, $v3cc7992a6d5b20ce784f6169f4423048)) {chmod($v3cc7992a6d5b20ce784f6169f4423048, self::$mask);}else {return false;}}else {return false;}}else {$v8c7dd922ad47494fc02c388e12c00eac = CURRENT_WORKING_DIR . "/" . $v8c7dd922ad47494fc02c388e12c00eac;if (!file_exists ($v8c7dd922ad47494fc02c388e12c00eac) || !is_writable($v8c7dd922ad47494fc02c388e12c00eac)) return "File not exists!";$ve6223bee17b330d9aed62e68463e0515 = getPathInfo ($v8c7dd922ad47494fc02c388e12c00eac);if ($ve6223bee17b330d9aed62e68463e0515['extension'] != "zip") {return "It's not zip-file!";}$v9024b204fb4c4ffdd07ee631ed791f75 = $v8c7dd922ad47494fc02c388e12c00eac;$v3cc7992a6d5b20ce784f6169f4423048 = $v8c7dd922ad47494fc02c388e12c00eac;}$vcedff02a1ddad18efd0b59b7b09e0eb5 = self::$addWaterMark;self::$addWaterMark = $v043f01e8ecc376fc15ecb17504a1f05e;$v888d0ee361af3603736f32131e7b20a2 = new PclZip($v3cc7992a6d5b20ce784f6169f4423048);$v10ae9fc7d453b0dd525d0edf2ede7961 = $v888d0ee361af3603736f32131e7b20a2->listContent();if (count($v10ae9fc7d453b0dd525d0edf2ede7961)<1) {throw new publicAdminException(getLabel('zip-file-empty'));}$v79001f389eb5f5185f6945430cb57be1 = cmsController::getInstance()->getModule('data')->getAllowedMaxFileSize();$ve6a7ab42343e8bc9131d89646abcb773 = regedit::getInstance()->getVal("//settings/max_img_filesize");if (!$ve6a7ab42343e8bc9131d89646abcb773) {$ve6a7ab42343e8bc9131d89646abcb773 = $v79001f389eb5f5185f6945430cb57be1;}$ve6a7ab42343e8bc9131d89646abcb773 = $ve6a7ab42343e8bc9131d89646abcb773 * 1024 * 1024;$va80da1282f2c775bbc5f2c92c836968b = 0;foreach($v10ae9fc7d453b0dd525d0edf2ede7961 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v8a8e67a18097123aaa2495f5465224da) {$v566bbee0f961ad71b54c3c2fd36db053 = strtolower(preg_replace('/^[^.]*\./', '', $v8a8e67a18097123aaa2495f5465224da['filename']));if (!umiFile::isAllowedImageType($v566bbee0f961ad71b54c3c2fd36db053)) {unset($v10ae9fc7d453b0dd525d0edf2ede7961[$v3c6e0b8a9c15224a8228b9a98ca1531d]);continue;}if ($v8a8e67a18097123aaa2495f5465224da['size']>$ve6a7ab42343e8bc9131d89646abcb773) {throw new publicAdminException(getLabel('zip-file-image-max-size')."{$v8a8e67a18097123aaa2495f5465224da['filename']}");}$va80da1282f2c775bbc5f2c92c836968b+=$v8a8e67a18097123aaa2495f5465224da['size'];}if (count($v10ae9fc7d453b0dd525d0edf2ede7961)<1) {throw new publicAdminException(getLabel('zip-file-images-absent'));}if (!checkAllowedDiskSize($va80da1282f2c775bbc5f2c92c836968b)) {throw new publicAdminException(getLabel('zip-file-images-no-free-size'));}$v10ae9fc7d453b0dd525d0edf2ede7961 = $v888d0ee361af3603736f32131e7b20a2->extract(PCLZIP_OPT_PATH, $v851148b4fd8fd7ae74bd9100c5c0c898,    PCLZIP_CB_PRE_EXTRACT, "callbackPreExtract",    PCLZIP_CB_POST_EXTRACT, "callbackPostExtract",    PCLZIP_OPT_REMOVE_ALL_PATH);self::$addWaterMark = $vcedff02a1ddad18efd0b59b7b09e0eb5;if (!is_array ($v10ae9fc7d453b0dd525d0edf2ede7961)) {throw new coreException ("Zip extracting error: ".$v888d0ee361af3603736f32131e7b20a2->errorInfo(true));}if(is_writable($v3cc7992a6d5b20ce784f6169f4423048)) {unlink($v3cc7992a6d5b20ce784f6169f4423048);}return $v10ae9fc7d453b0dd525d0edf2ede7961;}public function getFileName() {return $this->name;}public function getDirName() {return $this->dirname;}public function getModifyTime() {return $this->modify_time;}public function getExt() {return $this->ext;}public function getSize() {return $this->size;}public function getFilePath($v335fe1286880112c216697dceb9e2bd3 = false) {if($v335fe1286880112c216697dceb9e2bd3) {$vbf7be97451be760d000d8fd7b26c5a3d = ini_get("include_path");if ($vbf7be97451be760d000d8fd7b26c5a3d!='.' && substr($this->filepath, 0, strlen($vbf7be97451be760d000d8fd7b26c5a3d)) === $vbf7be97451be760d000d8fd7b26c5a3d) {return "/" . substr($this->filepath, strlen($vbf7be97451be760d000d8fd7b26c5a3d));}$vbf7be97451be760d000d8fd7b26c5a3d = CURRENT_WORKING_DIR;if (substr($this->filepath, 0, strlen($vbf7be97451be760d000d8fd7b26c5a3d)) === $vbf7be97451be760d000d8fd7b26c5a3d) {return substr($this->filepath, strlen($vbf7be97451be760d000d8fd7b26c5a3d));}return (substr($this->filepath, 0, 2) == "./") ? ("/" . substr($this->filepath, 2, strlen($this->filepath) - 2)) : $this->filepath;}else {return $this->filepath;}}private function loadInfo() {if(!is_file($this->filepath)) {$this->is_broken = true;return false;}if(!is_readable($this->filepath)) {$this->is_broken = true;return false;}$va93b85dcfbb9969f5bb3c6be71737ed5 = getPathInfo($this->filepath);$this->modify_time = filemtime($this->filepath);$this->size = filesize($this->filepath);$this->dirname = $va93b85dcfbb9969f5bb3c6be71737ed5['dirname'];$this->name = $va93b85dcfbb9969f5bb3c6be71737ed5['basename'];$this->ext = strtolower(getArrayKey($va93b85dcfbb9969f5bb3c6be71737ed5, 'extension'));if($this->ext == "php" || $this->ext == "php5" || $this->ext == "phtml") {$this->is_broken = true;}if($this->name == ".htaccess") {$this->is_broken = true;}}public function __toString() {$v6a2a431fe8b621037ea949531c28551d = $this->getFilePath(true);return is_null($v6a2a431fe8b621037ea949531c28551d) ? "" : $v6a2a431fe8b621037ea949531c28551d;}public function getIsBroken() {return (bool) $this->is_broken;}public static function getUnconflictPath($v9024b204fb4c4ffdd07ee631ed791f75) {if(!file_exists($v9024b204fb4c4ffdd07ee631ed791f75)) {return $v9024b204fb4c4ffdd07ee631ed791f75;}else {$vcaf9b6b99962bf5c2264824231d7a40c = getPathInfo($v9024b204fb4c4ffdd07ee631ed791f75);$v954eef6d6eac59aca304b6d7abb4fb3e = $vcaf9b6b99962bf5c2264824231d7a40c['dirname'];$v435ed7e9f07f740abf511a62c00eef6e = $vcaf9b6b99962bf5c2264824231d7a40c['filename'];$vabf77184f55403d75b9d51d79162a7ca = $vcaf9b6b99962bf5c2264824231d7a40c['extension'];for($v865c0c0b4ab0e063e5caa3387c1a8741 = 1;$v865c0c0b4ab0e063e5caa3387c1a8741 < 257;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v9024b204fb4c4ffdd07ee631ed791f75 = $v954eef6d6eac59aca304b6d7abb4fb3e . "/" . $v435ed7e9f07f740abf511a62c00eef6e . $v865c0c0b4ab0e063e5caa3387c1a8741 . "." . $vabf77184f55403d75b9d51d79162a7ca;if(!file_exists($v9024b204fb4c4ffdd07ee631ed791f75)) {return $v9024b204fb4c4ffdd07ee631ed791f75;}}throw new coreException("This is really hard to happen");}}protected static function getRelPath($vd6fe1d0be6347b8ef2427fa629c04485) {$v109633366fd0d46d371ede589998abaa = realpath(getcwd());return "." . substr(realpath($vd6fe1d0be6347b8ef2427fa629c04485), strlen($v109633366fd0d46d371ede589998abaa));}public static function getAddWaterMark() {return self::$addWaterMark;}public static function isAllowedImageType($v566bbee0f961ad71b54c3c2fd36db053) {return in_array($v566bbee0f961ad71b54c3c2fd36db053, self::$allowedImageTypes);}};function callbackPreExtract ($v50cd20d6ab1f950f5f7cd9594d824078, &$v346210869c15b12ae6d906bb9e095aac) {$vcaf9b6b99962bf5c2264824231d7a40c = getPathInfo($v346210869c15b12ae6d906bb9e095aac['filename']);$v566bbee0f961ad71b54c3c2fd36db053 = strtolower($vcaf9b6b99962bf5c2264824231d7a40c['extension']);if (!umiFile::isAllowedImageType($v566bbee0f961ad71b54c3c2fd36db053)) {return 0;}$v954eb83bca864c64ee1e669dfab01c95 = substr($vcaf9b6b99962bf5c2264824231d7a40c['basename'], 0, (strlen($vcaf9b6b99962bf5c2264824231d7a40c['basename']) - strlen($vcaf9b6b99962bf5c2264824231d7a40c['extension']))-1);$v954eb83bca864c64ee1e669dfab01c95 = translit::convert($v954eb83bca864c64ee1e669dfab01c95);$v346210869c15b12ae6d906bb9e095aac['filename'] = $vcaf9b6b99962bf5c2264824231d7a40c['dirname']."/".$v954eb83bca864c64ee1e669dfab01c95.".".$vcaf9b6b99962bf5c2264824231d7a40c['extension'];$v346210869c15b12ae6d906bb9e095aac['filename'] = umiFile::getUnconflictPath($v346210869c15b12ae6d906bb9e095aac['filename']);return 1;}function callbackPostExtract ($v50cd20d6ab1f950f5f7cd9594d824078, &$v346210869c15b12ae6d906bb9e095aac) {$vcaf9b6b99962bf5c2264824231d7a40c = getPathInfo($v346210869c15b12ae6d906bb9e095aac['stored_filename']);$v566bbee0f961ad71b54c3c2fd36db053 = strtolower($vcaf9b6b99962bf5c2264824231d7a40c['extension']);$v435ed7e9f07f740abf511a62c00eef6e = $v346210869c15b12ae6d906bb9e095aac['filename'];if (!umiFile::isAllowedImageType($v566bbee0f961ad71b54c3c2fd36db053)) {unlink ($v435ed7e9f07f740abf511a62c00eef6e);}else {$v3f6abb5601f05f03e3fdf4dec2668666 = @getimagesize($v435ed7e9f07f740abf511a62c00eef6e);if (!is_array($v3f6abb5601f05f03e3fdf4dec2668666)) {@unlink($v435ed7e9f07f740abf511a62c00eef6e);}if(umiFile::getAddWaterMark()) {if (umiImageFile::addWatermark($v435ed7e9f07f740abf511a62c00eef6e) !== false) return 1;}$vf9a3266ad8c9b1c7135d1e0d787fe91b = (bool) mainConfiguration::getInstance()->get("kernel", "jpg-through-gd");if ($vf9a3266ad8c9b1c7135d1e0d787fe91b) {if ($v566bbee0f961ad71b54c3c2fd36db053 == 'jpg' || $v566bbee0f961ad71b54c3c2fd36db053 == 'jpeg'){$v9b207167e5381c47682c6b4f58a623fb = imagecreatefromjpeg($v435ed7e9f07f740abf511a62c00eef6e);if($v9b207167e5381c47682c6b4f58a623fb) {imagejpeg($v9b207167e5381c47682c6b4f58a623fb, $v435ed7e9f07f740abf511a62c00eef6e, 100);imagedestroy($v9b207167e5381c47682c6b4f58a623fb);}}}}return 1;}interface iUmiImageFile {public function getWidth();public function getHeight();}class umiImageFile extends umiFile implements iUmiImageFile {const IMAGE_TYPE_GIF = "GIF";const IMAGE_TYPE_JPG = "JPG";const IMAGE_TYPE_JPEG = "JPEG";const IMAGE_TYPE_PNG = "PNG";const IMAGE_TYPE_WBMP = "WBMP";const IMAGE_TYPE_BMP = "BMP";const IMAGE_TYPE_SWF = "SWF";const IMAGE_TYPE_XBM = "XBM";private static $aSupportedTypes = null;private static $useWatermark = false;private static $CurrentBit = 0;private $sImageType;private $iImageWidth;private $iImageHeight;public function __construct($v6a2a431fe8b621037ea949531c28551d) {parent::__construct($v6a2a431fe8b621037ea949531c28551d);if (!$this->is_broken) {$this->is_broken = ! self::getIsImage($this->name);}if (!$this->getIsBroken()) {$v14b626809ea481d1490034025d1edd8b = getimagesize($v6a2a431fe8b621037ea949531c28551d);$this->iImageWidth = $v14b626809ea481d1490034025d1edd8b[0];$this->iImageHeight = $v14b626809ea481d1490034025d1edd8b[1];switch ($v14b626809ea481d1490034025d1edd8b['mime']) {case 'image/gif': $this->sImageType = self::IMAGE_TYPE_GIF;break;case 'image/jpg': $this->sImageType = self::IMAGE_TYPE_JPG;break;case 'image/jpeg': $this->sImageType = self::IMAGE_TYPE_JPEG;break;case 'image/png': $this->sImageType = self::IMAGE_TYPE_PNG;break;case 'image/vnd.wap.wbmp': $this->sImageType = self::IMAGE_TYPE_WBMP;break;case 'image/bmp': $this->sImageType = self::IMAGE_TYPE_BMP;break;case 'application/x-shockwave-flash': $this->sImageType = self::IMAGE_TYPE_SWF;break;}}}public static function getSupportedImageTypes() {if (is_null(self::$aSupportedTypes)) {self::$aSupportedTypes = array();self::$aSupportedTypes[] = self::IMAGE_TYPE_GIF;self::$aSupportedTypes[] = self::IMAGE_TYPE_JPG;self::$aSupportedTypes[] = self::IMAGE_TYPE_JPEG;self::$aSupportedTypes[] = self::IMAGE_TYPE_PNG;self::$aSupportedTypes[] = self::IMAGE_TYPE_WBMP;self::$aSupportedTypes[] = self::IMAGE_TYPE_BMP;self::$aSupportedTypes[] = self::IMAGE_TYPE_SWF;}return self::$aSupportedTypes;}public static function setWatermarkOn () {self::$useWatermark = true;}public static function setWatermarkOff () {self::$useWatermark = false;}public static function upload($veeeb23fbd23e52a6a6ff78b9f18cbc4e, $v86536e21993c5a96a4d4c9c9afcc9b17, $vb2ed5fc91c9760886b14c955ac6c82d7, $vb80bb7740288fda1f201890375a60c8f = false) {self::$class_name = __CLASS__;$v6a2a431fe8b621037ea949531c28551d = parent::upload($veeeb23fbd23e52a6a6ff78b9f18cbc4e, $v86536e21993c5a96a4d4c9c9afcc9b17, $vb2ed5fc91c9760886b14c955ac6c82d7, $vb80bb7740288fda1f201890375a60c8f);$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$ve6a7ab42343e8bc9131d89646abcb773 = (int) $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/max_img_filesize");$v79001f389eb5f5185f6945430cb57be1 = (int) ini_get("upload_max_filesize");$ve6a7ab42343e8bc9131d89646abcb773 = ($ve6a7ab42343e8bc9131d89646abcb773 < $v79001f389eb5f5185f6945430cb57be1) ? $ve6a7ab42343e8bc9131d89646abcb773 : $v79001f389eb5f5185f6945430cb57be1;$v11b4278c7e5a79003db77272c1ed2cf5 = (int) filesize("." . $v6a2a431fe8b621037ea949531c28551d);$ve6a7ab42343e8bc9131d89646abcb773 = (int) $ve6a7ab42343e8bc9131d89646abcb773*1024*1024;if($ve6a7ab42343e8bc9131d89646abcb773 > 0) {if($ve6a7ab42343e8bc9131d89646abcb773 < $v11b4278c7e5a79003db77272c1ed2cf5) {unlink("." . $v6a2a431fe8b621037ea949531c28551d);return false;}}$vcaf9b6b99962bf5c2264824231d7a40c = @getimagesize(".".$v6a2a431fe8b621037ea949531c28551d);if(!is_array($vcaf9b6b99962bf5c2264824231d7a40c)) {@unlink("." . $v6a2a431fe8b621037ea949531c28551d);return false;}$vf9a3266ad8c9b1c7135d1e0d787fe91b = (bool) mainConfiguration::getInstance()->get("kernel", "jpg-through-gd");if ($vf9a3266ad8c9b1c7135d1e0d787fe91b) {list(,, $v566bbee0f961ad71b54c3c2fd36db053) = array_values(getPathInfo("." . $v6a2a431fe8b621037ea949531c28551d));$v566bbee0f961ad71b54c3c2fd36db053 = strtolower($v566bbee0f961ad71b54c3c2fd36db053);if ($v566bbee0f961ad71b54c3c2fd36db053 == 'jpg' || $v566bbee0f961ad71b54c3c2fd36db053 == 'jpeg'){$v9b207167e5381c47682c6b4f58a623fb = imagecreatefromjpeg("." . $v6a2a431fe8b621037ea949531c28551d);if ($v9b207167e5381c47682c6b4f58a623fb) {imagejpeg($v9b207167e5381c47682c6b4f58a623fb, "." . $v6a2a431fe8b621037ea949531c28551d, 100);imagedestroy($v9b207167e5381c47682c6b4f58a623fb);}else {return false;}}}if (self::$useWatermark) {self::addWatermark ("./".$v6a2a431fe8b621037ea949531c28551d);}self::setWatermarkOff ();return $v6a2a431fe8b621037ea949531c28551d;}public static function getIsImage($v718f2106be68f0edfc366ed06124fe55) {$vdc94d607c2365888317e7b14f9ea0a9d = explode(".", $v718f2106be68f0edfc366ed06124fe55);$vdd3d03de4e016ecdd03c280fe46c86a3 = strtoupper(array_pop($vdc94d607c2365888317e7b14f9ea0a9d));return in_array($vdd3d03de4e016ecdd03c280fe46c86a3, self::getSupportedImageTypes());}public function getWidth() {return $this->iImageWidth;}public function getHeight() {return $this->iImageHeight;}public function getType () {return $this->sImageType;}public static function addWatermark ($v47826cacc65c665212b821e6ff80b9b0) {if (!empty($_REQUEST['disable_watermark'])) return false;$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance ();$v9234d6561fcbf96ed0c3f0ee5794032d = $vb1444fb0c07653567ad325aa25d4e37a->getVal ("//settings/watermark/image");$v8fa8b46b17731c7c9c882faede387741 = $vb1444fb0c07653567ad325aa25d4e37a->getVal ("//settings/watermark/alpha");$v379da31305f1eba200307fcdf9cf0ca0 = $vb1444fb0c07653567ad325aa25d4e37a->getVal ("//settings/watermark/valign");$vb1c37415e373f67b34bfbdeac8a8338f = $vb1444fb0c07653567ad325aa25d4e37a->getVal ("//settings/watermark/halign");if (!file_exists ($v9234d6561fcbf96ed0c3f0ee5794032d)) {return false;}if (!$v8fa8b46b17731c7c9c882faede387741) {$v8fa8b46b17731c7c9c882faede387741 = 100;}if (!$v379da31305f1eba200307fcdf9cf0ca0) {$v379da31305f1eba200307fcdf9cf0ca0 = "bottom";}if (!$vb1c37415e373f67b34bfbdeac8a8338f) {$vb1c37415e373f67b34bfbdeac8a8338f = "right";}$vfc1eb20506413fbbdc753afe5117cff0 = self::createImage ($v9234d6561fcbf96ed0c3f0ee5794032d);$v6226ba4abbac63dbd2114cb5966b1bf8 = self::createImage ($v47826cacc65c665212b821e6ff80b9b0);$vfcf76116d23aa625909b9eb0e709b276 = getPathInfo ($v47826cacc65c665212b821e6ff80b9b0);if (!$vfc1eb20506413fbbdc753afe5117cff0 || !$v6226ba4abbac63dbd2114cb5966b1bf8) {return false;}$v6382f6cf920a5e1f12258b86b3fcac3b = 0;$v44ef37a80954a70dc24d955310d80967 = 0;switch ($vb1c37415e373f67b34bfbdeac8a8338f){case "center" : {$v6382f6cf920a5e1f12258b86b3fcac3b = floor (($v6226ba4abbac63dbd2114cb5966b1bf8["width"] - $vfc1eb20506413fbbdc753afe5117cff0["width"]) / 2);break;}case "right" : {$v6382f6cf920a5e1f12258b86b3fcac3b = $v6226ba4abbac63dbd2114cb5966b1bf8["width"] - $vfc1eb20506413fbbdc753afe5117cff0["width"];}}switch ($v379da31305f1eba200307fcdf9cf0ca0) {case "center" : {$v44ef37a80954a70dc24d955310d80967 = floor (($v6226ba4abbac63dbd2114cb5966b1bf8["height"] - $vfc1eb20506413fbbdc753afe5117cff0["height"]) / 2);break;}case "bottom" : {$v44ef37a80954a70dc24d955310d80967 = $v6226ba4abbac63dbd2114cb5966b1bf8["height"] - $vfc1eb20506413fbbdc753afe5117cff0["height"];}}$vfa816edb83e95bf0c8da580bdfd491ef = $vfc1eb20506413fbbdc753afe5117cff0['im'];$vfe47aa7c733c490d36e80508d5dc4019 = imagecreatetruecolor($vfc1eb20506413fbbdc753afe5117cff0["width"], $vfc1eb20506413fbbdc753afe5117cff0["height"]);imagecopy($vfe47aa7c733c490d36e80508d5dc4019, $v6226ba4abbac63dbd2114cb5966b1bf8['im'], 0, 0, $v6382f6cf920a5e1f12258b86b3fcac3b , $v44ef37a80954a70dc24d955310d80967, $vfc1eb20506413fbbdc753afe5117cff0["width"], $vfc1eb20506413fbbdc753afe5117cff0["height"]);imagecopy($vfe47aa7c733c490d36e80508d5dc4019, $vfa816edb83e95bf0c8da580bdfd491ef, 0, 0, 0, 0, $vfc1eb20506413fbbdc753afe5117cff0["width"], $vfc1eb20506413fbbdc753afe5117cff0["height"]);imagecopymerge($v6226ba4abbac63dbd2114cb5966b1bf8['im'], $vfe47aa7c733c490d36e80508d5dc4019, $v6382f6cf920a5e1f12258b86b3fcac3b , $v44ef37a80954a70dc24d955310d80967, 0, 0, $vfc1eb20506413fbbdc753afe5117cff0["width"], $vfc1eb20506413fbbdc753afe5117cff0["height"], $v8fa8b46b17731c7c9c882faede387741);switch ($vfcf76116d23aa625909b9eb0e709b276['extension']) {case "jpeg" :    case "jpg"  :    case "JPEG" :    case "JPG"  : {imagejpeg ($v6226ba4abbac63dbd2114cb5966b1bf8['im'], $v47826cacc65c665212b821e6ff80b9b0, 90);break;}case "png" :    case "PNG" : {imagepng ($v6226ba4abbac63dbd2114cb5966b1bf8['im'], $v47826cacc65c665212b821e6ff80b9b0);}case "gif" :    case "GIF" : {imagegif ($v6226ba4abbac63dbd2114cb5966b1bf8['im'], $v47826cacc65c665212b821e6ff80b9b0);break;}case "bmp" :    case "BMP" :     imagewbmp($v6226ba4abbac63dbd2114cb5966b1bf8['im'], $v47826cacc65c665212b821e6ff80b9b0);break;}imagedestroy ($v6226ba4abbac63dbd2114cb5966b1bf8["im"]);imagedestroy ($vfc1eb20506413fbbdc753afe5117cff0["im"]);return;}public static function createImage ($vfdc0a99c383c1558bed83c633f57a836) {$vfdc0a99c383c1558bed83c633f57a836 = str_replace(CURRENT_WORKING_DIR, '', $vfdc0a99c383c1558bed83c633f57a836);$v931072b8630108758003074932646789 = 0;$va93b85dcfbb9969f5bb3c6be71737ed5 = parse_url ($vfdc0a99c383c1558bed83c633f57a836);$vfdc0a99c383c1558bed83c633f57a836 = (substr ($va93b85dcfbb9969f5bb3c6be71737ed5["path"], 0, 1) == "/")        ? substr ($va93b85dcfbb9969f5bb3c6be71737ed5["path"], 1)        : $va93b85dcfbb9969f5bb3c6be71737ed5["path"];list ($veaae26a6fb20ed3ef54fb23bfa0b1fcc, $vb435e227d5dd201e1768b2bcb2e0aa81, $v599dcce2998a6b40b1e38e8c6006cb0a, $v815be97df65d6c4b510cd07189c5347a) = getimagesize ($vfdc0a99c383c1558bed83c633f57a836);$vd14a8022b085f9ef19d479cbdd581127 = array (    "GIF" => "1",    "JPG" => "2",    "PNG" => "3",    "BMP" => "6",    "WBMP"=> "15",    "XBM" => "16"   );switch($v599dcce2998a6b40b1e38e8c6006cb0a){case $vd14a8022b085f9ef19d479cbdd581127["GIF"] : {$v931072b8630108758003074932646789 = imagecreatefromgif ($vfdc0a99c383c1558bed83c633f57a836);break;}case $vd14a8022b085f9ef19d479cbdd581127["JPG"] : {$v931072b8630108758003074932646789 = imagecreatefromjpeg ($vfdc0a99c383c1558bed83c633f57a836);break;}case $vd14a8022b085f9ef19d479cbdd581127["PNG"] : {$v931072b8630108758003074932646789 = imagecreatefrompng ($vfdc0a99c383c1558bed83c633f57a836);break;}case $vd14a8022b085f9ef19d479cbdd581127["BMP"] : {$v931072b8630108758003074932646789 = self::imagecreatefrombmp($vfdc0a99c383c1558bed83c633f57a836);break;}case $vd14a8022b085f9ef19d479cbdd581127["WBMP"] : {$v931072b8630108758003074932646789 = imagecreatefromwbmp ($vfdc0a99c383c1558bed83c633f57a836);break;}case $vd14a8022b085f9ef19d479cbdd581127["XBM"]: {$v931072b8630108758003074932646789 = imagecreatefromxbm ($vfdc0a99c383c1558bed83c633f57a836);}}if (!$v931072b8630108758003074932646789) {return false;}return array (    "im"     => $v931072b8630108758003074932646789,    "width"  => $veaae26a6fb20ed3ef54fb23bfa0b1fcc,    "height" => $vb435e227d5dd201e1768b2bcb2e0aa81   );}private static function imagecreatefrombmp($v8c7dd922ad47494fc02c388e12c00eac) {$v8fa14cdd754f91cc6554c9e71929cce7=fopen($v8c7dd922ad47494fc02c388e12c00eac,"r");$vbf50d5e661106d0abe925af3c2e6f7e7=fread($v8fa14cdd754f91cc6554c9e71929cce7,2);if($vbf50d5e661106d0abe925af3c2e6f7e7=="BM") {$v6f6cb72d544962fa333e2e34ce64f719=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$v93876cb309016fa725517b046474c44b=self::freadword($v8fa14cdd754f91cc6554c9e71929cce7);$vd783eb173ee49cc2a004bc1ca1313615=self::freadword($v8fa14cdd754f91cc6554c9e71929cce7);$v056a0c9991d04d9beff38e2b57cbd664=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$va4351f8f1ec9ca5a4c6ed7c410fcb257=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$v32954654ac8fe66a1d09be19001de2d4=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$veec6c4bdbd339edf8cbea68becb85244=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$v28b87ac4afa53ae10c311ab1f61a1e9e=self::freadword($v8fa14cdd754f91cc6554c9e71929cce7);$v136df92ca0fb8b357d993db54745c0b8=self::freadword($v8fa14cdd754f91cc6554c9e71929cce7);$vcc57d9dd82c4fd748040b0c307fd7549=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$v29b01310a538d19ce6d5f31b5778a184=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$vc1a9d41a7da069f13dceea59fe3ad5b2=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$vf2abe942bf77f78c928161aaaaa16e64=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$v5d79cce22329cceb25e3acdbf49968f2=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);$v50a66c470ac0166a9669fc3e03e3c6fb=self::freaddword($v8fa14cdd754f91cc6554c9e71929cce7);if($v136df92ca0fb8b357d993db54745c0b8<24) {$vb798abe6e1b1318ee36b0dcb3fb9e4d3=imagecreate($v32954654ac8fe66a1d09be19001de2d4,$veec6c4bdbd339edf8cbea68becb85244);$v5d50889672f6f860d14f502de3de1957=pow(2,$v136df92ca0fb8b357d993db54745c0b8);for($v83878c91171338902e0fe0fb97a8c47a=0;$v83878c91171338902e0fe0fb97a8c47a<$v5d50889672f6f860d14f502de3de1957;$v83878c91171338902e0fe0fb97a8c47a++) {$v9d5ed678fe57bcca610140957afab571=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$vdfcf28d0734569a6a693bc8194de62bf=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$ve1e1d3d40573127e9ee0480caf1283d6=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v942d4e37dd5607ab68e54755540d4a47=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v278f9a3d3077c522e71022e302b9e0e4[]=imagecolorallocate($vb798abe6e1b1318ee36b0dcb3fb9e4d3,$ve1e1d3d40573127e9ee0480caf1283d6,$vdfcf28d0734569a6a693bc8194de62bf,$v9d5ed678fe57bcca610140957afab571);}if($vcc57d9dd82c4fd748040b0c307fd7549==0) {$vf9071030634dc9ba61220c00f43154ec=(4-ceil(($v32954654ac8fe66a1d09be19001de2d4/(8/$v136df92ca0fb8b357d993db54745c0b8)))%4)%4;for($v415290769594460e2e485922904f345d=$veec6c4bdbd339edf8cbea68becb85244-1;$v415290769594460e2e485922904f345d>=0;$v415290769594460e2e485922904f345d--) {$v66d797234bd5226a7f693148bdba711d=0;for($v9dd4e461268c8034f5c8564e155c67a6=0;$v9dd4e461268c8034f5c8564e155c67a6<$v32954654ac8fe66a1d09be19001de2d4;$v9dd4e461268c8034f5c8564e155c67a6++) {$v0d61f8370cad1d412f80b84d143e1257=self::freadbits($v8fa14cdd754f91cc6554c9e71929cce7,$v136df92ca0fb8b357d993db54745c0b8);imagesetpixel($vb798abe6e1b1318ee36b0dcb3fb9e4d3,$v9dd4e461268c8034f5c8564e155c67a6,$v415290769594460e2e485922904f345d,$v278f9a3d3077c522e71022e302b9e0e4[$v0d61f8370cad1d412f80b84d143e1257]);}if($v66d797234bd5226a7f693148bdba711d!=0) {self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);}for($vb2f5ff47436671b6e533d8dc3614845d=0;$vb2f5ff47436671b6e533d8dc3614845d<$vf9071030634dc9ba61220c00f43154ec;$vb2f5ff47436671b6e533d8dc3614845d++) {self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);}}}}if($vcc57d9dd82c4fd748040b0c307fd7549==1) {$v415290769594460e2e485922904f345d=$veec6c4bdbd339edf8cbea68becb85244;$v274613660d6f553d0240876b0fbf6260=0;while(true) {$v415290769594460e2e485922904f345d--;$v851f5ac9941d720844d143ed9cfcf60a=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v4ec1b477cd0232b832c1899905ec51a4=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v274613660d6f553d0240876b0fbf6260+=2;$vedb344e177b15d313695ebb69ede7f74=false;if ($vedb344e177b15d313695ebb69ede7f74) {if ( ($v851f5ac9941d720844d143ed9cfcf60a==0) && ($v4ec1b477cd0232b832c1899905ec51a4==1) ) break;if ( feof($v8fa14cdd754f91cc6554c9e71929cce7) ) break;while(!(($v851f5ac9941d720844d143ed9cfcf60a==0)and($v4ec1b477cd0232b832c1899905ec51a4==0))) {if($v851f5ac9941d720844d143ed9cfcf60a==0) {$va99ef566140785e27eaf2d9d3fc45718=$v4ec1b477cd0232b832c1899905ec51a4;$vf6068daa29dbb05a7ead1e3b5a48bbee.=fread($v8fa14cdd754f91cc6554c9e71929cce7,$va99ef566140785e27eaf2d9d3fc45718);$v274613660d6f553d0240876b0fbf6260+=$va99ef566140785e27eaf2d9d3fc45718;if($v274613660d6f553d0240876b0fbf6260%2==1) {self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v274613660d6f553d0240876b0fbf6260++;}}if($v851f5ac9941d720844d143ed9cfcf60a>0) {$va99ef566140785e27eaf2d9d3fc45718=$v851f5ac9941d720844d143ed9cfcf60a;for($v4b43b0aee35624cd95b910189b3dc231=0;$v4b43b0aee35624cd95b910189b3dc231<$va99ef566140785e27eaf2d9d3fc45718;$v4b43b0aee35624cd95b910189b3dc231++) {$vf6068daa29dbb05a7ead1e3b5a48bbee.=chr($v4ec1b477cd0232b832c1899905ec51a4);}}}$v851f5ac9941d720844d143ed9cfcf60a=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v4ec1b477cd0232b832c1899905ec51a4=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v274613660d6f553d0240876b0fbf6260+=2;}for($v9dd4e461268c8034f5c8564e155c67a6=0;$v9dd4e461268c8034f5c8564e155c67a6<strlen($vf6068daa29dbb05a7ead1e3b5a48bbee);$v9dd4e461268c8034f5c8564e155c67a6++) {imagesetpixel($vb798abe6e1b1318ee36b0dcb3fb9e4d3,$v9dd4e461268c8034f5c8564e155c67a6,$v415290769594460e2e485922904f345d,$v278f9a3d3077c522e71022e302b9e0e4[ord($vf6068daa29dbb05a7ead1e3b5a48bbee[$v9dd4e461268c8034f5c8564e155c67a6])]);}$vf6068daa29dbb05a7ead1e3b5a48bbee="";}}if($vcc57d9dd82c4fd748040b0c307fd7549==2) {$v415290769594460e2e485922904f345d=$veec6c4bdbd339edf8cbea68becb85244;$v274613660d6f553d0240876b0fbf6260=0;while(true) {$v415290769594460e2e485922904f345d--;$v851f5ac9941d720844d143ed9cfcf60a=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v4ec1b477cd0232b832c1899905ec51a4=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v274613660d6f553d0240876b0fbf6260+=2;$vedb344e177b15d313695ebb69ede7f74=false;if ( ($v851f5ac9941d720844d143ed9cfcf60a==0) and ($v4ec1b477cd0232b832c1899905ec51a4==1) ) break;if ( feof($v8fa14cdd754f91cc6554c9e71929cce7) ) break;while(!(($v851f5ac9941d720844d143ed9cfcf60a==0)and($v4ec1b477cd0232b832c1899905ec51a4==0))) {if($v851f5ac9941d720844d143ed9cfcf60a==0) {$va99ef566140785e27eaf2d9d3fc45718=$v4ec1b477cd0232b832c1899905ec51a4;$v66d797234bd5226a7f693148bdba711d=0;for($v2510c39011c5be704182423e3a695e91=0;$v2510c39011c5be704182423e3a695e91<$va99ef566140785e27eaf2d9d3fc45718;$v2510c39011c5be704182423e3a695e91++) {$vf6068daa29dbb05a7ead1e3b5a48bbee.=chr(self::freadbits($v8fa14cdd754f91cc6554c9e71929cce7,4));}if ($v66d797234bd5226a7f693148bdba711d!=0) self::freadbits($v8fa14cdd754f91cc6554c9e71929cce7,4);$v274613660d6f553d0240876b0fbf6260+=ceil(($va99ef566140785e27eaf2d9d3fc45718/2));if($v274613660d6f553d0240876b0fbf6260%2==1) {self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v274613660d6f553d0240876b0fbf6260++;}}if($v851f5ac9941d720844d143ed9cfcf60a>0) {$va99ef566140785e27eaf2d9d3fc45718=$v851f5ac9941d720844d143ed9cfcf60a;$v865c0c0b4ab0e063e5caa3387c1a8741=0;for($v4b43b0aee35624cd95b910189b3dc231=0;$v4b43b0aee35624cd95b910189b3dc231<$va99ef566140785e27eaf2d9d3fc45718;$v4b43b0aee35624cd95b910189b3dc231++) {if($v865c0c0b4ab0e063e5caa3387c1a8741%2==0) {$vf6068daa29dbb05a7ead1e3b5a48bbee.=chr($v4ec1b477cd0232b832c1899905ec51a4%16);}else {$vf6068daa29dbb05a7ead1e3b5a48bbee.=chr(floor($v4ec1b477cd0232b832c1899905ec51a4/16));}$v865c0c0b4ab0e063e5caa3387c1a8741++;}}$v851f5ac9941d720844d143ed9cfcf60a=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v4ec1b477cd0232b832c1899905ec51a4=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v274613660d6f553d0240876b0fbf6260+=2;}for($v9dd4e461268c8034f5c8564e155c67a6=0;$v9dd4e461268c8034f5c8564e155c67a6<strlen($vf6068daa29dbb05a7ead1e3b5a48bbee);$v9dd4e461268c8034f5c8564e155c67a6++) {imagesetpixel($vb798abe6e1b1318ee36b0dcb3fb9e4d3,$v9dd4e461268c8034f5c8564e155c67a6,$v415290769594460e2e485922904f345d,$v278f9a3d3077c522e71022e302b9e0e4[ord($vf6068daa29dbb05a7ead1e3b5a48bbee[$v9dd4e461268c8034f5c8564e155c67a6])]);}$vf6068daa29dbb05a7ead1e3b5a48bbee="";}}if($v136df92ca0fb8b357d993db54745c0b8==24) {$vb798abe6e1b1318ee36b0dcb3fb9e4d3=imagecreatetruecolor($v32954654ac8fe66a1d09be19001de2d4,$veec6c4bdbd339edf8cbea68becb85244);$vf9071030634dc9ba61220c00f43154ec=$v32954654ac8fe66a1d09be19001de2d4%4;for($v415290769594460e2e485922904f345d=$veec6c4bdbd339edf8cbea68becb85244-1;$v415290769594460e2e485922904f345d>=0;$v415290769594460e2e485922904f345d--) {for($v9dd4e461268c8034f5c8564e155c67a6=0;$v9dd4e461268c8034f5c8564e155c67a6<$v32954654ac8fe66a1d09be19001de2d4;$v9dd4e461268c8034f5c8564e155c67a6++) {$v9d5ed678fe57bcca610140957afab571=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$vdfcf28d0734569a6a693bc8194de62bf=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$ve1e1d3d40573127e9ee0480caf1283d6=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$v70dda5dfb8053dc6d1c492574bce9bfd=imagecolorexact($vb798abe6e1b1318ee36b0dcb3fb9e4d3,$ve1e1d3d40573127e9ee0480caf1283d6,$vdfcf28d0734569a6a693bc8194de62bf,$v9d5ed678fe57bcca610140957afab571);if($v70dda5dfb8053dc6d1c492574bce9bfd==-1) $v70dda5dfb8053dc6d1c492574bce9bfd=imagecolorallocate($vb798abe6e1b1318ee36b0dcb3fb9e4d3,$ve1e1d3d40573127e9ee0480caf1283d6,$vdfcf28d0734569a6a693bc8194de62bf,$v9d5ed678fe57bcca610140957afab571);imagesetpixel($vb798abe6e1b1318ee36b0dcb3fb9e4d3,$v9dd4e461268c8034f5c8564e155c67a6,$v415290769594460e2e485922904f345d,$v70dda5dfb8053dc6d1c492574bce9bfd);}for($vfbade9e36a3f36d3d676c1b808451dd7=0;$vfbade9e36a3f36d3d676c1b808451dd7<$vf9071030634dc9ba61220c00f43154ec;$vfbade9e36a3f36d3d676c1b808451dd7++) {self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);}}}fclose($v8fa14cdd754f91cc6554c9e71929cce7);return $vb798abe6e1b1318ee36b0dcb3fb9e4d3;}fclose($v8fa14cdd754f91cc6554c9e71929cce7);}private static function freaddword($v8fa14cdd754f91cc6554c9e71929cce7) {$vedbab45572c72a5d9440b40bcc0500c0=self::freadword($v8fa14cdd754f91cc6554c9e71929cce7);$vfbfba2e45c2045dc5cab22a5afe83d9d=self::freadword($v8fa14cdd754f91cc6554c9e71929cce7);return $vfbfba2e45c2045dc5cab22a5afe83d9d*65536+$vedbab45572c72a5d9440b40bcc0500c0;}private static function freadword($v8fa14cdd754f91cc6554c9e71929cce7) {$vedbab45572c72a5d9440b40bcc0500c0=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$vfbfba2e45c2045dc5cab22a5afe83d9d=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);return $vfbfba2e45c2045dc5cab22a5afe83d9d*256+$vedbab45572c72a5d9440b40bcc0500c0;}private static function freadbyte($v8fa14cdd754f91cc6554c9e71929cce7) {return ord(fread($v8fa14cdd754f91cc6554c9e71929cce7,1));}private static function freadbits($v8fa14cdd754f91cc6554c9e71929cce7,$ve2942a04780e223b215eb8b663cf5353) {$va245c3230debe5c956484ecc6fa93877=self::freadbyte($v8fa14cdd754f91cc6554c9e71929cce7);$ve30207aeed603884c54f309c609d6c06 = self::$CurrentBit;self::$CurrentBit += $ve2942a04780e223b215eb8b663cf5353;if (self::$CurrentBit==8) {self::$CurrentBit=0;}else {fseek($v8fa14cdd754f91cc6554c9e71929cce7,ftell($v8fa14cdd754f91cc6554c9e71929cce7)-1);}return self::RetBits($va245c3230debe5c956484ecc6fa93877,$ve30207aeed603884c54f309c609d6c06,$ve2942a04780e223b215eb8b663cf5353);}private static function RetBits($v40ea57d3ee3c07bf1c102b466e1c3091,$vea2b2676c28c0db26d39331a336c6b92,$vf5a8e923f8cd24b56b3bab32358cc58a) {$vc1111bd512b29e821b120b86446026b8=self::decbin8($v40ea57d3ee3c07bf1c102b466e1c3091);$v4b43b0aee35624cd95b910189b3dc231=bindec(substr($vc1111bd512b29e821b120b86446026b8,$vea2b2676c28c0db26d39331a336c6b92,$vf5a8e923f8cd24b56b3bab32358cc58a));return $v4b43b0aee35624cd95b910189b3dc231;}private static function decbin8($v8277e0910d750195b448797616e091ad) {return self::decbinx($v8277e0910d750195b448797616e091ad,8);}private static function decbinx($v8277e0910d750195b448797616e091ad,$v7b8b965ad4bca0e41ab51de7b31363a1) {$vc1111bd512b29e821b120b86446026b8=decbin($v8277e0910d750195b448797616e091ad);$ve61c5d46c0763cd7a52e7d474dadfc16=strlen($vc1111bd512b29e821b120b86446026b8);for($v363b122c528f54df4a0446b6bab05515=0;$v363b122c528f54df4a0446b6bab05515<$v7b8b965ad4bca0e41ab51de7b31363a1-$ve61c5d46c0763cd7a52e7d474dadfc16;$v363b122c528f54df4a0446b6bab05515++) {$vc1111bd512b29e821b120b86446026b8="0$vc1111bd512b29e821b120b86446026b8";}return $vc1111bd512b29e821b120b86446026b8;}private function saveFile ($v57f1fe0c87b65e614245626aeea2a04e) {switch ($this->getType()) {case self::IMAGE_TYPE_GIF:     imagegif($v57f1fe0c87b65e614245626aeea2a04e, $this->getFilePath());break;case self::IMAGE_TYPE_JPEG:    case self::IMAGE_TYPE_JPG:     imagejpeg($v57f1fe0c87b65e614245626aeea2a04e, $this->getFilePath());break;case self::IMAGE_TYPE_PNG:     imagepng($v57f1fe0c87b65e614245626aeea2a04e, $this->getFilePath());break;case self::IMAGE_TYPE_WBMP:    case self::IMAGE_TYPE_BMP:     imagewbmp($v57f1fe0c87b65e614245626aeea2a04e, $this->getFilePath());break;case self::IMAGE_TYPE_XBM:     imagexbm($v57f1fe0c87b65e614245626aeea2a04e, $this->getFilePath());break;}$this->__construct($this->getFilePath());}private function getImageResource () {$v5c15edb4e54ca0933b526461d17393f3 = $this->createImage($this->getFilePath());if (!$v5c15edb4e54ca0933b526461d17393f3) {throw new coreException("Failed to load image");}return $v5c15edb4e54ca0933b526461d17393f3['im'];}public function rotate () {$va9ee1bf95fc30b0119d41ece16a4ef8a = $this->getImageResource();$v7a6a4e6acf4be0deee4d2ca3d5270443 = $this->rotate_cw_90deg($va9ee1bf95fc30b0119d41ece16a4ef8a);$this->saveFile($v7a6a4e6acf4be0deee4d2ca3d5270443);imagedestroy($va9ee1bf95fc30b0119d41ece16a4ef8a);imagedestroy($v7a6a4e6acf4be0deee4d2ca3d5270443);}private function rotate_cw_90deg ($v78805a221a988e79ef3f42d7c5bfd418) {$v27db346633b0e2d767950d1bd094acb2 = imagesx($v78805a221a988e79ef3f42d7c5bfd418);$v221f8f22ae36e81b0032c9f0a263780f = imagesy($v78805a221a988e79ef3f42d7c5bfd418);$v57f1fe0c87b65e614245626aeea2a04e= @imagecreatetruecolor($v221f8f22ae36e81b0032c9f0a263780f, $v27db346633b0e2d767950d1bd094acb2);$ve46ce6be1dd9fd2559e9e6e2d3197388 = 0;if ($this->getType() === self::IMAGE_TYPE_PNG) {imagealphablending($v57f1fe0c87b65e614245626aeea2a04e, false);imagesavealpha($v57f1fe0c87b65e614245626aeea2a04e, true);$ve46ce6be1dd9fd2559e9e6e2d3197388 = imagecolorallocatealpha($v57f1fe0c87b65e614245626aeea2a04e, 255, 255, 255, 127);imagefilledrectangle($v57f1fe0c87b65e614245626aeea2a04e, 0, 0, $v221f8f22ae36e81b0032c9f0a263780f, $v27db346633b0e2d767950d1bd094acb2, $ve46ce6be1dd9fd2559e9e6e2d3197388);}$vfa0d373b0592ddd352652108de5c4a85 = imagerotate($v78805a221a988e79ef3f42d7c5bfd418, 270, $ve46ce6be1dd9fd2559e9e6e2d3197388, true);if ($v57f1fe0c87b65e614245626aeea2a04e) {imagecopyresized(     $v57f1fe0c87b65e614245626aeea2a04e,     $vfa0d373b0592ddd352652108de5c4a85,     0, 0, 0, 0,     imagesx($v57f1fe0c87b65e614245626aeea2a04e), imagesy($v57f1fe0c87b65e614245626aeea2a04e), imagesx($vfa0d373b0592ddd352652108de5c4a85), imagesy($vfa0d373b0592ddd352652108de5c4a85)    );return $v57f1fe0c87b65e614245626aeea2a04e;}else {return false;}}public function crop ($v489a001de516fc9519ca1d9cbde938c1, $v1ab9e24365b22cfa518467c707a23c74, $v23b3a8ca2b02b4bd0a80827019c33864, $vdafa201743ff091488cceeb6ae5992a8) {$va9ee1bf95fc30b0119d41ece16a4ef8a = $this->getImageResource();$v087df9a6573cf747f418cf9957ad244a = imagecreatetruecolor($v1ab9e24365b22cfa518467c707a23c74, $vdafa201743ff091488cceeb6ae5992a8);if ($this->getType() === self::IMAGE_TYPE_PNG) {imagealphablending($v087df9a6573cf747f418cf9957ad244a, false);imagesavealpha($v087df9a6573cf747f418cf9957ad244a, true);$ve46ce6be1dd9fd2559e9e6e2d3197388 = imagecolorallocatealpha($v087df9a6573cf747f418cf9957ad244a, 255, 255, 255, 127);imagefilledrectangle($v087df9a6573cf747f418cf9957ad244a, 0, 0, $v1ab9e24365b22cfa518467c707a23c74, $vdafa201743ff091488cceeb6ae5992a8, $ve46ce6be1dd9fd2559e9e6e2d3197388);}imagecopyresampled($v087df9a6573cf747f418cf9957ad244a, $va9ee1bf95fc30b0119d41ece16a4ef8a, 0, 0, $v489a001de516fc9519ca1d9cbde938c1, $v23b3a8ca2b02b4bd0a80827019c33864, $v1ab9e24365b22cfa518467c707a23c74, $vdafa201743ff091488cceeb6ae5992a8, $v1ab9e24365b22cfa518467c707a23c74, $vdafa201743ff091488cceeb6ae5992a8);$this->saveFile($v087df9a6573cf747f418cf9957ad244a);}public function resize ($vb7a7dc15c3ff7a97b50f42c6ad9cf034, $vc89a98164477a92660a9d30b8a899f2a) {$va9ee1bf95fc30b0119d41ece16a4ef8a = $this->getImageResource();$va464d254c26af6536657e681a5ee4ea5 = imagecreatetruecolor($vb7a7dc15c3ff7a97b50f42c6ad9cf034, $vc89a98164477a92660a9d30b8a899f2a);if ($this->getType() === self::IMAGE_TYPE_PNG) {imagealphablending($va464d254c26af6536657e681a5ee4ea5, false);imagesavealpha($va464d254c26af6536657e681a5ee4ea5, true);$ve46ce6be1dd9fd2559e9e6e2d3197388 = imagecolorallocatealpha($va464d254c26af6536657e681a5ee4ea5, 255, 255, 255, 127);imagefilledrectangle($va464d254c26af6536657e681a5ee4ea5, 0, 0, $vb7a7dc15c3ff7a97b50f42c6ad9cf034, $vc89a98164477a92660a9d30b8a899f2a, $ve46ce6be1dd9fd2559e9e6e2d3197388);}imagecopyresampled($va464d254c26af6536657e681a5ee4ea5, $va9ee1bf95fc30b0119d41ece16a4ef8a, 0, 0, 0, 0, $vb7a7dc15c3ff7a97b50f42c6ad9cf034, $vc89a98164477a92660a9d30b8a899f2a, $this->getWidth(), $this->getHeight());$this->saveFile($va464d254c26af6536657e681a5ee4ea5);}}interface iUmiDirectory {public function getPath();public function getName();public function getIsBroken();public function getFSObjects($v726e8e4809d4c1b28a6549d86436a124 = 0, $vf2ce11ebf110993621bedd8e747d7b1b = "", $v327b3f8ccde0226c924bcb6f34a30232 = false);public function getFiles($vf2ce11ebf110993621bedd8e747d7b1b = "", $v327b3f8ccde0226c924bcb6f34a30232 = false);public function getDirectories($vf2ce11ebf110993621bedd8e747d7b1b = "", $v327b3f8ccde0226c924bcb6f34a30232 = false);public function getAllFiles($vd1c23eb6cdb82a62e26a8b358943d104=0, $v680c0a11687c0b2cf6554086431e2d31="", $v17fa2d7e21098f98c5ecf28224bd9e90=false);public function delete($vf8532b6380228945d474f37fb6cdac27 = true);public static function requireFolder($v851148b4fd8fd7ae74bd9100c5c0c898, $v2d5ec04ac614a2ce7db2e49fce18670c = "");};class umiDirectory implements iUmiDirectory, IteratorAggregate {protected $s_dir_path = "";protected $is_broken = false;protected $arr_files = array();protected $arr_dirs = array();protected $arr_objs = array();protected $is_readed = false;public function __construct($v40a9b083c3f1470a5d6db5014dcf3da9) {while (substr($v40a9b083c3f1470a5d6db5014dcf3da9, -1)=="/") $v40a9b083c3f1470a5d6db5014dcf3da9=substr($v40a9b083c3f1470a5d6db5014dcf3da9, 0, (strlen($v40a9b083c3f1470a5d6db5014dcf3da9)-1));if(is_dir($v40a9b083c3f1470a5d6db5014dcf3da9)) {$this->s_dir_path = $v40a9b083c3f1470a5d6db5014dcf3da9;}else {$this->is_broken = true;return false;}}public function getPath() {return $this->s_dir_path;}public function getName() {$vecc36294ab8c5c533b35f3e32182f913 = explode("/", $this->s_dir_path);return array_pop($vecc36294ab8c5c533b35f3e32182f913);}public function getIterator() {$this->read();return new umiDirectoryIterator($this->arr_objs);}private function read() {if($this->is_readed) {return false;}else {$this->is_readed = true;}$this->arr_files = array();$this->arr_dirs = array();if($v0fea6a13c52b4d4725368f24b045ca84 = self::cache($this->s_dir_path)) {list($this->arr_files, $this->arr_dirs, $this->arr_objs) = $v0fea6a13c52b4d4725368f24b045ca84;return;}if (is_dir($this->s_dir_path) && is_readable($this->s_dir_path)) {if ($vf6822f7a2c7f67642432cae7c6e16f11 = opendir($this->s_dir_path)) {$v2f45bcacffcc7baec90959eca25ca543 = "";while (($ve7f75a362d2d248bbabd5abbdbb8ab25 = readdir($vf6822f7a2c7f67642432cae7c6e16f11)) !== false) {if(defined("CURRENT_VERSION_LINE")) {if(CURRENT_VERSION_LINE == "demo") {if($ve7f75a362d2d248bbabd5abbdbb8ab25 == "demo") continue;}}$vf6fe2202aaa5491a9c7a9fef46f44483 = $this->s_dir_path."/".$ve7f75a362d2d248bbabd5abbdbb8ab25;if (is_file($vf6fe2202aaa5491a9c7a9fef46f44483)) {$this->arr_files[$ve7f75a362d2d248bbabd5abbdbb8ab25] = $vf6fe2202aaa5491a9c7a9fef46f44483;$this->arr_objs[] = $vf6fe2202aaa5491a9c7a9fef46f44483;}elseif (is_dir($vf6fe2202aaa5491a9c7a9fef46f44483) && $ve7f75a362d2d248bbabd5abbdbb8ab25 != ".." && $ve7f75a362d2d248bbabd5abbdbb8ab25 != ".") {$this->arr_dirs[$ve7f75a362d2d248bbabd5abbdbb8ab25] = $vf6fe2202aaa5491a9c7a9fef46f44483;$this->arr_objs[] = $vf6fe2202aaa5491a9c7a9fef46f44483;}}if(isset($vdcce6f99e5ae80245b8c2ed99b43823b)) {closedir($vdcce6f99e5ae80245b8c2ed99b43823b);}}}self::cache($this->s_dir_path, Array($this->arr_files, $this->arr_dirs, $this->arr_objs));}public function getIsBroken() {return (bool) $this->is_broken;}public function getFSObjects($vd1c23eb6cdb82a62e26a8b358943d104=0, $v680c0a11687c0b2cf6554086431e2d31="", $v17fa2d7e21098f98c5ecf28224bd9e90=false) {$this->read();$v7dc5291b1ee158186937dced87c5cdbd =array();$v563a5461acd4cf632a113d5b105e817e = array();switch ($vd1c23eb6cdb82a62e26a8b358943d104) {case 1:         $v563a5461acd4cf632a113d5b105e817e = $this->arr_files;break;case 2:         $v563a5461acd4cf632a113d5b105e817e = $this->arr_dirs;break;default:     $v563a5461acd4cf632a113d5b105e817e = array_merge($this->arr_dirs, $this->arr_files);}foreach ($v563a5461acd4cf632a113d5b105e817e as $v378a57caf83c2685b4ec1da99037a754 => $vf6fe2202aaa5491a9c7a9fef46f44483) {if ((!$v17fa2d7e21098f98c5ecf28224bd9e90 || is_readable($vf6fe2202aaa5491a9c7a9fef46f44483)) && (!strlen($v680c0a11687c0b2cf6554086431e2d31)) || preg_match("/".$v680c0a11687c0b2cf6554086431e2d31."/i", $v378a57caf83c2685b4ec1da99037a754)) {$v7dc5291b1ee158186937dced87c5cdbd[$v378a57caf83c2685b4ec1da99037a754] = $vf6fe2202aaa5491a9c7a9fef46f44483;}}ksort ($v7dc5291b1ee158186937dced87c5cdbd);return $v7dc5291b1ee158186937dced87c5cdbd;}public function getFiles($v680c0a11687c0b2cf6554086431e2d31="", $v17fa2d7e21098f98c5ecf28224bd9e90=false) {return $this->getFSObjects(1, $v680c0a11687c0b2cf6554086431e2d31, $v17fa2d7e21098f98c5ecf28224bd9e90);}public function getDirectories($v680c0a11687c0b2cf6554086431e2d31="", $v17fa2d7e21098f98c5ecf28224bd9e90=false) {return $this->getFSObjects(2, $v680c0a11687c0b2cf6554086431e2d31, $v17fa2d7e21098f98c5ecf28224bd9e90);}public function getAllFiles($vd1c23eb6cdb82a62e26a8b358943d104=0, $v680c0a11687c0b2cf6554086431e2d31="", $v17fa2d7e21098f98c5ecf28224bd9e90=false) {$v45b963397aa40d4a0063e0d85e4fe7a1 = $this->getFSObjects($vd1c23eb6cdb82a62e26a8b358943d104, $v680c0a11687c0b2cf6554086431e2d31, $v17fa2d7e21098f98c5ecf28224bd9e90);$result = array_flip($v45b963397aa40d4a0063e0d85e4fe7a1);$v33030abc929f083da5f6c3f755b46034 = $this->getFSObjects(2, $v680c0a11687c0b2cf6554086431e2d31, $v17fa2d7e21098f98c5ecf28224bd9e90);foreach ($v33030abc929f083da5f6c3f755b46034 as $v736007832d2167baaae763fd3a3f3cf1) {$v736007832d2167baaae763fd3a3f3cf1 = new umiDirectory($v736007832d2167baaae763fd3a3f3cf1);$v61bc14cb8b5ad53713391fa68d17e48c = $v736007832d2167baaae763fd3a3f3cf1->getAllFiles($vd1c23eb6cdb82a62e26a8b358943d104, $v680c0a11687c0b2cf6554086431e2d31="", $v17fa2d7e21098f98c5ecf28224bd9e90);$result = array_merge($result, $v61bc14cb8b5ad53713391fa68d17e48c);}return $result;}public function delete($vf8532b6380228945d474f37fb6cdac27 = false) {if(is_writable($this->s_dir_path)) {if($vf8532b6380228945d474f37fb6cdac27) {foreach($this as $v447b7147e84be512208dcc0995d67ebc) {if($v447b7147e84be512208dcc0995d67ebc instanceof umiDirectory) {$v447b7147e84be512208dcc0995d67ebc->delete(true);}else if ($v447b7147e84be512208dcc0995d67ebc instanceof umiFile) {$v447b7147e84be512208dcc0995d67ebc->delete();}}}return @rmdir($this->s_dir_path);}else {return false;}}public static function requireFolder($v851148b4fd8fd7ae74bd9100c5c0c898, $v2d5ec04ac614a2ce7db2e49fce18670c = "") {if(!$v851148b4fd8fd7ae74bd9100c5c0c898) return false;if(is_dir($v851148b4fd8fd7ae74bd9100c5c0c898) == false) {mkdir($v851148b4fd8fd7ae74bd9100c5c0c898, 0777, true);}$vf1717c0d3bb9106455d837859192864e = realpath($v851148b4fd8fd7ae74bd9100c5c0c898);$v2d5ec04ac614a2ce7db2e49fce18670c = realpath($v2d5ec04ac614a2ce7db2e49fce18670c);return (substr($vf1717c0d3bb9106455d837859192864e, 0, strlen($v2d5ec04ac614a2ce7db2e49fce18670c)) == $v2d5ec04ac614a2ce7db2e49fce18670c);}public function __toString() {return "umiDirectory::{$this->s_dir_path}";}protected static function cache($v3c6e0b8a9c15224a8228b9a98ca1531d, $v2063c1608d6e0baf80249c42e2be5804 = NULL) {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();if($v2063c1608d6e0baf80249c42e2be5804) {return $v0fea6a13c52b4d4725368f24b045ca84[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v2063c1608d6e0baf80249c42e2be5804;}if(isset($v0fea6a13c52b4d4725368f24b045ca84[$v3c6e0b8a9c15224a8228b9a98ca1531d])) {return $v0fea6a13c52b4d4725368f24b045ca84[$v3c6e0b8a9c15224a8228b9a98ca1531d];}else {return NULL;}}}class umiDirectoryIterator implements Iterator {private $arr_objs = array();public function __construct($v563a5461acd4cf632a113d5b105e817e) {if (is_array($v563a5461acd4cf632a113d5b105e817e)) {$this->arr_objs = $v563a5461acd4cf632a113d5b105e817e;}}public function rewind() {reset($this->arr_objs);}public function current() {$vdcb9afbd8280826e367d80729a873796 = null;$vf6fe2202aaa5491a9c7a9fef46f44483 = current($this->arr_objs);if (is_file($vf6fe2202aaa5491a9c7a9fef46f44483)) {if (umiImageFile::getIsImage($vf6fe2202aaa5491a9c7a9fef46f44483)) {$vdcb9afbd8280826e367d80729a873796 = new umiImageFile($vf6fe2202aaa5491a9c7a9fef46f44483);}else {$vdcb9afbd8280826e367d80729a873796 = new umiFile($vf6fe2202aaa5491a9c7a9fef46f44483);}}elseif (is_dir($vf6fe2202aaa5491a9c7a9fef46f44483)) {$vdcb9afbd8280826e367d80729a873796 = new umiDirectory($vf6fe2202aaa5491a9c7a9fef46f44483);}return $vdcb9afbd8280826e367d80729a873796;}public function key() {return current($this->arr_objs);}public function next() {$vdcb9afbd8280826e367d80729a873796 = null;$vf6fe2202aaa5491a9c7a9fef46f44483 = next($this->arr_objs);if (is_file($vf6fe2202aaa5491a9c7a9fef46f44483)) {if (umiImageFile::getIsImage($vf6fe2202aaa5491a9c7a9fef46f44483)) {$vdcb9afbd8280826e367d80729a873796 = new umiImageFile($vf6fe2202aaa5491a9c7a9fef46f44483);}else {$vdcb9afbd8280826e367d80729a873796 = new umiFile($vf6fe2202aaa5491a9c7a9fef46f44483);}}elseif (is_dir($vf6fe2202aaa5491a9c7a9fef46f44483)) {$vdcb9afbd8280826e367d80729a873796 = new umiDirectory($vf6fe2202aaa5491a9c7a9fef46f44483);}return $vdcb9afbd8280826e367d80729a873796;}public function valid() {return !is_null($this->current());}}class lang extends umiEntinty implements iUmiEntinty, iLang {private $prefix, $is_default, $title;protected $store_type = "lang";protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, prefix, is_default, title FROM cms3_langs WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($vb80bb7740288fda1f201890375a60c8f, $v851f5ac9941d720844d143ed9cfcf60a, $vf62baf4c4ead98d50d516eca0ac5a746, $vd5d3db1765287eef77d7927cc956f50a) = $vf1965a857bc285d26fe22023aa5ab50d) {$this->prefix = $v851f5ac9941d720844d143ed9cfcf60a;$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->is_default = (bool) $vf62baf4c4ead98d50d516eca0ac5a746;return true;}else {return false;}}public function getTitle() {return $this->title;}public function getPrefix() {return $this->prefix;}public function getIsDefault() {return $this->is_default;}public function setTitle($vd5d3db1765287eef77d7927cc956f50a) {$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->setIsUpdated();}public function setPrefix($v851f5ac9941d720844d143ed9cfcf60a) {$this->prefix = $v851f5ac9941d720844d143ed9cfcf60a;$this->setIsUpdated();}public function setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746) {$this->is_default = (bool) $vf62baf4c4ead98d50d516eca0ac5a746;$this->setIsUpdated();}protected function save() {$vd5d3db1765287eef77d7927cc956f50a = self::filterInputString($this->title);$v851f5ac9941d720844d143ed9cfcf60a = self::filterInputString($this->prefix);$v851f5ac9941d720844d143ed9cfcf60a = $this->filterPrefix($v851f5ac9941d720844d143ed9cfcf60a);$vf62baf4c4ead98d50d516eca0ac5a746 = (int) $this->is_default;$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_langs SET prefix = '{$v851f5ac9941d720844d143ed9cfcf60a}', is_default = '{$vf62baf4c4ead98d50d516eca0ac5a746}', title = '{$vd5d3db1765287eef77d7927cc956f50a}' WHERE id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}protected function filterPrefix($v851f5ac9941d720844d143ed9cfcf60a) {return preg_replace("/[^A-z0-9_\-]+/", "", $v851f5ac9941d720844d143ed9cfcf60a);}}class langsCollection extends singleton implements iSingleton, iLangsCollection {private $langs = Array(),   $def_lang;protected function __construct() {$this->loadLangs();}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}private function loadLangs() {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$v116f28135fae5e979e381e4d66222936 = $vb99eb979e6f6efabc396f777b503f7e7->loadData('langs_list');if(!is_array($v116f28135fae5e979e381e4d66222936)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, prefix, is_default, title FROM cms3_langs ORDER BY id";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v116f28135fae5e979e381e4d66222936 = array();while(list($v78e6dd7a49f5b0cb2106a3a434dd5c86) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {$v116f28135fae5e979e381e4d66222936[$v78e6dd7a49f5b0cb2106a3a434dd5c86] = $vf1965a857bc285d26fe22023aa5ab50d;}$vb99eb979e6f6efabc396f777b503f7e7->saveData('langs_list', $v116f28135fae5e979e381e4d66222936, 3600);}else $vf1965a857bc285d26fe22023aa5ab50d = false;foreach($v116f28135fae5e979e381e4d66222936 as $v78e6dd7a49f5b0cb2106a3a434dd5c86 => $vf1965a857bc285d26fe22023aa5ab50d) {$v7572559ca86e781ba8fe8073a0b725c6 = $vb99eb979e6f6efabc396f777b503f7e7->load($v78e6dd7a49f5b0cb2106a3a434dd5c86, 'lang');if($v7572559ca86e781ba8fe8073a0b725c6 instanceof lang == false) {try {$v7572559ca86e781ba8fe8073a0b725c6 = new lang($v78e6dd7a49f5b0cb2106a3a434dd5c86, $vf1965a857bc285d26fe22023aa5ab50d);}catch (privateException $ve1671797c52e15f763380b45e841ec32) {continue;}$vb99eb979e6f6efabc396f777b503f7e7->save($v7572559ca86e781ba8fe8073a0b725c6, 'lang');}$this->langs[$v78e6dd7a49f5b0cb2106a3a434dd5c86] = $v7572559ca86e781ba8fe8073a0b725c6;if($this->langs[$v78e6dd7a49f5b0cb2106a3a434dd5c86]->getIsDefault()) {$this->def_lang = $this->langs[$v78e6dd7a49f5b0cb2106a3a434dd5c86];}}}public function getLangId($v851f5ac9941d720844d143ed9cfcf60a) {foreach($this->langs as $v7572559ca86e781ba8fe8073a0b725c6) {if($v7572559ca86e781ba8fe8073a0b725c6->getPrefix() == $v851f5ac9941d720844d143ed9cfcf60a) {return $v7572559ca86e781ba8fe8073a0b725c6->getId();}}return false;}public function addLang($v851f5ac9941d720844d143ed9cfcf60a, $vd5d3db1765287eef77d7927cc956f50a, $vf62baf4c4ead98d50d516eca0ac5a746 = false) {$this->disableCache();cacheFrontend::getInstance()->flush();if($v78e6dd7a49f5b0cb2106a3a434dd5c86 = $this->getLangId($v851f5ac9941d720844d143ed9cfcf60a)) {return $v78e6dd7a49f5b0cb2106a3a434dd5c86;}$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_langs VALUES()";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v78e6dd7a49f5b0cb2106a3a434dd5c86 = l_mysql_insert_id();$v7572559ca86e781ba8fe8073a0b725c6 = new lang($v78e6dd7a49f5b0cb2106a3a434dd5c86);$v7572559ca86e781ba8fe8073a0b725c6->setPrefix($v851f5ac9941d720844d143ed9cfcf60a);$v7572559ca86e781ba8fe8073a0b725c6->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v7572559ca86e781ba8fe8073a0b725c6->setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746);$v7572559ca86e781ba8fe8073a0b725c6->commit();$this->langs[$v78e6dd7a49f5b0cb2106a3a434dd5c86] = &$v7572559ca86e781ba8fe8073a0b725c6;return $v78e6dd7a49f5b0cb2106a3a434dd5c86;}public function delLang($v78e6dd7a49f5b0cb2106a3a434dd5c86) {$this->disableCache();cacheFrontend::getInstance()->flush();$v78e6dd7a49f5b0cb2106a3a434dd5c86 = (int) $v78e6dd7a49f5b0cb2106a3a434dd5c86;if(!$this->isExists($v78e6dd7a49f5b0cb2106a3a434dd5c86)) return false;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_langs WHERE id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);unset($this->langs[$v78e6dd7a49f5b0cb2106a3a434dd5c86]);}public function getLang($v78e6dd7a49f5b0cb2106a3a434dd5c86) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = (int) $v78e6dd7a49f5b0cb2106a3a434dd5c86;return ($this->isExists($v78e6dd7a49f5b0cb2106a3a434dd5c86)) ? $this->langs[$v78e6dd7a49f5b0cb2106a3a434dd5c86] : false;}public function isExists($v78e6dd7a49f5b0cb2106a3a434dd5c86) {return (bool) @array_key_exists($v78e6dd7a49f5b0cb2106a3a434dd5c86, $this->langs);}public function getList() {return $this->langs;}public function setDefault($v78e6dd7a49f5b0cb2106a3a434dd5c86) {if(!$this->isExists($v78e6dd7a49f5b0cb2106a3a434dd5c86)) return false;if($this->def_lang) {$this->def_lang->setIsDefault(false);$this->def_lang->commit();}$this->def_lang = $this->getLang($v78e6dd7a49f5b0cb2106a3a434dd5c86);$this->def_lang->setIsDefault(true);$this->def_lang->commit();}public function getDefaultLang() {return ($this->def_lang) ? $this->def_lang : false;}public function getAssocArray() {$v9b207167e5381c47682c6b4f58a623fb = array();foreach($this->langs as $v7572559ca86e781ba8fe8073a0b725c6) {$v9b207167e5381c47682c6b4f58a623fb[$v7572559ca86e781ba8fe8073a0b725c6->getId()] = $v7572559ca86e781ba8fe8073a0b725c6->getTitle();}return $v9b207167e5381c47682c6b4f58a623fb;}public function clearCache() {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->langs);foreach($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) unset($this->langs[$v3c6e0b8a9c15224a8228b9a98ca1531d]);$this->langs = array();$this->loadLangs();}}class domainMirrow extends umiEntinty implements iUmiEntinty, iDomainMirrow {private $host;public function setHost($v67b3dba8bc6778101892eb77249db32e) {$this->host = domain::filterHostName($v67b3dba8bc6778101892eb77249db32e);$this->setIsUpdated();}public function getHost() {return $this->host;}protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, host FROM cms3_domain_mirrows WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($vb80bb7740288fda1f201890375a60c8f, $v67b3dba8bc6778101892eb77249db32e) = $vf1965a857bc285d26fe22023aa5ab50d) {$this->host = $v67b3dba8bc6778101892eb77249db32e;return true;}else return false;}protected function save() {$v67b3dba8bc6778101892eb77249db32e = self::filterInputString($this->host);$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_domain_mirrows SET host = '{$v67b3dba8bc6778101892eb77249db32e}' WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}};class domain extends umiEntinty implements iUmiEntinty, iDomainMirrow, iDomain {private $host, $default_lang_id, $mirrows = Array();protected $store_type = "domain";protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, host, is_default, default_lang_id FROM cms3_domains WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($vb80bb7740288fda1f201890375a60c8f, $v67b3dba8bc6778101892eb77249db32e, $vf62baf4c4ead98d50d516eca0ac5a746, $v97558aef72e0ceae6733793ba319a8d1) = $vf1965a857bc285d26fe22023aa5ab50d) {$this->host = $v67b3dba8bc6778101892eb77249db32e;$this->is_default = (bool) $vf62baf4c4ead98d50d516eca0ac5a746;$this->default_lang_id = (int) $v97558aef72e0ceae6733793ba319a8d1;return $this->loadMirrows();}else {return false;}}public function getHost() {return $this->host;}public function getIsDefault() {return $this->is_default;}public function setHost($v67b3dba8bc6778101892eb77249db32e) {$this->host = $this->filterHostName($v67b3dba8bc6778101892eb77249db32e);$this->setIsUpdated();}public function setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746) {$this->is_default = (bool) $vf62baf4c4ead98d50d516eca0ac5a746;$this->setIsUpdated();}public function getDefaultLangId() {return $this->default_lang_id;}public function setDefaultLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86) {if(langsCollection::getInstance()->isExists($v78e6dd7a49f5b0cb2106a3a434dd5c86)) {$this->default_lang_id = $v78e6dd7a49f5b0cb2106a3a434dd5c86;$this->setIsUpdated();return true;}else throw new coreException("Language #{$v78e6dd7a49f5b0cb2106a3a434dd5c86} doesn't exists");}public function addMirrow($vc9b148be34c2f7632fa35c418e265083) {if($v8ec042d79ac0de3ba2c91d757c4bbf06 = $this->getMirrowId($vc9b148be34c2f7632fa35c418e265083)) {return $v8ec042d79ac0de3ba2c91d757c4bbf06;}else {$this->setIsUpdated();$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_domain_mirrows (rel) VALUES('{$this->id}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v8ec042d79ac0de3ba2c91d757c4bbf06 = l_mysql_insert_id();$vda570110a5cf8f2ea8b037f530ec4f5a = new domainMirrow($v8ec042d79ac0de3ba2c91d757c4bbf06);$vda570110a5cf8f2ea8b037f530ec4f5a->setHost($vc9b148be34c2f7632fa35c418e265083);$vda570110a5cf8f2ea8b037f530ec4f5a->commit();$this->mirrows[$v8ec042d79ac0de3ba2c91d757c4bbf06] = $vda570110a5cf8f2ea8b037f530ec4f5a;return $v8ec042d79ac0de3ba2c91d757c4bbf06;}}public function delMirrow($v8ec042d79ac0de3ba2c91d757c4bbf06) {$v8ec042d79ac0de3ba2c91d757c4bbf06 = (int) $v8ec042d79ac0de3ba2c91d757c4bbf06;if($this->isMirrowExists($v8ec042d79ac0de3ba2c91d757c4bbf06)) {$this->setIsUpdated();$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_domain_mirrows WHERE id = '{$v8ec042d79ac0de3ba2c91d757c4bbf06}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);unset($this->mirrows[$v8ec042d79ac0de3ba2c91d757c4bbf06]);return true;}else return false;}public function delAllMirrows() {$this->setIsUpdated();$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_domain_mirrows WHERE rel = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getMirrowId($vc9b148be34c2f7632fa35c418e265083) {foreach($this->mirrows as $vda570110a5cf8f2ea8b037f530ec4f5a) {if($vda570110a5cf8f2ea8b037f530ec4f5a->getHost() == $vc9b148be34c2f7632fa35c418e265083) {return $vda570110a5cf8f2ea8b037f530ec4f5a->getId();}}return false;}public function getMirrow($v8ec042d79ac0de3ba2c91d757c4bbf06) {if($this->isMirrowExists($v8ec042d79ac0de3ba2c91d757c4bbf06)) {return $this->mirrows[$v8ec042d79ac0de3ba2c91d757c4bbf06];}else {return false;}}public function isMirrowExists($v8ec042d79ac0de3ba2c91d757c4bbf06) {return (bool) array_key_exists($v8ec042d79ac0de3ba2c91d757c4bbf06, $this->mirrows);}public function getMirrowsList() {return $this->mirrows;}private function loadMirrows() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, host FROM cms3_domain_mirrows WHERE rel = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v8ec042d79ac0de3ba2c91d757c4bbf06) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {try {$this->mirrows[$v8ec042d79ac0de3ba2c91d757c4bbf06] = new domainMirrow($v8ec042d79ac0de3ba2c91d757c4bbf06, $vf1965a857bc285d26fe22023aa5ab50d);}catch(privateException $ve1671797c52e15f763380b45e841ec32) {continue;}}return true;}protected function save() {$v67b3dba8bc6778101892eb77249db32e = self::filterInputString($this->host);$vf62baf4c4ead98d50d516eca0ac5a746 = (int) $this->is_default;$v97558aef72e0ceae6733793ba319a8d1 = (int) $this->default_lang_id;$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_domains SET host = '{$v67b3dba8bc6778101892eb77249db32e}', is_default = '{$vf62baf4c4ead98d50d516eca0ac5a746}', default_lang_id = '{$v97558aef72e0ceae6733793ba319a8d1}' WHERE id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public static function filterHostName($v67b3dba8bc6778101892eb77249db32e) {return preg_replace("/([^A-z0-9\-А-яёЁ\.:]+)|[\^_\\\\]/u", "", $v67b3dba8bc6778101892eb77249db32e);}public function getCurrentHostName() {$ve8d139c9c846fd27146dca0a73aa9391 = getServer('HTTP_HOST');if (strpos($ve8d139c9c846fd27146dca0a73aa9391, 'xn--') === 0) {$vab9712d74b7799bb2e149a8b3ae21d75 = new idna_convert();$ve8d139c9c846fd27146dca0a73aa9391 = $vab9712d74b7799bb2e149a8b3ae21d75->decode($ve8d139c9c846fd27146dca0a73aa9391);}if ($this->host != $ve8d139c9c846fd27146dca0a73aa9391) {foreach($this->mirrows as $vda570110a5cf8f2ea8b037f530ec4f5a) {if($vda570110a5cf8f2ea8b037f530ec4f5a->getHost() == $ve8d139c9c846fd27146dca0a73aa9391) {return $vda570110a5cf8f2ea8b037f530ec4f5a->getHost();}}}return $this->host;}};class domainsCollection extends singleton implements iSingleton, iDomainsCollection {private $domains = Array(), $def_domain;protected function __construct() {$this->loadDomains();}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function addDomain($v67b3dba8bc6778101892eb77249db32e, $v78e6dd7a49f5b0cb2106a3a434dd5c86, $vf62baf4c4ead98d50d516eca0ac5a746 = false) {if($v662cbf1253ac7d8750ed9190c52163e5 = $this->getDomainId($v67b3dba8bc6778101892eb77249db32e)) {return $v662cbf1253ac7d8750ed9190c52163e5;}else {cacheFrontend::getInstance()->flush();$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_domains VALUES()";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v662cbf1253ac7d8750ed9190c52163e5 = l_mysql_insert_id();$this->domains[$v662cbf1253ac7d8750ed9190c52163e5] = $vad5f82e879a9c5d6b5b442eb37e50551 = new domain($v662cbf1253ac7d8750ed9190c52163e5);$vad5f82e879a9c5d6b5b442eb37e50551->setHost($v67b3dba8bc6778101892eb77249db32e);$vad5f82e879a9c5d6b5b442eb37e50551->setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746);$vad5f82e879a9c5d6b5b442eb37e50551->setDefaultLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86);if($vf62baf4c4ead98d50d516eca0ac5a746) $this->setDefaultDomain($v662cbf1253ac7d8750ed9190c52163e5);$vad5f82e879a9c5d6b5b442eb37e50551->commit();return $v662cbf1253ac7d8750ed9190c52163e5;}}public function setDefaultDomain($v662cbf1253ac7d8750ed9190c52163e5) {if($this->isExists($v662cbf1253ac7d8750ed9190c52163e5)) {cacheFrontend::getInstance()->flush();$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_domains SET is_default = '0' WHERE is_default = '1'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v2dc2d350ce3298213f154e90eb3211c3 = $this->getDefaultDomain()) {$v2dc2d350ce3298213f154e90eb3211c3->setIsDefault(false);$v2dc2d350ce3298213f154e90eb3211c3->commit();}$this->def_domain = $this->getDomain($v662cbf1253ac7d8750ed9190c52163e5);$this->def_domain->setIsDefault(true);$this->def_domain->commit();}else return false;}public function delDomain($v662cbf1253ac7d8750ed9190c52163e5) {$v662cbf1253ac7d8750ed9190c52163e5 = (int) $v662cbf1253ac7d8750ed9190c52163e5;if($this->isExists($v662cbf1253ac7d8750ed9190c52163e5)) {$vad5f82e879a9c5d6b5b442eb37e50551 = $this->getDomain($v662cbf1253ac7d8750ed9190c52163e5);$vad5f82e879a9c5d6b5b442eb37e50551->delAllMirrows();cacheFrontend::getInstance()->flush();if($vad5f82e879a9c5d6b5b442eb37e50551->getIsDefault()) {$this->def_domain = false;}unset($vad5f82e879a9c5d6b5b442eb37e50551);unset($this->domains[$v662cbf1253ac7d8750ed9190c52163e5]);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_hierarchy WHERE domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_domains WHERE id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}else throw new coreException("Domain #{$v662cbf1253ac7d8750ed9190c52163e5} doesn't exists.");}public function getDomain($v662cbf1253ac7d8750ed9190c52163e5) {return $this->isExists($v662cbf1253ac7d8750ed9190c52163e5) ? $this->domains[$v662cbf1253ac7d8750ed9190c52163e5] : false;}public function getDefaultDomain() {return ($this->def_domain) ? $this->def_domain : false;}public function getList() {return $this->domains;}public function isExists($v662cbf1253ac7d8750ed9190c52163e5) {return (bool) @array_key_exists($v662cbf1253ac7d8750ed9190c52163e5, $this->domains);}public function getDomainId($v67b3dba8bc6778101892eb77249db32e, $vee68968f28c875319a24db7a4687bcc6 = true) {foreach($this->domains as $vad5f82e879a9c5d6b5b442eb37e50551) {if($vad5f82e879a9c5d6b5b442eb37e50551->getHost() == $v67b3dba8bc6778101892eb77249db32e) {return $vad5f82e879a9c5d6b5b442eb37e50551->getId();}else {if($vee68968f28c875319a24db7a4687bcc6) {$v1971009c5db21ab4fa6ae028d9fd2c9f = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrowsList();foreach($v1971009c5db21ab4fa6ae028d9fd2c9f as $v15515d42c0242547a1c1972abb21cfad) {if($v15515d42c0242547a1c1972abb21cfad->getHost() == $v67b3dba8bc6778101892eb77249db32e) {return $vad5f82e879a9c5d6b5b442eb37e50551->getId();}}}}}return false;}private function loadDomains() {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$v926a85278ca49b9c4de5ca08a420fa6d = $vb99eb979e6f6efabc396f777b503f7e7->loadData('domains_list');if(!is_array($v926a85278ca49b9c4de5ca08a420fa6d)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, host, is_default, default_lang_id FROM cms3_domains";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v926a85278ca49b9c4de5ca08a420fa6d = array();while(list($v662cbf1253ac7d8750ed9190c52163e5) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {$v926a85278ca49b9c4de5ca08a420fa6d[$v662cbf1253ac7d8750ed9190c52163e5] = $vf1965a857bc285d26fe22023aa5ab50d;}$vb99eb979e6f6efabc396f777b503f7e7->saveData('domains_list', $v926a85278ca49b9c4de5ca08a420fa6d, 3600);}else $vf1965a857bc285d26fe22023aa5ab50d = false;foreach($v926a85278ca49b9c4de5ca08a420fa6d as $v662cbf1253ac7d8750ed9190c52163e5 => $vf1965a857bc285d26fe22023aa5ab50d) {$vad5f82e879a9c5d6b5b442eb37e50551 = $vb99eb979e6f6efabc396f777b503f7e7->load($v662cbf1253ac7d8750ed9190c52163e5, 'domain');if($vad5f82e879a9c5d6b5b442eb37e50551 instanceof domain == false) {try {$vad5f82e879a9c5d6b5b442eb37e50551 = new domain($v662cbf1253ac7d8750ed9190c52163e5, $vf1965a857bc285d26fe22023aa5ab50d);}catch(privateException $ve1671797c52e15f763380b45e841ec32) {continue;}$vb99eb979e6f6efabc396f777b503f7e7->save($vad5f82e879a9c5d6b5b442eb37e50551, 'domain');}$this->domains[$v662cbf1253ac7d8750ed9190c52163e5] = $vad5f82e879a9c5d6b5b442eb37e50551;if($vad5f82e879a9c5d6b5b442eb37e50551->getIsDefault()) {$this->def_domain = $vad5f82e879a9c5d6b5b442eb37e50551;}}return true;}public function clearCache() {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->domains);foreach($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) unset($this->domains[$v3c6e0b8a9c15224a8228b9a98ca1531d]);$this->domains = array();$this->loadDomains();}}class template extends umiEntinty implements iUmiEntinty, iTemplate {private $name, $filename, $type, $title, $domain_id, $lang_id, $is_default;protected $store_type = "template";private $resourcesDirectory, $templatesDirectory, $filePath, $fileDir;public function getName() {return $this->name;}public function getFilename() {return $this->filename;}public function getResourcesDirectory($v64feae0988f5b61c96c305e3c3f04551 = false) {if ($v64feae0988f5b61c96c305e3c3f04551) {return $this->resourcesDirectory ? '/templates/' . $this->name . "/" : "/";}else {return $this->resourcesDirectory;}}public function getTemplatesDirectory() {return $this->templatesDirectory;}public function getFilePath() {return $this->filePath;}public function getType() {return $this->type;}public function getTitle() {return $this->title;}public function getDomainId() {return $this->domain_id;}public function getLangId() {return $this->lang_id;}public function getIsDefault() {return $this->is_default;}public function setName($vb068931cc450442b63f5b3d276ea4297) {$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->setIsUpdated();}public function setFilename($v435ed7e9f07f740abf511a62c00eef6e) {$this->filename = $v435ed7e9f07f740abf511a62c00eef6e;$this->setIsUpdated();}public function setTitle($vd5d3db1765287eef77d7927cc956f50a) {$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->setIsUpdated();}public function setType($v599dcce2998a6b40b1e38e8c6006cb0a) {$this->type = $v599dcce2998a6b40b1e38e8c6006cb0a;$this->setIsUpdated();}public function setDomainId($v662cbf1253ac7d8750ed9190c52163e5) {$ve4e46deb7f9cc58c7abfb32e5570b6f3 = domainsCollection::getInstance();if($ve4e46deb7f9cc58c7abfb32e5570b6f3->isExists($v662cbf1253ac7d8750ed9190c52163e5)) {$this->domain_id = (int) $v662cbf1253ac7d8750ed9190c52163e5;$this->setIsUpdated();return true;}else {return false;}}public function setLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86) {$v5a05866850c28651fe234659f6c92ada = langsCollection::getInstance();if($v5a05866850c28651fe234659f6c92ada->isExists($v78e6dd7a49f5b0cb2106a3a434dd5c86)) {$this->lang_id = (int) $v78e6dd7a49f5b0cb2106a3a434dd5c86;$this->setIsUpdated();return true;}else {return false;}}public function setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746) {$this->is_default = (bool) $vf62baf4c4ead98d50d516eca0ac5a746;$this->setIsUpdated();}public function getUsedPages() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT h.id, o.name FROM cms3_hierarchy h, cms3_objects o WHERE h.tpl_id = '{$this->id}' AND o.id = h.obj_id AND h.is_deleted = '0' AND h.domain_id = '{$this->domain_id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v9b207167e5381c47682c6b4f58a623fb = array();while(list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[] = Array($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297);}return $v9b207167e5381c47682c6b4f58a623fb;}public function setUsedPages($vb3b32a2d422265cd25c3323ed0157f81) {if(is_null($vb3b32a2d422265cd25c3323ed0157f81)) return false;$v3822e54d799ece2cf6bec7120d8a3a9f = templatesCollection::getInstance()->getDefaultTemplate($this->domain_id, $this->lang_id)->getId();$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_hierarchy SET tpl_id = '{$v3822e54d799ece2cf6bec7120d8a3a9f}' WHERE tpl_id = '{$this->id}' AND is_deleted = '0' AND domain_id = '{$this->domain_id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$vb99eb979e6f6efabc396f777b503f7e7->flush();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();if(!is_array($vb3b32a2d422265cd25c3323ed0157f81)) return false;if(is_array($vb3b32a2d422265cd25c3323ed0157f81)&&!empty($vb3b32a2d422265cd25c3323ed0157f81)) {foreach($vb3b32a2d422265cd25c3323ed0157f81 as $v7057e8409c7c531a1a6e9ac3df4ed549) {$v71860c77c6745379b0d44304d66b6a13 = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);if($v71860c77c6745379b0d44304d66b6a13 instanceof iUmiHierarchyElement) {$v71860c77c6745379b0d44304d66b6a13->setTplId($this->id);$v71860c77c6745379b0d44304d66b6a13->commit();unset($v71860c77c6745379b0d44304d66b6a13);$vb81ca7c0ccaa77e7aa91936ab0070695->unloadElement($v7057e8409c7c531a1a6e9ac3df4ed549);}}}return true;}protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name, filename, type, title, domain_id, lang_id, is_default FROM cms3_templates WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297, $v435ed7e9f07f740abf511a62c00eef6e, $v599dcce2998a6b40b1e38e8c6006cb0a, $vd5d3db1765287eef77d7927cc956f50a, $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86, $vf62baf4c4ead98d50d516eca0ac5a746) = $vf1965a857bc285d26fe22023aa5ab50d) {$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->filename = $v435ed7e9f07f740abf511a62c00eef6e;$this->type = $v599dcce2998a6b40b1e38e8c6006cb0a;$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->domain_id = (int) $v662cbf1253ac7d8750ed9190c52163e5;$this->lang_id = (int) $v78e6dd7a49f5b0cb2106a3a434dd5c86;$this->is_default = (bool) $vf62baf4c4ead98d50d516eca0ac5a746;if (!empty($this->filename)) {$v076ccfd7e9875932f89de6676f4c73d8 = pathinfo($this->filename, PATHINFO_EXTENSION);if (!strlen($this->type)) {if (strtolower($v076ccfd7e9875932f89de6676f4c73d8) == 'xsl') {$this->type = 'xslt';}elseif (strtolower($v076ccfd7e9875932f89de6676f4c73d8) == 'tpl') {$this->type = 'tpls';}else {$this->type = strlen($v076ccfd7e9875932f89de6676f4c73d8) ? $v076ccfd7e9875932f89de6676f4c73d8 : 'xslt';}}if ($this->type == 'xslt') {$this->templatesDirectory = $va44b3818d66f01cde4647f3ad2e3cb06 = $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.xsl');}elseif ($this->type == 'tpls') {$this->templatesDirectory = $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.tpl');$va44b3818d66f01cde4647f3ad2e3cb06 = $this->templatesDirectory . "content/";}else {$this->templatesDirectory = $va44b3818d66f01cde4647f3ad2e3cb06 = $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.' . $this->type) . "/";}if (strlen($this->name)) {$this->resourcesDirectory = CURRENT_WORKING_DIR . '/templates/' . $this->name . '/';$va44b3818d66f01cde4647f3ad2e3cb06 =  $this->templatesDirectory = $this->resourcesDirectory . $this->type . '/';if ($this->type == 'tpls') {$va44b3818d66f01cde4647f3ad2e3cb06 = $this->templatesDirectory . "content/";}}if (system_is_mobile() && is_file($va44b3818d66f01cde4647f3ad2e3cb06 . 'mobile/' . $this->filename)) {$this->filePath = $va44b3818d66f01cde4647f3ad2e3cb06 . 'mobile/' . $this->filename;}else {$this->filePath = $va44b3818d66f01cde4647f3ad2e3cb06 . $this->filename;}}return true;}else return false;}protected function save() {$vb068931cc450442b63f5b3d276ea4297 = self::filterInputString($this->name);$v435ed7e9f07f740abf511a62c00eef6e = self::filterInputString($this->filename);$v599dcce2998a6b40b1e38e8c6006cb0a = self::filterInputString($this->type);$vd5d3db1765287eef77d7927cc956f50a = self::filterInputString($this->title);$v662cbf1253ac7d8750ed9190c52163e5 = (int) $this->domain_id;$v78e6dd7a49f5b0cb2106a3a434dd5c86 =  (int) $this->lang_id;$vf62baf4c4ead98d50d516eca0ac5a746 = (int) $this->is_default;$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_templates SET name = '{$vb068931cc450442b63f5b3d276ea4297}', filename = '{$v435ed7e9f07f740abf511a62c00eef6e}', type = '{$v599dcce2998a6b40b1e38e8c6006cb0a}', title = '{$vd5d3db1765287eef77d7927cc956f50a}', domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}', lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}', is_default = '{$vf62baf4c4ead98d50d516eca0ac5a746}' WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}}class templatesCollection extends singleton implements iSingleton, iTemplatesCollection {private $templates = Array(), $def_template;protected function __construct() {$this->loadTemplates();}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function addTemplate($v435ed7e9f07f740abf511a62c00eef6e, $vd5d3db1765287eef77d7927cc956f50a, $v662cbf1253ac7d8750ed9190c52163e5 = false, $v78e6dd7a49f5b0cb2106a3a434dd5c86 = false, $vf62baf4c4ead98d50d516eca0ac5a746 = false) {$this->disableCache();cacheFrontend::getInstance()->flush();$ve4e46deb7f9cc58c7abfb32e5570b6f3 = domainsCollection::getInstance();$v5a05866850c28651fe234659f6c92ada = langsCollection::getInstance();if(!$ve4e46deb7f9cc58c7abfb32e5570b6f3->isExists($v662cbf1253ac7d8750ed9190c52163e5)) {if($ve4e46deb7f9cc58c7abfb32e5570b6f3->getDefaultDomain()) {$v662cbf1253ac7d8750ed9190c52163e5 = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDefaultDomain()->getId();}else {return false;}}if(!$v5a05866850c28651fe234659f6c92ada->isExists($v78e6dd7a49f5b0cb2106a3a434dd5c86)) {if($v5a05866850c28651fe234659f6c92ada->getDefaultLang()) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v5a05866850c28651fe234659f6c92ada->getDefaultLang()->getId();}else {return false;}}$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_templates VALUES()";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v74f5356453a69e438e0f58ef93103cc0 = l_mysql_insert_id();$v66f6181bcb4cff4cd38fbc804a036db6 = new template($v74f5356453a69e438e0f58ef93103cc0);$v66f6181bcb4cff4cd38fbc804a036db6->setFilename($v435ed7e9f07f740abf511a62c00eef6e);$v66f6181bcb4cff4cd38fbc804a036db6->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v66f6181bcb4cff4cd38fbc804a036db6->setDomainId($v662cbf1253ac7d8750ed9190c52163e5);$v66f6181bcb4cff4cd38fbc804a036db6->setLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86);$v66f6181bcb4cff4cd38fbc804a036db6->setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746);if($vf62baf4c4ead98d50d516eca0ac5a746) {$this->setDefaultTemplate($v74f5356453a69e438e0f58ef93103cc0);}$v66f6181bcb4cff4cd38fbc804a036db6->commit();$v66f6181bcb4cff4cd38fbc804a036db6->update();$this->templates[$v74f5356453a69e438e0f58ef93103cc0] = $v66f6181bcb4cff4cd38fbc804a036db6;return $v74f5356453a69e438e0f58ef93103cc0;}public function setDefaultTemplate($v74f5356453a69e438e0f58ef93103cc0, $v662cbf1253ac7d8750ed9190c52163e5 = false, $v78e6dd7a49f5b0cb2106a3a434dd5c86 = false) {if($v662cbf1253ac7d8750ed9190c52163e5 == false) $v662cbf1253ac7d8750ed9190c52163e5 = domainsCollection::getInstance()->getDefaultDomain()->getId();if($v78e6dd7a49f5b0cb2106a3a434dd5c86 ==false) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();if(!$this->isExists($v74f5356453a69e438e0f58ef93103cc0)) {return false;}$vfed36e93a0509e20f2dc96cbbd85b678 = $this->getTemplatesList($v662cbf1253ac7d8750ed9190c52163e5,$v78e6dd7a49f5b0cb2106a3a434dd5c86);foreach ($vfed36e93a0509e20f2dc96cbbd85b678 as $v66f6181bcb4cff4cd38fbc804a036db6) {if($v74f5356453a69e438e0f58ef93103cc0 == $v66f6181bcb4cff4cd38fbc804a036db6->getId()) {$v66f6181bcb4cff4cd38fbc804a036db6->setIsDefault(true);}else {$v66f6181bcb4cff4cd38fbc804a036db6->setIsDefault(false);}$v66f6181bcb4cff4cd38fbc804a036db6->commit();}return true;if(!($v66f6181bcb4cff4cd38fbc804a036db6 = $this->getTemplate($v3200a31fc05da4e9d5a0465c36822e2f))) {return false;}if($this->def_template) {$this->def_template->setIsDefault(false);$this->def_template->commit();}$this->def_template = $v66f6181bcb4cff4cd38fbc804a036db6;$this->def_template->setIsDefault(true);$this->def_template->commit();return true;}public function delTemplate($v74f5356453a69e438e0f58ef93103cc0) {$v74f5356453a69e438e0f58ef93103cc0 = (int) $v74f5356453a69e438e0f58ef93103cc0;$this->disableCache();cacheFrontend::getInstance()->flush();if($this->isExists($v74f5356453a69e438e0f58ef93103cc0)) {if($this->templates[$v74f5356453a69e438e0f58ef93103cc0]->getIsDefault()) {unset($this->def_template);}unset($this->templates[$v74f5356453a69e438e0f58ef93103cc0]);$vb3f91ed738222a77e3713df926f55fd7 = $this->getDefaultTemplate();if (!$vb3f91ed738222a77e3713df926f55fd7 || $vb3f91ed738222a77e3713df926f55fd7->getId() == $v74f5356453a69e438e0f58ef93103cc0) return false;$v9f59b21a53f60f6a67487a5896c52d7f = "UPDATE cms3_hierarchy SET tpl_id = '".$vb3f91ed738222a77e3713df926f55fd7->getId()."' WHERE tpl_id='{$v74f5356453a69e438e0f58ef93103cc0}'";l_mysql_query($v9f59b21a53f60f6a67487a5896c52d7f);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_templates WHERE id = '{$v74f5356453a69e438e0f58ef93103cc0}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}else return false;}public function getTemplatesList($v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86) {$v9b207167e5381c47682c6b4f58a623fb = array();foreach($this->templates as $v66f6181bcb4cff4cd38fbc804a036db6) {if($v66f6181bcb4cff4cd38fbc804a036db6->getDomainId() == $v662cbf1253ac7d8750ed9190c52163e5 && $v66f6181bcb4cff4cd38fbc804a036db6->getLangId() == $v78e6dd7a49f5b0cb2106a3a434dd5c86) {$v9b207167e5381c47682c6b4f58a623fb[] = $v66f6181bcb4cff4cd38fbc804a036db6;}}return $v9b207167e5381c47682c6b4f58a623fb;}public function getDefaultTemplate($v662cbf1253ac7d8750ed9190c52163e5 = false, $v78e6dd7a49f5b0cb2106a3a434dd5c86 = false) {if($v662cbf1253ac7d8750ed9190c52163e5 == false) $v662cbf1253ac7d8750ed9190c52163e5 = cmsController::getInstance()->getCurrentDomain()->getId();if($v78e6dd7a49f5b0cb2106a3a434dd5c86 == false) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$vfed36e93a0509e20f2dc96cbbd85b678 = $this->getTemplatesList($v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);foreach($vfed36e93a0509e20f2dc96cbbd85b678 as $v66f6181bcb4cff4cd38fbc804a036db6) {if($v66f6181bcb4cff4cd38fbc804a036db6->getIsDefault() == true) {return $v66f6181bcb4cff4cd38fbc804a036db6;}}if(sizeof($vfed36e93a0509e20f2dc96cbbd85b678)) {$v8e62a507ba5e75a37beefceaad9fe22c = $vfed36e93a0509e20f2dc96cbbd85b678[0];$this->setDefaultTemplate($v8e62a507ba5e75a37beefceaad9fe22c->getId(), $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);return $v8e62a507ba5e75a37beefceaad9fe22c;}return false;}public function getCurrentTemplate() {$v594c103f2c6e04c3d8ab059f031e0c1a = cmsController::getInstance();if ($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentElementId(), true)) {$v66f6181bcb4cff4cd38fbc804a036db6 = $this->getTemplate($v8e2dcfd7e7e24b1ca76c1193f645902b->getTplId());}elseif ($vcfb14cbbb0da97c5d6fc00de2231984b = $this->getHierarchyTypeTemplate($v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentModule(), $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentMethod())) {$v66f6181bcb4cff4cd38fbc804a036db6 = $this->getTemplate($vcfb14cbbb0da97c5d6fc00de2231984b);}else $v66f6181bcb4cff4cd38fbc804a036db6 = $this->getDefaultTemplate();return $v66f6181bcb4cff4cd38fbc804a036db6;}public function getHierarchyTypeTemplate($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce) {if (class_exists($v22884db148f0ffb0d830ba431102b0b5) && method_exists($v22884db148f0ffb0d830ba431102b0b5, "setupTemplate")) {$vb80bb7740288fda1f201890375a60c8f = call_user_func(array($v22884db148f0ffb0d830ba431102b0b5, "setupTemplate"), $vea9f6aca279138c58f705c8d4cb4b8ce);}else {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$vb80bb7740288fda1f201890375a60c8f = $v2245023265ae4cf87d02c8b6ba991139->get("templates", "{$v22884db148f0ffb0d830ba431102b0b5}.{$vea9f6aca279138c58f705c8d4cb4b8ce}");}return $this->isExists($vb80bb7740288fda1f201890375a60c8f) ? $vb80bb7740288fda1f201890375a60c8f : false;}public function getTemplate($v74f5356453a69e438e0f58ef93103cc0) {return ($this->isExists($v74f5356453a69e438e0f58ef93103cc0)) ? $this->templates[$v74f5356453a69e438e0f58ef93103cc0] : false;}public function isExists($v74f5356453a69e438e0f58ef93103cc0) {return (bool) @array_key_exists($v74f5356453a69e438e0f58ef93103cc0, $this->templates);}private function loadTemplates() {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$vf6238d8f90007df1c6f2fe05ac4fb868 = $vb99eb979e6f6efabc396f777b503f7e7->loadData('templates_list');if(!is_array($vf6238d8f90007df1c6f2fe05ac4fb868)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name, filename, type, title, domain_id, lang_id, is_default FROM cms3_templates";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vf6238d8f90007df1c6f2fe05ac4fb868 = array();while(list($v74f5356453a69e438e0f58ef93103cc0) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {$vf6238d8f90007df1c6f2fe05ac4fb868[$v74f5356453a69e438e0f58ef93103cc0] = $vf1965a857bc285d26fe22023aa5ab50d;}$vb99eb979e6f6efabc396f777b503f7e7->saveData('templates_list', $vf6238d8f90007df1c6f2fe05ac4fb868, 3600);}else $vf1965a857bc285d26fe22023aa5ab50d = false;foreach($vf6238d8f90007df1c6f2fe05ac4fb868 as $v74f5356453a69e438e0f58ef93103cc0 => $vf1965a857bc285d26fe22023aa5ab50d) {try {$v66f6181bcb4cff4cd38fbc804a036db6 = new template($v74f5356453a69e438e0f58ef93103cc0, $vf1965a857bc285d26fe22023aa5ab50d);}catch (privateException $ve1671797c52e15f763380b45e841ec32) {continue;}$this->templates[$v74f5356453a69e438e0f58ef93103cc0] = $v66f6181bcb4cff4cd38fbc804a036db6;if($v66f6181bcb4cff4cd38fbc804a036db6->getIsDefault()) {$this->def_template = $v66f6181bcb4cff4cd38fbc804a036db6;}}return true;}public function clearCache() {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->templates);foreach($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) unset($this->templates[$v3c6e0b8a9c15224a8228b9a98ca1531d]);$this->templates = array();$this->loadTemplates();}}class umiHierarchyType extends umiEntinty implements iUmiEntinty, iUmiHierarchyType {private $name, $title, $ext;protected $store_type = "element_type";public function getName() {return $this->name;}public function getTitle() {return $this->translateLabel($this->title);}public function getModule() {return $this->getName();}public function getMethod() {return $this->getExt();}public function getExt() {return $this->ext;}public function setName($vb068931cc450442b63f5b3d276ea4297) {$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->setIsUpdated();}public function setTitle($vd5d3db1765287eef77d7927cc956f50a) {$vd5d3db1765287eef77d7927cc956f50a = $this->translateI18n($vd5d3db1765287eef77d7927cc956f50a, "hierarchy-type-");$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->setIsUpdated();}public function setExt($vabf77184f55403d75b9d51d79162a7ca) {$this->ext = $vabf77184f55403d75b9d51d79162a7ca;$this->setIsUpdated();}protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name, title, ext FROM cms3_hierarchy_types WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $vabf77184f55403d75b9d51d79162a7ca) = $vf1965a857bc285d26fe22023aa5ab50d) {$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->ext = $vabf77184f55403d75b9d51d79162a7ca;return true;}else {return false;}}protected function save() {$vb068931cc450442b63f5b3d276ea4297 = self::filterInputString($this->name);$vd5d3db1765287eef77d7927cc956f50a = self::filterInputString($this->title);$vabf77184f55403d75b9d51d79162a7ca = self::filterInputString($this->ext);$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_hierarchy_types SET name = '{$vb068931cc450442b63f5b3d276ea4297}', title = '{$vd5d3db1765287eef77d7927cc956f50a}', ext = '{$vabf77184f55403d75b9d51d79162a7ca}' WHERE id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}}class umiHierarchyTypesCollection extends singleton implements iSingleton, iUmiHierarchyTypesCollection {private $types = array();protected function __construct() {$this->loadTypes();}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function getType($v94757cae63fd3e398c0811a976dd6bbe) {if($this->isExists($v94757cae63fd3e398c0811a976dd6bbe)) {return $this->types[$v94757cae63fd3e398c0811a976dd6bbe];}else {return false;}}public function getTypeByName($vb068931cc450442b63f5b3d276ea4297, $vabf77184f55403d75b9d51d79162a7ca = false) {if($vb068931cc450442b63f5b3d276ea4297 == 'content' and $vabf77184f55403d75b9d51d79162a7ca == 'page') $vabf77184f55403d75b9d51d79162a7ca = false;foreach($this->types as $v599dcce2998a6b40b1e38e8c6006cb0a) {if($v599dcce2998a6b40b1e38e8c6006cb0a->getName() == $vb068931cc450442b63f5b3d276ea4297 && $vabf77184f55403d75b9d51d79162a7ca === false) return $v599dcce2998a6b40b1e38e8c6006cb0a;if($v599dcce2998a6b40b1e38e8c6006cb0a->getName() == $vb068931cc450442b63f5b3d276ea4297 && $v599dcce2998a6b40b1e38e8c6006cb0a->getExt() == $vabf77184f55403d75b9d51d79162a7ca && $vabf77184f55403d75b9d51d79162a7ca !== false ) return $v599dcce2998a6b40b1e38e8c6006cb0a;}return false;}public function addType($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $vabf77184f55403d75b9d51d79162a7ca = "") {$this->disableCache();cacheFrontend::getInstance()->flush();if($vb946c44d711ade3b061653732977d043  = $this->getTypeByName($vb068931cc450442b63f5b3d276ea4297, $vabf77184f55403d75b9d51d79162a7ca)) {$vb946c44d711ade3b061653732977d043->setTitle($vd5d3db1765287eef77d7927cc956f50a);return $vb946c44d711ade3b061653732977d043->getId();}$v32409b63878fa9d5541998646b533159 = l_mysql_real_escape_string($vb068931cc450442b63f5b3d276ea4297);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_hierarchy_types (name) VALUES('{$v32409b63878fa9d5541998646b533159}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v94757cae63fd3e398c0811a976dd6bbe = l_mysql_insert_id();$v599dcce2998a6b40b1e38e8c6006cb0a = new umiHierarchyType($v94757cae63fd3e398c0811a976dd6bbe);$v599dcce2998a6b40b1e38e8c6006cb0a->setName($vb068931cc450442b63f5b3d276ea4297);$v599dcce2998a6b40b1e38e8c6006cb0a->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v599dcce2998a6b40b1e38e8c6006cb0a->setExt($vabf77184f55403d75b9d51d79162a7ca);$v599dcce2998a6b40b1e38e8c6006cb0a->commit();$this->types[$v94757cae63fd3e398c0811a976dd6bbe] = $v599dcce2998a6b40b1e38e8c6006cb0a;return $v94757cae63fd3e398c0811a976dd6bbe;}public function delType($v94757cae63fd3e398c0811a976dd6bbe) {$this->disableCache();cacheFrontend::getInstance()->flush();if($this->isExists($v94757cae63fd3e398c0811a976dd6bbe)) {unset($this->types[$v94757cae63fd3e398c0811a976dd6bbe]);$v94757cae63fd3e398c0811a976dd6bbe = (int) $v94757cae63fd3e398c0811a976dd6bbe;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_hierarchy_types WHERE id = '{$v94757cae63fd3e398c0811a976dd6bbe}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}else {return false;}}public function isExists($v5f694956811487225d15e973ca38fbab) {if($v5f694956811487225d15e973ca38fbab === false) return false;return (bool) array_key_exists($v5f694956811487225d15e973ca38fbab, $this->types);}private function loadTypes() {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$vda80b9ab86c2d00b85de0cf003cb3e6e = $vb99eb979e6f6efabc396f777b503f7e7->loadData('hierarchy_types');if(!is_array($vda80b9ab86c2d00b85de0cf003cb3e6e)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT  `id`, `name`, `title`, `ext` FROM `cms3_hierarchy_types` ORDER BY `name`, `ext`";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vda80b9ab86c2d00b85de0cf003cb3e6e = array();while(list($vb80bb7740288fda1f201890375a60c8f) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {$vda80b9ab86c2d00b85de0cf003cb3e6e[$vb80bb7740288fda1f201890375a60c8f] = $vf1965a857bc285d26fe22023aa5ab50d;}$vb99eb979e6f6efabc396f777b503f7e7->saveData('hierarchy_types', $vda80b9ab86c2d00b85de0cf003cb3e6e, 3600);}foreach($vda80b9ab86c2d00b85de0cf003cb3e6e as $vb80bb7740288fda1f201890375a60c8f => $vf1965a857bc285d26fe22023aa5ab50d) {$v599dcce2998a6b40b1e38e8c6006cb0a = $vb99eb979e6f6efabc396f777b503f7e7->load($vb80bb7740288fda1f201890375a60c8f, 'element_type');if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof iUmiHierarchyType == false) {try {$v599dcce2998a6b40b1e38e8c6006cb0a = new umiHierarchyType($vb80bb7740288fda1f201890375a60c8f, $vf1965a857bc285d26fe22023aa5ab50d);}catch (privateException $ve1671797c52e15f763380b45e841ec32) {continue;}$vb99eb979e6f6efabc396f777b503f7e7->save($v599dcce2998a6b40b1e38e8c6006cb0a, 'element_type');}$this->types[$vb80bb7740288fda1f201890375a60c8f] = $v599dcce2998a6b40b1e38e8c6006cb0a;}return true;}public function getTypesList() {return $this->types;}public function clearCache() {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->types);foreach($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) unset($this->types[$v3c6e0b8a9c15224a8228b9a98ca1531d]);$this->types = array();$this->loadTypes();}}class umiHierarchyElement extends umiEntinty implements iUmiEntinty, iUmiHierarchyElement {private $rel, $alt_name, $ord, $object_id,   $type_id, $domain_id, $lang_id, $tpl_id,   $is_deleted = false, $is_active = true, $is_visible = true, $is_default = false, $name,   $update_time,   $object,   $is_broken = false;protected $store_type = "element";public function getIsDeleted() {return $this->is_deleted;}public function getIsActive() {return $this->is_active;}public function getIsVisible() {return $this->is_visible;}public function getLangId() {return $this->lang_id;}public function getDomainId() {return $this->domain_id;}public function getTplId() {return $this->tpl_id;}public function getTypeId() {return $this->type_id;}public function getUpdateTime() {return $this->update_time;}public function getOrd() {return $this->ord;}public function getRel() {return $this->rel;}public function getAltName() {return $this->alt_name;}public function getIsDefault() {return $this->is_default;}public function getObject() {if(isset($this->object) && $this->object) {return $this->object;}else if(isset($this->object_id)) {$this->object = umiObjectsCollection::getInstance()->getObject($this->object_id);return $this->object;}else {return null;}}public function getParentId() {return $this->rel;}public function getName() {$this->name = umiObjectProperty::filterOutputString($this->name);return $this->translateLabel($this->name);}public function setName($vb068931cc450442b63f5b3d276ea4297) {$v9b207167e5381c47682c6b4f58a623fb = $this->getObject()->setName($vb068931cc450442b63f5b3d276ea4297);$this->name = $this->object->getName(true);$this->setIsUpdated(true);return $v9b207167e5381c47682c6b4f58a623fb;}public function getValue($vdfc394bd05a4b48161c790034af522a8, $v21ffce5b8a6cc8cc6a41448dd69623c9 = NULL) {$va8cfde6331bd59eb2ac96f8911c4b666 = $this->getObject();return $va8cfde6331bd59eb2ac96f8911c4b666 ? $va8cfde6331bd59eb2ac96f8911c4b666->getValue($vdfc394bd05a4b48161c790034af522a8, $v21ffce5b8a6cc8cc6a41448dd69623c9) : false;}public function setValue($vdfc394bd05a4b48161c790034af522a8, $v2771be291c4a714ca95fd1f45a32403e) {if($va8cfde6331bd59eb2ac96f8911c4b666 = $this->getObject()) {$result = $va8cfde6331bd59eb2ac96f8911c4b666->setValue($vdfc394bd05a4b48161c790034af522a8, $v2771be291c4a714ca95fd1f45a32403e);$this->setIsUpdated(true);return $result;}else {return false;}}public function setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = true) {if ($this->is_visible !== ((bool)$ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) {$this->is_visible = (bool) $ve1c6c9ef2fcbe75f26f815c4ef2e60b4;$this->setIsUpdated();}}public function setIsActive($v4264c638e0098acb172519b0436db099 = true) {if ($this->is_active !== ((bool)$v4264c638e0098acb172519b0436db099)) {$this->is_active = (bool) $v4264c638e0098acb172519b0436db099;$this->setIsUpdated();}}public function setIsDeleted($vf49e2553045b3240a95c36854d36dddc = false) {if ($this->is_deleted !== ((bool)$vf49e2553045b3240a95c36854d36dddc)) {$this->is_deleted = (bool) $vf49e2553045b3240a95c36854d36dddc;$this->setIsUpdated();}}public function setTypeId($v94757cae63fd3e398c0811a976dd6bbe) {if ($this->type_id !== ((int)$v94757cae63fd3e398c0811a976dd6bbe)) {$this->type_id = (int) $v94757cae63fd3e398c0811a976dd6bbe;$this->setIsUpdated();}}public function setLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86) {if ($this->lang_id !== ((int)$v78e6dd7a49f5b0cb2106a3a434dd5c86)) {$this->lang_id = (int) $v78e6dd7a49f5b0cb2106a3a434dd5c86;$this->setIsUpdated();}}public function setTplId($vd02e12eb6d6c3f6ebd763197df01e211) {if ($this->tpl_id !== ((int)$vd02e12eb6d6c3f6ebd763197df01e211)) {$this->tpl_id = (int) $vd02e12eb6d6c3f6ebd763197df01e211;$this->setIsUpdated();}}public function setDomainId($v662cbf1253ac7d8750ed9190c52163e5) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$vadce578d04ed03c31f6ac59451fcf8e4 = $vb81ca7c0ccaa77e7aa91936ab0070695->getChilds($this->id, true, true);foreach($vadce578d04ed03c31f6ac59451fcf8e4 as $vf36263a38d7de5cdaa953c1e2b2f79b5 => $v1a13105b7e4eb5fb2e7c9515ac06aa48) {$v1b7d5726533ab525a8760351e9b5e415 = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($vf36263a38d7de5cdaa953c1e2b2f79b5, true, true);$v1b7d5726533ab525a8760351e9b5e415->setDomainId($v662cbf1253ac7d8750ed9190c52163e5);$vb81ca7c0ccaa77e7aa91936ab0070695->unloadElement($vf36263a38d7de5cdaa953c1e2b2f79b5);unset($v1b7d5726533ab525a8760351e9b5e415);}if ($this->domain_id !== ((int)$v662cbf1253ac7d8750ed9190c52163e5)) {$this->domain_id = (int) $v662cbf1253ac7d8750ed9190c52163e5;$this->setIsUpdated();}}public function setUpdateTime($ve0df5a999da22bc6fa9e26b115eb4ae4 = 0) {if($ve0df5a999da22bc6fa9e26b115eb4ae4 == 0) {$ve0df5a999da22bc6fa9e26b115eb4ae4 = umiHierarchy::getTimeStamp();}if ($this->update_time !== ((int)$ve0df5a999da22bc6fa9e26b115eb4ae4)) {$this->update_time = (int) $ve0df5a999da22bc6fa9e26b115eb4ae4;$this->setIsUpdated();}}public function setOrd($v8bef1cc20ada3bef55fdf132cb2a1cb9) {if ($this->ord !== ((int)$v8bef1cc20ada3bef55fdf132cb2a1cb9)) {$this->ord = (int) $v8bef1cc20ada3bef55fdf132cb2a1cb9;$this->setIsUpdated();}}public function setRel($v7ffc4d510260a8544e5550e62ec56bc1) {if ($this->rel !== ((int)$v7ffc4d510260a8544e5550e62ec56bc1)) {$this->rel = (int) $v7ffc4d510260a8544e5550e62ec56bc1;$this->setIsUpdated();}}public function setObject(umiObject $va8cfde6331bd59eb2ac96f8911c4b666, $vac2a04437278cf6e6e597b1b9295b193 = true) {$this->object = $va8cfde6331bd59eb2ac96f8911c4b666;$this->object_id = $va8cfde6331bd59eb2ac96f8911c4b666->getId();if ($vac2a04437278cf6e6e597b1b9295b193) $this->setIsUpdated();}public function setAltName($vd84ff935144e00c3e1d395c2379aca47, $v5c42c04954c401e189bb85786bde8adb = true) {if(!$vd84ff935144e00c3e1d395c2379aca47) {$vd84ff935144e00c3e1d395c2379aca47 = $this->getName();}if($v5c42c04954c401e189bb85786bde8adb) {$vd84ff935144e00c3e1d395c2379aca47 = umiHierarchy::convertAltName($vd84ff935144e00c3e1d395c2379aca47);if(!$vd84ff935144e00c3e1d395c2379aca47) $vd84ff935144e00c3e1d395c2379aca47 = "_";}$vd295b8117d72bf06e54a27bcbfc782cf = $this->alt_name;$this->alt_name = $this->getRightAltName(umiObjectProperty::filterInputString($vd84ff935144e00c3e1d395c2379aca47));if(!$this->alt_name) {$this->alt_name = $vd84ff935144e00c3e1d395c2379aca47;}$v1988c61c48f30d2b39eed4edcf1e3c8b = $this->alt_name;if ($v1988c61c48f30d2b39eed4edcf1e3c8b !== $vd295b8117d72bf06e54a27bcbfc782cf) $this->setIsUpdated();}public function __destruct() {$v16b2b26000987faccb260b9d39df1269 = $this->object_id;parent::__destruct();unset($this->object_id);unset($this->object);umiObjectsCollection::getInstance()->unloadObject($v16b2b26000987faccb260b9d39df1269);}private function getRightAltName($vd84ff935144e00c3e1d395c2379aca47, $v0161cd78b4dc4a09ae9d2bbdb93dddc4 = false) {if (empty($vd84ff935144e00c3e1d395c2379aca47)) $vd84ff935144e00c3e1d395c2379aca47 = '1';if ($this->getRel() == 0 && !IGNORE_MODULE_NAMES_OVERWRITE) {$v6c63406410aa57b3c97b88d3feb09990 = regedit::getInstance()->getList("//modules");foreach($v6c63406410aa57b3c97b88d3feb09990 as $v854203cccade0bbe21be239a208aea49) {if ($vd84ff935144e00c3e1d395c2379aca47 == $v854203cccade0bbe21be239a208aea49[0]) {$vd84ff935144e00c3e1d395c2379aca47 .= '1';break;}}if (langsCollection::getInstance()->getLangId($vd84ff935144e00c3e1d395c2379aca47)) {$vd84ff935144e00c3e1d395c2379aca47 .= '1';}}$vc1332a8893475d77a4cb5226b0e6246d =  array();preg_match("/^([a-z0-9_.-]*)(\d*?)$/U", $vd84ff935144e00c3e1d395c2379aca47, $v66373a9c960d5bb19f89068c5a2797b0);$va2d2953131ec91efe3c90d4dbcee3777 = isset($v66373a9c960d5bb19f89068c5a2797b0[2]) ? $v66373a9c960d5bb19f89068c5a2797b0[2] : NULL;$v544988e29afe707b134aa03709eb443e = isset($v66373a9c960d5bb19f89068c5a2797b0[1]) ? $v66373a9c960d5bb19f89068c5a2797b0[1] : NULL;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $this->getLangId();$v662cbf1253ac7d8750ed9190c52163e5 = $this->getDomainId();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT alt_name FROM cms3_hierarchy WHERE rel={$this->getRel()} AND id <> {$this->getId()} AND is_deleted = '0' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}' AND alt_name LIKE '{$v544988e29afe707b134aa03709eb443e}%';";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v447b7147e84be512208dcc0995d67ebc) = mysql_fetch_row($result)) $vc1332a8893475d77a4cb5226b0e6246d[] = $v447b7147e84be512208dcc0995d67ebc;if (!empty($vc1332a8893475d77a4cb5226b0e6246d) and in_array($vd84ff935144e00c3e1d395c2379aca47,$vc1332a8893475d77a4cb5226b0e6246d)){foreach($vc1332a8893475d77a4cb5226b0e6246d as $v52dfbb9b0e571701b76699a145406d48){preg_match("/^([a-z0-9_.-]*)(\d*?)$/U", $v52dfbb9b0e571701b76699a145406d48, $v66373a9c960d5bb19f89068c5a2797b0);if (!empty($v66373a9c960d5bb19f89068c5a2797b0[2])) $va2d2953131ec91efe3c90d4dbcee3777 = max($va2d2953131ec91efe3c90d4dbcee3777,$v66373a9c960d5bb19f89068c5a2797b0[2]);}++$va2d2953131ec91efe3c90d4dbcee3777;if ($v0161cd78b4dc4a09ae9d2bbdb93dddc4) {$v363b122c528f54df4a0446b6bab05515 = 0;for ($v363b122c528f54df4a0446b6bab05515 = 1;$v363b122c528f54df4a0446b6bab05515<$va2d2953131ec91efe3c90d4dbcee3777;$v363b122c528f54df4a0446b6bab05515++) {if (!in_array($v544988e29afe707b134aa03709eb443e . $v363b122c528f54df4a0446b6bab05515, $vc1332a8893475d77a4cb5226b0e6246d)) {$va2d2953131ec91efe3c90d4dbcee3777 = $v363b122c528f54df4a0446b6bab05515;break;}}}}return $v544988e29afe707b134aa03709eb443e . $va2d2953131ec91efe3c90d4dbcee3777;}public function setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746 = true) {if ($this->is_default !== ((int)$vf62baf4c4ead98d50d516eca0ac5a746)) {umiHierarchy::getInstance()->clearDefaultElementCache();cacheFrontend::getInstance()->flush();$this->is_default = (int) $vf62baf4c4ead98d50d516eca0ac5a746;$this->setIsUpdated();}}public function getFieldId($v73f329f154a663bfda020aadcdd0b775) {return umiObjectTypesCollection::getInstance()->getType($this->getObject()->getTypeId())->getFieldId($v73f329f154a663bfda020aadcdd0b775);}protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT h.rel, h.type_id, h.lang_id, h.domain_id, h.tpl_id, h.obj_id, h.ord, h.alt_name, h.is_active, h.is_visible, h.is_deleted, h.updatetime, h.is_default, o.name FROM cms3_hierarchy h, cms3_objects o WHERE h.id = '{$this->id}' AND o.id = h.obj_id";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($v7ffc4d510260a8544e5550e62ec56bc1, $v94757cae63fd3e398c0811a976dd6bbe, $v78e6dd7a49f5b0cb2106a3a434dd5c86, $v662cbf1253ac7d8750ed9190c52163e5, $vd02e12eb6d6c3f6ebd763197df01e211, $v818ad5ef6588e140ecb9f81e810c028a, $v8bef1cc20ada3bef55fdf132cb2a1cb9, $vd84ff935144e00c3e1d395c2379aca47, $v4264c638e0098acb172519b0436db099, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4, $vf49e2553045b3240a95c36854d36dddc, $v3e04dc2abd929a9d02e2e0fa41d24bf9, $vf62baf4c4ead98d50d516eca0ac5a746, $vb068931cc450442b63f5b3d276ea4297) = $vf1965a857bc285d26fe22023aa5ab50d) {if(!$v818ad5ef6588e140ecb9f81e810c028a) {umiHierarchy::getInstance()->delElement($this->id);$this->is_broken = true;return false;}$this->rel = (int) $v7ffc4d510260a8544e5550e62ec56bc1;$this->type_id = (int) $v94757cae63fd3e398c0811a976dd6bbe;$this->lang_id = (int) $v78e6dd7a49f5b0cb2106a3a434dd5c86;$this->domain_id = (int) $v662cbf1253ac7d8750ed9190c52163e5;$this->tpl_id = (int) $vd02e12eb6d6c3f6ebd763197df01e211;$this->object_id = (int) $v818ad5ef6588e140ecb9f81e810c028a;$this->ord = (int) $v8bef1cc20ada3bef55fdf132cb2a1cb9;$this->alt_name = $vd84ff935144e00c3e1d395c2379aca47;$this->is_active = (bool) $v4264c638e0098acb172519b0436db099;$this->is_visible = (bool) $ve1c6c9ef2fcbe75f26f815c4ef2e60b4;$this->is_deleted = (bool) $vf49e2553045b3240a95c36854d36dddc;$this->is_default = (bool) $vf62baf4c4ead98d50d516eca0ac5a746;$this->name = $vb068931cc450442b63f5b3d276ea4297;if (!$v3e04dc2abd929a9d02e2e0fa41d24bf9) {$v3e04dc2abd929a9d02e2e0fa41d24bf9 = umiHierarchy::getTimeStamp();}$this->update_time = (int)$v3e04dc2abd929a9d02e2e0fa41d24bf9;return true;}else {$this->is_broken = true;return false;}}protected function save() {$v7ffc4d510260a8544e5550e62ec56bc1 = (int) $this->rel;$v94757cae63fd3e398c0811a976dd6bbe = (int) $this->type_id;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = (int) $this->lang_id;$v662cbf1253ac7d8750ed9190c52163e5 = (int) $this->domain_id;$vd02e12eb6d6c3f6ebd763197df01e211 = (int) $this->tpl_id;$vaf31437ce61345f416579830a98c91e5 = (int) $this->object_id;$v8bef1cc20ada3bef55fdf132cb2a1cb9 = (int) $this->ord;$vd84ff935144e00c3e1d395c2379aca47 = self::filterInputString($this->alt_name);$v4264c638e0098acb172519b0436db099 = (int) $this->is_active;$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = (int) $this->is_visible;$vf49e2553045b3240a95c36854d36dddc = (int) $this->is_deleted;$ve0df5a999da22bc6fa9e26b115eb4ae4 = (int) $this->update_time;$vf62baf4c4ead98d50d516eca0ac5a746 = (int) $this->is_default;if($vf62baf4c4ead98d50d516eca0ac5a746) {$vac5c74b64b4b8352ef2f181affb5ac2a ="UPDATE cms3_hierarchy SET is_default = '0' WHERE is_default = '1' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_hierarchy SET rel = '{$v7ffc4d510260a8544e5550e62ec56bc1}', type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}', lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}', domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}', tpl_id = '{$vd02e12eb6d6c3f6ebd763197df01e211}', obj_id = '{$vaf31437ce61345f416579830a98c91e5}', ord = '{$v8bef1cc20ada3bef55fdf132cb2a1cb9}', alt_name = '{$vd84ff935144e00c3e1d395c2379aca47}', is_active = '{$v4264c638e0098acb172519b0436db099}', is_visible = '{$ve1c6c9ef2fcbe75f26f815c4ef2e60b4}', is_deleted = '{$vf49e2553045b3240a95c36854d36dddc}', updatetime = '{$ve0df5a999da22bc6fa9e26b115eb4ae4}', is_default = '{$vf62baf4c4ead98d50d516eca0ac5a746}' WHERE id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($this->is_updated) {$v06a943c59f33a34bb5924aaf72cd2995 = searchModel::getInstance();if(PAGES_AUTO_INDEX) {if($this->getIsActive() && $this->getIsDeleted() == false) {$v06a943c59f33a34bb5924aaf72cd2995->index_item($this->id);}else {$v06a943c59f33a34bb5924aaf72cd2995->unindex_items($this->id);}}}if (!umiHierarchy::$ignoreSiteMap) $this->updateSiteMap(true);try {$this->updateYML();}catch (Exception $ve1671797c52e15f763380b45e841ec32) {}return true;}public function updateYML() {$v100664c6e2c0333b19a729f2f3ddb7dd = CURRENT_WORKING_DIR . "/sys-temp/yml/";$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();$v8c028488715d341980c5985fd02bfa1e = $v6942e8fa62b3cc9d93881a58210e2fd7->getTypeByName("catalog", "object");$v3e78669aa9a1bfe336037e3d77a22705 = $v6942e8fa62b3cc9d93881a58210e2fd7->getTypeByName("catalog", "category");$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();if (!$v8c028488715d341980c5985fd02bfa1e || !$v3e78669aa9a1bfe336037e3d77a22705) return false;if ($this->getHierarchyType()->getId() == $v3e78669aa9a1bfe336037e3d77a22705->getId()) {$this->checkYMLinclude();if (!$this->is_active || $this->is_deleted) {$v397c47bd29ed2de23a264b3de9d0aeaf = $vb81ca7c0ccaa77e7aa91936ab0070695->getChildIds($this->getId(), false);foreach($v397c47bd29ed2de23a264b3de9d0aeaf as $vf4f40123eb510dd3290125b38f4eb898) {$v0f635d0e0f3874fff8b581c132e6c7a7 = $v100664c6e2c0333b19a729f2f3ddb7dd . $vf4f40123eb510dd3290125b38f4eb898 . ".txt";if(file_exists($v0f635d0e0f3874fff8b581c132e6c7a7)) unlink($v0f635d0e0f3874fff8b581c132e6c7a7);}}return true;}if ($this->getHierarchyType()->getId() != $v8c028488715d341980c5985fd02bfa1e->getId()) return false;if (!is_dir($v100664c6e2c0333b19a729f2f3ddb7dd)) mkdir($v100664c6e2c0333b19a729f2f3ddb7dd, 0777, true);$v0f635d0e0f3874fff8b581c132e6c7a7 = $v100664c6e2c0333b19a729f2f3ddb7dd . "{$this->id}.txt";if(file_exists($v0f635d0e0f3874fff8b581c132e6c7a7)) unlink($v0f635d0e0f3874fff8b581c132e6c7a7);if ($this->is_active && !$this->is_deleted) {$v9c28d32df234037773be184dbdafc274 = $this->checkYMLinclude();if (!count($v9c28d32df234037773be184dbdafc274)) return false;$vbfa030fe63bacd523dd70a76cfaed98a = $this->getParentId();if ($vbfa030fe63bacd523dd70a76cfaed98a) {$vd0e45878043844ffc41aac437e86b602 = umiHierarchy::getInstance()->getElement($vbfa030fe63bacd523dd70a76cfaed98a, true, true);if ($vd0e45878043844ffc41aac437e86b602->getHierarchyType()->getId() != $v3e78669aa9a1bfe336037e3d77a22705->getId()) {$vbfa030fe63bacd523dd70a76cfaed98a = false;$vc68ad910ed49ac65f21f1bf2c5dbf912 = $vb81ca7c0ccaa77e7aa91936ab0070695->getAllParents($this->id, true, true);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = count($vc68ad910ed49ac65f21f1bf2c5dbf912)-1;$v865c0c0b4ab0e063e5caa3387c1a8741>=0 ;$v865c0c0b4ab0e063e5caa3387c1a8741--) {$veb26d1e3d9eea8920caf827a786b187f = $vc68ad910ed49ac65f21f1bf2c5dbf912[$v865c0c0b4ab0e063e5caa3387c1a8741];$v0b7a661d35d52d96b26b9f3f3bd32aab = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($veb26d1e3d9eea8920caf827a786b187f, true);if ($v0b7a661d35d52d96b26b9f3f3bd32aab instanceof umiHierarchyElement && $v0b7a661d35d52d96b26b9f3f3bd32aab->getHierarchyType()->getId() == $v3e78669aa9a1bfe336037e3d77a22705->getId()) {$vbfa030fe63bacd523dd70a76cfaed98a = $veb26d1e3d9eea8920caf827a786b187f;break;}}}}if (!$vbfa030fe63bacd523dd70a76cfaed98a) {throw new publicAdminException(getLabel('error-update-yml'));}$ved780287e302ec3b9fd3c5e78771919f = new xmlExporter('yml');$ved780287e302ec3b9fd3c5e78771919f->addElements(array($this->id));$ved780287e302ec3b9fd3c5e78771919f->setIgnoreRelations();$vbbd738a112791dd1d0cb6bd0d61d878f = $ved780287e302ec3b9fd3c5e78771919f->execute();$vd0c75bac742760cf71fd76cd75d0c02a = CURRENT_WORKING_DIR . '/xsl/export/YML.xsl';if (!is_file($vd0c75bac742760cf71fd76cd75d0c02a)) {throw new publicException("Can't load exporter {$vd0c75bac742760cf71fd76cd75d0c02a}");}$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument("1.0", "utf-8");$v9a09b4dfda82e3e665e31092d1c3ec8d->formatOutput = XML_FORMAT_OUTPUT;$v9a09b4dfda82e3e665e31092d1c3ec8d->loadXML($vbbd738a112791dd1d0cb6bd0d61d878f->saveXML());$v640eac53ad75db5c49a9ec86390d8530 = umiTemplater::create('XSLT', $vd0c75bac742760cf71fd76cd75d0c02a);$result = $v640eac53ad75db5c49a9ec86390d8530->parse($v9a09b4dfda82e3e665e31092d1c3ec8d);$vdd988cfd769c9f7fbd795a0f5da8e751 = new DOMDocument();$vdd988cfd769c9f7fbd795a0f5da8e751->loadXML($result);$vb2bf18e206cf9b5eb2d632030acb16cc = $vdd988cfd769c9f7fbd795a0f5da8e751->getElementsByTagName('offer');if ($vb2bf18e206cf9b5eb2d632030acb16cc->length) {$v9a0364b9e99bb480dd25e1f0284c8555 = '';foreach($vb2bf18e206cf9b5eb2d632030acb16cc as $vd60db28d94d538bbb249dcc7f2273ab1) {$vc4ef352f74e502ef5e7bc98e6f4e493d = $vd60db28d94d538bbb249dcc7f2273ab1->getElementsByTagName('categoryId')->item(0);if ($vc4ef352f74e502ef5e7bc98e6f4e493d) $vc4ef352f74e502ef5e7bc98e6f4e493d->nodeValue = $vbfa030fe63bacd523dd70a76cfaed98a;if (function_exists('mb_convert_encoding')) {$v9a0364b9e99bb480dd25e1f0284c8555 .= mb_convert_encoding($vdd988cfd769c9f7fbd795a0f5da8e751->saveXML($vd60db28d94d538bbb249dcc7f2273ab1), "CP1251", "UTF-8");}else {$v9a0364b9e99bb480dd25e1f0284c8555 .= iconv("UTF-8", "CP1251//IGNORE", $vdd988cfd769c9f7fbd795a0f5da8e751->saveXML($vd60db28d94d538bbb249dcc7f2273ab1));}}file_put_contents($v0f635d0e0f3874fff8b581c132e6c7a7, $v9a0364b9e99bb480dd25e1f0284c8555);}$v7f24d9fc4140045241b3f97bcf36bf03 = $vdd988cfd769c9f7fbd795a0f5da8e751->getElementsByTagName('currencies')->item(0);$v09c2a312ca0311b5e24340fe8f827077 = iconv("UTF-8", "CP1251//IGNORE", $vdd988cfd769c9f7fbd795a0f5da8e751->saveXML($v7f24d9fc4140045241b3f97bcf36bf03));file_put_contents($v100664c6e2c0333b19a729f2f3ddb7dd . 'currencies', $v09c2a312ca0311b5e24340fe8f827077);$vdaeed474badc5873f59f5c1933dfa304 = $vdd988cfd769c9f7fbd795a0f5da8e751->getElementsByTagName('name')->item(0);$vb068931cc450442b63f5b3d276ea4297 = $vdaeed474badc5873f59f5c1933dfa304->nodeValue;$v93c731f1c3a84ef05cd54d044c379eaa = $vdd988cfd769c9f7fbd795a0f5da8e751->getElementsByTagName('company')->item(0);$vdb486e4cdf8b2048591e59f683319c4c = $v93c731f1c3a84ef05cd54d044c379eaa->nodeValue;foreach ($v9c28d32df234037773be184dbdafc274 as $v013b012140e3049c2436475764dfba3c) {file_put_contents($v100664c6e2c0333b19a729f2f3ddb7dd . 'shop' . $v013b012140e3049c2436475764dfba3c, '<name>' . iconv("UTF-8", "CP1251//IGNORE", $vb068931cc450442b63f5b3d276ea4297) . '</name><company>' . iconv("UTF-8", "CP1251", $vdb486e4cdf8b2048591e59f683319c4c) . '</company><url>http://' . domainsCollection::getInstance()->getDomain($this->getDomainId())->getHost() . '</url>');}}}protected function checkYMLinclude() {$v100664c6e2c0333b19a729f2f3ddb7dd = CURRENT_WORKING_DIR . "/sys-temp/yml/";if (!is_dir($v100664c6e2c0333b19a729f2f3ddb7dd)) return false;$v736007832d2167baaae763fd3a3f3cf1 = dir($v100664c6e2c0333b19a729f2f3ddb7dd);$v9c28d32df234037773be184dbdafc274 = array();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$vc68ad910ed49ac65f21f1bf2c5dbf912 = $vb81ca7c0ccaa77e7aa91936ab0070695->getAllParents($this->id, true, true);while (false !== ($v8c7dd922ad47494fc02c388e12c00eac = $v736007832d2167baaae763fd3a3f3cf1->read())) {if(strpos($v8c7dd922ad47494fc02c388e12c00eac, "cat")) {$v013b012140e3049c2436475764dfba3c = trim($v8c7dd922ad47494fc02c388e12c00eac, 'cat');$vc2413b3d6b0162ee66c1ee1a90828706 = array();if (file_exists($v100664c6e2c0333b19a729f2f3ddb7dd . $v013b012140e3049c2436475764dfba3c . 'excluded')) {$vc2413b3d6b0162ee66c1ee1a90828706 = unserialize(file_get_contents($v100664c6e2c0333b19a729f2f3ddb7dd . $v013b012140e3049c2436475764dfba3c . "excluded"));}if (count(array_intersect($vc2413b3d6b0162ee66c1ee1a90828706, $vc68ad910ed49ac65f21f1bf2c5dbf912))) {continue;}$v3b79c910c0feb17f4f4462e3decfb786 = unserialize(file_get_contents($v100664c6e2c0333b19a729f2f3ddb7dd . $v8c7dd922ad47494fc02c388e12c00eac));$vc97e47c7f15ca0e987851078d2318eed = unserialize(file_get_contents($v100664c6e2c0333b19a729f2f3ddb7dd . $v013b012140e3049c2436475764dfba3c . "el"));$vea228c391b72961cc1370e2d66442d86 = array_keys(array_intersect($vc68ad910ed49ac65f21f1bf2c5dbf912, $v3b79c910c0feb17f4f4462e3decfb786));$vb0b5ccb4a195a07fd3eed14affb8695f = array();if (file_exists($v100664c6e2c0333b19a729f2f3ddb7dd . 'categories' . $v013b012140e3049c2436475764dfba3c)) {$vb0b5ccb4a195a07fd3eed14affb8695f = unserialize(file_get_contents($v100664c6e2c0333b19a729f2f3ddb7dd . 'categories' . $v013b012140e3049c2436475764dfba3c));}if (count($vea228c391b72961cc1370e2d66442d86)) {$vca890278cc5a293ee13dde5e16512d0f = $vea228c391b72961cc1370e2d66442d86[0];if ($vc68ad910ed49ac65f21f1bf2c5dbf912[$vca890278cc5a293ee13dde5e16512d0f] == $this->getId() && $this->getHierarchyType()->getMethod() == 'object') {if (isset($vc68ad910ed49ac65f21f1bf2c5dbf912[$vca890278cc5a293ee13dde5e16512d0f-1])) $vca890278cc5a293ee13dde5e16512d0f--;}for ($v865c0c0b4ab0e063e5caa3387c1a8741 = $vca890278cc5a293ee13dde5e16512d0f;$v865c0c0b4ab0e063e5caa3387c1a8741 < count($vc68ad910ed49ac65f21f1bf2c5dbf912);$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vbfa030fe63bacd523dd70a76cfaed98a = $vc68ad910ed49ac65f21f1bf2c5dbf912[$v865c0c0b4ab0e063e5caa3387c1a8741];$vd0e45878043844ffc41aac437e86b602 = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($vbfa030fe63bacd523dd70a76cfaed98a);if (!$vd0e45878043844ffc41aac437e86b602 instanceof umiHierarchyElement) continue;if (!$vd0e45878043844ffc41aac437e86b602->getIsActive() || $vd0e45878043844ffc41aac437e86b602->getIsDeleted()) {if ($this->getHierarchyType()->getMethod() == 'object') return $v9c28d32df234037773be184dbdafc274;}if ($vd0e45878043844ffc41aac437e86b602->getHierarchyType()->getMethod() != 'category') continue;if ($vd0e45878043844ffc41aac437e86b602->getIsActive() && !$vd0e45878043844ffc41aac437e86b602->getIsDeleted()) {$vffffe4247e7557c58cc7eb95ff95104e = $vd0e45878043844ffc41aac437e86b602->getName();$vffffe4247e7557c58cc7eb95ff95104e = iconv("UTF-8", "CP1251//IGNORE", $vffffe4247e7557c58cc7eb95ff95104e);$vffffe4247e7557c58cc7eb95ff95104e = strtr($vffffe4247e7557c58cc7eb95ff95104e, array("&" => "&amp;", "<" => "&lt;", ">" => "&gt;"));$v8daec67a558a7355db08d90eeadf7af7 = $vd0e45878043844ffc41aac437e86b602->getParentId();if ($v8daec67a558a7355db08d90eeadf7af7 && isset($vb0b5ccb4a195a07fd3eed14affb8695f[$v8daec67a558a7355db08d90eeadf7af7])) {$vb0b5ccb4a195a07fd3eed14affb8695f[$vbfa030fe63bacd523dd70a76cfaed98a] = '<category id="' . $vbfa030fe63bacd523dd70a76cfaed98a . '" parentId="' . $v8daec67a558a7355db08d90eeadf7af7 . '">' . $vffffe4247e7557c58cc7eb95ff95104e . '</category>';}else {$vb0b5ccb4a195a07fd3eed14affb8695f[$vbfa030fe63bacd523dd70a76cfaed98a] = '<category id="' . $vbfa030fe63bacd523dd70a76cfaed98a . '">' . $vffffe4247e7557c58cc7eb95ff95104e . '</category>';}}else {if(isset($vb0b5ccb4a195a07fd3eed14affb8695f[$vbfa030fe63bacd523dd70a76cfaed98a])) unset($vb0b5ccb4a195a07fd3eed14affb8695f[$vbfa030fe63bacd523dd70a76cfaed98a]);}}if(!in_array($this->id, $vc97e47c7f15ca0e987851078d2318eed) && $this->getHierarchyType()->getMethod() == 'object') {$vc97e47c7f15ca0e987851078d2318eed[] = $this->id;file_put_contents($v100664c6e2c0333b19a729f2f3ddb7dd . $v013b012140e3049c2436475764dfba3c . "el", serialize($vc97e47c7f15ca0e987851078d2318eed));}$v9c28d32df234037773be184dbdafc274[] = $v013b012140e3049c2436475764dfba3c;}elseif($this->getHierarchyType()->getMethod() == 'category' &&(!$this->getIsActive() || $this->getIsDeleted())) {$vadce578d04ed03c31f6ac59451fcf8e4 = $vb81ca7c0ccaa77e7aa91936ab0070695->getChildIds($this->getId(), false, true);$vea228c391b72961cc1370e2d66442d86 = array_intersect($vadce578d04ed03c31f6ac59451fcf8e4, $v3b79c910c0feb17f4f4462e3decfb786);if (count($vea228c391b72961cc1370e2d66442d86)) {foreach($vadce578d04ed03c31f6ac59451fcf8e4 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $vf4f40123eb510dd3290125b38f4eb898) {if(isset($vb0b5ccb4a195a07fd3eed14affb8695f[$vf4f40123eb510dd3290125b38f4eb898])) unset($vb0b5ccb4a195a07fd3eed14affb8695f[$vf4f40123eb510dd3290125b38f4eb898]);}}}else {if($v3c6e0b8a9c15224a8228b9a98ca1531d =  array_search($this->id, $vc97e47c7f15ca0e987851078d2318eed) && $this->getHierarchyType()->getMethod() == 'object') {unset($vc97e47c7f15ca0e987851078d2318eed[$v3c6e0b8a9c15224a8228b9a98ca1531d]);sort($vc97e47c7f15ca0e987851078d2318eed);file_put_contents($v100664c6e2c0333b19a729f2f3ddb7dd . $v013b012140e3049c2436475764dfba3c . "el", serialize($vc97e47c7f15ca0e987851078d2318eed));}}file_put_contents($v100664c6e2c0333b19a729f2f3ddb7dd . 'categories' . $v013b012140e3049c2436475764dfba3c, serialize($vb0b5ccb4a195a07fd3eed14affb8695f));}}$v736007832d2167baaae763fd3a3f3cf1->close();return $v9c28d32df234037773be184dbdafc274;}public function updateSiteMap($v5e6575e86b3e73984e620fe59289bb96 = false) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();if(!$v5e6575e86b3e73984e620fe59289bb96) {$vadce578d04ed03c31f6ac59451fcf8e4 = $vb81ca7c0ccaa77e7aa91936ab0070695->getChilds($this->id, true, true, 1);if (is_array($vadce578d04ed03c31f6ac59451fcf8e4)){foreach ($vadce578d04ed03c31f6ac59451fcf8e4 as $vf4f40123eb510dd3290125b38f4eb898 => $v2063c1608d6e0baf80249c42e2be5804) {$v1b7d5726533ab525a8760351e9b5e415 = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($vf4f40123eb510dd3290125b38f4eb898)->updateSiteMap($v5e6575e86b3e73984e620fe59289bb96);}}}$v9a5b3630a33f0e1697a63e8c9b24f50c = $vb81ca7c0ccaa77e7aa91936ab0070695->forceAbsolutePath();$v2a304a1348456ccd2234cd71a81bd338 = $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById($this->id, false, false, true);$ve0df5a999da22bc6fa9e26b115eb4ae4 = date('c', $this->update_time);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT level FROM cms3_hierarchy_relations WHERE (rel_id = '' or rel_id is null) and child_id={$this->id}";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v8aac9ddfd8f1554f195cfe07c8bd36f5 = 0.5;while(list($vc9e9a848920877e76685b2e4e76de38d) = mysql_fetch_row($result)) {$v8aac9ddfd8f1554f195cfe07c8bd36f5 = round(1 / ($vc9e9a848920877e76685b2e4e76de38d + 1), 1);if($v8aac9ddfd8f1554f195cfe07c8bd36f5 < 0.1) $v8aac9ddfd8f1554f195cfe07c8bd36f5 = 0.1;}$v100664c6e2c0333b19a729f2f3ddb7dd = CURRENT_WORKING_DIR . "/sys-temp/sitemap/{$this->domain_id}/";if (!is_dir($v100664c6e2c0333b19a729f2f3ddb7dd)) mkdir($v100664c6e2c0333b19a729f2f3ddb7dd, 0777, true);$v0f635d0e0f3874fff8b581c132e6c7a7 = $v100664c6e2c0333b19a729f2f3ddb7dd . "{$this->id}.xml";if(file_exists($v0f635d0e0f3874fff8b581c132e6c7a7)) unlink($v0f635d0e0f3874fff8b581c132e6c7a7);if ($this->is_active && !$this->robots_deny && !$this->is_deleted) {$vdd988cfd769c9f7fbd795a0f5da8e751 = new DOMDocument();$v572d4e421e5e6b9bc11d815e8a027112 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('url');$vce04bd8105c135f89b0dfd5d9c1e8c5d = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('loc', $v2a304a1348456ccd2234cd71a81bd338);$vb988295c268025b49dfb3df26171ddc3 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('priority', $v8aac9ddfd8f1554f195cfe07c8bd36f5);$v206125ac5c6d4ed520748b35f2c02136 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement('lastmod', $ve0df5a999da22bc6fa9e26b115eb4ae4);$vdd988cfd769c9f7fbd795a0f5da8e751->appendChild($v572d4e421e5e6b9bc11d815e8a027112);$v572d4e421e5e6b9bc11d815e8a027112->appendChild($vce04bd8105c135f89b0dfd5d9c1e8c5d);$v572d4e421e5e6b9bc11d815e8a027112->appendChild($v206125ac5c6d4ed520748b35f2c02136);$v572d4e421e5e6b9bc11d815e8a027112->appendChild($vb988295c268025b49dfb3df26171ddc3);file_put_contents($v0f635d0e0f3874fff8b581c132e6c7a7, $vdd988cfd769c9f7fbd795a0f5da8e751->saveXML($v572d4e421e5e6b9bc11d815e8a027112));}$vb81ca7c0ccaa77e7aa91936ab0070695->forceAbsolutePath($v9a5b3630a33f0e1697a63e8c9b24f50c);}public function setIsUpdated($v50e544b8aa9b48fae6d78fb7574d402f = true) {parent::setIsUpdated($v50e544b8aa9b48fae6d78fb7574d402f);$this->update_time = time();umiHierarchy::getInstance()->addUpdatedElementId($this->id);if($this->rel) {umiHierarchy::getInstance()->addUpdatedElementId($this->rel);}}public function getIsBroken() {return $this->is_broken;}public function commit() {$va8cfde6331bd59eb2ac96f8911c4b666 = $this->getObject();if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) {$va8cfde6331bd59eb2ac96f8911c4b666->commit();$v16b2b26000987faccb260b9d39df1269 = $va8cfde6331bd59eb2ac96f8911c4b666->getId();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();cacheFrontend::getInstance()->del($v16b2b26000987faccb260b9d39df1269, "object");$va7f1f2c46c62415198e0884b827bd2d2 = $vb81ca7c0ccaa77e7aa91936ab0070695->getObjectInstances($v16b2b26000987faccb260b9d39df1269, true, true);foreach($va7f1f2c46c62415198e0884b827bd2d2 as $va3e6bf52d6871a75cae73e5262de04af) {cacheFrontend::getInstance()->del($va3e6bf52d6871a75cae73e5262de04af, "element");}}parent::commit();}public function getObjectTypeId() {return $this->getObject()->getTypeId();}public function getHierarchyType() {return umiHierarchyTypesCollection::getInstance()->getType($this->type_id);}public function getObjectId() {return $this->object_id;}protected function getType() {$v1723bdd4ee51910267a625cae41ced8a = umiHierarchyTypesCollection::getInstance();return $v1723bdd4ee51910267a625cae41ced8a->getType($this->getTypeId());}public function getModule() {return $this->getType()->getName();}public function getMethod() {return $this->getType()->getExt();}public function delete() {umiHierarchy::getInstance()->delElement($this->id);}public function __sleep() {$vb63119da730344b345cdc8f62a4711e9 = get_class_vars(get_class($this));$vb63119da730344b345cdc8f62a4711e9['object'] = NULL;return array_keys($vb63119da730344b345cdc8f62a4711e9);}public function __get($v51746fc9cfaaf892e94c2d56d7508b37) {switch($v51746fc9cfaaf892e94c2d56d7508b37) {case "id":   return $this->id;case "objectId": return $this->object_id;case "name":  return $this->getName();case "altName":  return $this->getAltName();case "isActive": return $this->getIsActive();case "isVisible": return $this->getIsVisible();case "isDeleted": return $this->getIsDeleted();case "xlink":  return 'upage://' . $this->id;case "link": {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();return $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById($this->id);}default:   return $this->getValue($v51746fc9cfaaf892e94c2d56d7508b37);}}public function __set($v51746fc9cfaaf892e94c2d56d7508b37, $v2063c1608d6e0baf80249c42e2be5804) {switch($v51746fc9cfaaf892e94c2d56d7508b37) {case "id":   throw new coreException("Object id could not be changed");case "name":  return $this->setName($v2063c1608d6e0baf80249c42e2be5804);case "altName":  return $this->setAltName($v2063c1608d6e0baf80249c42e2be5804);case "isActive": return $this->setIsActive($v2063c1608d6e0baf80249c42e2be5804);case "isVisible": return $this->setIsVisible($v2063c1608d6e0baf80249c42e2be5804);case "isDeleted": return $this->setIsDeleted($v2063c1608d6e0baf80249c42e2be5804);default:   return $this->setValue($v51746fc9cfaaf892e94c2d56d7508b37, $v2063c1608d6e0baf80249c42e2be5804);}}public function beforeSerialize($v324b23d9adc662d7f9e99634ed47ab65 = false) {static $va8cfde6331bd59eb2ac96f8911c4b666 = null;if($v324b23d9adc662d7f9e99634ed47ab65 && !is_null($va8cfde6331bd59eb2ac96f8911c4b666)) {$this->object = $va8cfde6331bd59eb2ac96f8911c4b666;}else {$va8cfde6331bd59eb2ac96f8911c4b666 = $this->object;$this->object = null;}}public function afterSerialize() {$this->beforeSerialize(true);}public function afterUnSerialize() {$this->getObject();}};class umiHierarchy extends singleton implements iSingleton, iUmiHierarchy {private $elements = array(),   $objects, $langs, $domains, $templates;private $updatedElements = Array();private $autocorrectionDisabled = false;private $elementsLastUpdateTime = 0;private $bForceAbsolutePath = false;private $symlinks = Array();private $misc_elements = Array();private $pathCache = array();private $pathPiecesCache = array();private $defaultCache = array();private $parentsCache = array();private $idByPathCache = array();public static $ignoreSiteMap = false;protected function __construct() {showWorkTime("umihierarchy construct start");$this->objects  = umiObjectsCollection::getInstance();showWorkTime("umihierarchy umiObjectsCollection init");$this->langs  = langsCollection::getInstance();showWorkTime("umihierarchy langsCollection init");$this->domains  = domainsCollection::getInstance();showWorkTime("umihierarchy domainsCollection init");$this->templates = templatesCollection::getInstance();showWorkTime("umihierarchy templatesCollection init");if(regedit::getInstance()->getVal("//settings/disable_url_autocorrection")) {$this->autocorrectionDisabled = true;}}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function isExists($v7057e8409c7c531a1a6e9ac3df4ed549) {if($this->isLoaded($v7057e8409c7c531a1a6e9ac3df4ed549)) {return true;}else {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($ve2942a04780e223b215eb8b663cf5353) = mysql_fetch_row($result);return (bool) $ve2942a04780e223b215eb8b663cf5353;}}public function isLoaded($v7057e8409c7c531a1a6e9ac3df4ed549) {if($v7057e8409c7c531a1a6e9ac3df4ed549 === false) {return false;}if(is_array($v7057e8409c7c531a1a6e9ac3df4ed549)) {$v5b78ddc78e0a270e44c7928843456220 = true;foreach($v7057e8409c7c531a1a6e9ac3df4ed549 as $v7a83e592dae31301d9b5c2bbc544d822) {if(!array_key_exists($v7a83e592dae31301d9b5c2bbc544d822, $this->elements)) {$v5b78ddc78e0a270e44c7928843456220 = false;break;}}return $v5b78ddc78e0a270e44c7928843456220;}else {return (bool) array_key_exists($v7057e8409c7c531a1a6e9ac3df4ed549, $this->elements);}}public function getElement($v7057e8409c7c531a1a6e9ac3df4ed549, $ve70325c72e806c33fd52022dd9c07eb2 = false, $vbeaf7e25161be5ef9784e550ab4fc891 = false, $vf1965a857bc285d26fe22023aa5ab50d = false) {if(!$v7057e8409c7c531a1a6e9ac3df4ed549) {return false;}if($vf1965a857bc285d26fe22023aa5ab50d === false && !$ve70325c72e806c33fd52022dd9c07eb2 && !$this->isAllowed($v7057e8409c7c531a1a6e9ac3df4ed549)) return false;$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();if($this->isLoaded($v7057e8409c7c531a1a6e9ac3df4ed549)) {return $this->elements[$v7057e8409c7c531a1a6e9ac3df4ed549];}else {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb99eb979e6f6efabc396f777b503f7e7->load($v7057e8409c7c531a1a6e9ac3df4ed549, "element");if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement == false) {try {$v8e2dcfd7e7e24b1ca76c1193f645902b = new umiHierarchyElement($v7057e8409c7c531a1a6e9ac3df4ed549, $vf1965a857bc285d26fe22023aa5ab50d);$vb99eb979e6f6efabc396f777b503f7e7->save($v8e2dcfd7e7e24b1ca76c1193f645902b, "element");}catch (privateException $ve1671797c52e15f763380b45e841ec32) {return false;}}$this->misc_elements[] = $v7057e8409c7c531a1a6e9ac3df4ed549;if(is_object($v8e2dcfd7e7e24b1ca76c1193f645902b)) {if($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsBroken()) return false;if($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsDeleted() && !$vbeaf7e25161be5ef9784e550ab4fc891) return false;$this->pushElementsLastUpdateTime($v8e2dcfd7e7e24b1ca76c1193f645902b->getUpdateTime());$this->elements[$v7057e8409c7c531a1a6e9ac3df4ed549] = $v8e2dcfd7e7e24b1ca76c1193f645902b;return $this->elements[$v7057e8409c7c531a1a6e9ac3df4ed549];}else return false;}}public function delElement($v7057e8409c7c531a1a6e9ac3df4ed549) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$this->disableCache();$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$this->addUpdatedElementId($v7057e8409c7c531a1a6e9ac3df4ed549);$this->forceCacheCleanup();if(!$v41275a535677f79ff347e01bc530c176->isAllowedObject($v41275a535677f79ff347e01bc530c176->getUserId(), $v7057e8409c7c531a1a6e9ac3df4ed549)) return false;if($v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy FORCE INDEX(rel) WHERE rel = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($vf36263a38d7de5cdaa953c1e2b2f79b5) = mysql_fetch_row($result)) {$v2da0d90fc7822dade6effbdd1f48b458 = $this->getElement($vf36263a38d7de5cdaa953c1e2b2f79b5, true, true);$this->delElement($vf36263a38d7de5cdaa953c1e2b2f79b5);$vb99eb979e6f6efabc396f777b503f7e7->del($vf36263a38d7de5cdaa953c1e2b2f79b5, "element");}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("hierarchyDeleteElement");$v4119639092e62c55ea8be348e4d9260d->setParam("element_id", $v7057e8409c7c531a1a6e9ac3df4ed549);$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsDeleted(true);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();unset($this->elements[$v7057e8409c7c531a1a6e9ac3df4ed549]);$vb99eb979e6f6efabc396f777b503f7e7->del($v7057e8409c7c531a1a6e9ac3df4ed549, "element");return true;}else {return false;}}public function copyElement($v7057e8409c7c531a1a6e9ac3df4ed549, $vd5d4bb9b2c282937ee64b1fb0495ef08, $v5972c4d2dc988e33130281251a6f282a = false) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$this->disableCache();cacheFrontend::getInstance()->flush();$this->misc_elements[] = $vd5d4bb9b2c282937ee64b1fb0495ef08;$this->misc_elements[] = $v7057e8409c7c531a1a6e9ac3df4ed549;$this->forceCacheCleanup();if($this->isExists($v7057e8409c7c531a1a6e9ac3df4ed549) && ($this->isExists($vd5d4bb9b2c282937ee64b1fb0495ef08) || $vd5d4bb9b2c282937ee64b1fb0495ef08 === 0)) {$vd5d4bb9b2c282937ee64b1fb0495ef08 = (int) $vd5d4bb9b2c282937ee64b1fb0495ef08;$vd7e6d55ba379a13d08c25d15faf2a23b = self::getTimeStamp();if($v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549)) {$this->misc_elements[] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();}$v9b207167e5381c47682c6b4f58a623fb = mysql_fetch_array(l_mysql_query('SELECT MAX(ord) FROM cms3_hierarchy', true));$v8bef1cc20ada3bef55fdf132cb2a1cb9 = $v9b207167e5381c47682c6b4f58a623fb[0]+1;$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL

INSERT INTO cms3_hierarchy
	(rel, type_id, lang_id, domain_id, tpl_id, obj_id, alt_name, is_active, is_visible, is_deleted, updatetime, ord)
		SELECT '{$vd5d4bb9b2c282937ee64b1fb0495ef08}', type_id, lang_id, domain_id, tpl_id, obj_id, alt_name, is_active, is_visible, is_deleted, '{$vd7e6d55ba379a13d08c25d15faf2a23b}', '{$v8bef1cc20ada3bef55fdf132cb2a1cb9}'
				FROM cms3_hierarchy WHERE id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}' LIMIT 1
SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v2114c8075d855b3cea53d5d880c68948 = $v7057e8409c7c531a1a6e9ac3df4ed549;$v7057e8409c7c531a1a6e9ac3df4ed549 = l_mysql_insert_id();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL

INSERT INTO cms3_permissions
	(level, owner_id, rel_id)
		SELECT level, owner_id, '{$v7057e8409c7c531a1a6e9ac3df4ed549}' FROM cms3_permissions WHERE rel_id = '{$v2114c8075d855b3cea53d5d880c68948}'

SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549)) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setAltName($v8e2dcfd7e7e24b1ca76c1193f645902b->getAltName());$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$this->buildRelationNewNodes($v7057e8409c7c531a1a6e9ac3df4ed549);if($v5972c4d2dc988e33130281251a6f282a) {$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();$vadce578d04ed03c31f6ac59451fcf8e4 = $this->getChilds($v2114c8075d855b3cea53d5d880c68948, true, true, 0, false, $v662cbf1253ac7d8750ed9190c52163e5);foreach($vadce578d04ed03c31f6ac59451fcf8e4 as $vf36263a38d7de5cdaa953c1e2b2f79b5 => $v1a13105b7e4eb5fb2e7c9515ac06aa48) {$this->copyElement($vf36263a38d7de5cdaa953c1e2b2f79b5, $v7057e8409c7c531a1a6e9ac3df4ed549, true);}}$this->misc_elements[] = $v7057e8409c7c531a1a6e9ac3df4ed549;return $v7057e8409c7c531a1a6e9ac3df4ed549;}else return false;}else return false;}public function cloneElement($v7057e8409c7c531a1a6e9ac3df4ed549, $vd5d4bb9b2c282937ee64b1fb0495ef08, $v5972c4d2dc988e33130281251a6f282a = false) {$this->disableCache();cacheFrontend::getInstance()->flush();$this->misc_elements[] = $vd5d4bb9b2c282937ee64b1fb0495ef08;$this->misc_elements[] = $v7057e8409c7c531a1a6e9ac3df4ed549;$this->forceCacheCleanup();if($this->isExists($v7057e8409c7c531a1a6e9ac3df4ed549) && ($this->isExists($vd5d4bb9b2c282937ee64b1fb0495ef08) || $vd5d4bb9b2c282937ee64b1fb0495ef08 === 0)) {if($v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549)) {$v8bef1cc20ada3bef55fdf132cb2a1cb9 = (int) $v8e2dcfd7e7e24b1ca76c1193f645902b->getOrd();}$this->misc_elements[] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();$v9b207167e5381c47682c6b4f58a623fb = mysql_fetch_array(l_mysql_query('SELECT MAX(ord) FROM cms3_hierarchy', true));$v8bef1cc20ada3bef55fdf132cb2a1cb9 = $v9b207167e5381c47682c6b4f58a623fb[0] + 1;$vaf31437ce61345f416579830a98c91e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getId();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO cms3_objects
	(name, is_locked, type_id, owner_id)
		SELECT name, is_locked, type_id, owner_id
			FROM cms3_objects
				WHERE id = '{$vaf31437ce61345f416579830a98c91e5}'
SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v5e3f5f5bf865de072ff1e4cd710d4a39 = l_mysql_insert_id();$v7ae7003da59ae71dcc9f8638ef50593d = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5)->getTypeId();$vd42aabe7af66a0f15fceb090a57335e0 = umiBranch::getBranchedTableByTypeId($v7ae7003da59ae71dcc9f8638ef50593d);$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO {$vd42aabe7af66a0f15fceb090a57335e0}
	(field_id, int_val, varchar_val, text_val, rel_val, float_val, tree_val, obj_id)
		SELECT field_id, int_val, varchar_val, text_val, rel_val, float_val, tree_val, '{$v5e3f5f5bf865de072ff1e4cd710d4a39}'
			FROM {$vd42aabe7af66a0f15fceb090a57335e0}
				WHERE obj_id = '{$vaf31437ce61345f416579830a98c91e5}'
SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vd7e6d55ba379a13d08c25d15faf2a23b = self::getTimeStamp();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL

INSERT INTO cms3_hierarchy
	(rel, type_id, lang_id, domain_id, tpl_id, obj_id, alt_name, is_active, is_visible, is_deleted, updatetime, ord)
		SELECT '{$vd5d4bb9b2c282937ee64b1fb0495ef08}', type_id, lang_id, domain_id, tpl_id, '{$v5e3f5f5bf865de072ff1e4cd710d4a39}', alt_name, is_active, is_visible, is_deleted, '{$vd7e6d55ba379a13d08c25d15faf2a23b}', '{$v8bef1cc20ada3bef55fdf132cb2a1cb9}'
				FROM cms3_hierarchy WHERE id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}' LIMIT 1
SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v2114c8075d855b3cea53d5d880c68948 = $v7057e8409c7c531a1a6e9ac3df4ed549;$v7057e8409c7c531a1a6e9ac3df4ed549 = l_mysql_insert_id();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL

INSERT INTO cms3_permissions
	(level, owner_id, rel_id)
		SELECT level, owner_id, '{$v7057e8409c7c531a1a6e9ac3df4ed549}' FROM cms3_permissions WHERE rel_id = '{$v2114c8075d855b3cea53d5d880c68948}'

SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549)) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setAltName($v8e2dcfd7e7e24b1ca76c1193f645902b->getAltName());$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$this->buildRelationNewNodes($v7057e8409c7c531a1a6e9ac3df4ed549);if($v5972c4d2dc988e33130281251a6f282a) {$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();$vadce578d04ed03c31f6ac59451fcf8e4 = $this->getChilds($v2114c8075d855b3cea53d5d880c68948, true, true, 0, false, $v662cbf1253ac7d8750ed9190c52163e5);foreach($vadce578d04ed03c31f6ac59451fcf8e4 as $vf36263a38d7de5cdaa953c1e2b2f79b5 => $v1a13105b7e4eb5fb2e7c9515ac06aa48) {$this->cloneElement($vf36263a38d7de5cdaa953c1e2b2f79b5, $v7057e8409c7c531a1a6e9ac3df4ed549, true);}}$this->misc_elements[] = $v7057e8409c7c531a1a6e9ac3df4ed549;return $v7057e8409c7c531a1a6e9ac3df4ed549;}else  return false;}}public function getDeletedList(&$vfbb44b4487415b134bce9c790a27fe5e = 0, $vaa9f73eea60a006820d0f8768bc8a3fc = 20, $v71860c77c6745379b0d44304d66b6a13 = 0) {$vaa9f73eea60a006820d0f8768bc8a3fc = intval($vaa9f73eea60a006820d0f8768bc8a3fc);$v7a86c157ee9713c34fbd7a1ee40f0c5a = intval($v71860c77c6745379b0d44304d66b6a13) * $vaa9f73eea60a006820d0f8768bc8a3fc;$v9b207167e5381c47682c6b4f58a623fb = array();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
				SELECT 
					SQL_CALC_FOUND_ROWS id
				FROM
					cms3_hierarchy
				WHERE
					is_deleted = '1'
				AND
					rel NOT IN (
						SELECT 
							id
						FROM
							cms3_hierarchy
						WHERE 
							is_deleted = '1'
						)
				ORDER BY
					updatetime DESC
				LIMIT 
					{$v7a86c157ee9713c34fbd7a1ee40f0c5a}, {$vaa9f73eea60a006820d0f8768bc8a3fc}
SQL;   $result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while($vb80bb7740288fda1f201890375a60c8f = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[] = $vb80bb7740288fda1f201890375a60c8f[0];}$ve7a14812bb869b6eddde74d7ca08b73f = <<<TOTALSQL
				SELECT FOUND_ROWS()
TOTALSQL;   $vb7769c022b6306209770b577a45687c5 = l_mysql_query($ve7a14812bb869b6eddde74d7ca08b73f);$v5e3c2c28612a5e919ff42a4776424005 = mysql_fetch_row($vb7769c022b6306209770b577a45687c5);if($v5e3c2c28612a5e919ff42a4776424005) {$vfbb44b4487415b134bce9c790a27fe5e = intval($v5e3c2c28612a5e919ff42a4776424005[0]);}return $v9b207167e5381c47682c6b4f58a623fb;}public function restoreElement($v7057e8409c7c531a1a6e9ac3df4ed549) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$this->disableCache();if($v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, false, true)) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsDeleted(false);$v8e2dcfd7e7e24b1ca76c1193f645902b->setAltName($v8e2dcfd7e7e24b1ca76c1193f645902b->getAltName());$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE rel = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($vf36263a38d7de5cdaa953c1e2b2f79b5) = mysql_fetch_row($result)) {$v2da0d90fc7822dade6effbdd1f48b458 = $this->getElement($vf36263a38d7de5cdaa953c1e2b2f79b5, true, true);$this->restoreElement($vf36263a38d7de5cdaa953c1e2b2f79b5);}return true;}else return false;}public function removeDeletedElement($v7057e8409c7c531a1a6e9ac3df4ed549, &$v2bdedf5ebd33ff699be1ea17808150d4 = 0) {$this->disableCache();if($v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true, true)) {if($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsDeleted()) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$vaf31437ce61345f416579830a98c91e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectId();$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE rel = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($vf36263a38d7de5cdaa953c1e2b2f79b5) = mysql_fetch_row($result)) {$v2da0d90fc7822dade6effbdd1f48b458 = $this->getElement($vf36263a38d7de5cdaa953c1e2b2f79b5, true, true);$v2da0d90fc7822dade6effbdd1f48b458->setIsDeleted(true);$v2da0d90fc7822dade6effbdd1f48b458->commit();$this->removeDeletedElement($vf36263a38d7de5cdaa953c1e2b2f79b5, $v2bdedf5ebd33ff699be1ea17808150d4);}$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_hierarchy WHERE id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}' LIMIT 1";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);unset($v8e2dcfd7e7e24b1ca76c1193f645902b);unset($this->elements[$v7057e8409c7c531a1a6e9ac3df4ed549]);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_hierarchy WHERE obj_id = '{$vaf31437ce61345f416579830a98c91e5}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result)) {if($v4a8a08f09d37b73795649038408b5f33 == 0) {$v5891da2d64975cae48d175d1e001f5da->delObject($vaf31437ce61345f416579830a98c91e5);}}$this->earseRelationNodes($v7057e8409c7c531a1a6e9ac3df4ed549);$v2bdedf5ebd33ff699be1ea17808150d4 ++;return true;}else return false;}else return false;}public function removeDeletedAll() {$this->disableCache();l_mysql_query("START TRANSACTION /* umiHierarchy::removeDeletedAll() */");$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE is_deleted = '1'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v7057e8409c7c531a1a6e9ac3df4ed549) = mysql_fetch_row($result)) {$this->removeDeletedElement($v7057e8409c7c531a1a6e9ac3df4ed549);}l_mysql_query("COMMIT");return true;}public function removeDeletedWithLimit($vaa9f73eea60a006820d0f8768bc8a3fc = false) {if(empty($vaa9f73eea60a006820d0f8768bc8a3fc)) {$vaa9f73eea60a006820d0f8768bc8a3fc = 100;}$vaa9f73eea60a006820d0f8768bc8a3fc = (int) $vaa9f73eea60a006820d0f8768bc8a3fc;$this->disableCache();l_mysql_query("START TRANSACTION /* umiHierarchy::removeDeletedWithLimit() */");$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE is_deleted = '1' LIMIT ".$vaa9f73eea60a006820d0f8768bc8a3fc;$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v2bdedf5ebd33ff699be1ea17808150d4 = 0;while(list($v7057e8409c7c531a1a6e9ac3df4ed549) = mysql_fetch_row($result)) {$this->removeDeletedElement($v7057e8409c7c531a1a6e9ac3df4ed549, $v2bdedf5ebd33ff699be1ea17808150d4);}l_mysql_query("COMMIT");return $v2bdedf5ebd33ff699be1ea17808150d4;}public function getParent($v7057e8409c7c531a1a6e9ac3df4ed549) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT rel FROM cms3_hierarchy WHERE id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(mysql_num_rows($result)) {list($v6be379826b20cc58475f636e33f4606b) = mysql_fetch_row($result);$this->misc_elements[] = $v6be379826b20cc58475f636e33f4606b;mysql_freeresult($result);return (int) $v6be379826b20cc58475f636e33f4606b;}else {mysql_freeresult($result);return false;}}public function getAllParents($v7057e8409c7c531a1a6e9ac3df4ed549, $vd0e8988bcdf8745f43ea50ef3e1b54b2 = false, $vece42746c2b3aa1e585809fa739602ae = false) {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$vc68ad910ed49ac65f21f1bf2c5dbf912 = array();$v248064bbf6355f96570c9a17b0b1f781 = $vb99eb979e6f6efabc396f777b503f7e7->loadSql('hierarchy_parents');if(is_array($v248064bbf6355f96570c9a17b0b1f781) && sizeof($v248064bbf6355f96570c9a17b0b1f781)) {$this->parentsCache = $v248064bbf6355f96570c9a17b0b1f781;}if(!$vece42746c2b3aa1e585809fa739602ae && isset($this->parentsCache[$v7057e8409c7c531a1a6e9ac3df4ed549])) {$vc68ad910ed49ac65f21f1bf2c5dbf912 = $this->parentsCache[$v7057e8409c7c531a1a6e9ac3df4ed549];}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT rel_id FROM cms3_hierarchy_relations WHERE child_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}' ORDER BY id";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v6be379826b20cc58475f636e33f4606b) = mysql_fetch_row($result)) {$vc68ad910ed49ac65f21f1bf2c5dbf912[] = (int) $v6be379826b20cc58475f636e33f4606b;}$this->parentsCache[$v7057e8409c7c531a1a6e9ac3df4ed549] = $vc68ad910ed49ac65f21f1bf2c5dbf912;$vb99eb979e6f6efabc396f777b503f7e7->saveSql('hierarchy_parents', $this->parentsCache, 120);}if($vd0e8988bcdf8745f43ea50ef3e1b54b2) {$vc68ad910ed49ac65f21f1bf2c5dbf912[] = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;}return $vc68ad910ed49ac65f21f1bf2c5dbf912;}public function getChilds($v7057e8409c7c531a1a6e9ac3df4ed549, $v69077352f5ac48235305c08dd983bf9f = true, $vbdbeb3b037059befbd5195fe4863ac5e = true, $v12a055bf01a31369fe81ac35d85c7bc1 = 0, $v0715f6d9497f93911417c9c324265771 = false, $v72ee76c5c29383b7c9f9225c1fa4d10b = false, $vf585b7f018bb4ced15a03683a733e50b = false) {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$v69077352f5ac48235305c08dd983bf9f = (int) $v69077352f5ac48235305c08dd983bf9f;$vbdbeb3b037059befbd5195fe4863ac5e = (int) $vbdbeb3b037059befbd5195fe4863ac5e;$v0715f6d9497f93911417c9c324265771 = (int) $v0715f6d9497f93911417c9c324265771;if (!$vf585b7f018bb4ced15a03683a733e50b) $vf585b7f018bb4ced15a03683a733e50b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();$v662cbf1253ac7d8750ed9190c52163e5 = ($v72ee76c5c29383b7c9f9225c1fa4d10b) ? $v72ee76c5c29383b7c9f9225c1fa4d10b : $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();$vee90edc893b714c546b99fe996ebd90d = ($v7057e8409c7c531a1a6e9ac3df4ed549 > 0) ? "" : " AND h.domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $v41275a535677f79ff347e01bc530c176->getUserId();$ve6f9f41f5312cc3f7302c1a2687fc264 = $v41275a535677f79ff347e01bc530c176->isSv($v8e44f0089b076e18a718eb9ca3d94674);$v5cfe921b204e2c73f8afbec7c4b9ac54 = $v41275a535677f79ff347e01bc530c176->makeSqlWhere($v8e44f0089b076e18a718eb9ca3d94674);$v9b207167e5381c47682c6b4f58a623fb = array();$vc561c84df7b4640190f8290b973108e1 = ($v7057e8409c7c531a1a6e9ac3df4ed549) ? "= '{$v7057e8409c7c531a1a6e9ac3df4ed549}'" : "IS NULL";$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT hr.child_id, h.rel, cp.level FROM cms3_hierarchy_relations hr, cms3_permissions cp, cms3_hierarchy h WHERE hr.rel_id {$vc561c84df7b4640190f8290b973108e1} AND h.id = hr.child_id {$vee90edc893b714c546b99fe996ebd90d} AND h.lang_id = '{$vf585b7f018bb4ced15a03683a733e50b}' AND h.is_deleted = '0'";if($ve6f9f41f5312cc3f7302c1a2687fc264) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT hr.child_id, h.rel, 2 FROM cms3_hierarchy_relations hr, cms3_hierarchy h WHERE hr.rel_id {$vc561c84df7b4640190f8290b973108e1} AND h.id = hr.child_id {$vee90edc893b714c546b99fe996ebd90d} AND h.lang_id = '{$vf585b7f018bb4ced15a03683a733e50b}' AND h.is_deleted = '0'";}if(!$v69077352f5ac48235305c08dd983bf9f) $vac5c74b64b4b8352ef2f181affb5ac2a .= " AND h.is_active = '1'";if(!$vbdbeb3b037059befbd5195fe4863ac5e) $vac5c74b64b4b8352ef2f181affb5ac2a .= " AND h.is_visible = '1'";if($v0715f6d9497f93911417c9c324265771) $vac5c74b64b4b8352ef2f181affb5ac2a .= " AND h.type_id = '{$v0715f6d9497f93911417c9c324265771}'";if(!$ve6f9f41f5312cc3f7302c1a2687fc264) {$vac5c74b64b4b8352ef2f181affb5ac2a .= " AND (cp.rel_id = h.id AND {$v5cfe921b204e2c73f8afbec7c4b9ac54} AND cp.level > 0)";}if($v12a055bf01a31369fe81ac35d85c7bc1) {if($v7057e8409c7c531a1a6e9ac3df4ed549) {$result = l_mysql_query("SELECT level FROM cms3_hierarchy_relations WHERE child_id = {$v7057e8409c7c531a1a6e9ac3df4ed549}");if(mysql_num_rows($result)) {list($vc9e9a848920877e76685b2e4e76de38d) = mysql_fetch_row($result);$vc9e9a848920877e76685b2e4e76de38d += $v12a055bf01a31369fe81ac35d85c7bc1;}else {return false;}}else {$vc9e9a848920877e76685b2e4e76de38d = $v12a055bf01a31369fe81ac35d85c7bc1;}$vac5c74b64b4b8352ef2f181affb5ac2a .= " AND hr.level <= '{$vc9e9a848920877e76685b2e4e76de38d}'";}$vac5c74b64b4b8352ef2f181affb5ac2a .= " ORDER BY hr.level, h.ord";if($v9b207167e5381c47682c6b4f58a623fb = $vb99eb979e6f6efabc396f777b503f7e7->loadSql($vac5c74b64b4b8352ef2f181affb5ac2a)) {foreach($v9b207167e5381c47682c6b4f58a623fb[1] as $v7552cd149af7495ee7d8225974e50f80 => $vc9e9a848920877e76685b2e4e76de38d) {$v41275a535677f79ff347e01bc530c176->pushElementPermissions($v7552cd149af7495ee7d8225974e50f80, $vc9e9a848920877e76685b2e4e76de38d);}return $v9b207167e5381c47682c6b4f58a623fb[0];}$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vd22bbd30e009c5a782250725e19d22f2 = $v4051c8368d6b69eca174681d8daf0bf1 = $v9b207167e5381c47682c6b4f58a623fb = array();while(list($vf36263a38d7de5cdaa953c1e2b2f79b5, $vd5d4bb9b2c282937ee64b1fb0495ef08, $vc9e9a848920877e76685b2e4e76de38d) = mysql_fetch_row($result)) {$v41275a535677f79ff347e01bc530c176->pushElementPermissions($vf36263a38d7de5cdaa953c1e2b2f79b5, $vc9e9a848920877e76685b2e4e76de38d);$vd22bbd30e009c5a782250725e19d22f2[$vf36263a38d7de5cdaa953c1e2b2f79b5] = array();if($vd5d4bb9b2c282937ee64b1fb0495ef08 == $v7057e8409c7c531a1a6e9ac3df4ed549) {$v9b207167e5381c47682c6b4f58a623fb[$vf36263a38d7de5cdaa953c1e2b2f79b5] = &$vd22bbd30e009c5a782250725e19d22f2[$vf36263a38d7de5cdaa953c1e2b2f79b5];}if(isset($vd22bbd30e009c5a782250725e19d22f2[$vd5d4bb9b2c282937ee64b1fb0495ef08])) {$vd22bbd30e009c5a782250725e19d22f2[$vd5d4bb9b2c282937ee64b1fb0495ef08][$vf36263a38d7de5cdaa953c1e2b2f79b5] = &$vd22bbd30e009c5a782250725e19d22f2[$vf36263a38d7de5cdaa953c1e2b2f79b5];}$v4051c8368d6b69eca174681d8daf0bf1[$vf36263a38d7de5cdaa953c1e2b2f79b5] = $vc9e9a848920877e76685b2e4e76de38d;}$vb99eb979e6f6efabc396f777b503f7e7->saveSql($vac5c74b64b4b8352ef2f181affb5ac2a, array($v9b207167e5381c47682c6b4f58a623fb, $v4051c8368d6b69eca174681d8daf0bf1), 60);return $v9b207167e5381c47682c6b4f58a623fb;}public function getChildIds($v7057e8409c7c531a1a6e9ac3df4ed549, $v69077352f5ac48235305c08dd983bf9f = true, $vbdbeb3b037059befbd5195fe4863ac5e = true, $v0715f6d9497f93911417c9c324265771 = false, $v72ee76c5c29383b7c9f9225c1fa4d10b = false, $vd0e8988bcdf8745f43ea50ef3e1b54b2 = false, $vf585b7f018bb4ced15a03683a733e50b = false) {$va71e0fa4ca3616733f509b09bbe8b567 = array();if($vd0e8988bcdf8745f43ea50ef3e1b54b2) $va71e0fa4ca3616733f509b09bbe8b567[] = $v7057e8409c7c531a1a6e9ac3df4ed549;$vadce578d04ed03c31f6ac59451fcf8e4 = $this->getChilds($v7057e8409c7c531a1a6e9ac3df4ed549, $v69077352f5ac48235305c08dd983bf9f, $vbdbeb3b037059befbd5195fe4863ac5e, 1, $v0715f6d9497f93911417c9c324265771, $v72ee76c5c29383b7c9f9225c1fa4d10b, $vf585b7f018bb4ced15a03683a733e50b);if ($vadce578d04ed03c31f6ac59451fcf8e4 === false) return $va71e0fa4ca3616733f509b09bbe8b567;foreach ($vadce578d04ed03c31f6ac59451fcf8e4 as $vf4f40123eb510dd3290125b38f4eb898 => $v2063c1608d6e0baf80249c42e2be5804) {$va71e0fa4ca3616733f509b09bbe8b567 = array_merge($va71e0fa4ca3616733f509b09bbe8b567, $this->getChildIds($vf4f40123eb510dd3290125b38f4eb898, $v69077352f5ac48235305c08dd983bf9f, $vbdbeb3b037059befbd5195fe4863ac5e, $v0715f6d9497f93911417c9c324265771, $v72ee76c5c29383b7c9f9225c1fa4d10b, true, $vf585b7f018bb4ced15a03683a733e50b));}$va71e0fa4ca3616733f509b09bbe8b567 = array_unique($va71e0fa4ca3616733f509b09bbe8b567);return $va71e0fa4ca3616733f509b09bbe8b567;}public function getChildsCount($v7057e8409c7c531a1a6e9ac3df4ed549, $v69077352f5ac48235305c08dd983bf9f = true, $vbdbeb3b037059befbd5195fe4863ac5e = true, $v12a055bf01a31369fe81ac35d85c7bc1 = 0, $v0715f6d9497f93911417c9c324265771 = false, $v72ee76c5c29383b7c9f9225c1fa4d10b = false) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$v69077352f5ac48235305c08dd983bf9f = (int) $v69077352f5ac48235305c08dd983bf9f;$vbdbeb3b037059befbd5195fe4863ac5e = (int) $vbdbeb3b037059befbd5195fe4863ac5e;$v0715f6d9497f93911417c9c324265771 = (int) $v0715f6d9497f93911417c9c324265771;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$v662cbf1253ac7d8750ed9190c52163e5 = ($v72ee76c5c29383b7c9f9225c1fa4d10b) ? $v72ee76c5c29383b7c9f9225c1fa4d10b : cmsController::getInstance()->getCurrentDomain()->getId();if($v7057e8409c7c531a1a6e9ac3df4ed549) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();}}$vee90edc893b714c546b99fe996ebd90d = ($v7057e8409c7c531a1a6e9ac3df4ed549 > 0) ? "" : " AND h.domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";$v9b207167e5381c47682c6b4f58a623fb = array();$vc561c84df7b4640190f8290b973108e1 = ($v7057e8409c7c531a1a6e9ac3df4ed549) ? "= '{$v7057e8409c7c531a1a6e9ac3df4ed549}'" : "IS NULL";$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(hr.child_id) FROM cms3_hierarchy_relations hr, cms3_hierarchy h WHERE hr.rel_id {$vc561c84df7b4640190f8290b973108e1} AND h.id = hr.child_id {$vee90edc893b714c546b99fe996ebd90d} AND h.lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND h.is_deleted = '0'";if(!$v69077352f5ac48235305c08dd983bf9f) $vac5c74b64b4b8352ef2f181affb5ac2a .= " AND h.is_active = '1'";if(!$vbdbeb3b037059befbd5195fe4863ac5e) $vac5c74b64b4b8352ef2f181affb5ac2a .= " AND h.is_visible = '1'";if($v0715f6d9497f93911417c9c324265771) $vac5c74b64b4b8352ef2f181affb5ac2a .= " AND h.type_id = '{$v0715f6d9497f93911417c9c324265771}'";if($v12a055bf01a31369fe81ac35d85c7bc1) {if($v7057e8409c7c531a1a6e9ac3df4ed549) {list($vc9e9a848920877e76685b2e4e76de38d) = mysql_fetch_row(l_mysql_query("SELECT level FROM cms3_hierarchy_relations WHERE child_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'"));$vc9e9a848920877e76685b2e4e76de38d = $v12a055bf01a31369fe81ac35d85c7bc1 + $vc9e9a848920877e76685b2e4e76de38d;}else {$vc9e9a848920877e76685b2e4e76de38d = 1;}$vac5c74b64b4b8352ef2f181affb5ac2a .= " AND hr.level <= '{$vc9e9a848920877e76685b2e4e76de38d}'";}$vac5c74b64b4b8352ef2f181affb5ac2a .= " ORDER BY hr.level, h.ord";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(mysql_num_rows($result)) {list($ve2942a04780e223b215eb8b663cf5353) = mysql_fetch_row($result);return $ve2942a04780e223b215eb8b663cf5353;}else {return false;}}public function forceAbsolutePath($vf9448cc5666e281bc210298b60567801 = true) {$v8123ef13520d88a438e469cc8a7ab63b = $this->bForceAbsolutePath;$this->bForceAbsolutePath = (bool) $vf9448cc5666e281bc210298b60567801;return $v8123ef13520d88a438e469cc8a7ab63b;}public function getPathById($v7552cd149af7495ee7d8225974e50f80, $v5cd943c36b800237522c35155d898244 = false, $vbc9ecd0be77ceffa51fc6918c714e5d3 = false, $vece42746c2b3aa1e585809fa739602ae = false, $vbddb263f3f2e04e36c5d07d938f2818f = false) {$v7552cd149af7495ee7d8225974e50f80 = (int) $v7552cd149af7495ee7d8225974e50f80;$ve61c6daf47866cf4bb3def0e21054379 = $v7552cd149af7495ee7d8225974e50f80 . '#' . intval($v5cd943c36b800237522c35155d898244) . intval($vbc9ecd0be77ceffa51fc6918c714e5d3) . intval($vbddb263f3f2e04e36c5d07d938f2818f) . '#' . $this->bForceAbsolutePath;if (!$vece42746c2b3aa1e585809fa739602ae && isset($this->pathCache[$ve61c6daf47866cf4bb3def0e21054379])) {return $this->pathCache[$ve61c6daf47866cf4bb3def0e21054379];}$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$ve4e46deb7f9cc58c7abfb32e5570b6f3 = domainsCollection::getInstance();$v5a05866850c28651fe234659f6c92ada = langsCollection::getInstance();$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$vb4d8a0aedc43ad7b7ce2df2601a8c6af = $v8b1dc169bf460ee884fceef66c6607d6->getUrlPrefix();if ($v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80, true)) {$vf6afee894b3508441e878b464a92f4b0 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain();$vcb034e2873d007d1d03631ffa7dfd179 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();if(!$this->bForceAbsolutePath && $vf6afee894b3508441e878b464a92f4b0->getId() == $vcb034e2873d007d1d03631ffa7dfd179) {$vf5198af86a057f6504358afe85f08f0e = "";}else {$vf5198af86a057f6504358afe85f08f0e = "http://" . $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomain($vcb034e2873d007d1d03631ffa7dfd179)->getHost();}$v490bd131d955e14a2306bc3ec932e114 = intval($v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId());$vc025af2134befadeae3d5aa74045bb62 = $v5a05866850c28651fe234659f6c92ada->getLang($v490bd131d955e14a2306bc3ec932e114);$vc316baa776d6bafe947518a7eecd3cc5 = ($v490bd131d955e14a2306bc3ec932e114 === intval($v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getDefaultLangId()));$v0b925fa76ce9952e77f1f306dd8b6bb8 = (!$vc025af2134befadeae3d5aa74045bb62 || $vc316baa776d6bafe947518a7eecd3cc5 || $v5cd943c36b800237522c35155d898244 == true) ? "" : "/" . $vc025af2134befadeae3d5aa74045bb62->getPrefix();if($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsDefault() && !$vbc9ecd0be77ceffa51fc6918c714e5d3) {return $this->pathCache[$ve61c6daf47866cf4bb3def0e21054379] = $vf5198af86a057f6504358afe85f08f0e . $v0b925fa76ce9952e77f1f306dd8b6bb8 . $vb4d8a0aedc43ad7b7ce2df2601a8c6af . '/';}}else {return $this->pathCache[$ve61c6daf47866cf4bb3def0e21054379] = "";}if ($vc68ad910ed49ac65f21f1bf2c5dbf912 = $this->getAllParents($v7552cd149af7495ee7d8225974e50f80, false, $vece42746c2b3aa1e585809fa739602ae)) {$vd6fe1d0be6347b8ef2427fa629c04485 = $vf5198af86a057f6504358afe85f08f0e . $v0b925fa76ce9952e77f1f306dd8b6bb8 . $vb4d8a0aedc43ad7b7ce2df2601a8c6af;$vc68ad910ed49ac65f21f1bf2c5dbf912[] = $v7552cd149af7495ee7d8225974e50f80;$v9199efdc2e31629bd5956c3cdb15e609 = array();foreach ($vc68ad910ed49ac65f21f1bf2c5dbf912 as $vbfa030fe63bacd523dd70a76cfaed98a) {if($vbfa030fe63bacd523dd70a76cfaed98a == 0) continue;if (!$vece42746c2b3aa1e585809fa739602ae && isset($this->pathPiecesCache[$vbfa030fe63bacd523dd70a76cfaed98a])) continue;if($this->isLoaded($vbfa030fe63bacd523dd70a76cfaed98a) && $vd0e45878043844ffc41aac437e86b602 = $this->getElement($vbfa030fe63bacd523dd70a76cfaed98a, true)) {$this->pathPiecesCache[$vbfa030fe63bacd523dd70a76cfaed98a] = $vd0e45878043844ffc41aac437e86b602->getAltName();}else {$v9199efdc2e31629bd5956c3cdb15e609[] = $vbfa030fe63bacd523dd70a76cfaed98a;}}if (count($v9199efdc2e31629bd5956c3cdb15e609)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, alt_name FROM cms3_hierarchy WHERE id IN (" . implode(", ", $v9199efdc2e31629bd5956c3cdb15e609) . ")";$vd2bdf98f906ac8b3f641d40000c97caa = !$vece42746c2b3aa1e585809fa739602ae ? $vb99eb979e6f6efabc396f777b503f7e7->loadSql($vac5c74b64b4b8352ef2f181affb5ac2a) : null;if(!is_array($vd2bdf98f906ac8b3f641d40000c97caa)) {$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vd2bdf98f906ac8b3f641d40000c97caa = array();while(list($vb80bb7740288fda1f201890375a60c8f, $v0330da281541887f65b0a60066351c91) = mysql_fetch_row($result)) {$vd2bdf98f906ac8b3f641d40000c97caa[$vb80bb7740288fda1f201890375a60c8f] = $v0330da281541887f65b0a60066351c91;$this->pathPiecesCache[$vb80bb7740288fda1f201890375a60c8f] = $v0330da281541887f65b0a60066351c91;}$vb99eb979e6f6efabc396f777b503f7e7->saveSql($vac5c74b64b4b8352ef2f181affb5ac2a, $vd2bdf98f906ac8b3f641d40000c97caa, 600);}else {$this->pathPiecesCache = $this->pathPiecesCache + $vd2bdf98f906ac8b3f641d40000c97caa;}}$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($vc68ad910ed49ac65f21f1bf2c5dbf912);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {if (!$vc68ad910ed49ac65f21f1bf2c5dbf912[$v865c0c0b4ab0e063e5caa3387c1a8741]) continue;if (isset($this->pathPiecesCache[$vc68ad910ed49ac65f21f1bf2c5dbf912[$v865c0c0b4ab0e063e5caa3387c1a8741]])) {$vd6fe1d0be6347b8ef2427fa629c04485 .= "/" . $this->pathPiecesCache[$vc68ad910ed49ac65f21f1bf2c5dbf912[$v865c0c0b4ab0e063e5caa3387c1a8741]];}}if ($v2245023265ae4cf87d02c8b6ba991139->get('seo', 'url-suffix.add') && !$vbddb263f3f2e04e36c5d07d938f2818f) {$vd6fe1d0be6347b8ef2427fa629c04485 .= $v2245023265ae4cf87d02c8b6ba991139->get('seo', 'url-suffix');}return $this->pathCache[$ve61c6daf47866cf4bb3def0e21054379] = $vd6fe1d0be6347b8ef2427fa629c04485;}else {return $this->pathCache[$ve61c6daf47866cf4bb3def0e21054379] = false;}}public function getIdByPath($v84d8c2148d233e7430fceb3f20ae3314, $vda936bf93b2dd512e0554fd9eb7b4120 = false, &$v3dbd53d892aaea70c9f5fefc18fc7e4c = 0, $v662cbf1253ac7d8750ed9190c52163e5 = false, $v78e6dd7a49f5b0cb2106a3a434dd5c86 = false) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = (int) $v78e6dd7a49f5b0cb2106a3a434dd5c86;$v662cbf1253ac7d8750ed9190c52163e5 = (int) $v662cbf1253ac7d8750ed9190c52163e5;if($v5f44c555cfb3ecb28f624fa95617f277 = mainConfiguration::getInstance()->get('seo', 'url-suffix')){$v5e0bdcbddccca4d66d74ba8c1cee1a68 = strrpos($v84d8c2148d233e7430fceb3f20ae3314, $v5f44c555cfb3ecb28f624fa95617f277);if ($v5e0bdcbddccca4d66d74ba8c1cee1a68 && ($v5e0bdcbddccca4d66d74ba8c1cee1a68 + strlen($v5f44c555cfb3ecb28f624fa95617f277) == strlen($v84d8c2148d233e7430fceb3f20ae3314))) {$v84d8c2148d233e7430fceb3f20ae3314 = substr($v84d8c2148d233e7430fceb3f20ae3314, 0, $v5e0bdcbddccca4d66d74ba8c1cee1a68);}}$v84d8c2148d233e7430fceb3f20ae3314 = trim($v84d8c2148d233e7430fceb3f20ae3314, "\/ \n");$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if(empty($v78e6dd7a49f5b0cb2106a3a434dd5c86)) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();}if(empty( $v662cbf1253ac7d8750ed9190c52163e5)) {$v662cbf1253ac7d8750ed9190c52163e5 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();}$v143e21b64126735544d3142d33aa4bbe = md5( $v662cbf1253ac7d8750ed9190c52163e5.":".$v78e6dd7a49f5b0cb2106a3a434dd5c86.":".$v84d8c2148d233e7430fceb3f20ae3314 );if(isset($this->idByPathCache[$v143e21b64126735544d3142d33aa4bbe])) {return $this->idByPathCache[$v143e21b64126735544d3142d33aa4bbe];}$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();if($vb80bb7740288fda1f201890375a60c8f = $vb99eb979e6f6efabc396f777b503f7e7->loadSql($v143e21b64126735544d3142d33aa4bbe . "_path")) {return $vb80bb7740288fda1f201890375a60c8f;}if($v84d8c2148d233e7430fceb3f20ae3314 == "") {return $this->idByPathCache[$v143e21b64126735544d3142d33aa4bbe] = $this->getDefaultElementId($v78e6dd7a49f5b0cb2106a3a434dd5c86, $v662cbf1253ac7d8750ed9190c52163e5);}$ve4e46deb7f9cc58c7abfb32e5570b6f3 = domainsCollection::getInstance();$v13872c0118a4316afd1e99295017d654 = explode("/", $v84d8c2148d233e7430fceb3f20ae3314);$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v13872c0118a4316afd1e99295017d654);$vb80bb7740288fda1f201890375a60c8f = 0;for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vd84ff935144e00c3e1d395c2379aca47 = $v13872c0118a4316afd1e99295017d654[$v865c0c0b4ab0e063e5caa3387c1a8741];$vd84ff935144e00c3e1d395c2379aca47 = l_mysql_real_escape_string($vd84ff935144e00c3e1d395c2379aca47);if($v865c0c0b4ab0e063e5caa3387c1a8741 == 0) {if($v3c2d776e82f7716166c1c2183822a04b = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomainId($vd84ff935144e00c3e1d395c2379aca47)) {$v662cbf1253ac7d8750ed9190c52163e5 = $v3c2d776e82f7716166c1c2183822a04b;continue;}}if($vda936bf93b2dd512e0554fd9eb7b4120) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE rel = '{$vb80bb7740288fda1f201890375a60c8f}' AND alt_name = '{$vd84ff935144e00c3e1d395c2379aca47}' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE rel = '{$vb80bb7740288fda1f201890375a60c8f}' AND alt_name = '{$vd84ff935144e00c3e1d395c2379aca47}' AND is_active='1' AND is_deleted = '0' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";}$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(!mysql_num_rows($result)) {if($vda936bf93b2dd512e0554fd9eb7b4120) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, alt_name FROM cms3_hierarchy WHERE rel = '{$vb80bb7740288fda1f201890375a60c8f}' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, alt_name FROM cms3_hierarchy WHERE rel = '{$vb80bb7740288fda1f201890375a60c8f}' AND is_active = '1' AND is_deleted = '0' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";}$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v2ffe4e77325d9a7152f7086ea7aa5114 = 0;$vb6b6e66c9db093b3c4c8800ac9365830 = 0;$v1a1cc17b4341344c0ceec516de628da3 = 0;while(list($vb6b6e66c9db093b3c4c8800ac9365830, $v423b21e5932f11b123a1ddb35654b51b) = mysql_fetch_row($result)) {if($this->autocorrectionDisabled) {if($vd84ff935144e00c3e1d395c2379aca47 == $v423b21e5932f11b123a1ddb35654b51b) {$v1a1cc17b4341344c0ceec516de628da3 = $vb6b6e66c9db093b3c4c8800ac9365830;}}else {$v3d801aa532c1cec3ee82d87a99fdf63f = umiHierarchy::compareStrings($vd84ff935144e00c3e1d395c2379aca47, $v423b21e5932f11b123a1ddb35654b51b);if($v3d801aa532c1cec3ee82d87a99fdf63f > $v2ffe4e77325d9a7152f7086ea7aa5114) {$v2ffe4e77325d9a7152f7086ea7aa5114 = $v3d801aa532c1cec3ee82d87a99fdf63f;$v1a1cc17b4341344c0ceec516de628da3 = $vb6b6e66c9db093b3c4c8800ac9365830;++$v3dbd53d892aaea70c9f5fefc18fc7e4c;}}}if($v2ffe4e77325d9a7152f7086ea7aa5114 > 75) {$vb80bb7740288fda1f201890375a60c8f = $v1a1cc17b4341344c0ceec516de628da3;}else {return $this->idByPathCache[$v143e21b64126735544d3142d33aa4bbe] = false;}}else {if(!(list($vb80bb7740288fda1f201890375a60c8f) = mysql_fetch_row($result))) {return $this->idByPathCache[$v143e21b64126735544d3142d33aa4bbe] = false;}}}$vb99eb979e6f6efabc396f777b503f7e7->saveSql($v143e21b64126735544d3142d33aa4bbe . "_path", $vb80bb7740288fda1f201890375a60c8f, 3600);return $this->idByPathCache[$v143e21b64126735544d3142d33aa4bbe] = $vb80bb7740288fda1f201890375a60c8f;}public function addElement($vd5d4bb9b2c282937ee64b1fb0495ef08, $v0715f6d9497f93911417c9c324265771, $vb068931cc450442b63f5b3d276ea4297, $vd84ff935144e00c3e1d395c2379aca47, $v94757cae63fd3e398c0811a976dd6bbe = false, $v662cbf1253ac7d8750ed9190c52163e5 = false, $v78e6dd7a49f5b0cb2106a3a434dd5c86 = false, $vd02e12eb6d6c3f6ebd763197df01e211 = false) {$this->disableCache();$vd5d4bb9b2c282937ee64b1fb0495ef08 = (int) $vd5d4bb9b2c282937ee64b1fb0495ef08;$v662cbf1253ac7d8750ed9190c52163e5 = (int) $v662cbf1253ac7d8750ed9190c52163e5;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = (int) $v78e6dd7a49f5b0cb2106a3a434dd5c86;$vd02e12eb6d6c3f6ebd763197df01e211 = (int) $vd02e12eb6d6c3f6ebd763197df01e211;$vb946c44d711ade3b061653732977d043 = null;if($v94757cae63fd3e398c0811a976dd6bbe === false) {if($vb946c44d711ade3b061653732977d043 = umiHierarchyTypesCollection::getInstance()->getType($v0715f6d9497f93911417c9c324265771)) {$v94757cae63fd3e398c0811a976dd6bbe = umiObjectTypesCollection::getInstance()->getBaseType($vb946c44d711ade3b061653732977d043->getName(), $vb946c44d711ade3b061653732977d043->getExt());if(!$v94757cae63fd3e398c0811a976dd6bbe) {throw new coreException("There is no base object type for hierarchy type #{$v0715f6d9497f93911417c9c324265771}");return false;}}}else {$v7ae7003da59ae71dcc9f8638ef50593d = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);if (!$v7ae7003da59ae71dcc9f8638ef50593d) {throw new coreException("Wrong object type id given");return false;}$v0715f6d9497f93911417c9c324265771 = $v7ae7003da59ae71dcc9f8638ef50593d->getHierarchyTypeId();$vb946c44d711ade3b061653732977d043 = umiHierarchyTypesCollection::getInstance()->getType($v0715f6d9497f93911417c9c324265771);}if (!$vb946c44d711ade3b061653732977d043 instanceof umiHierarchyType) {throw new coreException("Cannot detect hierarchy type");return false;}$vd0e45878043844ffc41aac437e86b602 = null;if(!$v662cbf1253ac7d8750ed9190c52163e5) {if($vd5d4bb9b2c282937ee64b1fb0495ef08 == 0) {$v662cbf1253ac7d8750ed9190c52163e5 = cmsController::getInstance()->getCurrentDomain()->getId();}else {$vd0e45878043844ffc41aac437e86b602 = $this->getElement($vd5d4bb9b2c282937ee64b1fb0495ef08, true, true);$v662cbf1253ac7d8750ed9190c52163e5 = $vd0e45878043844ffc41aac437e86b602->getDomainId();}}if(!$v78e6dd7a49f5b0cb2106a3a434dd5c86) {if($vd5d4bb9b2c282937ee64b1fb0495ef08 == 0) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();}else {if(!$vd0e45878043844ffc41aac437e86b602) $vd0e45878043844ffc41aac437e86b602 = $this->getElement($vd5d4bb9b2c282937ee64b1fb0495ef08, true, true);$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $vd0e45878043844ffc41aac437e86b602->getLangId();}}if(!$vd02e12eb6d6c3f6ebd763197df01e211) {$vd02e12eb6d6c3f6ebd763197df01e211 = templatesCollection::getInstance()->getHierarchyTypeTemplate($vb946c44d711ade3b061653732977d043->getName(), $vb946c44d711ade3b061653732977d043->getExt());if($vd02e12eb6d6c3f6ebd763197df01e211 === false) {$vd02e12eb6d6c3f6ebd763197df01e211 = $this->getDominantTplId($vd5d4bb9b2c282937ee64b1fb0495ef08);if(!$vd02e12eb6d6c3f6ebd763197df01e211) {$v4f2afc9c4099ee1f39c9f551123e54bd = templatesCollection::getInstance()->getDefaultTemplate($v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);if (!$v4f2afc9c4099ee1f39c9f551123e54bd instanceof template) throw new coreException("Failed to detect default template");$vd02e12eb6d6c3f6ebd763197df01e211 = $v4f2afc9c4099ee1f39c9f551123e54bd->getId();}}}if($vd5d4bb9b2c282937ee64b1fb0495ef08) {$this->addUpdatedElementId($vd5d4bb9b2c282937ee64b1fb0495ef08);}else {$this->addUpdatedElementId($this->getDefaultElementId());}if($vaf31437ce61345f416579830a98c91e5 = $this->objects->addObject($vb068931cc450442b63f5b3d276ea4297, $v94757cae63fd3e398c0811a976dd6bbe)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_hierarchy (rel, type_id, domain_id, lang_id, tpl_id, obj_id) VALUES('{$vd5d4bb9b2c282937ee64b1fb0495ef08}', '{$v0715f6d9497f93911417c9c324265771}', '{$v662cbf1253ac7d8750ed9190c52163e5}', '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}', '{$vd02e12eb6d6c3f6ebd763197df01e211}', '{$vaf31437ce61345f416579830a98c91e5}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v7057e8409c7c531a1a6e9ac3df4ed549 = l_mysql_insert_id();$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true);$v8e2dcfd7e7e24b1ca76c1193f645902b->setAltName($vd84ff935144e00c3e1d395c2379aca47);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT MAX(ord) FROM cms3_hierarchy WHERE rel = '{$vd5d4bb9b2c282937ee64b1fb0495ef08}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(list($v8bef1cc20ada3bef55fdf132cb2a1cb9) = mysql_fetch_row($result)) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setOrd( ($v8bef1cc20ada3bef55fdf132cb2a1cb9 + 1) );}$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$this->elements[$v7057e8409c7c531a1a6e9ac3df4ed549] = $v8e2dcfd7e7e24b1ca76c1193f645902b;$this->addUpdatedElementId($vd5d4bb9b2c282937ee64b1fb0495ef08);$this->addUpdatedElementId($v7057e8409c7c531a1a6e9ac3df4ed549);if($vd5d4bb9b2c282937ee64b1fb0495ef08) {$vc975d8201fe751ebb3429336eeee7d3b = $this->getElement($vd5d4bb9b2c282937ee64b1fb0495ef08);if($vc975d8201fe751ebb3429336eeee7d3b instanceof umiHierarchyElement) {$vd011f21d73bbed77facded50f36b9e7d = $this->getObjectInstances($vc975d8201fe751ebb3429336eeee7d3b->getObject()->getId());if(sizeof($vd011f21d73bbed77facded50f36b9e7d) > 1) {foreach($vd011f21d73bbed77facded50f36b9e7d as $v249d9032fd2c81de7f755fc06b1c397a) {if($v249d9032fd2c81de7f755fc06b1c397a == $vd5d4bb9b2c282937ee64b1fb0495ef08) continue;$this->symlinks[] = array($v7057e8409c7c531a1a6e9ac3df4ed549, $v249d9032fd2c81de7f755fc06b1c397a);}}}}$this->misc_elements[] = $v7057e8409c7c531a1a6e9ac3df4ed549;$this->buildRelationNewNodes($v7057e8409c7c531a1a6e9ac3df4ed549);return $v7057e8409c7c531a1a6e9ac3df4ed549;}else {throw new coreException("Failed to create new object for hierarchy element");return false;}}public function getDefaultElementId($v78e6dd7a49f5b0cb2106a3a434dd5c86 = false, $v662cbf1253ac7d8750ed9190c52163e5 = false) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = (int) $v78e6dd7a49f5b0cb2106a3a434dd5c86;$v662cbf1253ac7d8750ed9190c52163e5 = (int) $v662cbf1253ac7d8750ed9190c52163e5;$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if(empty($this->defaultCache)) {$v248064bbf6355f96570c9a17b0b1f781 = $vb99eb979e6f6efabc396f777b503f7e7->loadData('default_pages');if(is_array($v248064bbf6355f96570c9a17b0b1f781)) {$this->defaultCache = $v248064bbf6355f96570c9a17b0b1f781;}}if (!$v78e6dd7a49f5b0cb2106a3a434dd5c86) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();if (!$v662cbf1253ac7d8750ed9190c52163e5) $v662cbf1253ac7d8750ed9190c52163e5 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();if(isset($this->defaultCache[$v78e6dd7a49f5b0cb2106a3a434dd5c86][$v662cbf1253ac7d8750ed9190c52163e5])) {return $this->defaultCache[$v78e6dd7a49f5b0cb2106a3a434dd5c86][$v662cbf1253ac7d8750ed9190c52163e5];}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE is_default = '1' AND is_deleted='0' AND is_active='1' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(list($v7057e8409c7c531a1a6e9ac3df4ed549) = mysql_fetch_row($result)) {$this->defaultCache[$v78e6dd7a49f5b0cb2106a3a434dd5c86][$v662cbf1253ac7d8750ed9190c52163e5] = $v7057e8409c7c531a1a6e9ac3df4ed549;$vb99eb979e6f6efabc396f777b503f7e7->saveData('default_pages', $this->defaultCache, 3600);return $this->defaultCache[$v78e6dd7a49f5b0cb2106a3a434dd5c86][$v662cbf1253ac7d8750ed9190c52163e5];}else {return false;}}public static function compareStrings($vd7b5808c3f443eb5a496225468c7e4a5, $v6dc84905d6df841d6f19153bd593e213) {return 100 * (    similar_text($vd7b5808c3f443eb5a496225468c7e4a5, $v6dc84905d6df841d6f19153bd593e213) / (     (strlen($vd7b5808c3f443eb5a496225468c7e4a5) + strlen($v6dc84905d6df841d6f19153bd593e213))    / 2)   );}public static function convertAltName($vd84ff935144e00c3e1d395c2379aca47, $va0f0bc95016c862498bbad29d1f4d9d4 = false) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if (!$va0f0bc95016c862498bbad29d1f4d9d4) $va0f0bc95016c862498bbad29d1f4d9d4 = $v2245023265ae4cf87d02c8b6ba991139->get('seo', 'alt-name-separator') ? $v2245023265ae4cf87d02c8b6ba991139->get('seo', 'alt-name-separator') : "_";$vd84ff935144e00c3e1d395c2379aca47 = translit::convert($vd84ff935144e00c3e1d395c2379aca47, $va0f0bc95016c862498bbad29d1f4d9d4);$vd84ff935144e00c3e1d395c2379aca47 = preg_replace("/[\?\\\\&=]+/", "_", $vd84ff935144e00c3e1d395c2379aca47);$vd84ff935144e00c3e1d395c2379aca47 = preg_replace("/[_\/]+/", "_", $vd84ff935144e00c3e1d395c2379aca47);return $vd84ff935144e00c3e1d395c2379aca47;}public static function getTimeStamp() {return time();}public function moveBefore($v7057e8409c7c531a1a6e9ac3df4ed549, $vd5d4bb9b2c282937ee64b1fb0495ef08, $v37b7e5e846e31d9da322c6e743ce3b3c = false) {$this->disableCache();if(!$this->isExists($v7057e8409c7c531a1a6e9ac3df4ed549)) return false;$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();$v41a1470180f8488ba6040c5ff7dc6833 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getRel();$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$vd5d4bb9b2c282937ee64b1fb0495ef08 = (int) $vd5d4bb9b2c282937ee64b1fb0495ef08;$v8e2dcfd7e7e24b1ca76c1193f645902b->setRel($vd5d4bb9b2c282937ee64b1fb0495ef08);$v46a8df3f1b0f374830be2497076b9446 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTplId();$v3568678a69e0e639e9c3163b2d10ceba = templatesCollection::getInstance()->getTemplatesList($v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);$vf07440bfac87b2aa38a59a0109b6cd38 = true;foreach($v3568678a69e0e639e9c3163b2d10ceba as $vcfc7e0dcf6883d635b928f1e31f7694d) {if ($vcfc7e0dcf6883d635b928f1e31f7694d->getId() == $v46a8df3f1b0f374830be2497076b9446) {$vf07440bfac87b2aa38a59a0109b6cd38 = false;break;}}if ($vf07440bfac87b2aa38a59a0109b6cd38) {$v84b4de448609c5297d79dbec08101fbd = templatesCollection::getInstance()->getDefaultTemplate($v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);if ($v84b4de448609c5297d79dbec08101fbd) {$v8c3112e89e491f40ed057b32883c646c = $v84b4de448609c5297d79dbec08101fbd->getId();$v770c309c1aed0fbfabad24a3d5933129 = new umiSelection;$v770c309c1aed0fbfabad24a3d5933129->addHierarchyFilter($v7057e8409c7c531a1a6e9ac3df4ed549, 100);$v4650086681d0c3d7660463e94b1156a5 = umiSelectionsParser::runSelection($v770c309c1aed0fbfabad24a3d5933129);$v4650086681d0c3d7660463e94b1156a5[] = $v7057e8409c7c531a1a6e9ac3df4ed549;$v18e7588ee516318bc8ae9c8c0ff7c917 = implode(",", $v4650086681d0c3d7660463e94b1156a5);$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_hierarchy SET tpl_id = '{$v8c3112e89e491f40ed057b32883c646c}' WHERE id IN (".$v18e7588ee516318bc8ae9c8c0ff7c917.")";}}if($v37b7e5e846e31d9da322c6e743ce3b3c) {$v37b7e5e846e31d9da322c6e743ce3b3c = (int) $v37b7e5e846e31d9da322c6e743ce3b3c;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT ord FROM cms3_hierarchy WHERE id = '{$v37b7e5e846e31d9da322c6e743ce3b3c}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v8bef1cc20ada3bef55fdf132cb2a1cb9) = mysql_fetch_row($result)) {$v8bef1cc20ada3bef55fdf132cb2a1cb9 = (int) $v8bef1cc20ada3bef55fdf132cb2a1cb9;$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_hierarchy SET ord = (ord + 1) WHERE rel = '{$vd5d4bb9b2c282937ee64b1fb0495ef08}' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}' AND ord >= {$v8bef1cc20ada3bef55fdf132cb2a1cb9}";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v8e2dcfd7e7e24b1ca76c1193f645902b->setOrd($v8bef1cc20ada3bef55fdf132cb2a1cb9);$this->rewriteElementAltName($v7057e8409c7c531a1a6e9ac3df4ed549);$this->rebuildRelationNodes($v7057e8409c7c531a1a6e9ac3df4ed549);$this->addUpdatedElementId($v7057e8409c7c531a1a6e9ac3df4ed549);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();return true;}else return false;}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT MAX(ord) FROM cms3_hierarchy WHERE rel = '{$vd5d4bb9b2c282937ee64b1fb0495ef08}' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(list($v8bef1cc20ada3bef55fdf132cb2a1cb9) = mysql_fetch_row($result)) {++$v8bef1cc20ada3bef55fdf132cb2a1cb9;}else {$v8bef1cc20ada3bef55fdf132cb2a1cb9 = 1;}$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_hierarchy SET ord = '{$v8bef1cc20ada3bef55fdf132cb2a1cb9}', rel = '{$vd5d4bb9b2c282937ee64b1fb0495ef08}' WHERE id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$this->rewriteElementAltName($v7057e8409c7c531a1a6e9ac3df4ed549);$this->rebuildRelationNodes($v7057e8409c7c531a1a6e9ac3df4ed549);$this->addUpdatedElementId($v7057e8409c7c531a1a6e9ac3df4ed549);return true;}}public function moveFirst($v7057e8409c7c531a1a6e9ac3df4ed549, $vd5d4bb9b2c282937ee64b1fb0495ef08) {$this->disableCache();$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$vd5d4bb9b2c282937ee64b1fb0495ef08 = (int) $vd5d4bb9b2c282937ee64b1fb0495ef08;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE rel = '{$vd5d4bb9b2c282937ee64b1fb0495ef08}' ORDER BY ord ASC";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($v37b7e5e846e31d9da322c6e743ce3b3c) = mysql_fetch_row($result);return $this->moveBefore($v7057e8409c7c531a1a6e9ac3df4ed549, $vd5d4bb9b2c282937ee64b1fb0495ef08, $v37b7e5e846e31d9da322c6e743ce3b3c);}protected function isAllowed($v7552cd149af7495ee7d8225974e50f80) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();list($v4b43b0aee35624cd95b910189b3dc231) = $v41275a535677f79ff347e01bc530c176->isAllowedObject($v41275a535677f79ff347e01bc530c176->getUserId(), $v7552cd149af7495ee7d8225974e50f80);return $v4b43b0aee35624cd95b910189b3dc231;}public function getDominantTypeId($v7057e8409c7c531a1a6e9ac3df4ed549, $v12a055bf01a31369fe81ac35d85c7bc1 = 1, $v0715f6d9497f93911417c9c324265771 = null) {if (!$this->isExists($v7057e8409c7c531a1a6e9ac3df4ed549) && $v7057e8409c7c531a1a6e9ac3df4ed549 !== 0) {return false;}if ($v7057e8409c7c531a1a6e9ac3df4ed549 === 0) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$v662cbf1253ac7d8750ed9190c52163e5 = cmsController::getInstance()->getCurrentDomain()->getId();}else {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true);$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();}$v12a055bf01a31369fe81ac35d85c7bc1 = (int) $v12a055bf01a31369fe81ac35d85c7bc1;$v3ffc6a9588cb6b3add8e15f37ebc93ad = '';if ($v0715f6d9497f93911417c9c324265771) {$v3ffc6a9588cb6b3add8e15f37ebc93ad = " AND h.type_id = '" . ((int) $v0715f6d9497f93911417c9c324265771) . "'";}if ($v12a055bf01a31369fe81ac35d85c7bc1 > 1) {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT o.type_id, COUNT(*) AS c
	FROM cms3_hierarchy h, cms3_objects o, cms3_hierarchy_relations hr
		WHERE hr.rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}' AND h.id=hr.child_id AND h.is_deleted = '0' AND o.id = h.obj_id AND h.lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND h.domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'
			{$v3ffc6a9588cb6b3add8e15f37ebc93ad}
			GROUP BY o.type_id
				ORDER BY c DESC
					LIMIT 1
SQL;   }else {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT o.type_id, COUNT(*) AS c
	FROM cms3_hierarchy h, cms3_objects o
		WHERE h.rel = '{$v7057e8409c7c531a1a6e9ac3df4ed549}' AND h.is_deleted = '0' AND o.id = h.obj_id AND h.lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND h.domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'
		{$v3ffc6a9588cb6b3add8e15f37ebc93ad}
			GROUP BY o.type_id
				ORDER BY c DESC
					LIMIT 1
SQL;   }if ($v94757cae63fd3e398c0811a976dd6bbe = (int) cacheFrontend::getInstance()->loadSql($vac5c74b64b4b8352ef2f181affb5ac2a)) {return $v94757cae63fd3e398c0811a976dd6bbe;}$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if (mysql_num_rows($result) == 0) {return NULL;}list($v94757cae63fd3e398c0811a976dd6bbe) = mysql_fetch_row($result);$v94757cae63fd3e398c0811a976dd6bbe = (int) $v94757cae63fd3e398c0811a976dd6bbe;cacheFrontend::getInstance()->saveSql($vac5c74b64b4b8352ef2f181affb5ac2a, $v94757cae63fd3e398c0811a976dd6bbe);return $v94757cae63fd3e398c0811a976dd6bbe;}public function addUpdatedElementId($v7057e8409c7c531a1a6e9ac3df4ed549) {if(!in_array($v7057e8409c7c531a1a6e9ac3df4ed549, $this->updatedElements)) {$this->updatedElements[] = $v7057e8409c7c531a1a6e9ac3df4ed549;}}public function getUpdatedElements() {return $this->updatedElements;}protected function forceCacheCleanup() {if(sizeof($this->updatedElements)) {$va10311459433adf322f2590a4987c423 = (bool) mainConfiguration::getInstance()->get('cache', 'static.enabled');if ($va10311459433adf322f2590a4987c423) {require_once CURRENT_WORKING_DIR . '/libs/cacheControl.php';$v805e6b8e623f5dd06f99f55e55230cca = new staticCache;$v805e6b8e623f5dd06f99f55e55230cca->cleanup();}if(function_exists("deleteElementsRelatedPages")) {deleteElementsRelatedPages();}}}public function __destruct() {if(defined('SMU_PROCESS') && SMU_PROCESS) {return;}$this->forceCacheCleanup();if(sizeof($this->symlinks)) {foreach($this->symlinks as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v47c80780ab608cc046f2a6e6f071feb6) {list($v7057e8409c7c531a1a6e9ac3df4ed549, $va473047c73202ee9a9ff3648c5aab351) = $v47c80780ab608cc046f2a6e6f071feb6;$this->copyElement($v7057e8409c7c531a1a6e9ac3df4ed549, $va473047c73202ee9a9ff3648c5aab351);unset($this->symlinks[$v865c0c0b4ab0e063e5caa3387c1a8741]);}$this->symlinks = Array();}}public function getCollectedElements() {return array_merge(array_keys($this->elements), $this->misc_elements);}public function unloadElement($v7057e8409c7c531a1a6e9ac3df4ed549) {static $v0db3209e1adc6d67be435a81baf9a66e;if($v0db3209e1adc6d67be435a81baf9a66e === NULL) {$v0db3209e1adc6d67be435a81baf9a66e = cmsController::getInstance()->getCurrentElementId();}if($v0db3209e1adc6d67be435a81baf9a66e == $v7057e8409c7c531a1a6e9ac3df4ed549) return false;if(array_key_exists($v7057e8409c7c531a1a6e9ac3df4ed549, $this->elements)) {unset($this->elements[$v7057e8409c7c531a1a6e9ac3df4ed549]);}else {return false;}}public function unloadAllElements() {static $v0db3209e1adc6d67be435a81baf9a66e;if($v0db3209e1adc6d67be435a81baf9a66e === NULL) {$v0db3209e1adc6d67be435a81baf9a66e = cmsController::getInstance()->getCurrentElementId();}foreach($this->elements as $v7057e8409c7c531a1a6e9ac3df4ed549=>$v9e3669d19b675bd57058fd4664205d2a) {if($v0db3209e1adc6d67be435a81baf9a66e == $v7057e8409c7c531a1a6e9ac3df4ed549) {continue;}unset($this->elements[$v7057e8409c7c531a1a6e9ac3df4ed549]);}}public function getElementsCount($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce = "") {$v0715f6d9497f93911417c9c324265771 = umiHierarchyTypesCollection::getInstance()->getTypeByName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce)->getId();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_hierarchy WHERE type_id = '{$v0715f6d9497f93911417c9c324265771}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(list($ve2942a04780e223b215eb8b663cf5353) = mysql_fetch_row($result)) {return $ve2942a04780e223b215eb8b663cf5353;}else {return false;}}private function pushElementsLastUpdateTime($ve0df5a999da22bc6fa9e26b115eb4ae4 = 0) {if($ve0df5a999da22bc6fa9e26b115eb4ae4 > $this->elementsLastUpdateTime) {$this->elementsLastUpdateTime = $ve0df5a999da22bc6fa9e26b115eb4ae4;}}public function getElementsLastUpdateTime() {return $this->elementsLastUpdateTime;}public function getMaxNestingLevel($v7552cd149af7495ee7d8225974e50f80) {$v7552cd149af7495ee7d8225974e50f80 = (int) $v7552cd149af7495ee7d8225974e50f80;$vac5c74b64b4b8352ef2f181affb5ac2a = 'SELECT max(level) FROM `cms3_hierarchy_relations` where rel_id=' . $v7552cd149af7495ee7d8225974e50f80;$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {list($vc9e9a848920877e76685b2e4e76de38d) = $vf1965a857bc285d26fe22023aa5ab50d;return $vc9e9a848920877e76685b2e4e76de38d;}else {return false;}}public function getObjectInstances($vaf31437ce61345f416579830a98c91e5, $vfc9bd216c399e5612672290fa3f0cbe2 = false, $v1200c36ada21fb70df10f131f49eaf3d = false, $v7cdb97c18de62c6e81d975cdf168b225 = false) {$vaf31437ce61345f416579830a98c91e5 = (int) $vaf31437ce61345f416579830a98c91e5;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE obj_id = '{$vaf31437ce61345f416579830a98c91e5}'";if(!$vfc9bd216c399e5612672290fa3f0cbe2) {$v662cbf1253ac7d8750ed9190c52163e5 = cmsController::getInstance()->getCurrentDomain()->getId();$vac5c74b64b4b8352ef2f181affb5ac2a .= " AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}'";}if(!$v1200c36ada21fb70df10f131f49eaf3d) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$vac5c74b64b4b8352ef2f181affb5ac2a .= " AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}'";}if($v7cdb97c18de62c6e81d975cdf168b225) {$vac5c74b64b4b8352ef2f181affb5ac2a .= " AND is_deleted = 0";}$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v9b207167e5381c47682c6b4f58a623fb = array();while(list($v7057e8409c7c531a1a6e9ac3df4ed549) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[] = $v7057e8409c7c531a1a6e9ac3df4ed549;}return $v9b207167e5381c47682c6b4f58a623fb;}public function getDominantTplId($v7552cd149af7495ee7d8225974e50f80) {$v7552cd149af7495ee7d8225974e50f80 = (int) $v7552cd149af7495ee7d8225974e50f80;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `tpl_id`, COUNT(*) AS `cnt` FROM cms3_hierarchy WHERE rel = '{$v7552cd149af7495ee7d8225974e50f80}' AND is_deleted = '0' GROUP BY tpl_id ORDER BY `cnt` DESC";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {list($vd02e12eb6d6c3f6ebd763197df01e211) = $vf1965a857bc285d26fe22023aa5ab50d;return $vd02e12eb6d6c3f6ebd763197df01e211;}else {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7552cd149af7495ee7d8225974e50f80);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {return $v8e2dcfd7e7e24b1ca76c1193f645902b->getTplId();}}}public function getLastUpdatedElements($vaa9f73eea60a006820d0f8768bc8a3fc, $vd7e6d55ba379a13d08c25d15faf2a23b = 0) {$vaa9f73eea60a006820d0f8768bc8a3fc = (int) $vaa9f73eea60a006820d0f8768bc8a3fc;$vd7e6d55ba379a13d08c25d15faf2a23b = (int) $vd7e6d55ba379a13d08c25d15faf2a23b;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE updatetime >= {$vd7e6d55ba379a13d08c25d15faf2a23b} LIMIT {$vaa9f73eea60a006820d0f8768bc8a3fc}";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v9b207167e5381c47682c6b4f58a623fb = Array();while(list($vb80bb7740288fda1f201890375a60c8f) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[] = $vb80bb7740288fda1f201890375a60c8f;}return $v9b207167e5381c47682c6b4f58a623fb;}public function checkIsVirtual($v47c80780ab608cc046f2a6e6f071feb6) {if(sizeof($v47c80780ab608cc046f2a6e6f071feb6) == 0) return $v47c80780ab608cc046f2a6e6f071feb6;foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v7057e8409c7c531a1a6e9ac3df4ed549 => $v1a13105b7e4eb5fb2e7c9515ac06aa48) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);$v47c80780ab608cc046f2a6e6f071feb6[$v7057e8409c7c531a1a6e9ac3df4ed549] = (string) $v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectId();}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT obj_id, COUNT(*) FROM cms3_hierarchy WHERE obj_id IN (" . implode(", ", $v47c80780ab608cc046f2a6e6f071feb6) . ") AND is_deleted = '0' GROUP BY obj_id";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v818ad5ef6588e140ecb9f81e810c028a, $v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result)) {$vcfeadf6a60808e5ffeff8268bec49bb6 = ($v4a8a08f09d37b73795649038408b5f33 > 1) ? true : false;foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if($v9e3669d19b675bd57058fd4664205d2a === $v818ad5ef6588e140ecb9f81e810c028a) {$v47c80780ab608cc046f2a6e6f071feb6[$v865c0c0b4ab0e063e5caa3387c1a8741] = $vcfeadf6a60808e5ffeff8268bec49bb6;}}}return $v47c80780ab608cc046f2a6e6f071feb6;}protected function rewriteElementAltName($v7057e8409c7c531a1a6e9ac3df4ed549) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true, true);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setAltName($v8e2dcfd7e7e24b1ca76c1193f645902b->getAltName());$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();return true;}else {return false;}}protected function earseRelationNodes($v7057e8409c7c531a1a6e9ac3df4ed549) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_hierarchy_relations WHERE rel_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}' OR child_id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}public function rebuildRelationNodes($v7552cd149af7495ee7d8225974e50f80) {$v7552cd149af7495ee7d8225974e50f80 = (int) $v7552cd149af7495ee7d8225974e50f80;$this->earseRelationNodes($v7552cd149af7495ee7d8225974e50f80);$this->buildRelationNewNodes($v7552cd149af7495ee7d8225974e50f80);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_hierarchy WHERE rel = '{$v7552cd149af7495ee7d8225974e50f80}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v6b6fbabcee280415a5bc3e6f99d3a15e) = mysql_fetch_row($result)) {$this->rebuildRelationNodes($v6b6fbabcee280415a5bc3e6f99d3a15e);}}public function buildRelationNewNodes($v7057e8409c7c531a1a6e9ac3df4ed549) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) $v7057e8409c7c531a1a6e9ac3df4ed549;$this->earseRelationNodes($v7057e8409c7c531a1a6e9ac3df4ed549);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT rel FROM cms3_hierarchy WHERE id = '{$v7057e8409c7c531a1a6e9ac3df4ed549}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(mysql_num_rows($result)) {list($v6be379826b20cc58475f636e33f4606b) = mysql_fetch_row($result);$v8eeb1538ad4ac95142835550d08f1212 = ($v6be379826b20cc58475f636e33f4606b > 0) ? " = '{$v6be379826b20cc58475f636e33f4606b}'" : " IS NULL";$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO cms3_hierarchy_relations (rel_id, child_id, level)
SELECT rel_id, '{$v7057e8409c7c531a1a6e9ac3df4ed549}', (level + 1) FROM cms3_hierarchy_relations WHERE child_id {$v8eeb1538ad4ac95142835550d08f1212}
SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vc68ad910ed49ac65f21f1bf2c5dbf912 = $this->getAllParents($v6be379826b20cc58475f636e33f4606b, true, true);$vc68ad910ed49ac65f21f1bf2c5dbf912 = array_extract_values($vc68ad910ed49ac65f21f1bf2c5dbf912);$vc9e9a848920877e76685b2e4e76de38d = sizeof($vc68ad910ed49ac65f21f1bf2c5dbf912);$v59a040d8f146c76cb91c7f341268d909 = ($v6be379826b20cc58475f636e33f4606b > 0) ? "'{$v6be379826b20cc58475f636e33f4606b}'" : "NULL";$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO cms3_hierarchy_relations (rel_id, child_id, level)
VALUES ({$v59a040d8f146c76cb91c7f341268d909}, '{$v7057e8409c7c531a1a6e9ac3df4ed549}', '{$vc9e9a848920877e76685b2e4e76de38d}')
SQL;    l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}else return false;}public function hasParent($vb81ca7c0ccaa77e7aa91936ab0070695, $v57fca6a4b2fee07f7be81d5306d334a5) {if( ! $vb81ca7c0ccaa77e7aa91936ab0070695 ) return false;if(is_numeric($vb81ca7c0ccaa77e7aa91936ab0070695)) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance()->getElement ($vb81ca7c0ccaa77e7aa91936ab0070695);}if(is_numeric($v57fca6a4b2fee07f7be81d5306d334a5)) {$v57fca6a4b2fee07f7be81d5306d334a5 = umiHierarchy::getInstance()->getElement ($v57fca6a4b2fee07f7be81d5306d334a5);}if( ! $vb81ca7c0ccaa77e7aa91936ab0070695 instanceof umiHierarchyElement) return false;if( ! $v57fca6a4b2fee07f7be81d5306d334a5 instanceof umiHierarchyElement) return false;if($vb81ca7c0ccaa77e7aa91936ab0070695->getRel() == $v57fca6a4b2fee07f7be81d5306d334a5->getId()) {return true;}return $this->hasParent( $vb81ca7c0ccaa77e7aa91936ab0070695->getRel(), $v57fca6a4b2fee07f7be81d5306d334a5);}public function clearCache() {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->elements);foreach($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) unset($this->elements[$v3c6e0b8a9c15224a8228b9a98ca1531d]);$this->elements = array();$this->symlinks = array();$this->misc_elements = array();$this->pathCache = array();$this->pathPiecesCache = array();$this->defaultCache = array();$this->parentsCache = array();$this->idByPathCache = array();}public function clearDefaultElementCache() {$this->defaultCache = array();}public function getRightAltName($vd84ff935144e00c3e1d395c2379aca47, $v8e2dcfd7e7e24b1ca76c1193f645902b, $v0161cd78b4dc4a09ae9d2bbdb93dddc4 = false, $v0a0599000e41580f9918d858774bd2f0 = false) {if (empty($vd84ff935144e00c3e1d395c2379aca47)) $vd84ff935144e00c3e1d395c2379aca47 = '1';if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getRel() == 0 && !IGNORE_MODULE_NAMES_OVERWRITE) {$v6c63406410aa57b3c97b88d3feb09990 = regedit::getInstance()->getList("//modules");foreach($v6c63406410aa57b3c97b88d3feb09990 as $v854203cccade0bbe21be239a208aea49) {if ($vd84ff935144e00c3e1d395c2379aca47 == $v854203cccade0bbe21be239a208aea49[0]) {$vd84ff935144e00c3e1d395c2379aca47 .= '1';break;}}if (langsCollection::getInstance()->getLangId($vd84ff935144e00c3e1d395c2379aca47)) {$vd84ff935144e00c3e1d395c2379aca47 .= '1';}}$vc1332a8893475d77a4cb5226b0e6246d =  array();preg_match("/^([a-z0-9_.-]*)(\d*?)$/U", $vd84ff935144e00c3e1d395c2379aca47, $v66373a9c960d5bb19f89068c5a2797b0);$va2d2953131ec91efe3c90d4dbcee3777 = isset($v66373a9c960d5bb19f89068c5a2797b0[2]) ? $v66373a9c960d5bb19f89068c5a2797b0[2] : NULL;$v544988e29afe707b134aa03709eb443e = isset($v66373a9c960d5bb19f89068c5a2797b0[1]) ? $v66373a9c960d5bb19f89068c5a2797b0[1] : NULL;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();if($v0a0599000e41580f9918d858774bd2f0) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT alt_name FROM cms3_hierarchy WHERE rel={$v8e2dcfd7e7e24b1ca76c1193f645902b->getRel()}  AND is_deleted = '0' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}' AND alt_name LIKE '{$v544988e29afe707b134aa03709eb443e}%';";}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT alt_name FROM cms3_hierarchy WHERE rel={$v8e2dcfd7e7e24b1ca76c1193f645902b->getRel()} AND id <> {$v8e2dcfd7e7e24b1ca76c1193f645902b->getId()} AND is_deleted = '0' AND lang_id = '{$v78e6dd7a49f5b0cb2106a3a434dd5c86}' AND domain_id = '{$v662cbf1253ac7d8750ed9190c52163e5}' AND alt_name LIKE '{$v544988e29afe707b134aa03709eb443e}%';";}$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v447b7147e84be512208dcc0995d67ebc) = mysql_fetch_row($result)) $vc1332a8893475d77a4cb5226b0e6246d[] = $v447b7147e84be512208dcc0995d67ebc;if (!empty($vc1332a8893475d77a4cb5226b0e6246d) and in_array($vd84ff935144e00c3e1d395c2379aca47,$vc1332a8893475d77a4cb5226b0e6246d)){foreach($vc1332a8893475d77a4cb5226b0e6246d as $v52dfbb9b0e571701b76699a145406d48){preg_match("/^([a-z0-9_.-]*)(\d*?)$/U", $v52dfbb9b0e571701b76699a145406d48, $v66373a9c960d5bb19f89068c5a2797b0);if (!empty($v66373a9c960d5bb19f89068c5a2797b0[2])) $va2d2953131ec91efe3c90d4dbcee3777 = max($va2d2953131ec91efe3c90d4dbcee3777,$v66373a9c960d5bb19f89068c5a2797b0[2]);}++$va2d2953131ec91efe3c90d4dbcee3777;if ($v0161cd78b4dc4a09ae9d2bbdb93dddc4) {$v363b122c528f54df4a0446b6bab05515 = 0;for ($v363b122c528f54df4a0446b6bab05515 = 1;$v363b122c528f54df4a0446b6bab05515<$va2d2953131ec91efe3c90d4dbcee3777;$v363b122c528f54df4a0446b6bab05515++) {if (!in_array($v544988e29afe707b134aa03709eb443e . $v363b122c528f54df4a0446b6bab05515, $vc1332a8893475d77a4cb5226b0e6246d)) {$va2d2953131ec91efe3c90d4dbcee3777 = $v363b122c528f54df4a0446b6bab05515;break;}}}}return $v544988e29afe707b134aa03709eb443e . $va2d2953131ec91efe3c90d4dbcee3777;}};interface iUmiSelection {public function forceHierarchyTable($v9a11e4b1e888a4467c1e9cabcd5243c9 = true);public function addObjectType($v6301cee35ea764a1e241978f93f01069);public function addElementType($v94efb9bd8805ffa2a3d248cbe836b6ef);public function addLimit($v46e7bdf0a692b1eca202f0d12b593b1e, $v8a9b81a55f7d809de402f0d2ce9d42af = 0);public function setOrderByProperty($v945100186b119048837b9859c2c46410, $v375a52cb87b22005816fe7a418ec6660 = true);public function setOrderByOrd();public function setOrderByRand();public function setOrderByName($v375a52cb87b22005816fe7a418ec6660 = true);public function setOrderByObjectId($v375a52cb87b22005816fe7a418ec6660 = true);public function addHierarchyFilter($v7552cd149af7495ee7d8225974e50f80, $v12a055bf01a31369fe81ac35d85c7bc1 = 0, $vabd12ea100a9ec8377e3c7339f056b00 = false);public function addPropertyFilterBetween($v945100186b119048837b9859c2c46410, $vc77a6602bc26923923022914991f7089, $ve728b2d791dd5ba5e95cf932e053ee54);public function addPropertyFilterEqual($v945100186b119048837b9859c2c46410, $vceddaedc8950c06207af818c743f5986, $vd32ea5905defab375bc68bc780334f4f = true);public function addPropertyFilterNotEqual($v945100186b119048837b9859c2c46410, $vceddaedc8950c06207af818c743f5986, $vd32ea5905defab375bc68bc780334f4f = true);public function addPropertyFilterLike($v945100186b119048837b9859c2c46410, $ve1099940f96cfb8bb4fbfd8af691553e, $vd32ea5905defab375bc68bc780334f4f = true);public function addPropertyFilterMore($v945100186b119048837b9859c2c46410, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);public function addPropertyFilterLess($v945100186b119048837b9859c2c46410, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);public function addPropertyFilterIsNull($v945100186b119048837b9859c2c46410);public function addActiveFilter($vc76a5e84e4bdee527e274ea30c680d79);public function addOwnerFilter($v72122ce96bfec66e2396d2e25225d70a);public function addObjectsFilter($v486e8f4c27e77f00e55301bea98709b3);public function addElementsFilter($v8d7953acf74eb79d375a932e111d71a3);public function addNameFilterEquals($vceddaedc8950c06207af818c743f5986);public function addNameFilterLike($ve1099940f96cfb8bb4fbfd8af691553e);public function addPermissions($v8e44f0089b076e18a718eb9ca3d94674 = false);public function setPermissionsLevel($vc9e9a848920877e76685b2e4e76de38d = 1);public function setDomainId($v72ee76c5c29383b7c9f9225c1fa4d10b = false);public function setLangId($vf585b7f018bb4ced15a03683a733e50b = false);public function setConditionModeOR();public function setIsDomainIgnored($vf3e6017a1a6654acd4f621a18cc49878 = false);public function setIsLangIgnored($ve17f508d15b7985bf0f67b6d72c72072 = false);public function resetTextSearch();public function result();public function count();}class umiSelection implements iUmiSelection {private $order = Array(),   $limit = Array(),   $object_type = Array(),   $element_type = Array(),   $props = Array(),   $hierarchy = Array(),   $perms = Array(),   $names = Array(),   $active = Array(),   $owner = Array(),   $objects_ids = Array(),   $elements_ids = Array(),   $is_order = false,  $is_limit = false, $is_object_type = false, $is_element_type = false, $is_props = false, $is_hierarchy = false, $is_permissions = false, $is_forced = false, $is_names = false, $is_active = false,   $condition_mode_or = false, $is_owner = false,   $is_objects_ids = false, $is_elements_ids = false,   $is_domain_ignored = false, $isDomainIgnored = false, $isLangIgnored = false, $langId = false, $domainId = false,   $permissionsLevel = 1,   $searchStrings = Array();public $result = false, $count = false, $switchIllegalBetween = true;public $optimize_root_search_query = false;public $sql_part__hierarchy = "";public $sql_part__element_type = "";public $sql_part__owner = "";public $sql_part__objects = "";public $sql_part__elements = "";public $sql_part__perms = "";public $sql_part__perms_tables = "";public $sql_part__content_tables = "";public $sql_part__object_type = "";public $sql_part__props_and_names = "";public $sql_part__lang_cond = "";public $sql_part__domain_cond = "";public $sql_part__unactive_cond = "";public $sql_cond__total_joins = 0;public $sql_cond__content_tables_loaded = 0;public $sql_cond__need_content = false;public $sql_cond__need_hierarchy = false;public $sql_cond__domain_ignored = false;public $sql_cond_auto_domain = false;public $sql_arr_for_mark_used_fields = array();public $sql_arr_for_and_or_part = array();public $sql_kwd_distinct = "";public $sql_kwd_distinct_count = "";public $sql_kwd_straight_join = "";public $sql_select_expr = "";public $sql_table_references = "";public $sql_where_condition_required = "";public $sql_where_condition_common = "";public $sql_where_condition_additional = "";public $sql_order_by = "";public $sql_limit = "";public $objectTableIsRequired = false;public $excludeNestedPages = false;public $usedContentTables = Array();public function result() {return umiSelectionsParser::runSelection($this);}public function count() {return umiSelectionsParser::runSelectionCounts($this);}public function setObjectTypeFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_object_type = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->object_type = Array();}public function setElementTypeFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_element_type = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->element_type = Array();}public function setPropertyFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_props = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->props = Array();}public function setLimitFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_limit = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->limit = Array();}public function setHierarchyFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_hierarchy = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->hierarchy = Array();}public function setOrderFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_order = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->order = Array();}public function setPermissionsFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_permissions = $v615ed030b41392ae2a69ca39f0d521a3;$ve8701ad48ba05a91604e480dd60899a3 = $this->getCurrentUserId();if(cmsController::getInstance()->getModule("users")->isSv($ve8701ad48ba05a91604e480dd60899a3)) {$this->is_permissions = false;}if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->perms = Array();}public function setActiveFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_active = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->is_active = Array();}public function setOwnerFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_owner = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->is_owner = Array();}public function setObjectsFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_objects_ids = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->is_objects_ids = Array();}public function setElementsFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_elements_ids = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->is_elements_ids = Array();}public function setNamesFilter($v615ed030b41392ae2a69ca39f0d521a3 = true) {$this->is_names = (bool) $v615ed030b41392ae2a69ca39f0d521a3;if (!$v615ed030b41392ae2a69ca39f0d521a3) $this->names = Array();}public function forceHierarchyTable($v9a11e4b1e888a4467c1e9cabcd5243c9 = true) {$this->is_forced = (bool) $v9a11e4b1e888a4467c1e9cabcd5243c9;}public function addObjectType($v87306dd4235ed712ebc07fe169b76f83) {$this->setObjectTypeFilter();if(is_array($v87306dd4235ed712ebc07fe169b76f83)) {foreach($v87306dd4235ed712ebc07fe169b76f83 as $v9191678b4dce60a558a09976502caa71) {if(!$this->addObjectType($v9191678b4dce60a558a09976502caa71)) {return false;}}return true;}if(umiObjectTypesCollection::getInstance()->isExists($v87306dd4235ed712ebc07fe169b76f83)) {if(in_array($v87306dd4235ed712ebc07fe169b76f83, $this->object_type) === false) {$this->object_type[] = $v87306dd4235ed712ebc07fe169b76f83;return true;}else {return false;}}else {return false;}}public function addElementType($v9a0ad81d8ded2798e111f35a942f00e9) {$this->setElementTypeFilter();if(umiHierarchyTypesCollection::getInstance()->isExists($v9a0ad81d8ded2798e111f35a942f00e9)) {if(in_array($v9a0ad81d8ded2798e111f35a942f00e9, $this->element_type) === false) {$this->element_type[] = $v9a0ad81d8ded2798e111f35a942f00e9;return true;}else {return false;}}else {return false;}}public function addLimit($v9d85c254b5062e518a134a61950999c3, $v71860c77c6745379b0d44304d66b6a13 = 0) {$this->setLimitFilter();$v9d85c254b5062e518a134a61950999c3 = (int) $v9d85c254b5062e518a134a61950999c3;$v71860c77c6745379b0d44304d66b6a13 = (int) $v71860c77c6745379b0d44304d66b6a13;if($v71860c77c6745379b0d44304d66b6a13 < 0) {$v71860c77c6745379b0d44304d66b6a13 = 0;}$this->limit = Array($v9d85c254b5062e518a134a61950999c3, $v71860c77c6745379b0d44304d66b6a13);}public function addActiveFilter($vc76a5e84e4bdee527e274ea30c680d79) {$this->setActiveFilter();$this->active = Array($vc76a5e84e4bdee527e274ea30c680d79);}public function addOwnerFilter($vca105ed04a437dfe76422775527d3e83) {$this->setOwnerFilter();$this->owner = $this->toIntsArray($vca105ed04a437dfe76422775527d3e83);}public function addObjectsFilter($v486e8f4c27e77f00e55301bea98709b3) {$this->setObjectsFilter();$this->objects_ids = $this->toIntsArray($v486e8f4c27e77f00e55301bea98709b3);}public function addElementsFilter($v8d7953acf74eb79d375a932e111d71a3) {$this->setElementsFilter();$this->elements_ids = $this->toIntsArray($v8d7953acf74eb79d375a932e111d71a3);}public function setOrderByProperty($v3aabf39f2d943fa886d86dcbbee4d910, $v375a52cb87b22005816fe7a418ec6660 = true) {if(!$v3aabf39f2d943fa886d86dcbbee4d910) return false;$this->setOrderFilter();$v17f71d965fe9589ddbd11caf7182243e = $this->getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);$vb2c97ae425dd751b0e48a3acae79cf4a = Array("field_id" => $v3aabf39f2d943fa886d86dcbbee4d910, "asc" => $v375a52cb87b22005816fe7a418ec6660, "type" => $v17f71d965fe9589ddbd11caf7182243e, "native_field" => false);if(in_array($vb2c97ae425dd751b0e48a3acae79cf4a, $this->order) === false) {$this->order[] = $vb2c97ae425dd751b0e48a3acae79cf4a;return true;}else {return false;}}public function setOrderByOrd($v375a52cb87b22005816fe7a418ec6660 = true) {$this->setOrderFilter();$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => "native", "native_field" => "ord", "asc" => $v375a52cb87b22005816fe7a418ec6660);if(in_array($vb2c97ae425dd751b0e48a3acae79cf4a, $this->order) === false) {$this->order[] = $vb2c97ae425dd751b0e48a3acae79cf4a;return true;}else {return false;}}public function setOrderByRand() {$this->setOrderFilter();$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => "native", "native_field" => "rand", "asc" => true);if(in_array($vb2c97ae425dd751b0e48a3acae79cf4a, $this->order) === false) {$this->order[] = $vb2c97ae425dd751b0e48a3acae79cf4a;return true;}else {return false;}}public function setOrderByName($v375a52cb87b22005816fe7a418ec6660 = true) {$this->setOrderFilter();$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => "native", "native_field" => "name", "asc" => $v375a52cb87b22005816fe7a418ec6660);if(in_array($vb2c97ae425dd751b0e48a3acae79cf4a, $this->order) === false) {$this->order[] = $vb2c97ae425dd751b0e48a3acae79cf4a;return true;}else {return false;}}public function setOrderByObjectId($v375a52cb87b22005816fe7a418ec6660 = true) {$this->setOrderFilter();$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => "native", "native_field" => "object_id", "asc" => $v375a52cb87b22005816fe7a418ec6660);if(in_array($vb2c97ae425dd751b0e48a3acae79cf4a, $this->order) === false) {$this->order[] = $vb2c97ae425dd751b0e48a3acae79cf4a;return true;}else {return false;}}public function addHierarchyFilter($v7057e8409c7c531a1a6e9ac3df4ed549, $v12a055bf01a31369fe81ac35d85c7bc1 = 0, $vabd12ea100a9ec8377e3c7339f056b00 = true) {$this->setHierarchyFilter();if(is_array($v7057e8409c7c531a1a6e9ac3df4ed549)) {foreach($v7057e8409c7c531a1a6e9ac3df4ed549 as $vb80bb7740288fda1f201890375a60c8f) {$this->addHierarchyFilter($vb80bb7740288fda1f201890375a60c8f, $v12a055bf01a31369fe81ac35d85c7bc1);}return;}if(umiHierarchy::getInstance()->isExists($v7057e8409c7c531a1a6e9ac3df4ed549) || (is_numeric($v7057e8409c7c531a1a6e9ac3df4ed549) && $v7057e8409c7c531a1a6e9ac3df4ed549 == 0)) {if($v7057e8409c7c531a1a6e9ac3df4ed549 == umiHierarchy::getInstance()->getDefaultElementId() && $vabd12ea100a9ec8377e3c7339f056b00 == false) {$v7057e8409c7c531a1a6e9ac3df4ed549 = Array(0, 0);}if(in_array($v7057e8409c7c531a1a6e9ac3df4ed549, $this->hierarchy) === false || $v7057e8409c7c531a1a6e9ac3df4ed549 == 0) {$this->hierarchy[] = Array((int) $v7057e8409c7c531a1a6e9ac3df4ed549, $v12a055bf01a31369fe81ac35d85c7bc1);}if($v12a055bf01a31369fe81ac35d85c7bc1 > 0) {$this->hierarchy[] = Array($v7057e8409c7c531a1a6e9ac3df4ed549, $v12a055bf01a31369fe81ac35d85c7bc1);}}else {return false;}}public function addPropertyFilterBetween($v3aabf39f2d943fa886d86dcbbee4d910, $vd8bd79cc131920d5de426f914d17405a, $v2ffe4e77325d9a7152f7086ea7aa5114) {if(!$v3aabf39f2d943fa886d86dcbbee4d910) return false;$this->setPropertyFilter();$v17f71d965fe9589ddbd11caf7182243e = $this->getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);if($this->switchIllegalBetween && $vd8bd79cc131920d5de426f914d17405a > $v2ffe4e77325d9a7152f7086ea7aa5114) {$vfa816edb83e95bf0c8da580bdfd491ef = $vd8bd79cc131920d5de426f914d17405a;$vd8bd79cc131920d5de426f914d17405a = $v2ffe4e77325d9a7152f7086ea7aa5114;$v2ffe4e77325d9a7152f7086ea7aa5114 = $vfa816edb83e95bf0c8da580bdfd491ef;unset($vfa816edb83e95bf0c8da580bdfd491ef);}$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => $v17f71d965fe9589ddbd11caf7182243e, "field_id" => $v3aabf39f2d943fa886d86dcbbee4d910, "filter_type" => "between", "min" => $vd8bd79cc131920d5de426f914d17405a, "max" => $v2ffe4e77325d9a7152f7086ea7aa5114);$this->props[] = $vb2c97ae425dd751b0e48a3acae79cf4a;}public function addPropertyFilterEqual($v3aabf39f2d943fa886d86dcbbee4d910, $v2063c1608d6e0baf80249c42e2be5804, $ve1e4c5d3ee9d4ae51d2a0e4d3ed5460c = true) {if(!$v3aabf39f2d943fa886d86dcbbee4d910 || !sizeof($v2063c1608d6e0baf80249c42e2be5804)) return false;$this->setPropertyFilter();$v17f71d965fe9589ddbd11caf7182243e = $this->getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => $v17f71d965fe9589ddbd11caf7182243e, "field_id" => $v3aabf39f2d943fa886d86dcbbee4d910, "filter_type" => "equal", "value" => $v2063c1608d6e0baf80249c42e2be5804, "case_insencetive" => $ve1e4c5d3ee9d4ae51d2a0e4d3ed5460c);$this->props[] = $vb2c97ae425dd751b0e48a3acae79cf4a;}public function addPropertyFilterNotEqual($v3aabf39f2d943fa886d86dcbbee4d910, $v2063c1608d6e0baf80249c42e2be5804, $ve1e4c5d3ee9d4ae51d2a0e4d3ed5460c = true) {if(!$v3aabf39f2d943fa886d86dcbbee4d910) return false;$this->setPropertyFilter();$v17f71d965fe9589ddbd11caf7182243e = $this->getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => $v17f71d965fe9589ddbd11caf7182243e, "field_id" => $v3aabf39f2d943fa886d86dcbbee4d910, "filter_type" => "not_equal", "value" => $v2063c1608d6e0baf80249c42e2be5804, "case_insencetive" => $ve1e4c5d3ee9d4ae51d2a0e4d3ed5460c);$this->props[] = $vb2c97ae425dd751b0e48a3acae79cf4a;}public function addPropertyFilterLike($v3aabf39f2d943fa886d86dcbbee4d910, $v2063c1608d6e0baf80249c42e2be5804, $ve1e4c5d3ee9d4ae51d2a0e4d3ed5460c = true) {if(!$v3aabf39f2d943fa886d86dcbbee4d910) return false;$this->setPropertyFilter();$v17f71d965fe9589ddbd11caf7182243e = $this->getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => $v17f71d965fe9589ddbd11caf7182243e, "field_id" => $v3aabf39f2d943fa886d86dcbbee4d910, "filter_type" => "like", "value" => $v2063c1608d6e0baf80249c42e2be5804, "case_insencetive" => $ve1e4c5d3ee9d4ae51d2a0e4d3ed5460c);$this->props[] = $vb2c97ae425dd751b0e48a3acae79cf4a;}public function addPropertyFilterMore($v3aabf39f2d943fa886d86dcbbee4d910, $v2063c1608d6e0baf80249c42e2be5804) {if(!$v3aabf39f2d943fa886d86dcbbee4d910) return false;$this->setPropertyFilter();$v17f71d965fe9589ddbd11caf7182243e = $this->getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => $v17f71d965fe9589ddbd11caf7182243e, "field_id" => $v3aabf39f2d943fa886d86dcbbee4d910, "filter_type" => "more", "value" => $v2063c1608d6e0baf80249c42e2be5804);$this->props[] = $vb2c97ae425dd751b0e48a3acae79cf4a;}public function addPropertyFilterLess($v3aabf39f2d943fa886d86dcbbee4d910, $v2063c1608d6e0baf80249c42e2be5804) {if(!$v3aabf39f2d943fa886d86dcbbee4d910) return false;$this->setPropertyFilter();$v17f71d965fe9589ddbd11caf7182243e = $this->getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => $v17f71d965fe9589ddbd11caf7182243e, "field_id" => $v3aabf39f2d943fa886d86dcbbee4d910, "filter_type" => "less", "value" => $v2063c1608d6e0baf80249c42e2be5804);$this->props[] = $vb2c97ae425dd751b0e48a3acae79cf4a;}public function addPropertyFilterIsNull($v3aabf39f2d943fa886d86dcbbee4d910) {if(!$v3aabf39f2d943fa886d86dcbbee4d910) return false;$this->setPropertyFilter();$v17f71d965fe9589ddbd11caf7182243e = $this->getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => $v17f71d965fe9589ddbd11caf7182243e, "field_id" => $v3aabf39f2d943fa886d86dcbbee4d910, "filter_type" => "null");$this->props[] = $vb2c97ae425dd751b0e48a3acae79cf4a;}public function addPropertyFilterIsNotNull($v3aabf39f2d943fa886d86dcbbee4d910) {if(!$v3aabf39f2d943fa886d86dcbbee4d910) return false;$this->setPropertyFilter();$v17f71d965fe9589ddbd11caf7182243e = $this->getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);$vb2c97ae425dd751b0e48a3acae79cf4a = Array("type" => $v17f71d965fe9589ddbd11caf7182243e, "field_id" => $v3aabf39f2d943fa886d86dcbbee4d910, "filter_type" => "notnull");$this->props[] = $vb2c97ae425dd751b0e48a3acae79cf4a;}public function addPermissions($ve8701ad48ba05a91604e480dd60899a3 = false) {$this->setPermissionsFilter();if($ve8701ad48ba05a91604e480dd60899a3 === false) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();if($v41275a535677f79ff347e01bc530c176->isSv()) return;$ve8701ad48ba05a91604e480dd60899a3 = $v41275a535677f79ff347e01bc530c176->getUserId();}$vb132392a317588e56460e77a8fd74229 = $this->getOwnersByUser($ve8701ad48ba05a91604e480dd60899a3);$this->perms = $vb132392a317588e56460e77a8fd74229;}public function setPermissionsLevel($vc9e9a848920877e76685b2e4e76de38d = 1) {$this->permissionsLevel = (int) $vc9e9a848920877e76685b2e4e76de38d;}public function addNameFilterEquals($v2063c1608d6e0baf80249c42e2be5804) {$this->setNamesFilter();$v2063c1608d6e0baf80249c42e2be5804 = Array("value" => $v2063c1608d6e0baf80249c42e2be5804, "type" => "exact");if(!in_array($v2063c1608d6e0baf80249c42e2be5804, $this->names)) {$this->names[] = $v2063c1608d6e0baf80249c42e2be5804;}}public function addNameFilterLike($v2063c1608d6e0baf80249c42e2be5804) {$this->setNamesFilter();$v2063c1608d6e0baf80249c42e2be5804 = Array("value" => $v2063c1608d6e0baf80249c42e2be5804, "type" => "like");if(!in_array($v2063c1608d6e0baf80249c42e2be5804, $this->names)) {$this->names[] = $v2063c1608d6e0baf80249c42e2be5804;}}public function getOrderConds() {return ($this->is_order) ? $this->order : false;}public function getLimitConds() {return ($this->is_limit) ? $this->limit : false;}public function getActiveConds() {return ($this->is_active) ? $this->active : false;}public function getOwnerConds() {$va7ea85302605a40475ffd70703779448 = array();if (is_array($this->owner) && count($this->owner)) {$va7ea85302605a40475ffd70703779448 = array_map('intval', $this->owner);}return ($this->is_owner) ? $va7ea85302605a40475ffd70703779448 : false;}public function getObjectsConds() {$va7ea85302605a40475ffd70703779448 = array();if (is_array($this->objects_ids) && count($this->objects_ids)) {$va7ea85302605a40475ffd70703779448 = array_map('intval', $this->objects_ids);}return ($this->is_objects_ids) ? $va7ea85302605a40475ffd70703779448 : false;}public function getElementsConds() {$va7ea85302605a40475ffd70703779448 = array();if (is_array($this->elements_ids) && count($this->elements_ids)) {$va7ea85302605a40475ffd70703779448 = array_map('intval', $this->elements_ids);}return ($this->is_elements_ids) ? $va7ea85302605a40475ffd70703779448 : false;}public function getPropertyConds() {return ($this->is_props) ? $this->props : false;}public function getObjectTypeConds() {return ($this->is_object_type) ? $this->object_type : false;}public function getElementTypeConds() {if($this->getObjectTypeConds() !== false) {return false;}if($this->optimize_root_search_query) {if(is_array($this->element_type)) {if(sizeof($this->element_type) > 1) {reset($this->element_type);$this->element_type = Array(current($this->element_type));}}}return ($this->is_element_type) ? $this->element_type : false;}public function getHierarchyConds() {$this->hierarchy = array_unique_arrays($this->hierarchy, 0);return ($this->is_hierarchy && !$this->optimize_root_search_query) ? $this->hierarchy : false;}public function getPermissionsConds() {return ($this->is_permissions) ? $this->perms : false;}public function getForceCond() {return $this->is_forced;}public function getNameConds() {return ($this->is_names) ? $this->names : false;}private function getDataByFieldId($v3aabf39f2d943fa886d86dcbbee4d910) {if($v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910)) {$v1e3f04102267eaf5e8d0ca424fd5c561 = $v06e3d36fa30cea095545139854ad1fb9->getFieldTypeId();if($v519504d7d4beb745dac24ccfb6c1d7c9 = umiFieldTypesCollection::getInstance()->getFieldType($v1e3f04102267eaf5e8d0ca424fd5c561)) {if($v17f71d965fe9589ddbd11caf7182243e = $v519504d7d4beb745dac24ccfb6c1d7c9->getDataType()) {return umiFieldType::getDataTypeDB($v17f71d965fe9589ddbd11caf7182243e);}else {return false;}}else {return false;}}else {return false;}}private function getCurrentUserId() {if($v9bc65c2abec141778ffaa729489f3e87 = cmsController::getInstance()->getModule("users")) {return $v9bc65c2abec141778ffaa729489f3e87->user_id;}else {return false;}}private function getOwnersByUser($ve8701ad48ba05a91604e480dd60899a3) {if($vee11cbb19052e40b07aac0ca060c23ee = umiObjectsCollection::getInstance()->getObject($ve8701ad48ba05a91604e480dd60899a3)) {$v1471e4e05a4db95d353cc867fe317314 = $vee11cbb19052e40b07aac0ca060c23ee->getValue("groups");$v1471e4e05a4db95d353cc867fe317314[] = $ve8701ad48ba05a91604e480dd60899a3;return $v1471e4e05a4db95d353cc867fe317314;}else {return false;}}public function setConditionModeOr() {$this->condition_mode_or = true;}public function getConditionModeOr() {return $this->condition_mode_or;}public function setIsDomainIgnored($vf3e6017a1a6654acd4f621a18cc49878 = false) {$this->isDomainIgnored = (bool) $vf3e6017a1a6654acd4f621a18cc49878;}public function setIsLangIgnored($ve17f508d15b7985bf0f67b6d72c72072 = false) {$this->isLangIgnored = (bool) $ve17f508d15b7985bf0f67b6d72c72072;}public function getIsDomainIgnored() {return $this->isDomainIgnored;}public function getIsLangIgnored() {return $this->isLangIgnored;}public function setDomainId($v72ee76c5c29383b7c9f9225c1fa4d10b = false) {$this->domainId = ($v72ee76c5c29383b7c9f9225c1fa4d10b === false) ? false : (int) $v72ee76c5c29383b7c9f9225c1fa4d10b;}public function setLangId($vf585b7f018bb4ced15a03683a733e50b = false) {$this->langId = ($vf585b7f018bb4ced15a03683a733e50b === false) ? false : (int) $vf585b7f018bb4ced15a03683a733e50b;}public function searchText($v597a51f04d341eba4ca965899acc10b3) {if(is_string($v597a51f04d341eba4ca965899acc10b3)) {if(strlen($v597a51f04d341eba4ca965899acc10b3) > 0 && !in_array($v597a51f04d341eba4ca965899acc10b3, $this->searchStrings)) {$this->searchStrings[] = $v597a51f04d341eba4ca965899acc10b3;return true;}}return false;}public function getDomainId() {return $this->domainId;}public function getLangId() {return $this->langId;}public function getRequiredPermissionsLevel() {return $this->permissionsLevel;}public function getSearchStrings() {return $this->searchStrings;}public function resetTextSearch() {$this->searchStrings = Array();}private function toIntsArray($vb84684c51768c267eb8836ba206ab734) {$va7ea85302605a40475ffd70703779448 = Array();if (is_string($vb84684c51768c267eb8836ba206ab734)) {$va7ea85302605a40475ffd70703779448 = preg_split("/[^\d]/is", $vb84684c51768c267eb8836ba206ab734);}elseif (is_numeric($vb84684c51768c267eb8836ba206ab734)) {$va7ea85302605a40475ffd70703779448 = array(intval($vb84684c51768c267eb8836ba206ab734));}elseif (!is_array($vb84684c51768c267eb8836ba206ab734)) {$va7ea85302605a40475ffd70703779448 = array();}else {$va7ea85302605a40475ffd70703779448 = $vb84684c51768c267eb8836ba206ab734;}return array_map('intval', $va7ea85302605a40475ffd70703779448);}};interface iUmiSelectionsParser {public static function runSelection(umiSelection $v8780ef07c6558a6e696d79a8c05d3e87);public static function runSelectionCounts(umiSelection $v8780ef07c6558a6e696d79a8c05d3e87);public static function parseSelection(umiSelection $v8780ef07c6558a6e696d79a8c05d3e87);}class umiSelectionsParser implements iUmiSelectionsParser {private function __construct() {}public static function runSelection(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {static $v41275a535677f79ff347e01bc530c176;if ($vef5714e0519bfaa645cdff7d28843b70->result !== false) return $vef5714e0519bfaa645cdff7d28843b70->result;$v59f8ce5cb01404063bd7eb308df3b7dc = self::parseSelection($vef5714e0519bfaa645cdff7d28843b70);if (!$v59f8ce5cb01404063bd7eb308df3b7dc['result']) return false;$result = l_mysql_query($v59f8ce5cb01404063bd7eb308df3b7dc['result']);$v9b207167e5381c47682c6b4f58a623fb = Array();while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {list($v7057e8409c7c531a1a6e9ac3df4ed549) = $vf1965a857bc285d26fe22023aa5ab50d;if(isset($vf1965a857bc285d26fe22023aa5ab50d[1])) {if(!$v41275a535677f79ff347e01bc530c176) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();}$v41275a535677f79ff347e01bc530c176->pushElementPermissions($v7057e8409c7c531a1a6e9ac3df4ed549, $vf1965a857bc285d26fe22023aa5ab50d[1]);}$v7057e8409c7c531a1a6e9ac3df4ed549 = intval($v7057e8409c7c531a1a6e9ac3df4ed549);if(in_array($v7057e8409c7c531a1a6e9ac3df4ed549, $v9b207167e5381c47682c6b4f58a623fb) == false) {$v9b207167e5381c47682c6b4f58a623fb[] = $v7057e8409c7c531a1a6e9ac3df4ed549;}}if($vef5714e0519bfaa645cdff7d28843b70->excludeNestedPages) {$v9b207167e5381c47682c6b4f58a623fb = self::excludeNestedPages($v9b207167e5381c47682c6b4f58a623fb);}$vef5714e0519bfaa645cdff7d28843b70->result = $v9b207167e5381c47682c6b4f58a623fb;if(defined("DISABLE_CALC_FOUND_ROWS")) {if(DISABLE_CALC_FOUND_ROWS) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT FOUND_ROWS()";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($ve2942a04780e223b215eb8b663cf5353) = mysql_fetch_row($result);$vef5714e0519bfaa645cdff7d28843b70->count = $ve2942a04780e223b215eb8b663cf5353;}}if ($vef5714e0519bfaa645cdff7d28843b70->optimize_root_search_query) {$vef5714e0519bfaa645cdff7d28843b70->count = false;}return $vef5714e0519bfaa645cdff7d28843b70->result;}public static function runSelectionCounts(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if ($vef5714e0519bfaa645cdff7d28843b70->count !== false) return $vef5714e0519bfaa645cdff7d28843b70->count;$v59f8ce5cb01404063bd7eb308df3b7dc = self::parseSelection($vef5714e0519bfaa645cdff7d28843b70);if (!$v59f8ce5cb01404063bd7eb308df3b7dc['count']) return false;if ($ve2942a04780e223b215eb8b663cf5353 = cacheFrontend::getInstance()->loadSql($v59f8ce5cb01404063bd7eb308df3b7dc['count'])) {return $ve2942a04780e223b215eb8b663cf5353;}$result = l_mysql_query($v59f8ce5cb01404063bd7eb308df3b7dc['count']);if (list($ve2942a04780e223b215eb8b663cf5353) = mysql_fetch_row($result)) {$vef5714e0519bfaa645cdff7d28843b70->count = intval($ve2942a04780e223b215eb8b663cf5353);cacheFrontend::getInstance()->saveSql($v59f8ce5cb01404063bd7eb308df3b7dc['count'], $vef5714e0519bfaa645cdff7d28843b70->count);return $vef5714e0519bfaa645cdff7d28843b70->count;}else {return false;}}public static function parseSelection(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if(!defined('MAX_SELECTION_TABLE_JOINS')) {define('MAX_SELECTION_TABLE_JOINS', 10);}$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content = false;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = $vef5714e0519bfaa645cdff7d28843b70->getForceCond();$vef5714e0519bfaa645cdff7d28843b70->sql_cond__domain_ignored = $vef5714e0519bfaa645cdff7d28843b70->getIsDomainIgnored();$vef5714e0519bfaa645cdff7d28843b70->sql_cond__lang_ignored = $vef5714e0519bfaa645cdff7d28843b70->getIsLangIgnored();$vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins = 0;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__content_tables_loaded = 0;$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_mark_used_fields = array();$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part = array();$vef5714e0519bfaa645cdff7d28843b70->sql_part__hierarchy = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__element_type = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__object_type = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__objects = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__elements = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__unactive_cond = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables = "";$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct = "";$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct_count = "";$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join = "";$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr = "";$vef5714e0519bfaa645cdff7d28843b70->sql_table_references = "";$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required = "";$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common = "";$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional = "";$vef5714e0519bfaa645cdff7d28843b70->sql_order_by = "";$vef5714e0519bfaa645cdff7d28843b70->sql_limit = "";self::makeLimitPart($vef5714e0519bfaa645cdff7d28843b70);self::makeHierarchyPart($vef5714e0519bfaa645cdff7d28843b70);self::makeElementTypePart($vef5714e0519bfaa645cdff7d28843b70);self::makeOwnerPart($vef5714e0519bfaa645cdff7d28843b70);self::makeObjectsPart($vef5714e0519bfaa645cdff7d28843b70);self::makeElementsPart($vef5714e0519bfaa645cdff7d28843b70);self::makePermsParts($vef5714e0519bfaa645cdff7d28843b70);self::makePropPart($vef5714e0519bfaa645cdff7d28843b70);self::makeObjectTypePart($vef5714e0519bfaa645cdff7d28843b70);self::makeOrderPart($vef5714e0519bfaa645cdff7d28843b70);self::makeNamesPart($vef5714e0519bfaa645cdff7d28843b70);self::makePropsAndNames($vef5714e0519bfaa645cdff7d28843b70);self::makeHierarchySpecificConds($vef5714e0519bfaa645cdff7d28843b70);if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins >= 59) {return Array("result" => false, "count" => false);}self::makeDistinctKeywords($vef5714e0519bfaa645cdff7d28843b70);self::makeStraitJoinKeyword($vef5714e0519bfaa645cdff7d28843b70);self::makeSelectExpr($vef5714e0519bfaa645cdff7d28843b70);self::makeTables($vef5714e0519bfaa645cdff7d28843b70);self::makeWhereConditions($vef5714e0519bfaa645cdff7d28843b70);$v1126b3d9572018ac34b2e234c00dc2c3 = "";$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($vef5714e0519bfaa645cdff7d28843b70->usedContentTables);if($v7dabf5c198b0bab2eaa42bb03a113e55 > 1) {for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55 - 1;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v43b5c9175984c071f30b873fdce0a000 = $vef5714e0519bfaa645cdff7d28843b70->usedContentTables[$v865c0c0b4ab0e063e5caa3387c1a8741];$vd0cab90d8d20d57e2f2b9be52f7dd25d = $vef5714e0519bfaa645cdff7d28843b70->usedContentTables[$v865c0c0b4ab0e063e5caa3387c1a8741 + 1];$v1126b3d9572018ac34b2e234c00dc2c3 .= " AND {$v43b5c9175984c071f30b873fdce0a000}.obj_id = {$vd0cab90d8d20d57e2f2b9be52f7dd25d}.obj_id";}}$v16efe07aeec5bc36c29c1116370aaf55 = "";if(defined("DISABLE_CALC_FOUND_ROWS")) {if(DISABLE_CALC_FOUND_ROWS) {$v16efe07aeec5bc36c29c1116370aaf55 = "SQL_CALC_FOUND_ROWS";}}if($vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables) {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct = "";$vef5714e0519bfaa645cdff7d28843b70->sql_group_by = " GROUP BY h.id";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_group_by = "";}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
				SELECT {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join} {$v16efe07aeec5bc36c29c1116370aaf55}  {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr}
				FROM
					{$vef5714e0519bfaa645cdff7d28843b70->sql_table_references}
				WHERE
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional}
					{$v1126b3d9572018ac34b2e234c00dc2c3}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_group_by}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_order_by}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_limit}
SQL;   $vc89ab23398f486d0df6dc8ad44ae1d4c = <<<SQL
				SELECT {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join} 
					COUNT({$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct_count}{$vef5714e0519bfaa645cdff7d28843b70->sql_select_count_expr})
				FROM
					{$vef5714e0519bfaa645cdff7d28843b70->sql_table_references}
				WHERE
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional}
					{$v1126b3d9572018ac34b2e234c00dc2c3}
SQL;   if($vef5714e0519bfaa645cdff7d28843b70->optimize_root_search_query   && sizeof($vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds())   && !sizeof(array_positive_values($vef5714e0519bfaa645cdff7d28843b70->getHierarchyConds()))) {$vca7adb9881c5ed53066501aa82aae638 = implode(", ", $vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds());if($vef5714e0519bfaa645cdff7d28843b70->sql_table_references) {$vef5714e0519bfaa645cdff7d28843b70->sql_table_references = "," . $vef5714e0519bfaa645cdff7d28843b70->sql_table_references;}if($vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required) {$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required = " AND " . $vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required;}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT DISTINCT h.id
	FROM cms3_hierarchy hp
		{$vef5714e0519bfaa645cdff7d28843b70->sql_table_references}
		WHERE h.type_id IN ({$vca7adb9881c5ed53066501aa82aae638})
			AND (h.rel = 0 OR (h.rel = hp.id AND hp.type_id NOT IN ({$vca7adb9881c5ed53066501aa82aae638}))) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond} {$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond}
			AND h.is_deleted = '0'
			{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required}
			{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common}
			{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_order_by}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_limit}
SQL;    $vc89ab23398f486d0df6dc8ad44ae1d4c = <<<SQL
SELECT COUNT(DISTINCT h.id) FROM cms3_hierarchy h, cms3_hierarchy hp WHERE h.type_id IN ({$vca7adb9881c5ed53066501aa82aae638}) AND (h.rel = 0 OR (h.rel = hp.id AND hp.type_id NOT IN ({$vca7adb9881c5ed53066501aa82aae638}))) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond} {$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond} AND h.is_deleted = '0'
SQL;   }return array(    'result' => $vac5c74b64b4b8352ef2f181affb5ac2a,    'count' => $vc89ab23398f486d0df6dc8ad44ae1d4c   );}private static function makeDistinctKeywords(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct = '';$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct_count = '';if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content || ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy && $vef5714e0519bfaa645cdff7d28843b70->sql_part__perms)) {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct = ' DISTINCT';$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct_count = 'DISTINCT ';}}private static function makeStraitJoinKeyword(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if (MAX_SELECTION_TABLE_JOINS > 0 && $vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins > MAX_SELECTION_TABLE_JOINS) {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join = "STRAIGHT_JOIN";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join = "";}}private static function makeSelectExpr(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy) {if($vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables) {$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr = "h.id, MAX(c3p.level)";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr = "h.id";}$vef5714e0519bfaa645cdff7d28843b70->sql_select_count_expr = "h.id";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr = "o.id";$vef5714e0519bfaa645cdff7d28843b70->sql_select_count_expr = "o.id";}}private static function makeTables(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$v3e4e493f22840daa9ac1724a72ab3e69 = '';if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content) {$v3e4e493f22840daa9ac1724a72ab3e69 = $vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables;}if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy) {if($vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables || $vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired) {$ve73bcc9cfc2941d6e1afe96205af0d0e = "cms3_objects o,";}else {$ve73bcc9cfc2941d6e1afe96205af0d0e = "";}$vef5714e0519bfaa645cdff7d28843b70->sql_table_references .= <<<SQL
					{$ve73bcc9cfc2941d6e1afe96205af0d0e}
					cms3_hierarchy h
					{$v3e4e493f22840daa9ac1724a72ab3e69}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables}
SQL;   }else {$vef5714e0519bfaa645cdff7d28843b70->sql_table_references .= <<<SQL
					cms3_objects o
					{$v3e4e493f22840daa9ac1724a72ab3e69}
SQL;   }}private static function makeWhereConditions(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if($vef5714e0519bfaa645cdff7d28843b70->sql_part__owner) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner = " AND " . $vef5714e0519bfaa645cdff7d28843b70->sql_part__owner;}$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common = <<<SQL
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__object_type}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__objects}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__elements}
SQL;   if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy) {if($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy     && !$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables     && !$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired) {$v0e2dd3565df1bb7b04bb23eee21bef0b = "";}else {$v0e2dd3565df1bb7b04bb23eee21bef0b = "h.obj_id = o.id AND ";}$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required = <<<SQL
					{$v0e2dd3565df1bb7b04bb23eee21bef0b}
					h.is_deleted = '0'
SQL;    $vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional = <<<SQL
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__hierarchy}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__unactive_cond}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__element_type}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond}
SQL;   }else {$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required = "1";$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional = "";}}private static function makeLimitPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vef5714e0519bfaa645cdff7d28843b70->sql_limit = "";$v4db7515c8b18fa48e815e443f5783196 = $vef5714e0519bfaa645cdff7d28843b70->getLimitConds();if ($v4db7515c8b18fa48e815e443f5783196 !== false) {if (is_array($v4db7515c8b18fa48e815e443f5783196) && count($v4db7515c8b18fa48e815e443f5783196) > 1 && is_numeric($v4db7515c8b18fa48e815e443f5783196[0]) && is_numeric($v4db7515c8b18fa48e815e443f5783196[1])) {$vee00b4dd5a72dccc8a3bf821a0854ef9 = intval($v4db7515c8b18fa48e815e443f5783196[0]);$vac588e91956d2ecbac36ea0c4f3dceec = intval($v4db7515c8b18fa48e815e443f5783196[1]);$vf4a0ecf68633a2a8d8bbc8a44a5c8829 = $vac588e91956d2ecbac36ea0c4f3dceec * $vee00b4dd5a72dccc8a3bf821a0854ef9;$vef5714e0519bfaa645cdff7d28843b70->sql_limit = " LIMIT ".$vf4a0ecf68633a2a8d8bbc8a44a5c8829.", ".$vee00b4dd5a72dccc8a3bf821a0854ef9;}}return $vef5714e0519bfaa645cdff7d28843b70->sql_limit;}private static function makeHierarchyPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$v09e7a2bb896092bc4abe376dc931f83e = $vef5714e0519bfaa645cdff7d28843b70->getHierarchyConds();if (!empty($v09e7a2bb896092bc4abe376dc931f83e)) {$v32ba5dc8b093c913a929cf77b2fe5679 = 0;$v71f3d1a6a90fada957aea649a871d420 = 0;$v6b31ca7a6d10b4f4bdf4bcf1d2e27244 = Array();foreach($v09e7a2bb896092bc4abe376dc931f83e as $v50e7514e30aa173cb1278b26505e79bb) {list($vbfa030fe63bacd523dd70a76cfaed98a, $v12a055bf01a31369fe81ac35d85c7bc1) = $v50e7514e30aa173cb1278b26505e79bb;if($vbfa030fe63bacd523dd70a76cfaed98a == 0) {$v32ba5dc8b093c913a929cf77b2fe5679++;--$v12a055bf01a31369fe81ac35d85c7bc1;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT level FROM cms3_hierarchy_relations WHERE child_id = {$vbfa030fe63bacd523dd70a76cfaed98a}";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($vc9e9a848920877e76685b2e4e76de38d) = mysql_fetch_row($result);$v131eec2e3a1c0cebac938273907d5290 = ($vbfa030fe63bacd523dd70a76cfaed98a > 0) ? "hr.rel_id = '{$vbfa030fe63bacd523dd70a76cfaed98a}'" : "hr.rel_id IS NULL";if($v71f3d1a6a90fada957aea649a871d420 == 0) {$vef5714e0519bfaa645cdff7d28843b70->sql_table_references .= "cms3_hierarchy_relations hr, ";$v71f3d1a6a90fada957aea649a871d420++;}$vb81e229503292fbbcb3ff39f8fb2ce76 = $v12a055bf01a31369fe81ac35d85c7bc1 + $vc9e9a848920877e76685b2e4e76de38d + 1;$v6b31ca7a6d10b4f4bdf4bcf1d2e27244[] = <<<SQL
({$v131eec2e3a1c0cebac938273907d5290} AND hr.level <= '{$vb81e229503292fbbcb3ff39f8fb2ce76}') AND hr.child_id = h.id
SQL;    }if(sizeof($v6b31ca7a6d10b4f4bdf4bcf1d2e27244) > 0) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__hierarchy .= " AND ((" . implode(") OR (", $v6b31ca7a6d10b4f4bdf4bcf1d2e27244) . ")) ";}$vef5714e0519bfaa645cdff7d28843b70->sql_cond__domain_ignored = ($v32ba5dc8b093c913a929cf77b2fe5679) ? false : true;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__lang_ignored = ($v32ba5dc8b093c913a929cf77b2fe5679) ? false : true;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = true;if(sizeof($v09e7a2bb896092bc4abe376dc931f83e) == 1) {if($v09e7a2bb896092bc4abe376dc931f83e[0] != 0) {$vef5714e0519bfaa645cdff7d28843b70->sql_cond_auto_domain = true;}}else {$vef5714e0519bfaa645cdff7d28843b70->sql_cond_auto_domain = true;}}}private static function makeElementTypePart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vf39b5a31bc0c51db0171da81d3523763 = $vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds();if ($vf39b5a31bc0c51db0171da81d3523763 && count($vf39b5a31bc0c51db0171da81d3523763)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__element_type = " AND h.type_id IN ('".implode("', '", $vf39b5a31bc0c51db0171da81d3523763)."')";$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = true;}}private static function makeOwnerPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vf14994e23e2f95ddcfe1f7db4b8c2837 = $vef5714e0519bfaa645cdff7d28843b70->getOwnerConds();if (is_array($vf14994e23e2f95ddcfe1f7db4b8c2837) && count($vf14994e23e2f95ddcfe1f7db4b8c2837)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner = " o.owner_id IN ('".implode("', '", $vf14994e23e2f95ddcfe1f7db4b8c2837)."')";$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;}}private static function makeObjectsPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vcf7ed7a30bdebabccdfa6099ba7df387 = $vef5714e0519bfaa645cdff7d28843b70->getObjectsConds();if (is_array($vcf7ed7a30bdebabccdfa6099ba7df387) && count($vcf7ed7a30bdebabccdfa6099ba7df387)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__objects = " AND o.id IN ('".implode("', '", $vcf7ed7a30bdebabccdfa6099ba7df387)."')";}}private static function makeElementsPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$v08ad7524bd80c27d5ec900b7d03a0820 = $vef5714e0519bfaa645cdff7d28843b70->getElementsConds();if (is_array($v08ad7524bd80c27d5ec900b7d03a0820) && count($v08ad7524bd80c27d5ec900b7d03a0820)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__elements = " AND h.id IN ('".implode("', '", $v08ad7524bd80c27d5ec900b7d03a0820)."')";$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = true;}}private static function makePermsParts(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if ($v077e247dd24fb5f2092caa5b6ecd4404 = $vef5714e0519bfaa645cdff7d28843b70->getPermissionsConds()) {$v92ad7554e2e0d208f33729db6d54b59b = umiObjectsCollection::getInstance()->getObjectIdByGUID('system-guest');$v077e247dd24fb5f2092caa5b6ecd4404[] = $v92ad7554e2e0d208f33729db6d54b59b;if ($v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v077e247dd24fb5f2092caa5b6ecd4404)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables = ",cms3_permissions c3p";$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = true;$v61b9295e93e2ba331ea1e6f1b79f459d = $vef5714e0519bfaa645cdff7d28843b70->getRequiredPermissionsLevel();for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms .= ($v865c0c0b4ab0e063e5caa3387c1a8741 === 0 ? " AND (" : "");$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms .= "(c3p.owner_id = '".$v077e247dd24fb5f2092caa5b6ecd4404[$v865c0c0b4ab0e063e5caa3387c1a8741]."' AND c3p.rel_id = h.id AND c3p.level & '{$v61b9295e93e2ba331ea1e6f1b79f459d}')";$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms .= ($v865c0c0b4ab0e063e5caa3387c1a8741 === ($v7dabf5c198b0bab2eaa42bb03a113e55 - 1) ? ")" : " OR ");}}}}private static function makePropPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if($v23182694bce9f52758fbab174a0b3607 = $vef5714e0519bfaa645cdff7d28843b70->getSearchStrings()) {$v80071f37861c360a27b7327e132c911a = "cms3_object_content";$v6a7f245843454cf4f28ad7c5e2572aa2 = $vef5714e0519bfaa645cdff7d28843b70->getHierarchyConds();$v6a7f245843454cf4f28ad7c5e2572aa2 = array_extract_values($v6a7f245843454cf4f28ad7c5e2572aa2);if(sizeof($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6301cee35ea764a1e241978f93f01069 = umiHierarchy::getInstance()->getDominantTypeId(array_pop($v6a7f245843454cf4f28ad7c5e2572aa2));$v80071f37861c360a27b7327e132c911a = umiBranch::getBranchedTableByTypeId($v6301cee35ea764a1e241978f93f01069);}else {$vd14a8022b085f9ef19d479cbdd581127 = $vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds();if(is_array($vd14a8022b085f9ef19d479cbdd581127) && sizeof($vd14a8022b085f9ef19d479cbdd581127)) {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = array_pop($vd14a8022b085f9ef19d479cbdd581127);if($vacf567c9c3d6cf7c6e2cc0ce108e0631 == 21 && sizeof($vd14a8022b085f9ef19d479cbdd581127)) {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = array_pop($vd14a8022b085f9ef19d479cbdd581127);}if(umiBranch::checkIfBranchedByHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631)) {$v80071f37861c360a27b7327e132c911a .= "_" . $vacf567c9c3d6cf7c6e2cc0ce108e0631;}}}$v056301054c43f8bbea2090debfec16b1 = "ct";$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables .= ", {$v80071f37861c360a27b7327e132c911a} {$v056301054c43f8bbea2090debfec16b1}";$vef5714e0519bfaa645cdff7d28843b70->usedContentTables[] = $v056301054c43f8bbea2090debfec16b1;$ve1043d63313a1b59f16fe608277bc9a7 = self::getFileFields();if(sizeof($ve1043d63313a1b59f16fe608277bc9a7) > 0) {$vd60fb1b18e68fb7029b3ef48c9a18834 = " AND ct.field_id NOT IN (" . implode(", ", $ve1043d63313a1b59f16fe608277bc9a7) . ")";}else {$vd60fb1b18e68fb7029b3ef48c9a18834 = "";}$v4ab5dfe1c68b36d1aa7d5f8d9cde73bc = Array();foreach($v23182694bce9f52758fbab174a0b3607 as $v597a51f04d341eba4ca965899acc10b3) {$v597a51f04d341eba4ca965899acc10b3 = l_mysql_real_escape_string($v597a51f04d341eba4ca965899acc10b3);$v4439237446062bd0268640161c6a6bc3 = (is_numeric($v597a51f04d341eba4ca965899acc10b3)) ? " OR ct.float_val = '{$v597a51f04d341eba4ca965899acc10b3}' OR ct.int_val = '{$v597a51f04d341eba4ca965899acc10b3}'" : "";$v4ab5dfe1c68b36d1aa7d5f8d9cde73bc[] = "o.name LIKE '%{$v597a51f04d341eba4ca965899acc10b3}%' OR ct.varchar_val LIKE '%{$v597a51f04d341eba4ca965899acc10b3}%' OR ct.text_val LIKE '%{$v597a51f04d341eba4ca965899acc10b3}%' {$v4439237446062bd0268640161c6a6bc3}" . $vd60fb1b18e68fb7029b3ef48c9a18834;}$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'][] = "ct.obj_id = o.id AND (" . implode(" OR ", $v4ab5dfe1c68b36d1aa7d5f8d9cde73bc) . ")";$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content = true;}if ($vc25b09274ac632224f348e21022a7106 = $vef5714e0519bfaa645cdff7d28843b70->getPropertyConds()) {$v47ec37bbecbabe9f73c2d0056e5cb796 = array();foreach ($vc25b09274ac632224f348e21022a7106 as $v7f8b41bdd7c22fc431a0314de4595025) {if ($v7f8b41bdd7c22fc431a0314de4595025['type'] !== false) $v47ec37bbecbabe9f73c2d0056e5cb796[] = $v7f8b41bdd7c22fc431a0314de4595025;}unset($vc25b09274ac632224f348e21022a7106);if ($v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v47ec37bbecbabe9f73c2d0056e5cb796)) {$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v5cba202deaa7e9f47bd0317cf014c64b = $v47ec37bbecbabe9f73c2d0056e5cb796[$v865c0c0b4ab0e063e5caa3387c1a8741];$vf642bf0e4102797f994548b9f4ee9e4a = (isset($v5cba202deaa7e9f47bd0317cf014c64b['filter_type']) ? $v5cba202deaa7e9f47bd0317cf014c64b['filter_type'] : '');$v01aaeba75d696598feafcb0226fdb7e9 = (isset($v5cba202deaa7e9f47bd0317cf014c64b['value']) ? $v5cba202deaa7e9f47bd0317cf014c64b['value'] : null);$v0f728ec6147eaec54f5f45e37bce8ddd = (isset($v5cba202deaa7e9f47bd0317cf014c64b['field_id']) ? $v5cba202deaa7e9f47bd0317cf014c64b['field_id'] : 0);$v1abd88b57ac7e290b6c91d26b0909006 = (isset($v5cba202deaa7e9f47bd0317cf014c64b['type']) ? $v5cba202deaa7e9f47bd0317cf014c64b['type'] : '');if($v1abd88b57ac7e290b6c91d26b0909006 == 'optioned') {if(!is_array($v01aaeba75d696598feafcb0226fdb7e9)) continue;$v14f802e1fba977727845e8872c1743a7 = array_keys($v01aaeba75d696598feafcb0226fdb7e9);if(sizeof($v14f802e1fba977727845e8872c1743a7) == 0) continue;list($v1abd88b57ac7e290b6c91d26b0909006) = $v14f802e1fba977727845e8872c1743a7;if(in_array($v1abd88b57ac7e290b6c91d26b0909006, array('int', 'float', 'varchar', 'tree', 'rel')) == false) continue;$v1abd88b57ac7e290b6c91d26b0909006 .= "_val";}if (!$vef5714e0519bfaa645cdff7d28843b70->getConditionModeOr() || $vef5714e0519bfaa645cdff7d28843b70->sql_cond__content_tables_loaded == 0) {$v056301054c43f8bbea2090debfec16b1 = "c" . (++$vef5714e0519bfaa645cdff7d28843b70->sql_cond__content_tables_loaded);$v80071f37861c360a27b7327e132c911a = self::chooseContentTableName($vef5714e0519bfaa645cdff7d28843b70, $v47ec37bbecbabe9f73c2d0056e5cb796[$v865c0c0b4ab0e063e5caa3387c1a8741]['field_id']);$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables .= ", {$v80071f37861c360a27b7327e132c911a} {$v056301054c43f8bbea2090debfec16b1}";$vef5714e0519bfaa645cdff7d28843b70->usedContentTables[] = $v056301054c43f8bbea2090debfec16b1;}$v64df937f321ebd648bc77b99cf76cb38 = $v056301054c43f8bbea2090debfec16b1.".obj_id = o.id AND ".$v056301054c43f8bbea2090debfec16b1.".field_id = '".$v0f728ec6147eaec54f5f45e37bce8ddd."'";if($v1abd88b57ac7e290b6c91d26b0909006 != 'optioned') {$v4cdef984848c418ea8a3c646e5852e32 = $v056301054c43f8bbea2090debfec16b1.".".$v1abd88b57ac7e290b6c91d26b0909006;}switch ($vf642bf0e4102797f994548b9f4ee9e4a) {case 'equal':         if($v01aaeba75d696598feafcb0226fdb7e9) {if (!is_array($v01aaeba75d696598feafcb0226fdb7e9)) $v01aaeba75d696598feafcb0226fdb7e9 = array($v01aaeba75d696598feafcb0226fdb7e9);$v3a0317e07571e01889f5f6982960cc2a = "'".(implode("', '", array_map('l_mysql_real_escape_string', $v01aaeba75d696598feafcb0226fdb7e9)))."'";$vf92fcd26dc4ba92f75934707ad0917d9 = "(".$v64df937f321ebd648bc77b99cf76cb38." AND (".$v4cdef984848c418ea8a3c646e5852e32." IN (".$v3a0317e07571e01889f5f6982960cc2a.")))";}else {$v01aaeba75d696598feafcb0226fdb7e9 = l_mysql_real_escape_string($v01aaeba75d696598feafcb0226fdb7e9);$vf92fcd26dc4ba92f75934707ad0917d9 = "({$v64df937f321ebd648bc77b99cf76cb38} AND ({$v4cdef984848c418ea8a3c646e5852e32} = '{$v01aaeba75d696598feafcb0226fdb7e9}' OR {$v4cdef984848c418ea8a3c646e5852e32} IS NULL))";}break;case 'not_equal':         if (!is_array($v01aaeba75d696598feafcb0226fdb7e9)) $v01aaeba75d696598feafcb0226fdb7e9 = array($v01aaeba75d696598feafcb0226fdb7e9);$v3a0317e07571e01889f5f6982960cc2a = "'".(implode("', '", array_map('l_mysql_real_escape_string', $v01aaeba75d696598feafcb0226fdb7e9)))."'";$vf92fcd26dc4ba92f75934707ad0917d9 = "(".$v64df937f321ebd648bc77b99cf76cb38." AND ((".$v4cdef984848c418ea8a3c646e5852e32." IS NULL) OR (".$v4cdef984848c418ea8a3c646e5852e32." NOT IN (".$v3a0317e07571e01889f5f6982960cc2a."))))";break;case 'like':         $vb6c8416e95a754076b10d65d1afd3fa9 = true;if (substr($v01aaeba75d696598feafcb0226fdb7e9, 0, 1) === '%' || substr($v01aaeba75d696598feafcb0226fdb7e9, -1) === '%') $vb6c8416e95a754076b10d65d1afd3fa9 = false;$vf578b860df8544c8f826f66977b6e908 = l_mysql_real_escape_string($v01aaeba75d696598feafcb0226fdb7e9);$vf92fcd26dc4ba92f75934707ad0917d9 = "(".$v64df937f321ebd648bc77b99cf76cb38." AND ".$v4cdef984848c418ea8a3c646e5852e32." LIKE '".($vb6c8416e95a754076b10d65d1afd3fa9 ? "%" : "").$vf578b860df8544c8f826f66977b6e908.($vb6c8416e95a754076b10d65d1afd3fa9 ? "%" : "")."')";break;case 'between':         $v17fdfd1db155ff501f9553066c50cdab = (isset($v5cba202deaa7e9f47bd0317cf014c64b['min']) ? floatval($v5cba202deaa7e9f47bd0317cf014c64b['min']) : 0);$v3a86ffe4f7adcc1fe1457ada5ec034b0 = (isset($v5cba202deaa7e9f47bd0317cf014c64b['max']) ? floatval($v5cba202deaa7e9f47bd0317cf014c64b['max']) : 0);$vf92fcd26dc4ba92f75934707ad0917d9 = "(".$v64df937f321ebd648bc77b99cf76cb38." AND ".$v4cdef984848c418ea8a3c646e5852e32." BETWEEN '".$v17fdfd1db155ff501f9553066c50cdab."' AND '".$v3a86ffe4f7adcc1fe1457ada5ec034b0."')";break;case 'more':         $v6ec037ff2ad4d8e71e8a10efa0ba90ba = floatval($v01aaeba75d696598feafcb0226fdb7e9);$vf92fcd26dc4ba92f75934707ad0917d9 = "(".$v64df937f321ebd648bc77b99cf76cb38." AND ".$v4cdef984848c418ea8a3c646e5852e32." >= '".$v6ec037ff2ad4d8e71e8a10efa0ba90ba."')";break;case 'less':         $v6ec037ff2ad4d8e71e8a10efa0ba90ba = floatval($v01aaeba75d696598feafcb0226fdb7e9);$vf92fcd26dc4ba92f75934707ad0917d9 = "(".$v64df937f321ebd648bc77b99cf76cb38." AND ".$v4cdef984848c418ea8a3c646e5852e32." <= '".$v6ec037ff2ad4d8e71e8a10efa0ba90ba."')";break;case 'null':        $vf92fcd26dc4ba92f75934707ad0917d9 = "(".$v64df937f321ebd648bc77b99cf76cb38." AND ".$v4cdef984848c418ea8a3c646e5852e32." IS NULL)";break;case 'notnull':        $vf92fcd26dc4ba92f75934707ad0917d9 = "(".$v64df937f321ebd648bc77b99cf76cb38." AND ".$v4cdef984848c418ea8a3c646e5852e32." IS NOT NULL)";break;default:        $vf92fcd26dc4ba92f75934707ad0917d9 = "";break;}if (strlen($vf92fcd26dc4ba92f75934707ad0917d9)) {$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'][] = $vf92fcd26dc4ba92f75934707ad0917d9;}}if (count($vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part)) {$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content = true;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins += $v865c0c0b4ab0e063e5caa3387c1a8741;}}}}private static function makeObjectTypePart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vcc186db1b3286c09fd5b1f61c6b78b8c = $vef5714e0519bfaa645cdff7d28843b70->getObjectTypeConds();if ($vcc186db1b3286c09fd5b1f61c6b78b8c && count($vcc186db1b3286c09fd5b1f61c6b78b8c)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__object_type = " AND o.type_id IN ('".implode("', '", $vcc186db1b3286c09fd5b1f61c6b78b8c)."')";$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;}}private static function makeOrderPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vc7f62b660bf9e56e6df63ef3d2540a77 = $vef5714e0519bfaa645cdff7d28843b70->getOrderConds();if ($vc7f62b660bf9e56e6df63ef3d2540a77) {$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$vef5714e0519bfaa645cdff7d28843b70->sql_order_by = " ORDER BY ";$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($vc7f62b660bf9e56e6df63ef3d2540a77);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {if ($v11537f7c46ecc6ae45e5497ea0aec6bf = $vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['native_field']) {switch($v11537f7c46ecc6ae45e5497ea0aec6bf) {case "name": {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "o.name " . (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");$vef5714e0519bfaa645cdff7d28843b70->sql_need_object_table = true;$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;break;}case "object_id": {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "o.id " . (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;break;}case "rand": {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "RAND()";break;}case "ord": {if($vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired && !$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy) {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "o.ord " . (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");}else {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "h.ord " . (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");}break;}}if ($v865c0c0b4ab0e063e5caa3387c1a8741 !== ($v7dabf5c198b0bab2eaa42bb03a113e55 - 1)) {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= ", ";}}else {$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content = true;$v056301054c43f8bbea2090debfec16b1 = "c" . (++$vef5714e0519bfaa645cdff7d28843b70->sql_cond__content_tables_loaded);$v80071f37861c360a27b7327e132c911a = self::chooseContentTableName($vef5714e0519bfaa645cdff7d28843b70, $vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['field_id']);$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables .= ", {$v80071f37861c360a27b7327e132c911a} {$v056301054c43f8bbea2090debfec16b1}";$vef5714e0519bfaa645cdff7d28843b70->usedContentTables[] = $v056301054c43f8bbea2090debfec16b1;$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['order'][] = "{$v056301054c43f8bbea2090debfec16b1}.obj_id = o.id AND {$v056301054c43f8bbea2090debfec16b1}.field_id = '{$vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['field_id']}'";$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "{$v056301054c43f8bbea2090debfec16b1}.{$vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['type']} " . (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");if ($v865c0c0b4ab0e063e5caa3387c1a8741 == ($v7dabf5c198b0bab2eaa42bb03a113e55 - 1)) {}else {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= ", ";}}}if ($vef5714e0519bfaa645cdff7d28843b70->sql_order_by == " ORDER BY ") {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by = "";}$vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins += $v865c0c0b4ab0e063e5caa3387c1a8741;}elseif ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy == true) {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by = " ORDER BY h.ord";}}private static function makeNamesPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$v932238d827b73f9a5329f0ee492a6175 = array();if (($v44c20123a4be1d9cc98c2f1c2470598d = $vef5714e0519bfaa645cdff7d28843b70->getNameConds()) && count($v44c20123a4be1d9cc98c2f1c2470598d)) {foreach ($v44c20123a4be1d9cc98c2f1c2470598d as $ve0f38ebd960676b35b7fda2446bff541) {$v056301054c43f8bbea2090debfec16b1 = $ve0f38ebd960676b35b7fda2446bff541['value'];$vb6c8416e95a754076b10d65d1afd3fa9 = true;if (substr($v056301054c43f8bbea2090debfec16b1, 0, 1) === '%' || substr($v056301054c43f8bbea2090debfec16b1, -1) === '%') $vb6c8416e95a754076b10d65d1afd3fa9 = false;$v056301054c43f8bbea2090debfec16b1 = l_mysql_real_escape_string($v056301054c43f8bbea2090debfec16b1);if ($ve0f38ebd960676b35b7fda2446bff541['type'] == 'exact') {$v932238d827b73f9a5329f0ee492a6175[] = "o.name = '".$v056301054c43f8bbea2090debfec16b1."'";}else {$v932238d827b73f9a5329f0ee492a6175[] = "o.name LIKE '".($vb6c8416e95a754076b10d65d1afd3fa9 ? "%" : "").$v056301054c43f8bbea2090debfec16b1.($vb6c8416e95a754076b10d65d1afd3fa9 ? "%" : "")."'";}$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;}}if (count($v932238d827b73f9a5329f0ee492a6175)) {$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'][] = "(".implode(' OR ', $v932238d827b73f9a5329f0ee492a6175).")";}}private static function makePropsAndNames(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names = "";if($vef5714e0519bfaa645cdff7d28843b70->sql_part__owner) {$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'][] = $vef5714e0519bfaa645cdff7d28843b70->sql_part__owner;$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner = "";}if (isset($vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'])) {$v91119290c889cd919565d8b3e0e39560 = ($vef5714e0519bfaa645cdff7d28843b70->getConditionModeOr() ? ' OR ' : ' AND ');$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names = " AND (" . implode($v91119290c889cd919565d8b3e0e39560, $vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where']) . ")";}if(isset($vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['order'])) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names .= " AND (" . implode(" AND ", $vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['order']) . ")";}}private static function makeHierarchySpecificConds(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy == true) {{if(!$vef5714e0519bfaa645cdff7d28843b70->sql_cond__lang_ignored) {if(($vf585b7f018bb4ced15a03683a733e50b = $vef5714e0519bfaa645cdff7d28843b70->getLangId()) == false) {$vf585b7f018bb4ced15a03683a733e50b = (int) cmsController::getInstance()->getCurrentLang()->getId();}$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond = " AND h.lang_id = '" . $vf585b7f018bb4ced15a03683a733e50b . "' ";}}if (!$vef5714e0519bfaa645cdff7d28843b70->sql_cond__domain_ignored) {if(($v72ee76c5c29383b7c9f9225c1fa4d10b = $vef5714e0519bfaa645cdff7d28843b70->getDomainId()) == false) {$v72ee76c5c29383b7c9f9225c1fa4d10b = cmsController::getInstance()->getCurrentDomain()->getId();}$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond = " AND h.domain_id = '" . (int) $v72ee76c5c29383b7c9f9225c1fa4d10b . "' ";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond = "";}if ($vca47c8f843acba03d8a1ba7138319e58 = $vef5714e0519bfaa645cdff7d28843b70->getActiveConds()) {$v4264c638e0098acb172519b0436db099 = (isset($vca47c8f843acba03d8a1ba7138319e58[0]) && (bool) $vca47c8f843acba03d8a1ba7138319e58[0])? 1 : 0;$vef5714e0519bfaa645cdff7d28843b70->sql_part__unactive_cond = " AND h.is_active = '".$v4264c638e0098acb172519b0436db099."' ";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_part__unactive_cond = (cmsController::getInstance()->getCurrentMode() != "admin") ? " AND h.is_active = '1' " : "";}}}protected static function chooseContentTableName(umiSelection $vef5714e0519bfaa645cdff7d28843b70, $v945100186b119048837b9859c2c46410) {$v6942e8fa62b3cc9d93881a58210e2fd7 = $vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds();$v0e8133eb006c0f85ed9444ae07a60842 = $vef5714e0519bfaa645cdff7d28843b70->getObjectTypeConds();if(!is_array($v6942e8fa62b3cc9d93881a58210e2fd7)) {$v6942e8fa62b3cc9d93881a58210e2fd7 = Array();}else {$v6942e8fa62b3cc9d93881a58210e2fd7 = array_extract_values($v6942e8fa62b3cc9d93881a58210e2fd7);}if(!is_array($v0e8133eb006c0f85ed9444ae07a60842)) {$v0e8133eb006c0f85ed9444ae07a60842 = Array();}else {$v0e8133eb006c0f85ed9444ae07a60842 = array_extract_values($v0e8133eb006c0f85ed9444ae07a60842);}if(sizeof($v6942e8fa62b3cc9d93881a58210e2fd7) == 1) {reset($v6942e8fa62b3cc9d93881a58210e2fd7);$vacf567c9c3d6cf7c6e2cc0ce108e0631 = current($v6942e8fa62b3cc9d93881a58210e2fd7);$v4aa3988e15afb9618423a0c2961a469f = umiBranch::checkIfBranchedByHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631);return $v4aa3988e15afb9618423a0c2961a469f ? "cms3_object_content_{$vacf567c9c3d6cf7c6e2cc0ce108e0631}" : "cms3_object_content";}if(sizeof($v6942e8fa62b3cc9d93881a58210e2fd7) > 1) {$v6301cee35ea764a1e241978f93f01069 = self::getObjectTypeByFieldId($v945100186b119048837b9859c2c46410);return umiBranch::getBranchedTableByTypeId($v6301cee35ea764a1e241978f93f01069);}if(sizeof($v6942e8fa62b3cc9d93881a58210e2fd7) == 0) {if(sizeof($v0e8133eb006c0f85ed9444ae07a60842) == 1) {reset($v0e8133eb006c0f85ed9444ae07a60842);$v6301cee35ea764a1e241978f93f01069 = current($v0e8133eb006c0f85ed9444ae07a60842);}else {$v6301cee35ea764a1e241978f93f01069 = self::getObjectTypeByFieldId($v945100186b119048837b9859c2c46410);}return umiBranch::getBranchedTableByTypeId($v6301cee35ea764a1e241978f93f01069);}return "cms3_object_content";}public static function getObjectTypeByFieldId($v945100186b119048837b9859c2c46410) {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();$v945100186b119048837b9859c2c46410 = (int) $v945100186b119048837b9859c2c46410;if(isset($v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410])) {return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410];}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT  MIN(fg.type_id)
	FROM cms3_fields_controller fc, cms3_object_field_groups fg
	WHERE fc.field_id = {$v945100186b119048837b9859c2c46410} AND fg.id = fc.group_id
SQL;   if($v6301cee35ea764a1e241978f93f01069 = cacheFrontend::getInstance()->loadSql($vac5c74b64b4b8352ef2f181affb5ac2a)) {return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = $v6301cee35ea764a1e241978f93f01069;}$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(mysql_num_rows($result)) {list($v6301cee35ea764a1e241978f93f01069) = mysql_fetch_row($result);}else {$v6301cee35ea764a1e241978f93f01069 = false;}$v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = $v6301cee35ea764a1e241978f93f01069;cacheFrontend::getInstance()->saveSql($vac5c74b64b4b8352ef2f181affb5ac2a, $v6301cee35ea764a1e241978f93f01069, 60);return $v6301cee35ea764a1e241978f93f01069;}protected static function excludeNestedPages($v47c80780ab608cc046f2a6e6f071feb6) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$result = Array();foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {if(in_array($v8e2dcfd7e7e24b1ca76c1193f645902b->getRel(), $v47c80780ab608cc046f2a6e6f071feb6)) {continue;}else {$result[] = $v7552cd149af7495ee7d8225974e50f80;}}}return $result;}protected static function getFileFields() {static $v0fea6a13c52b4d4725368f24b045ca84 = false;if($v0fea6a13c52b4d4725368f24b045ca84) return $v0fea6a13c52b4d4725368f24b045ca84;$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT of.id
	FROM cms3_object_fields of, cms3_object_field_types oft
		WHERE of.field_type_id = oft.id
		AND oft.data_type IN ('file', 'img_file', 'swf_file')
SQL;   $result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v9b207167e5381c47682c6b4f58a623fb = array();while(list($v945100186b119048837b9859c2c46410) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[] = $v945100186b119048837b9859c2c46410;}return $v0fea6a13c52b4d4725368f24b045ca84 = $v9b207167e5381c47682c6b4f58a623fb;}};class umiFieldType extends umiEntinty implements iUmiEntinty, iUmiFieldType {private $name, $data_type, $is_multiple = false, $is_unsigned = false;protected $store_type = "field_type";public function getName() {return $this->translateLabel($this->name);}public function getIsMultiple() {return $this->is_multiple;}public function getIsUnsigned() {return $this->is_unsigned;}public function getDataType() {return $this->data_type;}public static function getDataTypes() {return   Array (    "int",    "string",    "text",    "relation",    "file",    "img_file",    "video_file",    "swf_file",    "date",    "boolean",    "wysiwyg",    "password",    "tags",    "symlink",    "price",    "formula",    "float",    "counter",    "optioned"    );}public static function getDataTypeDB($v17f71d965fe9589ddbd11caf7182243e) {$v48908871a0d20dd2e5bd0a3d634ac745 = Array (    "int"   => "int_val",    "string"  => "varchar_val",    "text"   => "text_val",    "relation"  => "rel_val",    "file"   => "text_val",    "img_file"  => "text_val",    "swf_file"  => "text_val",    "video_file" => "text_val",    "date"   => "int_val",    "boolean"  => "int_val",    "wysiwyg"  => "text_val",    "password"  => "varchar_val",    "tags"   => "varchar_val",    "symlink"  => "tree_val",    "price"   => "float_val",    "formula"  => "varchar_val",    "float"   => "float_val",    "counter"  => "counter",    "optioned"  => "optioned"    );if(array_key_exists($v17f71d965fe9589ddbd11caf7182243e, $v48908871a0d20dd2e5bd0a3d634ac745) === false) {return false;}else {return $v48908871a0d20dd2e5bd0a3d634ac745[$v17f71d965fe9589ddbd11caf7182243e];}}public static function isValidDataType($v17f71d965fe9589ddbd11caf7182243e) {return in_array($v17f71d965fe9589ddbd11caf7182243e, self::getDataTypes());}public function setName($vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = $this->translateI18n($vb068931cc450442b63f5b3d276ea4297, "field-type-");$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->setIsUpdated();}public function setIsMultiple($v96a76ec43956dac431b643cbd544dd08) {$this->is_multiple = (bool) $v96a76ec43956dac431b643cbd544dd08;$this->setIsUpdated();}public function setIsUnsigned($vf089d93c2ef0d088edadddb0028d548d) {$this->is_unsigned = (bool) $vf089d93c2ef0d088edadddb0028d548d;$this->setIsUpdated();}public function setDataType($v17f71d965fe9589ddbd11caf7182243e) {if(self::isValidDataType($v17f71d965fe9589ddbd11caf7182243e)) {$this->data_type = $v17f71d965fe9589ddbd11caf7182243e;$this->setIsUpdated();return true;}else {return false;}}protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name, data_type, is_multiple, is_unsigned FROM cms3_object_field_types WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297, $v17f71d965fe9589ddbd11caf7182243e, $v96a76ec43956dac431b643cbd544dd08, $vf089d93c2ef0d088edadddb0028d548d) = $vf1965a857bc285d26fe22023aa5ab50d) {if(!self::isValidDataType($v17f71d965fe9589ddbd11caf7182243e)) {throw new coreException("Wrong data type given for filed type #{$this->id}");return false;}$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->data_type = $v17f71d965fe9589ddbd11caf7182243e;$this->is_multiple= (bool) $v96a76ec43956dac431b643cbd544dd08;$this->is_unsigned = (bool) $vf089d93c2ef0d088edadddb0028d548d;return true;}else {return false;}}protected function save() {$vb068931cc450442b63f5b3d276ea4297 = l_mysql_real_escape_string($this->name);$v17f71d965fe9589ddbd11caf7182243e = l_mysql_real_escape_string($this->data_type);$v96a76ec43956dac431b643cbd544dd08 = (int) $this->is_multiple;$vf089d93c2ef0d088edadddb0028d548d = (int) $this->is_unsigned;$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_object_field_types SET name = '{$vb068931cc450442b63f5b3d276ea4297}', data_type = '{$v17f71d965fe9589ddbd11caf7182243e}', is_multiple = '{$v96a76ec43956dac431b643cbd544dd08}', is_unsigned = '{$vf089d93c2ef0d088edadddb0028d548d}' WHERE id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);cacheFrontend::getInstance()->flush();if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}else {return true;}}}class umiField extends umiEntinty implements iUmiEntinty, iUmiField {private $name, $title, $is_locked = false, $is_inheritable = false, $is_visible = true;private  $field_type_id, $guide_id, $isRequired, $restrictionId, $sortable = false;private $is_in_search = true, $is_in_filter = true, $tip = NULL, $is_system;protected $store_type = "field";public function getName() {return $this->name;}public function getTitle() {return $this->translateLabel($this->title);}public function getIsLocked() {return $this->is_locked;}public function getIsInheritable() {return $this->is_inheritable;}public function getIsVisible() {return $this->is_visible;}public function getFieldTypeId() {return $this->field_type_id;}public function getFieldType() {return umiFieldTypesCollection::getInstance()->getFieldType($this->field_type_id);}public function getGuideId() {return $this->guide_id;}public function getIsInSearch() {return $this->is_in_search;}public function getIsInFilter() {return $this->is_in_filter;}public function getTip() {return $this->tip;}public function getIsSystem() {return $this->is_system;}public function setIsSystem($v03c1f379372e00d33098fed2f34f423a = false) {$this->is_system = (bool) $v03c1f379372e00d33098fed2f34f423a;}public function setName($vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = umiHierarchy::convertAltName($vb068931cc450442b63f5b3d276ea4297, "_");$this->name = umiObjectProperty::filterInputString($vb068931cc450442b63f5b3d276ea4297);if(!strlen($this->name)) $this->name = '_';$this->setIsUpdated();}public function setTitle($vd5d3db1765287eef77d7927cc956f50a) {$vd5d3db1765287eef77d7927cc956f50a = $this->translateI18n($vd5d3db1765287eef77d7927cc956f50a, "field-");$this->title = umiObjectProperty::filterInputString($vd5d3db1765287eef77d7927cc956f50a);$this->setIsUpdated();}public function setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb) {$this->is_locked = (bool) $v1945c9a2a5e2ba6133f1db6757a35fcb;$this->setIsUpdated();}public function setIsInheritable($vd5752333adc3a004f826f2ea2a41273a) {$this->is_inheritable = (bool) $vd5752333adc3a004f826f2ea2a41273a;$this->setIsUpdated();}public function setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4) {$this->is_visible = (bool) $ve1c6c9ef2fcbe75f26f815c4ef2e60b4;$this->setIsUpdated();}public function setFieldTypeId($v1e3f04102267eaf5e8d0ca424fd5c561) {$this->field_type_id = (int) $v1e3f04102267eaf5e8d0ca424fd5c561;$this->setIsUpdated();return true;}public function setGuideId($v051369818a8073bba5feeb0e957eb308) {$this->guide_id = is_numeric($v051369818a8073bba5feeb0e957eb308) ? (int) $v051369818a8073bba5feeb0e957eb308 : null;$this->setIsUpdated();}public function setIsInSearch($v26ff9f2281b323db6a9f4fda798fb0dc) {$this->is_in_search = (bool) $v26ff9f2281b323db6a9f4fda798fb0dc;$this->setIsUpdated();}public function setIsInFilter($v8a98dfdd379bf6548fa217678117ce3b) {$this->is_in_filter = (bool) $v8a98dfdd379bf6548fa217678117ce3b;$this->setIsUpdated();}public function setTip($v6a2139364f96787c8ce1bbb0070b898c) {$this->tip = umiObjectProperty::filterInputString($v6a2139364f96787c8ce1bbb0070b898c);$this->setIsUpdated();}public function getIsRequired() {return $this->isRequired;}public function setIsRequired($v2a9d32d17ad47ac15c87d2e7c96d0e69 = false) {$this->isRequired = (bool) $v2a9d32d17ad47ac15c87d2e7c96d0e69;$this->setIsUpdated();}public function getRestrictionId() {return $this->restrictionId;}public function setRestrictionId($v6b1a57fa235477758817df3c91158006 = false) {$this->restrictionId = (int) $v6b1a57fa235477758817df3c91158006;}public function getIsSortable() {return $this->sortable;}public function setIsSortable($v23aec26e2b521c0e5f1061b3d04983a5 = false) {$this->sortable = (bool) $v23aec26e2b521c0e5f1061b3d04983a5;}public function getDataType() {$v69552af3a03df9391f70eb1851f817c5 = umiFieldTypesCollection::getInstance();return $v69552af3a03df9391f70eb1851f817c5->getFieldType($this->field_type_id)->getDataType();}protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name, title, is_locked, is_inheritable, is_visible, field_type_id, guide_id, in_search, in_filter, tip, is_required, sortable, is_system, restriction_id FROM cms3_object_fields WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v1945c9a2a5e2ba6133f1db6757a35fcb, $vd5752333adc3a004f826f2ea2a41273a, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4, $v1e3f04102267eaf5e8d0ca424fd5c561, $v051369818a8073bba5feeb0e957eb308, $v5fa2ecd1dc485ead330e65903d19650a, $ve4a2ed2dde6e8354ae6f321744843084, $v6a2139364f96787c8ce1bbb0070b898c, $v0d2ac6f3b02c0de484369013b31f2ed7, $v23aec26e2b521c0e5f1061b3d04983a5, $vc9409711ebff9250bd075037d3d18263, $v6b1a57fa235477758817df3c91158006) = $vf1965a857bc285d26fe22023aa5ab50d) {$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->is_locked = (bool) $v1945c9a2a5e2ba6133f1db6757a35fcb;$this->is_inheritable = (bool) $vd5752333adc3a004f826f2ea2a41273a;$this->is_visible = (bool) $ve1c6c9ef2fcbe75f26f815c4ef2e60b4;$this->field_type_id = (int) $v1e3f04102267eaf5e8d0ca424fd5c561;$this->guide_id = $v051369818a8073bba5feeb0e957eb308;$this->is_in_search = (bool) $v5fa2ecd1dc485ead330e65903d19650a;$this->is_in_filter = (bool) $ve4a2ed2dde6e8354ae6f321744843084;$this->tip = (string) $v6a2139364f96787c8ce1bbb0070b898c;$this->isRequired = (bool) $v0d2ac6f3b02c0de484369013b31f2ed7;$this->sortable = (bool) $v23aec26e2b521c0e5f1061b3d04983a5;$this->is_system = (bool) $vc9409711ebff9250bd075037d3d18263;$this->restrictionId = (int) $v6b1a57fa235477758817df3c91158006;}else {return false;}}protected function save() {$vb068931cc450442b63f5b3d276ea4297 = l_mysql_real_escape_string($this->name);$vd5d3db1765287eef77d7927cc956f50a = l_mysql_real_escape_string($this->title);$v1945c9a2a5e2ba6133f1db6757a35fcb = (int) $this->is_locked;$vd5752333adc3a004f826f2ea2a41273a = (int) $this->is_inheritable;$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = (int) $this->is_visible;$v1e3f04102267eaf5e8d0ca424fd5c561 = (int) $this->field_type_id;$v051369818a8073bba5feeb0e957eb308 = $this->guide_id ? (int) $this->guide_id : 'NULL';$v5fa2ecd1dc485ead330e65903d19650a = (int) $this->is_in_search;$ve4a2ed2dde6e8354ae6f321744843084 = (int) $this->is_in_filter;$v6a2139364f96787c8ce1bbb0070b898c = l_mysql_real_escape_string($this->tip);$v2a9d32d17ad47ac15c87d2e7c96d0e69 = (int) $this->isRequired;$v23aec26e2b521c0e5f1061b3d04983a5 = (int) $this->sortable;$v6b1a57fa235477758817df3c91158006 = (int) $this->restrictionId;$vc9409711ebff9250bd075037d3d18263 = (int) $this->is_system;$v2c4fe296b3cbdd86fd5aba8ebcad6d36 = $v6b1a57fa235477758817df3c91158006 ? ", restriction_id = '{$v6b1a57fa235477758817df3c91158006}'" : ", restriction_id = NULL";$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_object_fields SET name = '{$vb068931cc450442b63f5b3d276ea4297}', title = '{$vd5d3db1765287eef77d7927cc956f50a}', is_locked = '{$v1945c9a2a5e2ba6133f1db6757a35fcb}', is_inheritable = '{$vd5752333adc3a004f826f2ea2a41273a}', is_visible = '{$ve1c6c9ef2fcbe75f26f815c4ef2e60b4}', field_type_id = '{$v1e3f04102267eaf5e8d0ca424fd5c561}', guide_id = {$v051369818a8073bba5feeb0e957eb308}, in_search = '{$v5fa2ecd1dc485ead330e65903d19650a}', in_filter = '{$ve4a2ed2dde6e8354ae6f321744843084}', tip = '{$v6a2139364f96787c8ce1bbb0070b898c}', is_required = '{$v2a9d32d17ad47ac15c87d2e7c96d0e69}', sortable = '{$v23aec26e2b521c0e5f1061b3d04983a5}', is_system = '{$vc9409711ebff9250bd075037d3d18263}' {$v2c4fe296b3cbdd86fd5aba8ebcad6d36} WHERE id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);cacheFrontend::getInstance()->flush();return true;}}class umiFieldsGroup extends umiEntinty implements iUmiEntinty, iUmiFieldsGroup {private $name, $title,   $type_id, $ord,   $is_active = true, $is_visible = true, $is_locked = false,   $autoload_fields = false,   $fields = Array();protected $store_type = "fields_group";public function getName() {return $this->name;}public function getTitle() {return $this->translateLabel($this->title);}public function getTypeId() {return $this->type_id;}public function getOrd() {return $this->ord;}public function getIsActive() {return $this->is_active;}public function getIsVisible() {return $this->is_visible;}public function getIsLocked() {return $this->is_locked;}public function setName($vb068931cc450442b63f5b3d276ea4297) {$this->name = umiObjectProperty::filterInputString($vb068931cc450442b63f5b3d276ea4297);$this->setIsUpdated();}public function setTitle($vd5d3db1765287eef77d7927cc956f50a) {$vd5d3db1765287eef77d7927cc956f50a = $this->translateI18n($vd5d3db1765287eef77d7927cc956f50a, "fields-group");$this->title = umiObjectProperty::filterInputString($vd5d3db1765287eef77d7927cc956f50a);$this->setIsUpdated();}public function setTypeId($v94757cae63fd3e398c0811a976dd6bbe) {$vd14a8022b085f9ef19d479cbdd581127 = umiObjectTypesCollection::getInstance();if($vd14a8022b085f9ef19d479cbdd581127->isExists($v94757cae63fd3e398c0811a976dd6bbe)) {$this->type_id = $v94757cae63fd3e398c0811a976dd6bbe;return true;}else {return false;}}public function setOrd($v8bef1cc20ada3bef55fdf132cb2a1cb9) {$this->ord = $v8bef1cc20ada3bef55fdf132cb2a1cb9;$this->setIsUpdated();}public function setIsActive($v4264c638e0098acb172519b0436db099) {$this->is_active = (bool) $v4264c638e0098acb172519b0436db099;$this->setIsUpdated();}public function setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4) {$this->is_visible = (bool) $ve1c6c9ef2fcbe75f26f815c4ef2e60b4;$this->setIsUpdated();}public function setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb) {$this->is_locked = (bool) $v1945c9a2a5e2ba6133f1db6757a35fcb;$this->setIsUpdated();}protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name, title, type_id, is_active, is_visible, is_locked, ord FROM cms3_object_field_groups WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v94757cae63fd3e398c0811a976dd6bbe, $v4264c638e0098acb172519b0436db099, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4, $v1945c9a2a5e2ba6133f1db6757a35fcb, $v8bef1cc20ada3bef55fdf132cb2a1cb9) = $vf1965a857bc285d26fe22023aa5ab50d) {if(!umiObjectTypesCollection::getInstance()->isExists($v94757cae63fd3e398c0811a976dd6bbe)) {return false;}$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->type_id = $v94757cae63fd3e398c0811a976dd6bbe;$this->is_active = (bool) $v4264c638e0098acb172519b0436db099;$this->is_visible = (bool) $ve1c6c9ef2fcbe75f26f815c4ef2e60b4;$this->is_locked = (bool) $v1945c9a2a5e2ba6133f1db6757a35fcb;$this->ord = (int) $v8bef1cc20ada3bef55fdf132cb2a1cb9;if($this->autoload_fields) {return $this->loadFields();}else {return true;}}else {return false;}}protected function save() {$vb068931cc450442b63f5b3d276ea4297 = l_mysql_real_escape_string($this->name);$vd5d3db1765287eef77d7927cc956f50a = l_mysql_real_escape_string($this->title);$v94757cae63fd3e398c0811a976dd6bbe = (int) $this->type_id;$v4264c638e0098acb172519b0436db099 = (int) $this->is_active;$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = (int) $this->is_visible;$v8bef1cc20ada3bef55fdf132cb2a1cb9 = (int) $this->ord;$v1945c9a2a5e2ba6133f1db6757a35fcb = (int) $this->is_locked;$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_object_field_groups SET name = '{$vb068931cc450442b63f5b3d276ea4297}', title = '{$vd5d3db1765287eef77d7927cc956f50a}', type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}', is_active = '{$v4264c638e0098acb172519b0436db099}', is_visible = '{$ve1c6c9ef2fcbe75f26f815c4ef2e60b4}', ord = '{$v8bef1cc20ada3bef55fdf132cb2a1cb9}', is_locked = '{$v1945c9a2a5e2ba6133f1db6757a35fcb}' WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}else {return true;}}public function loadFields($vdf347a373b8f92aa0ae3dd920a5ec2f6 = false) {$vd05b6ed7d2345020440df396d6da7f73 = umiFieldsCollection::getInstance();if($vdf347a373b8f92aa0ae3dd920a5ec2f6 === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT cof.id, cof.name, cof.title, cof.is_locked, cof.is_inheritable, cof.is_visible, cof.field_type_id, cof.guide_id, cof.in_search, cof.in_filter, cof.tip, cof.is_required FROM cms3_fields_controller cfc, cms3_object_fields cof WHERE cfc.group_id = '{$this->id}' AND cof.id = cfc.field_id ORDER BY cfc.ord ASC";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}while(list($v3aabf39f2d943fa886d86dcbbee4d910) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {if($v06e3d36fa30cea095545139854ad1fb9 = $vd05b6ed7d2345020440df396d6da7f73->getField($v3aabf39f2d943fa886d86dcbbee4d910, $vf1965a857bc285d26fe22023aa5ab50d)) {$this->fields[$v3aabf39f2d943fa886d86dcbbee4d910] = $v06e3d36fa30cea095545139854ad1fb9;}}}else {foreach($vdf347a373b8f92aa0ae3dd920a5ec2f6 as $vf1965a857bc285d26fe22023aa5ab50d) {list($v3aabf39f2d943fa886d86dcbbee4d910) = $vf1965a857bc285d26fe22023aa5ab50d;if($v06e3d36fa30cea095545139854ad1fb9 = $vd05b6ed7d2345020440df396d6da7f73->getField($v3aabf39f2d943fa886d86dcbbee4d910, $vf1965a857bc285d26fe22023aa5ab50d)) {$this->fields[$v3aabf39f2d943fa886d86dcbbee4d910] = $v06e3d36fa30cea095545139854ad1fb9;}}}}public function getFields() {return $this->fields;}private function isLoaded($v3aabf39f2d943fa886d86dcbbee4d910) {return (bool) array_key_exists($v3aabf39f2d943fa886d86dcbbee4d910, $this->fields);}public function attachField($v3aabf39f2d943fa886d86dcbbee4d910, $vcfc3576cd3c177283e25ebc525a5aece = false) {if($this->isLoaded($v3aabf39f2d943fa886d86dcbbee4d910) && !$vcfc3576cd3c177283e25ebc525a5aece) {return true;}else {$v3aabf39f2d943fa886d86dcbbee4d910 = (int) $v3aabf39f2d943fa886d86dcbbee4d910;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT MAX(ord) FROM cms3_fields_controller WHERE group_id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}list($v8bef1cc20ada3bef55fdf132cb2a1cb9) = mysql_fetch_row($result);$v8bef1cc20ada3bef55fdf132cb2a1cb9 += 5;$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_fields_controller (field_id, group_id, ord) VALUES('{$v3aabf39f2d943fa886d86dcbbee4d910}', '{$this->id}', '{$v8bef1cc20ada3bef55fdf132cb2a1cb9}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}cacheFrontend::getInstance()->flush();$vd05b6ed7d2345020440df396d6da7f73 = umiFieldsCollection::getInstance();$v06e3d36fa30cea095545139854ad1fb9 = $vd05b6ed7d2345020440df396d6da7f73->getField($v3aabf39f2d943fa886d86dcbbee4d910);$this->fields[$v3aabf39f2d943fa886d86dcbbee4d910] = $v06e3d36fa30cea095545139854ad1fb9;$this->fillInContentTable($v3aabf39f2d943fa886d86dcbbee4d910);}}protected function fillInContentTable($v3aabf39f2d943fa886d86dcbbee4d910) {$v94757cae63fd3e398c0811a976dd6bbe = (int) $this->type_id;$v3aabf39f2d943fa886d86dcbbee4d910 = (int) $v3aabf39f2d943fa886d86dcbbee4d910;$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_object_content (obj_id, field_id, int_val, varchar_val, text_val, rel_val, tree_val, float_val) SELECT id, {$v3aabf39f2d943fa886d86dcbbee4d910}, NULL, NULL, NULL, NULL, NULL, NULL FROM cms3_objects WHERE type_id = {$v94757cae63fd3e398c0811a976dd6bbe}";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}}public function detachField($v3aabf39f2d943fa886d86dcbbee4d910) {if($this->isLoaded($v3aabf39f2d943fa886d86dcbbee4d910)) {$v3aabf39f2d943fa886d86dcbbee4d910 = (int) $v3aabf39f2d943fa886d86dcbbee4d910;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_fields_controller WHERE field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' AND group_id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}unset($this->fields[$v3aabf39f2d943fa886d86dcbbee4d910]);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms3_fields_controller WHERE field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}cacheFrontend::getInstance()->flush();if(list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result)) {return ($v4a8a08f09d37b73795649038408b5f33 == 0) ? umiFieldsCollection::getInstance()->delField($v3aabf39f2d943fa886d86dcbbee4d910) : true;}else return false;return true;}else {return false;}}public function moveFieldAfter($v3aabf39f2d943fa886d86dcbbee4d910, $vfcd4b86e12c95a57c24239e8a4125360, $v0e939a4ffd3aacd724dd3b50147b4353, $v3f84b203eef48e9862ac1ffbe344dffe) {if($vfcd4b86e12c95a57c24239e8a4125360 == 0) {$vf2400bf3c8b70283e04af07d6d67fe6a = 0;}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT ord FROM cms3_fields_controller WHERE group_id = '{$v0e939a4ffd3aacd724dd3b50147b4353}' AND field_id = '{$vfcd4b86e12c95a57c24239e8a4125360}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}else {list($vf2400bf3c8b70283e04af07d6d67fe6a) = mysql_fetch_row($result);}}if($v3f84b203eef48e9862ac1ffbe344dffe) {$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_fields_controller SET ord = (ord + 1) WHERE group_id = '{$this->id}' AND ord >= '{$vf2400bf3c8b70283e04af07d6d67fe6a}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT MAX(ord) FROM cms3_fields_controller WHERE group_id = '{$v0e939a4ffd3aacd724dd3b50147b4353}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}list($vf2400bf3c8b70283e04af07d6d67fe6a) = mysql_fetch_row($result);++$vf2400bf3c8b70283e04af07d6d67fe6a;}$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_fields_controller SET ord = '{$vf2400bf3c8b70283e04af07d6d67fe6a}', group_id = '$v0e939a4ffd3aacd724dd3b50147b4353' WHERE group_id = '{$this->id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);cacheFrontend::getInstance()->flush();if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}else {return true;}}public function commit() {parent::commit();cacheFrontend::getInstance()->flush();}public static function getAllGroupsByName($vb068931cc450442b63f5b3d276ea4297) {if($vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = l_mysql_real_escape_string($vb068931cc450442b63f5b3d276ea4297);}else {return false;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `id` FROM `cms3_object_field_groups` WHERE `name` = '{$vb068931cc450442b63f5b3d276ea4297}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v1471e4e05a4db95d353cc867fe317314 = Array();while(list($v47db2588331bbe530c80dd001fc60aed) = mysql_fetch_row($result)) {$vdb0f6f37ebeb6ea09489124345af2a45 = new umiFieldsGroup($v47db2588331bbe530c80dd001fc60aed);if($vdb0f6f37ebeb6ea09489124345af2a45 instanceof umiFieldsGroup) {$v1471e4e05a4db95d353cc867fe317314[] = $vdb0f6f37ebeb6ea09489124345af2a45;}}return $v1471e4e05a4db95d353cc867fe317314;}};class umiObjectType extends umiEntinty implements iUmiEntinty, iUmiObjectType {private $name, $parent_id, $is_locked = false;private $field_groups = Array(), $field_all_groups = Array();private $is_guidable = false, $is_public = false, $hierarchy_type_id;private $sortable = false;private $guid = null;protected $store_type = "object_type";public function getName() {return $this->translateLabel($this->name);}public function setName($vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = $this->translateI18n($vb068931cc450442b63f5b3d276ea4297, "object-type-");$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->setIsUpdated();}public function getIsLocked() {return $this->is_locked;}public function setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb) {$this->is_locked = (bool) $v1945c9a2a5e2ba6133f1db6757a35fcb;$this->setIsUpdated();}public function getParentId() {return $this->parent_id;}public function getIsGuidable() {return $this->is_guidable;}public function setIsGuidable($v7617e8d03bb811f5c37135234006b114) {$this->is_guidable = (bool) $v7617e8d03bb811f5c37135234006b114;$this->setIsUpdated();}public function getIsPublic() {return $this->is_public;}public function setIsPublic($v117256556af3bd1a0c9710a593d93814) {$this->is_public = (bool) $v117256556af3bd1a0c9710a593d93814;$this->setIsUpdated();}public function getHierarchyTypeId() {return $this->hierarchy_type_id;}public function getIsSortable() {return $this->sortable;}public function setIsSortable($v23aec26e2b521c0e5f1061b3d04983a5 = false) {$this->sortable = (bool) $v23aec26e2b521c0e5f1061b3d04983a5;}public function setHierarchyTypeId($v0715f6d9497f93911417c9c324265771) {$this->hierarchy_type_id = (int) $v0715f6d9497f93911417c9c324265771;$this->setIsUpdated();}public function addFieldsGroup($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v4264c638e0098acb172519b0436db099 = true, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = true) {if ($vdb0f6f37ebeb6ea09489124345af2a45 = $this->getFieldsGroupByName($vb068931cc450442b63f5b3d276ea4297)) {return $vdb0f6f37ebeb6ea09489124345af2a45->getId();}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT MAX(ord) FROM cms3_object_field_groups WHERE type_id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}if (list($v8bef1cc20ada3bef55fdf132cb2a1cb9) = mysql_fetch_row($result)) {$v8bef1cc20ada3bef55fdf132cb2a1cb9 = ((int) $v8bef1cc20ada3bef55fdf132cb2a1cb9) + 5;}else {$v8bef1cc20ada3bef55fdf132cb2a1cb9 = 1;}$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_object_field_groups (type_id, ord) VALUES('{$this->id}', '{$v8bef1cc20ada3bef55fdf132cb2a1cb9}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$v6c26c1979a522c2dd7e76e527aa69ca5 = l_mysql_insert_id();$v38f582e54454005ec0664831734e1152 = new umiFieldsGroup($v6c26c1979a522c2dd7e76e527aa69ca5);$v38f582e54454005ec0664831734e1152->setName($vb068931cc450442b63f5b3d276ea4297);$v38f582e54454005ec0664831734e1152->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v38f582e54454005ec0664831734e1152->setIsActive($v4264c638e0098acb172519b0436db099);$v38f582e54454005ec0664831734e1152->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4);$v38f582e54454005ec0664831734e1152->commit();$this->field_groups[$v6c26c1979a522c2dd7e76e527aa69ca5] = $v38f582e54454005ec0664831734e1152;$this->field_all_groups[$v6c26c1979a522c2dd7e76e527aa69ca5] = $v38f582e54454005ec0664831734e1152;$v2af1d1812273df0bd0f720da7068f8a6 = umiObjectTypesCollection::getInstance()->getSubTypesList($this->id);$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v2af1d1812273df0bd0f720da7068f8a6);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vd4fd255f51559df00de5424b64292413 = $v2af1d1812273df0bd0f720da7068f8a6[$v865c0c0b4ab0e063e5caa3387c1a8741];if ($v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($vd4fd255f51559df00de5424b64292413)) {$v599dcce2998a6b40b1e38e8c6006cb0a->addFieldsGroup($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v4264c638e0098acb172519b0436db099, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4);}else {throw new coreException("Can't load object type #{$vd4fd255f51559df00de5424b64292413}");}}cacheFrontend::getInstance()->flush();return $v6c26c1979a522c2dd7e76e527aa69ca5;}public function delFieldsGroup($v3fdcf94940aa24dc024a819904427035) {if ($this->isFieldsGroupExists($v3fdcf94940aa24dc024a819904427035)) {$v3fdcf94940aa24dc024a819904427035 = (int) $v3fdcf94940aa24dc024a819904427035;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_object_field_groups WHERE id = '{$v3fdcf94940aa24dc024a819904427035}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}unset($this->field_groups[$v3fdcf94940aa24dc024a819904427035]);cacheFrontend::getInstance()->flush();return true;}else {return false;}}public function getFieldsGroupByName($v120aafc4d1ddeda208736bcfa6be14cb, $v2341fa2230653c0d670ff747cb70c10d = false) {$v1471e4e05a4db95d353cc867fe317314 = $this->getFieldsGroupsList($v2341fa2230653c0d670ff747cb70c10d);foreach ($v1471e4e05a4db95d353cc867fe317314 as $v47db2588331bbe530c80dd001fc60aed => $vdb0f6f37ebeb6ea09489124345af2a45) {if ($vdb0f6f37ebeb6ea09489124345af2a45->getName() == $v120aafc4d1ddeda208736bcfa6be14cb) {return $vdb0f6f37ebeb6ea09489124345af2a45;}}return false;}public function getFieldsGroup($v3fdcf94940aa24dc024a819904427035, $vc5a4db6951a1f7b0728c532c01f58793 = false) {if($this->isFieldsGroupExists($v3fdcf94940aa24dc024a819904427035)) {if ($vc5a4db6951a1f7b0728c532c01f58793) {return $this->field_all_groups[$v3fdcf94940aa24dc024a819904427035];}else {if (array_key_exists($v3fdcf94940aa24dc024a819904427035, $this->field_groups)) {return $this->field_groups[$v3fdcf94940aa24dc024a819904427035];}else {return false;}}}else {return false;}}public function getFieldsGroupsList($v370a5fabf1a6ce8eea9597760df7de41 = false) {return $v370a5fabf1a6ce8eea9597760df7de41 ? $this->field_all_groups : $this->field_groups;}private function isFieldsGroupExists($v3fdcf94940aa24dc024a819904427035) {if (!$v3fdcf94940aa24dc024a819904427035) {return false;}else {return (bool) array_key_exists($v3fdcf94940aa24dc024a819904427035, $this->field_all_groups);}}protected function loadInfo() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT name, parent_id, is_locked, is_guidable, is_public, hierarchy_type_id, sortable, guid FROM cms3_object_types WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if (list($vb068931cc450442b63f5b3d276ea4297, $v6be379826b20cc58475f636e33f4606b, $v1945c9a2a5e2ba6133f1db6757a35fcb, $v7617e8d03bb811f5c37135234006b114, $v117256556af3bd1a0c9710a593d93814, $v0715f6d9497f93911417c9c324265771, $v23aec26e2b521c0e5f1061b3d04983a5, $v1e0ca5b1252f1f6b1e0ac91be7e7219e) = mysql_fetch_row($result)) {$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->parent_id = (int) $v6be379826b20cc58475f636e33f4606b;$this->is_locked = (bool) $v1945c9a2a5e2ba6133f1db6757a35fcb;$this->is_guidable = (bool) $v7617e8d03bb811f5c37135234006b114;$this->is_public = (bool) $v117256556af3bd1a0c9710a593d93814;$this->hierarchy_type_id = (int) $v0715f6d9497f93911417c9c324265771;$this->sortable = (bool) $v23aec26e2b521c0e5f1061b3d04983a5;$this->guid = $v1e0ca5b1252f1f6b1e0ac91be7e7219e;return $this->loadFieldsGroups();}else {return false;}}private function loadFieldsGroups() {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT
   ofg.id as groupId, cof.id, cof.name, cof.title, cof.is_locked, cof.is_inheritable, cof.is_visible, cof.field_type_id, cof.guide_id, cof.in_search, cof.in_filter, cof.tip, cof.is_required, cof.sortable, cof.is_system, cof.restriction_id
      FROM cms3_object_field_groups ofg, cms3_fields_controller cfc, cms3_object_fields cof
         WHERE ofg.type_id = '{$this->id}' AND cfc.group_id = ofg.id AND cof.id = cfc.field_id
            ORDER BY ofg.ord ASC, cfc.ord ASC
SQL;   $result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vd05b6ed7d2345020440df396d6da7f73 = Array();while (list($v0e939a4ffd3aacd724dd3b50147b4353, $vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v1945c9a2a5e2ba6133f1db6757a35fcb, $vd5752333adc3a004f826f2ea2a41273a, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4, $v1e3f04102267eaf5e8d0ca424fd5c561, $v051369818a8073bba5feeb0e957eb308, $v5fa2ecd1dc485ead330e65903d19650a, $ve4a2ed2dde6e8354ae6f321744843084, $v6a2139364f96787c8ce1bbb0070b898c, $v0d2ac6f3b02c0de484369013b31f2ed7, $vc9409711ebff9250bd075037d3d18263, $v23aec26e2b521c0e5f1061b3d04983a5, $v228c63e369a5906eb7f0500a13729edc) = mysql_fetch_row($result)) {if (!isset($vd05b6ed7d2345020440df396d6da7f73[$v0e939a4ffd3aacd724dd3b50147b4353]) || !is_array($vd05b6ed7d2345020440df396d6da7f73[$v0e939a4ffd3aacd724dd3b50147b4353])) {$vd05b6ed7d2345020440df396d6da7f73[$v0e939a4ffd3aacd724dd3b50147b4353] = Array();}$vd05b6ed7d2345020440df396d6da7f73[$v0e939a4ffd3aacd724dd3b50147b4353][] = Array($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v1945c9a2a5e2ba6133f1db6757a35fcb, $vd5752333adc3a004f826f2ea2a41273a, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4, $v1e3f04102267eaf5e8d0ca424fd5c561, $v051369818a8073bba5feeb0e957eb308, $v5fa2ecd1dc485ead330e65903d19650a, $ve4a2ed2dde6e8354ae6f321744843084, $v6a2139364f96787c8ce1bbb0070b898c, $v0d2ac6f3b02c0de484369013b31f2ed7, $vc9409711ebff9250bd075037d3d18263, $v23aec26e2b521c0e5f1061b3d04983a5, $v228c63e369a5906eb7f0500a13729edc);}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name, title, type_id, is_active, is_visible, is_locked, ord FROM cms3_object_field_groups WHERE type_id = '{$this->id}' ORDER BY ord ASC";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while (list($v6c26c1979a522c2dd7e76e527aa69ca5,,,,$v367e854225a0810977297b3bedb2f309) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {$v38f582e54454005ec0664831734e1152 = new umiFieldsGroup($v6c26c1979a522c2dd7e76e527aa69ca5, $vf1965a857bc285d26fe22023aa5ab50d);if (!isset($vd05b6ed7d2345020440df396d6da7f73[$v6c26c1979a522c2dd7e76e527aa69ca5])) {$vd05b6ed7d2345020440df396d6da7f73[$v6c26c1979a522c2dd7e76e527aa69ca5] = Array();}$v38f582e54454005ec0664831734e1152->loadFields($vd05b6ed7d2345020440df396d6da7f73[$v6c26c1979a522c2dd7e76e527aa69ca5]);$this->field_all_groups[$v6c26c1979a522c2dd7e76e527aa69ca5] = $v38f582e54454005ec0664831734e1152;if ($v367e854225a0810977297b3bedb2f309) {$this->field_groups[$v6c26c1979a522c2dd7e76e527aa69ca5] = $v38f582e54454005ec0664831734e1152;}}return true;}protected function save() {$vb068931cc450442b63f5b3d276ea4297 = umiObjectProperty::filterInputString($this->name);$v1e0ca5b1252f1f6b1e0ac91be7e7219e = umiObjectProperty::filterInputString($this->guid);$v6be379826b20cc58475f636e33f4606b = (int) $this->parent_id;$v1945c9a2a5e2ba6133f1db6757a35fcb = (int) $this->is_locked;$v7617e8d03bb811f5c37135234006b114 = (int) $this->is_guidable;$v117256556af3bd1a0c9710a593d93814 = (int) $this->is_public;$v0715f6d9497f93911417c9c324265771 = (int) $this->hierarchy_type_id;$v23aec26e2b521c0e5f1061b3d04983a5 = (int) $this->sortable;$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_object_types SET name = '{$vb068931cc450442b63f5b3d276ea4297}', guid = '{$v1e0ca5b1252f1f6b1e0ac91be7e7219e}', parent_id = '{$v6be379826b20cc58475f636e33f4606b}', is_locked = '{$v1945c9a2a5e2ba6133f1db6757a35fcb}', is_guidable = '{$v7617e8d03bb811f5c37135234006b114}', is_public = '{$v117256556af3bd1a0c9710a593d93814}', hierarchy_type_id = '{$v0715f6d9497f93911417c9c324265771}', sortable = '{$v23aec26e2b521c0e5f1061b3d04983a5}' WHERE id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);cacheFrontend::getInstance()->flush();if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}return true;}public function setFieldGroupOrd($v0e939a4ffd3aacd724dd3b50147b4353, $vf2400bf3c8b70283e04af07d6d67fe6a, $v3f84b203eef48e9862ac1ffbe344dffe) {$vf2400bf3c8b70283e04af07d6d67fe6a = (int) $vf2400bf3c8b70283e04af07d6d67fe6a;$v0e939a4ffd3aacd724dd3b50147b4353 = (int) $v0e939a4ffd3aacd724dd3b50147b4353;if (!$v3f84b203eef48e9862ac1ffbe344dffe) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT type_id FROM cms3_object_field_groups WHERE id = '{$v0e939a4ffd3aacd724dd3b50147b4353}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}if (!(list($v94757cae63fd3e398c0811a976dd6bbe) = mysql_fetch_row($result))) {return false;}$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_object_field_groups SET ord = (ord + 1) WHERE type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}' AND ord >= '{$vf2400bf3c8b70283e04af07d6d67fe6a}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}}$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_object_field_groups SET ord = '{$vf2400bf3c8b70283e04af07d6d67fe6a}' WHERE id = '{$v0e939a4ffd3aacd724dd3b50147b4353}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);cacheFrontend::getInstance()->flush();if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}return true;}public function getAllFields($v33a8421fb9f5a2636cefaed92ae056c3 = false) {$vd05b6ed7d2345020440df396d6da7f73 = Array();$v1471e4e05a4db95d353cc867fe317314 = $this->getFieldsGroupsList();foreach ($v1471e4e05a4db95d353cc867fe317314 as $vdb0f6f37ebeb6ea09489124345af2a45) {if ($v33a8421fb9f5a2636cefaed92ae056c3) {if (!$vdb0f6f37ebeb6ea09489124345af2a45->getIsVisible()) {continue;}}$vd05b6ed7d2345020440df396d6da7f73 = array_merge($vd05b6ed7d2345020440df396d6da7f73, $vdb0f6f37ebeb6ea09489124345af2a45->getFields());}return $vd05b6ed7d2345020440df396d6da7f73;}public function getFieldId($v972bf3f05d14ffbdb817bef60638ff00, $v6bd2538e48a1e53b65fcff51a2296046 = true) {$v1471e4e05a4db95d353cc867fe317314 = $this->getFieldsGroupsList(!$v6bd2538e48a1e53b65fcff51a2296046);foreach ($v1471e4e05a4db95d353cc867fe317314 as $v47db2588331bbe530c80dd001fc60aed => $vdb0f6f37ebeb6ea09489124345af2a45) {$vd05b6ed7d2345020440df396d6da7f73 = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v945100186b119048837b9859c2c46410 => $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getName() == $v972bf3f05d14ffbdb817bef60638ff00) {return $v06e3d36fa30cea095545139854ad1fb9->getId();}}}return false;}public function getModule() {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $this->getHierarchyTypeId();$v89b0b9deff65f8b9cd1f71bc74ce36ba = umiHierarchyTypesCollection::getInstance()->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {return $v89b0b9deff65f8b9cd1f71bc74ce36ba->getName();}else {return false;}}public function getMethod() {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $this->getHierarchyTypeId();$v89b0b9deff65f8b9cd1f71bc74ce36ba = umiHierarchyTypesCollection::getInstance()->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {return $v89b0b9deff65f8b9cd1f71bc74ce36ba->getExt();}else {return false;}}public function getGUID() {return $this->guid;}public function setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e) {$vb80bb7740288fda1f201890375a60c8f = umiObjectTypesCollection::getInstance()->getTypeIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if($vb80bb7740288fda1f201890375a60c8f && $vb80bb7740288fda1f201890375a60c8f != $this->id) {throw new coreException("GUID {$v1e0ca5b1252f1f6b1e0ac91be7e7219e} already in use");}$this->guid = $v1e0ca5b1252f1f6b1e0ac91be7e7219e;$this->setIsUpdated();}};class umiObject extends umiEntinty implements iUmiEntinty, iUmiObject {private $name, $type_id, $is_locked, $owner_id = false,   $type, $properties = Array(), $prop_groups = Array(), $guid = null, $type_guid = null;protected $store_type = "object";public function getName($v550dc225cad913e4f765ae3862e42a3e = false) {$this->name = umiObjectProperty::filterOutputString($this->name);return $v550dc225cad913e4f765ae3862e42a3e ? $this->name : $this->translateLabel($this->name);}public function getTypeId() {return $this->type_id;}public function getTypeGUID(){return $this->type_guid;}public function getType() {if(!$this->type) {$this->loadType();}return $this->type;}public function getIsLocked() {return $this->is_locked;}public function setName($vb068931cc450442b63f5b3d276ea4297) {$vfb5eb12472d87d2d7be0b9ca6a410c2b = array(1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20,21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31);$v240bf022e685b0ee30ad9fe9e1fb5d5b ='';foreach ($vfb5eb12472d87d2d7be0b9ca6a410c2b as $v97bff26855a8bfa63e05d5477e794b24) {$v240bf022e685b0ee30ad9fe9e1fb5d5b = $v240bf022e685b0ee30ad9fe9e1fb5d5b . chr($v97bff26855a8bfa63e05d5477e794b24);}$vb068931cc450442b63f5b3d276ea4297 = preg_replace("/[" . $v240bf022e685b0ee30ad9fe9e1fb5d5b . "]/isu", "", $vb068931cc450442b63f5b3d276ea4297);$vb068931cc450442b63f5b3d276ea4297 = $this->translateI18n($vb068931cc450442b63f5b3d276ea4297, "object-");$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->setIsUpdated();}public function setTypeId($v94757cae63fd3e398c0811a976dd6bbe) {if ($this->type_id !== $v94757cae63fd3e398c0811a976dd6bbe) {$this->type_id = $v94757cae63fd3e398c0811a976dd6bbe;$this->setIsUpdated();}return true;}public function setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb) {if ($this->is_locked !== ((bool) $v1945c9a2a5e2ba6133f1db6757a35fcb)) {$this->is_locked = (bool) $v1945c9a2a5e2ba6133f1db6757a35fcb;$this->setIsUpdated();}}public function setOwnerId($vb0ab4f7791b60b1e8ea01057b77873b0) {if (!is_null($vb0ab4f7791b60b1e8ea01057b77873b0) and umiObjectsCollection::getInstance()->isExists($vb0ab4f7791b60b1e8ea01057b77873b0)) {if ($this->owner_id !== $vb0ab4f7791b60b1e8ea01057b77873b0) {$this->owner_id = $vb0ab4f7791b60b1e8ea01057b77873b0;$this->setIsUpdated();}return true;}else {if (!is_null($this->owner_id)) {$this->owner_id = NULL;$this->setIsUpdated();}return false;}}public function getOwnerId() {return $this->owner_id;}public function isFilled() {$vd05b6ed7d2345020440df396d6da7f73 = $this->type->getAllFields();foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9)    if ($v06e3d36fa30cea095545139854ad1fb9->getIsRequired() && is_null($this->getValue($v06e3d36fa30cea095545139854ad1fb9->getName())))     return false;return true;}protected function save() {if ($this->is_updated) {$vb068931cc450442b63f5b3d276ea4297 = umiObjectProperty::filterInputString($this->name);$v1e0ca5b1252f1f6b1e0ac91be7e7219e = umiObjectProperty::filterInputString($this->guid);$v94757cae63fd3e398c0811a976dd6bbe = (int) $this->type_id;$v1945c9a2a5e2ba6133f1db6757a35fcb = (int) $this->is_locked;$v5e7b19364b8de2dedd3aa48cf62706e3 = (int) $this->owner_id;$vac5c74b64b4b8352ef2f181affb5ac2a = "START TRANSACTION /* Updating object #{$this->id} info */";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$vc200d1cdcad0901ed1f5100f96a16c1e = $vb068931cc450442b63f5b3d276ea4297 ? "'{$vb068931cc450442b63f5b3d276ea4297}'" : "NULL";$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_objects SET name = {$vc200d1cdcad0901ed1f5100f96a16c1e}, type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}', is_locked = '{$v1945c9a2a5e2ba6133f1db6757a35fcb}', owner_id = '{$v5e7b19364b8de2dedd3aa48cf62706e3}', guid = '{$v1e0ca5b1252f1f6b1e0ac91be7e7219e}' WHERE id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}foreach ($this->properties as $v23a5b8ab834cb5140fa6665622eb6417) {if (is_object($v23a5b8ab834cb5140fa6665622eb6417)) {$v23a5b8ab834cb5140fa6665622eb6417->commit();}}$vac5c74b64b4b8352ef2f181affb5ac2a = "COMMIT";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$this->setIsUpdated(false);}return true;}public function __construct($vb80bb7740288fda1f201890375a60c8f, $vf1965a857bc285d26fe22023aa5ab50d = false) {parent::__construct($vb80bb7740288fda1f201890375a60c8f, $vf1965a857bc285d26fe22023aa5ab50d);}protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if ($vf1965a857bc285d26fe22023aa5ab50d === false || count($vf1965a857bc285d26fe22023aa5ab50d) < 6) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT o.name, o.type_id, o.is_locked, o.owner_id, o.guid as `guid`, t.guid as `type_guid` FROM cms3_objects `o`, cms3_object_types `t` WHERE o.id = '{$this->id}' and o.type_id = t.id";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {cacheFrontend::getInstance()->del($va8cfde6331bd59eb2ac96f8911c4b666->getId(), "object");throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);if (!$vf1965a857bc285d26fe22023aa5ab50d) {throw new coreException("Object #{$this->id} doesn't exists");}}list($vb068931cc450442b63f5b3d276ea4297, $v94757cae63fd3e398c0811a976dd6bbe, $v1945c9a2a5e2ba6133f1db6757a35fcb, $v5e7b19364b8de2dedd3aa48cf62706e3, $v1e0ca5b1252f1f6b1e0ac91be7e7219e, $vca12b90a66059f75e25460e700ed4c61) = $vf1965a857bc285d26fe22023aa5ab50d;if (!$v94757cae63fd3e398c0811a976dd6bbe) {umiObjectsCollection::getInstance()->delObject($this->id);return false;}$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->type_id = (int) $v94757cae63fd3e398c0811a976dd6bbe;$this->is_locked = (bool) $v1945c9a2a5e2ba6133f1db6757a35fcb;$this->owner_id = (int) $v5e7b19364b8de2dedd3aa48cf62706e3;$this->guid = $v1e0ca5b1252f1f6b1e0ac91be7e7219e;$this->type_guid = $vca12b90a66059f75e25460e700ed4c61;return $this->loadType();}private function loadType() {$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($this->type_id);if (!$v599dcce2998a6b40b1e38e8c6006cb0a) {throw new coreException("Can't load type in object's init");}$this->type = $v599dcce2998a6b40b1e38e8c6006cb0a;return $this->loadProperties();}private function loadProperties() {$v599dcce2998a6b40b1e38e8c6006cb0a = $this->type;$v041f36f9e13e5473c5b995506bad2aaa = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroupsList();foreach ($v041f36f9e13e5473c5b995506bad2aaa as $vdb0f6f37ebeb6ea09489124345af2a45) {if ($vdb0f6f37ebeb6ea09489124345af2a45->getIsActive() == false) {continue;}$vd05b6ed7d2345020440df396d6da7f73 = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();$this->prop_groups[$vdb0f6f37ebeb6ea09489124345af2a45->getId()] = Array();foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {$this->properties[$v06e3d36fa30cea095545139854ad1fb9->getId()] = $v06e3d36fa30cea095545139854ad1fb9->getName();$this->prop_groups[$vdb0f6f37ebeb6ea09489124345af2a45->getId()][] = $v06e3d36fa30cea095545139854ad1fb9->getId();}}}public function getPropByName($vdfc394bd05a4b48161c790034af522a8) {$vdfc394bd05a4b48161c790034af522a8 = strtolower($vdfc394bd05a4b48161c790034af522a8);foreach ($this->properties as $v3aabf39f2d943fa886d86dcbbee4d910 => $v23a5b8ab834cb5140fa6665622eb6417) {if (is_object($v23a5b8ab834cb5140fa6665622eb6417)) {if ($v23a5b8ab834cb5140fa6665622eb6417->getName() == $vdfc394bd05a4b48161c790034af522a8) {return $v23a5b8ab834cb5140fa6665622eb6417;}}else {if (strtolower($v23a5b8ab834cb5140fa6665622eb6417) == $vdfc394bd05a4b48161c790034af522a8) {$v23a5b8ab834cb5140fa6665622eb6417 = cacheFrontend::getInstance()->load($this->id . "." . $v3aabf39f2d943fa886d86dcbbee4d910, "property");if ($v23a5b8ab834cb5140fa6665622eb6417 instanceof umiObjectProperty == false) {$v23a5b8ab834cb5140fa6665622eb6417 = umiObjectProperty::getProperty($this->id, $v3aabf39f2d943fa886d86dcbbee4d910, $this->type_id);cacheFrontend::getInstance()->save($v23a5b8ab834cb5140fa6665622eb6417, "property");}$this->properties[$v3aabf39f2d943fa886d86dcbbee4d910] = $v23a5b8ab834cb5140fa6665622eb6417;return $v23a5b8ab834cb5140fa6665622eb6417;}}}return NULL;}public function getPropById($v3aabf39f2d943fa886d86dcbbee4d910) {if (!$this->isPropertyExists($v3aabf39f2d943fa886d86dcbbee4d910)) {return NULL;}else {if (!is_object($this->properties)) {$this->properties[$v3aabf39f2d943fa886d86dcbbee4d910] = umiObjectProperty::getProperty($this->id, $v3aabf39f2d943fa886d86dcbbee4d910, $this->type_id);}return $this->properties[$v3aabf39f2d943fa886d86dcbbee4d910];}}public function isPropertyExists($v3aabf39f2d943fa886d86dcbbee4d910) {return (bool) array_key_exists($v3aabf39f2d943fa886d86dcbbee4d910, $this->properties);}public function isPropGroupExists($vb78a51df08ebf5c0b87001c180e3c2ab) {return (bool) array_key_exists($vb78a51df08ebf5c0b87001c180e3c2ab, $this->prop_groups);}public function getPropGroupId($v630d7459cbc61bfef50b1a0fff2ea42e) {$v041f36f9e13e5473c5b995506bad2aaa = $this->getType()->getFieldsGroupsList();foreach ($v041f36f9e13e5473c5b995506bad2aaa as $vdb0f6f37ebeb6ea09489124345af2a45) {if ($vdb0f6f37ebeb6ea09489124345af2a45->getName() == $v630d7459cbc61bfef50b1a0fff2ea42e) {return $vdb0f6f37ebeb6ea09489124345af2a45->getId();}}return false;}public function getPropGroupByName($v630d7459cbc61bfef50b1a0fff2ea42e) {if ($v0e939a4ffd3aacd724dd3b50147b4353 = $this->getPropGroupId($v630d7459cbc61bfef50b1a0fff2ea42e)) {return $this->getPropGroupById($v0e939a4ffd3aacd724dd3b50147b4353);}else {return false;}}public function getPropGroupById($vb78a51df08ebf5c0b87001c180e3c2ab) {if ($this->isPropGroupExists($vb78a51df08ebf5c0b87001c180e3c2ab)) {return $this->prop_groups[$vb78a51df08ebf5c0b87001c180e3c2ab];}else {return false;}}public function getValue($vdfc394bd05a4b48161c790034af522a8, $v21ffce5b8a6cc8cc6a41448dd69623c9 = NULL) {if ($v23a5b8ab834cb5140fa6665622eb6417 = $this->getPropByName($vdfc394bd05a4b48161c790034af522a8)) {return $v23a5b8ab834cb5140fa6665622eb6417->getValue($v21ffce5b8a6cc8cc6a41448dd69623c9);}else {return false;}}public function setValue($vdfc394bd05a4b48161c790034af522a8, $v2771be291c4a714ca95fd1f45a32403e) {if ($v23a5b8ab834cb5140fa6665622eb6417 = $this->getPropByName($vdfc394bd05a4b48161c790034af522a8)) {$this->setIsUpdated();return $v23a5b8ab834cb5140fa6665622eb6417->setValue($v2771be291c4a714ca95fd1f45a32403e);}else {return false;}}public function commit() {l_mysql_query("START TRANSACTION /* Saving object {$this->id} */");$v3c9c288f4021bd9f84c98cc0eddd1838 = umiObjectProperty::$USE_TRANSACTIONS;umiObjectProperty::$USE_TRANSACTIONS = false;if ($this->checkSelf()) {foreach ($this->properties as $v23a5b8ab834cb5140fa6665622eb6417) {if (is_object($v23a5b8ab834cb5140fa6665622eb6417)) {$v23a5b8ab834cb5140fa6665622eb6417->commit();}}}parent::commit();l_mysql_query("COMMIT");umiObjectProperty::$USE_TRANSACTIONS = $v3c9c288f4021bd9f84c98cc0eddd1838;}public function checkSelf() {static $v9b207167e5381c47682c6b4f58a623fb;if ($v9b207167e5381c47682c6b4f58a623fb !== null) {return $v9b207167e5381c47682c6b4f58a623fb;}if (!cacheFrontend::getInstance()->getIsConnected()) {return $v9b207167e5381c47682c6b4f58a623fb = true;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_objects WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$v9b207167e5381c47682c6b4f58a623fb = (bool) mysql_num_rows($result);if (!$v9b207167e5381c47682c6b4f58a623fb) {cacheFrontend::getInstance()->flush();}return $v9b207167e5381c47682c6b4f58a623fb;}public function setIsUpdated($v8de61324edc43f3acb1b73da3c63e89e = true) {umiObjectsCollection::getInstance()->addUpdatedObjectId($this->id);return parent::setIsUpdated($v8de61324edc43f3acb1b73da3c63e89e);}public function delete() {umiObjectsCollection::getInstance()->delObject($this->id);}public function __get($v51746fc9cfaaf892e94c2d56d7508b37) {switch ($v51746fc9cfaaf892e94c2d56d7508b37) {case "id":  return $this->id;case "name": return $this->getName();case "ownerId": return $this->getOwnerId();case "typeId": return $this->getTypeId();case "GUID": return $this->getGUID();case "typeGUID":return $this->getTypeGUID();case "xlink": return 'uobject://' . $this->id;default:  return $this->getValue($v51746fc9cfaaf892e94c2d56d7508b37);}}public function __set($v51746fc9cfaaf892e94c2d56d7508b37, $v2063c1608d6e0baf80249c42e2be5804) {switch ($v51746fc9cfaaf892e94c2d56d7508b37) {case "id":  throw new coreException("Object id could not be changed");case "name": return $this->setName($v2063c1608d6e0baf80249c42e2be5804);case "ownerId": return $this->setOwnerId($v2063c1608d6e0baf80249c42e2be5804);default:  return $this->setValue($v51746fc9cfaaf892e94c2d56d7508b37, $v2063c1608d6e0baf80249c42e2be5804);}}public function beforeSerialize($v324b23d9adc662d7f9e99634ed47ab65 = false) {static $vd14a8022b085f9ef19d479cbdd581127 = array();if ($v324b23d9adc662d7f9e99634ed47ab65 && isset($vd14a8022b085f9ef19d479cbdd581127[$this->type_id])) {$this->type = $vd14a8022b085f9ef19d479cbdd581127[$this->type_id];}else {$vd14a8022b085f9ef19d479cbdd581127[$this->type_id] = $this->type;$this->type = null;}}public function afterSerialize() {$this->beforeSerialize(true);}public function afterUnSerialize() {$this->getType();}public function getModule() {return $this->type->getModule();}public function getMethod() {return $this->type->getMethod();}public function getGUID() {return $this->guid;}public function setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e) {$vb80bb7740288fda1f201890375a60c8f = umiObjectsCollection::getInstance()->getObjectIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if($vb80bb7740288fda1f201890375a60c8f && $vb80bb7740288fda1f201890375a60c8f != $this->id) {throw new coreException("GUID {$v1e0ca5b1252f1f6b1e0ac91be7e7219e} already in use");}$this->guid = $v1e0ca5b1252f1f6b1e0ac91be7e7219e;$this->setIsUpdated();}}class umiFieldTypesCollection extends singleton implements iSingleton, iUmiFieldTypesCollection {private $field_types = Array();protected function __construct() {$this->loadFieldTypes();}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function addFieldType($vb068931cc450442b63f5b3d276ea4297, $v17f71d965fe9589ddbd11caf7182243e = "string", $v96a76ec43956dac431b643cbd544dd08 = false, $vf089d93c2ef0d088edadddb0028d548d = false) {if(!umiFieldType::isValidDataType($v17f71d965fe9589ddbd11caf7182243e)) {throw new coreException("Not valid data type given");return false;}$this->disableCache();cacheFrontend::getInstance()->flush();$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_object_field_types (data_type) VALUES('{$v17f71d965fe9589ddbd11caf7182243e}')";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}$v1e3f04102267eaf5e8d0ca424fd5c561 = l_mysql_insert_id();$v519504d7d4beb745dac24ccfb6c1d7c9 = new umiFieldType($v1e3f04102267eaf5e8d0ca424fd5c561);$v519504d7d4beb745dac24ccfb6c1d7c9->setName($vb068931cc450442b63f5b3d276ea4297);$v519504d7d4beb745dac24ccfb6c1d7c9->setDataType($v17f71d965fe9589ddbd11caf7182243e);$v519504d7d4beb745dac24ccfb6c1d7c9->setIsMultiple($v96a76ec43956dac431b643cbd544dd08);$v519504d7d4beb745dac24ccfb6c1d7c9->setIsUnsigned($vf089d93c2ef0d088edadddb0028d548d);$v519504d7d4beb745dac24ccfb6c1d7c9->commit();$this->field_types[$v1e3f04102267eaf5e8d0ca424fd5c561] = $v519504d7d4beb745dac24ccfb6c1d7c9;return $v1e3f04102267eaf5e8d0ca424fd5c561;}public function delFieldType($v1e3f04102267eaf5e8d0ca424fd5c561) {$this->disableCache();cacheFrontend::getInstance()->flush();if($this->isExists($v1e3f04102267eaf5e8d0ca424fd5c561)) {$v1e3f04102267eaf5e8d0ca424fd5c561 = (int) $v1e3f04102267eaf5e8d0ca424fd5c561;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_object_field_types WHERE id = '{$v1e3f04102267eaf5e8d0ca424fd5c561}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}unset($this->field_types[$v1e3f04102267eaf5e8d0ca424fd5c561]);return true;}else {return false;}}public function getFieldType($v1e3f04102267eaf5e8d0ca424fd5c561) {if($this->isExists($v1e3f04102267eaf5e8d0ca424fd5c561)) {return $this->field_types[$v1e3f04102267eaf5e8d0ca424fd5c561];}else {return true;}}public function getFieldTypeByDataType($v17f71d965fe9589ddbd11caf7182243e, $vce495ab8d79db0d37413d8e95b54e606 = false) {if(!strlen($v17f71d965fe9589ddbd11caf7182243e)) return false;$v3fa9d6639f24f9bb4bf81ac6bdbdbc8c = $this->getFieldTypesList();$v519504d7d4beb745dac24ccfb6c1d7c9 = false;foreach($v3fa9d6639f24f9bb4bf81ac6bdbdbc8c as $v39bb421562d6f6128a957f3d162538d2) {if ($v39bb421562d6f6128a957f3d162538d2->getDataType() == $v17f71d965fe9589ddbd11caf7182243e && $v39bb421562d6f6128a957f3d162538d2->getIsMultiple() == $vce495ab8d79db0d37413d8e95b54e606) {$v519504d7d4beb745dac24ccfb6c1d7c9 = $v39bb421562d6f6128a957f3d162538d2;break;}}return $v519504d7d4beb745dac24ccfb6c1d7c9;}public function isExists($v1e3f04102267eaf5e8d0ca424fd5c561) {return (bool) array_key_exists($v1e3f04102267eaf5e8d0ca424fd5c561, $this->field_types);}private function loadFieldTypes() {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$v15bd395be197dd13a55dac4aac09c1e8 = $vb99eb979e6f6efabc396f777b503f7e7->loadData("field_types");if(!is_array($v15bd395be197dd13a55dac4aac09c1e8)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name, data_type, is_multiple, is_unsigned FROM cms3_object_field_types ORDER BY name ASC";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v15bd395be197dd13a55dac4aac09c1e8 = array();while(list($v1e3f04102267eaf5e8d0ca424fd5c561) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {$v15bd395be197dd13a55dac4aac09c1e8[$v1e3f04102267eaf5e8d0ca424fd5c561] = $vf1965a857bc285d26fe22023aa5ab50d;}$vb99eb979e6f6efabc396f777b503f7e7->saveData("field_types", $v15bd395be197dd13a55dac4aac09c1e8, 3600);}else $vf1965a857bc285d26fe22023aa5ab50d = false;foreach($v15bd395be197dd13a55dac4aac09c1e8 as $v1e3f04102267eaf5e8d0ca424fd5c561 => $vf1965a857bc285d26fe22023aa5ab50d) {$v519504d7d4beb745dac24ccfb6c1d7c9 = $vb99eb979e6f6efabc396f777b503f7e7->load($v1e3f04102267eaf5e8d0ca424fd5c561, "field_type");if($v519504d7d4beb745dac24ccfb6c1d7c9 instanceof umiFieldType == false) {try {$v519504d7d4beb745dac24ccfb6c1d7c9 = new umiFieldType($v1e3f04102267eaf5e8d0ca424fd5c561, $vf1965a857bc285d26fe22023aa5ab50d);}catch(privateException $ve1671797c52e15f763380b45e841ec32) {continue;}$vb99eb979e6f6efabc396f777b503f7e7->save($v519504d7d4beb745dac24ccfb6c1d7c9, "field_type");}$this->field_types[$v1e3f04102267eaf5e8d0ca424fd5c561] = $v519504d7d4beb745dac24ccfb6c1d7c9;}return true;}public function getFieldTypesList() {return $this->field_types;}public function clearCache() {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->field_types);foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) {unset($this->field_types[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}$this->field_types = array();$this->loadFieldTypes();}}class umiFieldsCollection extends singleton implements iSingleton, iUmiFieldsCollection {private $fields = Array();protected function __construct() {}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function getField($v3aabf39f2d943fa886d86dcbbee4d910, $vf1965a857bc285d26fe22023aa5ab50d = false) {if($this->isExists($v3aabf39f2d943fa886d86dcbbee4d910)) {return $this->fields[$v3aabf39f2d943fa886d86dcbbee4d910];}else {return $this->loadField($v3aabf39f2d943fa886d86dcbbee4d910, $vf1965a857bc285d26fe22023aa5ab50d);}}public function delField($v3aabf39f2d943fa886d86dcbbee4d910) {$v3aabf39f2d943fa886d86dcbbee4d910 = (int) $v3aabf39f2d943fa886d86dcbbee4d910;$this->disableCache();if($this->isExists($v3aabf39f2d943fa886d86dcbbee4d910)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_object_fields WHERE id = '{$v3aabf39f2d943fa886d86dcbbee4d910}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}unset($this->fields[$v3aabf39f2d943fa886d86dcbbee4d910]);return true;}else {return false;}}public function addField($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v1e3f04102267eaf5e8d0ca424fd5c561, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = true, $v1945c9a2a5e2ba6133f1db6757a35fcb = false, $vd5752333adc3a004f826f2ea2a41273a = false) {$this->disableCache();$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_object_fields VALUES()";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}$v3aabf39f2d943fa886d86dcbbee4d910 = l_mysql_insert_id();$v06e3d36fa30cea095545139854ad1fb9 = new umiField($v3aabf39f2d943fa886d86dcbbee4d910);$v06e3d36fa30cea095545139854ad1fb9->setName($vb068931cc450442b63f5b3d276ea4297);$v06e3d36fa30cea095545139854ad1fb9->setTitle($vd5d3db1765287eef77d7927cc956f50a);if(!$v06e3d36fa30cea095545139854ad1fb9->setFieldTypeId($v1e3f04102267eaf5e8d0ca424fd5c561)) return false;$v06e3d36fa30cea095545139854ad1fb9->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4);$v06e3d36fa30cea095545139854ad1fb9->setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb);$v06e3d36fa30cea095545139854ad1fb9->setIsInheritable($vd5752333adc3a004f826f2ea2a41273a);if(!$v06e3d36fa30cea095545139854ad1fb9->commit()) return false;$this->fields[$v3aabf39f2d943fa886d86dcbbee4d910] = $v06e3d36fa30cea095545139854ad1fb9;return $v3aabf39f2d943fa886d86dcbbee4d910;}public function isExists($v3aabf39f2d943fa886d86dcbbee4d910) {if(!$v3aabf39f2d943fa886d86dcbbee4d910) return false;return (bool) array_key_exists($v3aabf39f2d943fa886d86dcbbee4d910, $this->fields);}private function loadField($v3aabf39f2d943fa886d86dcbbee4d910, $vf1965a857bc285d26fe22023aa5ab50d) {$v06e3d36fa30cea095545139854ad1fb9 = cacheFrontend::getInstance()->load($v3aabf39f2d943fa886d86dcbbee4d910, "field");if($v06e3d36fa30cea095545139854ad1fb9 instanceof umiField == false) {try {$v06e3d36fa30cea095545139854ad1fb9 = new umiField($v3aabf39f2d943fa886d86dcbbee4d910, $vf1965a857bc285d26fe22023aa5ab50d);}catch(privateException $ve1671797c52e15f763380b45e841ec32) {return false;}cacheFrontend::getInstance()->save($v06e3d36fa30cea095545139854ad1fb9, "field");}if($v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {$this->fields[$v3aabf39f2d943fa886d86dcbbee4d910] = $v06e3d36fa30cea095545139854ad1fb9;return $this->fields[$v3aabf39f2d943fa886d86dcbbee4d910];}else {return false;}}public function clearCache() {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->fields);foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) {unset($this->fields[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}$this->fields = array();}}class umiObjectTypesCollection extends singleton implements iSingleton, iUmiObjectTypesCollection {private $types = Array();protected function __construct() {}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function getType($v94757cae63fd3e398c0811a976dd6bbe) {if (!$v94757cae63fd3e398c0811a976dd6bbe) {return false;}if (!is_numeric($v94757cae63fd3e398c0811a976dd6bbe)) {$v94757cae63fd3e398c0811a976dd6bbe = $this->getTypeIdByGUID($v94757cae63fd3e398c0811a976dd6bbe);}if ($this->isLoaded($v94757cae63fd3e398c0811a976dd6bbe)) {return $this->types[$v94757cae63fd3e398c0811a976dd6bbe];}else {$this->loadType($v94757cae63fd3e398c0811a976dd6bbe);return getArrayKey($this->types, $v94757cae63fd3e398c0811a976dd6bbe);}throw new coreException("Unknow error");}public function getTypeByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e) {$vb80bb7740288fda1f201890375a60c8f = $this->getTypeIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);return $this->getType($vb80bb7740288fda1f201890375a60c8f);}public function getTypeIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();if (!$v1e0ca5b1252f1f6b1e0ac91be7e7219e) {return false;}if (!cmsController::$IGNORE_MICROCACHE && isset($v0fea6a13c52b4d4725368f24b045ca84[$v1e0ca5b1252f1f6b1e0ac91be7e7219e])) {return $v0fea6a13c52b4d4725368f24b045ca84[$v1e0ca5b1252f1f6b1e0ac91be7e7219e];}$v1e0ca5b1252f1f6b1e0ac91be7e7219e = l_mysql_real_escape_string($v1e0ca5b1252f1f6b1e0ac91be7e7219e);$v1b1cc7f086b3f074da452bc3129981eb = "SELECT `id` FROM `cms3_object_types` WHERE `guid` = '{$v1e0ca5b1252f1f6b1e0ac91be7e7219e}'";$result = l_mysql_query($v1b1cc7f086b3f074da452bc3129981eb);if ($vcb5e100e5a9a3e7f6d1fd97512215282 = l_mysql_error()) {throw new coreException($vcb5e100e5a9a3e7f6d1fd97512215282);}if(list($vb80bb7740288fda1f201890375a60c8f) = mysql_fetch_row($result)) {return $v0fea6a13c52b4d4725368f24b045ca84[$v1e0ca5b1252f1f6b1e0ac91be7e7219e] = $vb80bb7740288fda1f201890375a60c8f;}else {return $v0fea6a13c52b4d4725368f24b045ca84[$v1e0ca5b1252f1f6b1e0ac91be7e7219e] = false;}}public function addType($v6be379826b20cc58475f636e33f4606b, $vb068931cc450442b63f5b3d276ea4297, $v1945c9a2a5e2ba6133f1db6757a35fcb = false, $vfd2a8ab94cb104d2f8e25a402c260ae4 = false) {$this->disableCache();$v6be379826b20cc58475f636e33f4606b = (int) $v6be379826b20cc58475f636e33f4606b;$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_object_types (parent_id) VALUES('{$v6be379826b20cc58475f636e33f4606b}')";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$v94757cae63fd3e398c0811a976dd6bbe = l_mysql_insert_id();if (!$vfd2a8ab94cb104d2f8e25a402c260ae4) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT * FROM cms3_object_field_groups WHERE type_id = '{$v6be379826b20cc58475f636e33f4606b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_assoc($result)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_object_field_groups (name, title, type_id, is_active, is_visible, ord, is_locked) VALUES ('" . l_mysql_real_escape_string($vf1965a857bc285d26fe22023aa5ab50d['name']) . "', '" . l_mysql_real_escape_string($vf1965a857bc285d26fe22023aa5ab50d['title']) . "', '{$v94757cae63fd3e398c0811a976dd6bbe}', '{$vf1965a857bc285d26fe22023aa5ab50d['is_active']}', '{$vf1965a857bc285d26fe22023aa5ab50d['is_visible']}', '{$vf1965a857bc285d26fe22023aa5ab50d['ord']}', '{$vf1965a857bc285d26fe22023aa5ab50d['is_locked']}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$v159ce805831f9f42598564e0fbd06f83 = $vf1965a857bc285d26fe22023aa5ab50d['id'];$v5f2444d49c5d43b9cf7a3d7174b983f1 = l_mysql_insert_id();$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_fields_controller SELECT ord, field_id, '{$v5f2444d49c5d43b9cf7a3d7174b983f1}' FROM cms3_fields_controller WHERE group_id = '{$v159ce805831f9f42598564e0fbd06f83}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}}}$vee085e556579b9a69e64e3eddc559b89 = false;if($v6be379826b20cc58475f636e33f4606b) {$v328a21868fce2b3f8569db40f1aa8a89 = $this->getType($v6be379826b20cc58475f636e33f4606b);if($v328a21868fce2b3f8569db40f1aa8a89) {$vee085e556579b9a69e64e3eddc559b89 = $v328a21868fce2b3f8569db40f1aa8a89->getHierarchyTypeId();}}$v599dcce2998a6b40b1e38e8c6006cb0a = new umiObjectType($v94757cae63fd3e398c0811a976dd6bbe);$v599dcce2998a6b40b1e38e8c6006cb0a->setName($vb068931cc450442b63f5b3d276ea4297);$v599dcce2998a6b40b1e38e8c6006cb0a->setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb);if($vee085e556579b9a69e64e3eddc559b89) {$v599dcce2998a6b40b1e38e8c6006cb0a->setHierarchyTypeId($vee085e556579b9a69e64e3eddc559b89);}$v599dcce2998a6b40b1e38e8c6006cb0a->commit();$this->types[$v94757cae63fd3e398c0811a976dd6bbe] = $v599dcce2998a6b40b1e38e8c6006cb0a;umiBranch::saveBranchedTablesRelations();return $v94757cae63fd3e398c0811a976dd6bbe;}public function delType($v94757cae63fd3e398c0811a976dd6bbe) {$v599dcce2998a6b40b1e38e8c6006cb0a = $this->getType($v94757cae63fd3e398c0811a976dd6bbe);if ($v599dcce2998a6b40b1e38e8c6006cb0a->getIsLocked()) {throw new publicAdminException (getLabel('error-object-type-locked'));}$this->disableCache();$vadce578d04ed03c31f6ac59451fcf8e4 = $this->getChildClasses($v94757cae63fd3e398c0811a976dd6bbe);$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($vadce578d04ed03c31f6ac59451fcf8e4);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vd4fd255f51559df00de5424b64292413 = $vadce578d04ed03c31f6ac59451fcf8e4[$v865c0c0b4ab0e063e5caa3387c1a8741];if($this->isExists($vd4fd255f51559df00de5424b64292413)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_objects WHERE type_id = '{$vd4fd255f51559df00de5424b64292413}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_object_types WHERE id = '{$vd4fd255f51559df00de5424b64292413}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_types WHERE new_id = '{$vd4fd255f51559df00de5424b64292413}';";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}unset($this->types[$vd4fd255f51559df00de5424b64292413]);}}$v94757cae63fd3e398c0811a976dd6bbe = (int) $v94757cae63fd3e398c0811a976dd6bbe;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_objects WHERE type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_object_types WHERE id = '{$v94757cae63fd3e398c0811a976dd6bbe}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_types WHERE new_id = '{$v94757cae63fd3e398c0811a976dd6bbe}';";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}unset($this->types[$v94757cae63fd3e398c0811a976dd6bbe]);umiBranch::saveBranchedTablesRelations();return true;}public function isExists($v94757cae63fd3e398c0811a976dd6bbe) {return true;}private function isLoaded($v94757cae63fd3e398c0811a976dd6bbe) {if($v94757cae63fd3e398c0811a976dd6bbe === false) {return false;}return (bool) array_key_exists($v94757cae63fd3e398c0811a976dd6bbe, $this->types);}private function loadType($v94757cae63fd3e398c0811a976dd6bbe) {if($this->isLoaded($v94757cae63fd3e398c0811a976dd6bbe)) {return true;}else {$v599dcce2998a6b40b1e38e8c6006cb0a = cacheFrontend::getInstance()->load($v94757cae63fd3e398c0811a976dd6bbe, "object_type");if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType == false) {try {$v599dcce2998a6b40b1e38e8c6006cb0a = new umiObjectType($v94757cae63fd3e398c0811a976dd6bbe);}catch(privateException $ve1671797c52e15f763380b45e841ec32) {return false;}cacheFrontend::getInstance()->save($v599dcce2998a6b40b1e38e8c6006cb0a, "object_type");}if(is_object($v599dcce2998a6b40b1e38e8c6006cb0a)) {$this->types[$v94757cae63fd3e398c0811a976dd6bbe] = $v599dcce2998a6b40b1e38e8c6006cb0a;return true;}else {return false;}}}public function getSubTypesList($v94757cae63fd3e398c0811a976dd6bbe) {if (!is_numeric($v94757cae63fd3e398c0811a976dd6bbe)) {throw new coreException("Type id must be numeric");}$v94757cae63fd3e398c0811a976dd6bbe = (int) $v94757cae63fd3e398c0811a976dd6bbe;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_object_types WHERE parent_id = '{$v94757cae63fd3e398c0811a976dd6bbe}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$v9b207167e5381c47682c6b4f58a623fb = Array();while (list($v94757cae63fd3e398c0811a976dd6bbe) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[] = (int) $v94757cae63fd3e398c0811a976dd6bbe;}return $v9b207167e5381c47682c6b4f58a623fb;}public function getParentClassId($v94757cae63fd3e398c0811a976dd6bbe) {if($this->isLoaded($v94757cae63fd3e398c0811a976dd6bbe)) {return $this->getType($v94757cae63fd3e398c0811a976dd6bbe)->getParentId();}else {$v94757cae63fd3e398c0811a976dd6bbe = (int) $v94757cae63fd3e398c0811a976dd6bbe;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT parent_id FROM cms3_object_types WHERE id = '{$v94757cae63fd3e398c0811a976dd6bbe}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}if (list($v2e3c048401582f4247d7ccac43657d2d) = mysql_fetch_row($result)) {return (int) $v2e3c048401582f4247d7ccac43657d2d;}else {return false;}}}public function getChildClasses($v94757cae63fd3e398c0811a976dd6bbe, $vadce578d04ed03c31f6ac59451fcf8e4 = false) {$v9b207167e5381c47682c6b4f58a623fb = Array();if (!$vadce578d04ed03c31f6ac59451fcf8e4) {$vadce578d04ed03c31f6ac59451fcf8e4 = Array();}$v94757cae63fd3e398c0811a976dd6bbe = (int) $v94757cae63fd3e398c0811a976dd6bbe;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_object_types WHERE parent_id = '{$v94757cae63fd3e398c0811a976dd6bbe}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}while (list($vb80bb7740288fda1f201890375a60c8f) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[] = $vb80bb7740288fda1f201890375a60c8f;if (!in_array($vb80bb7740288fda1f201890375a60c8f, $vadce578d04ed03c31f6ac59451fcf8e4)) {$v9b207167e5381c47682c6b4f58a623fb = array_merge($v9b207167e5381c47682c6b4f58a623fb, $this->getChildClasses($vb80bb7740288fda1f201890375a60c8f, $v9b207167e5381c47682c6b4f58a623fb));}}$v9b207167e5381c47682c6b4f58a623fb = array_unique($v9b207167e5381c47682c6b4f58a623fb);return $v9b207167e5381c47682c6b4f58a623fb;}public function getGuidesList($v805ab0374f72d8da46502cbb00c05464 = false, $va08f2aee9de301619776deb6fee83e50 = null) {$v9b207167e5381c47682c6b4f58a623fb = Array();if ($v805ab0374f72d8da46502cbb00c05464) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name FROM cms3_object_types WHERE is_guidable = '1' AND is_public = '1'";}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name FROM cms3_object_types WHERE is_guidable = '1'";}if ($va08f2aee9de301619776deb6fee83e50) {$va08f2aee9de301619776deb6fee83e50 = (int) $va08f2aee9de301619776deb6fee83e50;$vac5c74b64b4b8352ef2f181affb5ac2a .= " AND parent_id = '{$va08f2aee9de301619776deb6fee83e50}'";}$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while (list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[$vb80bb7740288fda1f201890375a60c8f] = $this->translateLabel($vb068931cc450442b63f5b3d276ea4297);}return $v9b207167e5381c47682c6b4f58a623fb;}public function getTypesByHierarchyTypeId($v0715f6d9497f93911417c9c324265771, $v35507ea46d2c0b049d7ed968c449223d = false) {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();$v0715f6d9497f93911417c9c324265771 = (int) $v0715f6d9497f93911417c9c324265771;if (isset($v0fea6a13c52b4d4725368f24b045ca84[$v0715f6d9497f93911417c9c324265771]) && $v35507ea46d2c0b049d7ed968c449223d == false) {return $v0fea6a13c52b4d4725368f24b045ca84[$v0715f6d9497f93911417c9c324265771];}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name FROM cms3_object_types WHERE hierarchy_type_id = '{$v0715f6d9497f93911417c9c324265771}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$v9b207167e5381c47682c6b4f58a623fb = Array();while (list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[$vb80bb7740288fda1f201890375a60c8f] = $this->translateLabel($vb068931cc450442b63f5b3d276ea4297);}return $v0fea6a13c52b4d4725368f24b045ca84[$v0715f6d9497f93911417c9c324265771] = $v9b207167e5381c47682c6b4f58a623fb;}public function getTypeByHierarchyTypeId($v0715f6d9497f93911417c9c324265771, $v35507ea46d2c0b049d7ed968c449223d = false) {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();$v0715f6d9497f93911417c9c324265771 = (int) $v0715f6d9497f93911417c9c324265771;if (isset($v0fea6a13c52b4d4725368f24b045ca84[$v0715f6d9497f93911417c9c324265771]) && $v35507ea46d2c0b049d7ed968c449223d == false && cmsController::$IGNORE_MICROCACHE == false) {return $v0fea6a13c52b4d4725368f24b045ca84[$v0715f6d9497f93911417c9c324265771];}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT  id FROM cms3_object_types WHERE hierarchy_type_id = '{$v0715f6d9497f93911417c9c324265771}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}if (list($vb80bb7740288fda1f201890375a60c8f) = mysql_fetch_row($result)) {return $v0fea6a13c52b4d4725368f24b045ca84[$v0715f6d9497f93911417c9c324265771] = $vb80bb7740288fda1f201890375a60c8f;}else {return $v0fea6a13c52b4d4725368f24b045ca84[$v0715f6d9497f93911417c9c324265771] = false;}}public function getAllTypes() {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();if(!empty($v0fea6a13c52b4d4725368f24b045ca84)) {return $v0fea6a13c52b4d4725368f24b045ca84;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name, guid, is_locked, parent_id, is_guidable, is_public, hierarchy_type_id, sortable FROM cms3_object_types";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}$v9b207167e5381c47682c6b4f58a623fb = Array();while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_assoc($result)) {$vf1965a857bc285d26fe22023aa5ab50d['name'] = $this->translateLabel($vf1965a857bc285d26fe22023aa5ab50d['name']);$v9b207167e5381c47682c6b4f58a623fb [$vf1965a857bc285d26fe22023aa5ab50d['id']] = $vf1965a857bc285d26fe22023aa5ab50d;}$v0fea6a13c52b4d4725368f24b045ca84 = $v9b207167e5381c47682c6b4f58a623fb;return $v9b207167e5381c47682c6b4f58a623fb;}public function getBaseType($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce = "") {$vb946c44d711ade3b061653732977d043 = umiHierarchyTypesCollection::getInstance()->getTypeByName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);if($vb946c44d711ade3b061653732977d043) {$v0715f6d9497f93911417c9c324265771 = $vb946c44d711ade3b061653732977d043->getId();$v94757cae63fd3e398c0811a976dd6bbe = $this->getTypeByHierarchyTypeId($v0715f6d9497f93911417c9c324265771);return (int) $v94757cae63fd3e398c0811a976dd6bbe;}else {return false;}}public function clearCache() {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->types);foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) {unset($this->types[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}$this->types = array();}}class umiObjectsCollection extends singleton implements iSingleton, iUmiObjectsCollection {private $objects = Array();private $updatedObjects = Array();protected function __construct() {}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}private function isLoaded($vaf31437ce61345f416579830a98c91e5) {if(gettype($vaf31437ce61345f416579830a98c91e5) == "object") {throw new coreException("Object given!");}return (bool) array_key_exists($vaf31437ce61345f416579830a98c91e5, $this->objects);}public function isExists($vaf31437ce61345f416579830a98c91e5) {$vaf31437ce61345f416579830a98c91e5 = (int) $vaf31437ce61345f416579830a98c91e5;$result = l_mysql_query("SELECT COUNT(*) FROM cms3_objects WHERE id = '{$vaf31437ce61345f416579830a98c91e5}'");if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}else {list($ve2942a04780e223b215eb8b663cf5353) = mysql_fetch_row($result);}return ($ve2942a04780e223b215eb8b663cf5353 > 0);}public function getObject($vaf31437ce61345f416579830a98c91e5, $vf1965a857bc285d26fe22023aa5ab50d = false) {$vaf31437ce61345f416579830a98c91e5 = (int) $vaf31437ce61345f416579830a98c91e5;if(!$vaf31437ce61345f416579830a98c91e5) {return false;}if($this->isLoaded($vaf31437ce61345f416579830a98c91e5)) {return $this->objects[$vaf31437ce61345f416579830a98c91e5];}$va8cfde6331bd59eb2ac96f8911c4b666 = cacheFrontend::getInstance()->load($vaf31437ce61345f416579830a98c91e5, "object");if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject == false) {try {$va8cfde6331bd59eb2ac96f8911c4b666 = new umiObject($vaf31437ce61345f416579830a98c91e5, $vf1965a857bc285d26fe22023aa5ab50d);}catch (baseException $ve1671797c52e15f763380b45e841ec32) {return false;}cacheFrontend::getInstance()->save($va8cfde6331bd59eb2ac96f8911c4b666, "object");}if(is_object($va8cfde6331bd59eb2ac96f8911c4b666)) {$this->objects[$vaf31437ce61345f416579830a98c91e5] = $va8cfde6331bd59eb2ac96f8911c4b666;return $this->objects[$vaf31437ce61345f416579830a98c91e5];}else {return false;}}public function getObjectByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e) {$vb80bb7740288fda1f201890375a60c8f = $this->getObjectIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);return $this->getObject($vb80bb7740288fda1f201890375a60c8f);}public function getObjectIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();if(!$v1e0ca5b1252f1f6b1e0ac91be7e7219e) {return false;}if(!cmsController::$IGNORE_MICROCACHE && isset($v0fea6a13c52b4d4725368f24b045ca84[$v1e0ca5b1252f1f6b1e0ac91be7e7219e])) return $v0fea6a13c52b4d4725368f24b045ca84[$v1e0ca5b1252f1f6b1e0ac91be7e7219e];$v1e0ca5b1252f1f6b1e0ac91be7e7219e = l_mysql_real_escape_string($v1e0ca5b1252f1f6b1e0ac91be7e7219e);$v1b1cc7f086b3f074da452bc3129981eb = "SELECT `id` FROM `cms3_objects` WHERE `guid` = '{$v1e0ca5b1252f1f6b1e0ac91be7e7219e}'";$result = l_mysql_query($v1b1cc7f086b3f074da452bc3129981eb);if($vcb5e100e5a9a3e7f6d1fd97512215282 = l_mysql_error()) {throw new coreException($vcb5e100e5a9a3e7f6d1fd97512215282);}if(list($vb80bb7740288fda1f201890375a60c8f) = mysql_fetch_row($result)) {return $v0fea6a13c52b4d4725368f24b045ca84[$v1e0ca5b1252f1f6b1e0ac91be7e7219e] = $vb80bb7740288fda1f201890375a60c8f;}else {return $v0fea6a13c52b4d4725368f24b045ca84[$v1e0ca5b1252f1f6b1e0ac91be7e7219e] = false;}}public function delObject($vaf31437ce61345f416579830a98c91e5) {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("collectionDeleteObject");$v4119639092e62c55ea8be348e4d9260d->setParam("object_id", $vaf31437ce61345f416579830a98c91e5);$v4119639092e62c55ea8be348e4d9260d->setMode("before");$v4119639092e62c55ea8be348e4d9260d->call();if($this->isExists($vaf31437ce61345f416579830a98c91e5)) {$this->disableCache();$vaf31437ce61345f416579830a98c91e5 = (int) $vaf31437ce61345f416579830a98c91e5;if(defined("SV_USER_ID")) {if($vaf31437ce61345f416579830a98c91e5 == SV_USER_ID || $vaf31437ce61345f416579830a98c91e5 == SV_GROUP_ID || $vaf31437ce61345f416579830a98c91e5 == $this->getObjectIdByGUID('system-guest')) {throw new coreException("You are not allowed to delete object #{$vaf31437ce61345f416579830a98c91e5}. Never. Don't even try.");}}$va8cfde6331bd59eb2ac96f8911c4b666 = $this->getObject($vaf31437ce61345f416579830a98c91e5);$va8cfde6331bd59eb2ac96f8911c4b666->commit();$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_objects WHERE id = '{$vaf31437ce61345f416579830a98c91e5}' AND is_locked='0'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}if($this->isLoaded($vaf31437ce61345f416579830a98c91e5)) {unset($this->objects[$vaf31437ce61345f416579830a98c91e5]);}cacheFrontend::getInstance()->del($vaf31437ce61345f416579830a98c91e5, "object");$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();return true;}else {return false;}}public function addObject($vb068931cc450442b63f5b3d276ea4297, $v94757cae63fd3e398c0811a976dd6bbe, $v1945c9a2a5e2ba6133f1db6757a35fcb = false) {$this->disableCache();$v94757cae63fd3e398c0811a976dd6bbe = (int) $v94757cae63fd3e398c0811a976dd6bbe;if(!$v94757cae63fd3e398c0811a976dd6bbe) {throw new coreException("Can't create object without object type id (null given)");}$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_objects (type_id) VALUES('$v94757cae63fd3e398c0811a976dd6bbe')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}$vaf31437ce61345f416579830a98c91e5 = l_mysql_insert_id();$va8cfde6331bd59eb2ac96f8911c4b666 = new umiObject($vaf31437ce61345f416579830a98c91e5);$va8cfde6331bd59eb2ac96f8911c4b666->setName($vb068931cc450442b63f5b3d276ea4297);$va8cfde6331bd59eb2ac96f8911c4b666->setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb);if($v5571898aeb5505ee9a9111ddd83598f7 = cmsController::getInstance()->getModule("users")) {if($v5571898aeb5505ee9a9111ddd83598f7->is_auth()) {$ve8701ad48ba05a91604e480dd60899a3 = cmsController::getInstance()->getModule("users")->user_id;$va8cfde6331bd59eb2ac96f8911c4b666->setOwnerId($ve8701ad48ba05a91604e480dd60899a3);}}else {$va8cfde6331bd59eb2ac96f8911c4b666->setOwnerId(NULL);}$this->resetObjectProperties($vaf31437ce61345f416579830a98c91e5);$va8cfde6331bd59eb2ac96f8911c4b666->commit();$this->objects[$vaf31437ce61345f416579830a98c91e5] = $va8cfde6331bd59eb2ac96f8911c4b666;return $vaf31437ce61345f416579830a98c91e5;}public function cloneObject($va77b1053cb200e022574f213c7553d88) {$va77b1053cb200e022574f213c7553d88 = (int) $va77b1053cb200e022574f213c7553d88;$v25d877efea6783c4bc6117555350c1d3 = false;$vd82f268d5a82fc66260ad083d1a2e5b4 = $this->getObject($va77b1053cb200e022574f213c7553d88);if ($vd82f268d5a82fc66260ad083d1a2e5b4 instanceof umiObject) {$v2ac03ecbbe52ba8d9e62808d586f02aa = "INSERT INTO cms3_objects (name, is_locked, type_id, owner_id) SELECT name, is_locked, type_id, owner_id FROM cms3_objects WHERE id = '{$va77b1053cb200e022574f213c7553d88}'";l_mysql_query($v2ac03ecbbe52ba8d9e62808d586f02aa);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}$vadf62911d523a4c7be2611e6b5f23612 = l_mysql_insert_id();$v2ac03ecbbe52ba8d9e62808d586f02aa = "INSERT INTO cms3_object_content (obj_id, field_id, int_val, varchar_val, text_val, rel_val, tree_val,float_val)  SELECT '{$vadf62911d523a4c7be2611e6b5f23612}' as obj_id, field_id, int_val, varchar_val, text_val, rel_val, tree_val,float_val FROM cms3_object_content WHERE obj_id = '$va77b1053cb200e022574f213c7553d88'";l_mysql_query($v2ac03ecbbe52ba8d9e62808d586f02aa);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}$v25d877efea6783c4bc6117555350c1d3 = $vadf62911d523a4c7be2611e6b5f23612;}return $v25d877efea6783c4bc6117555350c1d3;}public function getGuidedItems($v051369818a8073bba5feeb0e957eb308) {$v9b207167e5381c47682c6b4f58a623fb = Array();if (is_int($v051369818a8073bba5feeb0e957eb308)) {$v051369818a8073bba5feeb0e957eb308 = (int) $v051369818a8073bba5feeb0e957eb308;}else {$v051369818a8073bba5feeb0e957eb308 = l_mysql_real_escape_string($v051369818a8073bba5feeb0e957eb308);$v1b1cc7f086b3f074da452bc3129981eb = "SELECT `id` FROM `cms3_object_types` WHERE `guid`='". $v051369818a8073bba5feeb0e957eb308 ."' LIMIT 1";$result = l_mysql_query($v1b1cc7f086b3f074da452bc3129981eb);if (0 < mysql_numrows($result)) {$v051369818a8073bba5feeb0e957eb308 = mysql_result($result, 0);}else {$v051369818a8073bba5feeb0e957eb308 = (int) $v051369818a8073bba5feeb0e957eb308;}}$v47474f16bc8e08736ec6d8eece4f8c96 = intval(regedit::getInstance()->getVal("//settings/ignore_guides_sort")) ? true : false;if($v47474f16bc8e08736ec6d8eece4f8c96)    $vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name FROM cms3_objects WHERE type_id = '{$v051369818a8073bba5feeb0e957eb308}' ORDER BY id ASC";else    $vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, name FROM cms3_objects WHERE type_id = '{$v051369818a8073bba5feeb0e957eb308}' ORDER BY name ASC";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);return false;}while(list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297) = mysql_fetch_row($result)) {$v9b207167e5381c47682c6b4f58a623fb[$vb80bb7740288fda1f201890375a60c8f] = $this->translateLabel($vb068931cc450442b63f5b3d276ea4297);}if(!$v47474f16bc8e08736ec6d8eece4f8c96)    natsort($v9b207167e5381c47682c6b4f58a623fb);return $v9b207167e5381c47682c6b4f58a623fb;}public function getCountByTypeId($v5f694956811487225d15e973ca38fbab) {$ve2942a04780e223b215eb8b663cf5353 = false;$v5f694956811487225d15e973ca38fbab = (int) $v5f694956811487225d15e973ca38fbab;$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult("SELECT COUNT(id) FROM cms3_objects WHERE type_id = '{$v5f694956811487225d15e973ca38fbab}'");if($vcb5e100e5a9a3e7f6d1fd97512215282 = l_mysql_error()) {throw new databaseException($vcb5e100e5a9a3e7f6d1fd97512215282);}list($ve2942a04780e223b215eb8b663cf5353) = $result->fetch();return $ve2942a04780e223b215eb8b663cf5353;}protected function resetObjectProperties($vaf31437ce61345f416579830a98c91e5) {$vaf31437ce61345f416579830a98c91e5 = (int) $vaf31437ce61345f416579830a98c91e5;$va8cfde6331bd59eb2ac96f8911c4b666 = $this->getObject($vaf31437ce61345f416579830a98c91e5);$v87306dd4235ed712ebc07fe169b76f83 = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();$v7ae7003da59ae71dcc9f8638ef50593d = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);$v80071f37861c360a27b7327e132c911a = umiBranch::getBranchedTableByTypeId($v87306dd4235ed712ebc07fe169b76f83);$v1b1cc7f086b3f074da452bc3129981eb = "INSERT INTO {$v80071f37861c360a27b7327e132c911a} (obj_id, field_id, int_val, varchar_val, text_val, rel_val, tree_val, float_val) VALUES ";$v37c0c66b0de38f0adb05826f136d75f7 = $v7ae7003da59ae71dcc9f8638ef50593d->getAllFields();$vb2021c4149dfd5dc85c88823b7df34bd = array();foreach($v37c0c66b0de38f0adb05826f136d75f7 as $vb8b49ef6bc7c1cfa510520b8a17b9f69) {$vb2021c4149dfd5dc85c88823b7df34bd[] = "('{$vaf31437ce61345f416579830a98c91e5}', '{$vb8b49ef6bc7c1cfa510520b8a17b9f69->getId()}', NULL, NULL, NULL, NULL, NULL, NULL)";}if(sizeof($v37c0c66b0de38f0adb05826f136d75f7) != 0) {l_mysql_query($v1b1cc7f086b3f074da452bc3129981eb . implode($vb2021c4149dfd5dc85c88823b7df34bd, ", "));}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$v80071f37861c360a27b7327e132c911a} (obj_id, field_id) VALUES ('{$vaf31437ce61345f416579830a98c91e5}', NULL)";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}}}public function unloadObject($vaf31437ce61345f416579830a98c91e5) {if($this->isLoaded($vaf31437ce61345f416579830a98c91e5)) {unset($this->objects[$vaf31437ce61345f416579830a98c91e5]);}else {return false;}}public function unloadAllObjects() {foreach($this->objects as $vaf31437ce61345f416579830a98c91e5 => $v9e3669d19b675bd57058fd4664205d2a)   {unset($this->objects[$vaf31437ce61345f416579830a98c91e5]);}}public function getCollectedObjects() {return array_keys($this->objects);}public function addUpdatedObjectId($vaf31437ce61345f416579830a98c91e5) {if(!in_array($vaf31437ce61345f416579830a98c91e5, $this->updatedObjects)) {$this->updatedObjects[] = $vaf31437ce61345f416579830a98c91e5;}}public function getUpdatedObjects() {return $this->updatedObjects;}public function __destruct() {if(sizeof($this->updatedObjects)) {if(function_exists("deleteObjectsRelatedPages")) {deleteObjectsRelatedPages();}}}public function clearCache() {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->objects);foreach($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) unset($this->objects[$v3c6e0b8a9c15224a8228b9a98ca1531d]);$this->objects = array();}}abstract class umiObjectProperty extends umiEntinty implements iUmiEntinty, iUmiObjectProperty {protected   $object_id, $field_id, $field, $field_type,   $value = array(), $tableName = "cms3_object_content", $is_updated = false;protected static $dataCache = array();public $store_type = "property";public static $USE_FORCE_OBJECTS_CREATION = false;public static $IGNORE_FILTER_INPUT_STRING = false;public static $IGNORE_FILTER_OUTPUT_STRING = false;public static $USE_TRANSACTIONS = true;public static $IGNORE_CACHE = false;public function __construct($vb80bb7740288fda1f201890375a60c8f, $v3aabf39f2d943fa886d86dcbbee4d910, $v94757cae63fd3e398c0811a976dd6bbe) {$this->tableName = umiBranch::getBranchedTableByTypeId($v94757cae63fd3e398c0811a976dd6bbe);$this->setId($vb80bb7740288fda1f201890375a60c8f);$this->object_id = (int) $vb80bb7740288fda1f201890375a60c8f;$this->field = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);$this->field_id = $v3aabf39f2d943fa886d86dcbbee4d910;$this->loadInfo();}public static function getProperty($vb80bb7740288fda1f201890375a60c8f, $v3aabf39f2d943fa886d86dcbbee4d910, $v94757cae63fd3e398c0811a976dd6bbe) {$v6f66e878c62db60568a3487869695820 = self::getClassNameByFieldId($v3aabf39f2d943fa886d86dcbbee4d910);return new $v6f66e878c62db60568a3487869695820($vb80bb7740288fda1f201890375a60c8f, $v3aabf39f2d943fa886d86dcbbee4d910, $v94757cae63fd3e398c0811a976dd6bbe);}public function getId() {return $this->id . "." . $this->field_id;}public function getValue(array $v21ffce5b8a6cc8cc6a41448dd69623c9 = NULL) {if ($this->getIsMultiple() === false) {if (sizeof($this->value) > 0) {list($v2063c1608d6e0baf80249c42e2be5804) = $this->value;}else {$v2063c1608d6e0baf80249c42e2be5804 = null;}}else {$v2063c1608d6e0baf80249c42e2be5804 = $this->value;}if (!is_null($v21ffce5b8a6cc8cc6a41448dd69623c9)) {$v2063c1608d6e0baf80249c42e2be5804 = $this->applyParams($v2063c1608d6e0baf80249c42e2be5804, $v21ffce5b8a6cc8cc6a41448dd69623c9);}if ($v6b1a57fa235477758817df3c91158006 = $this->field->getRestrictionId()) {$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v6b1a57fa235477758817df3c91158006);if ($v3dadfaeb46ec74762b37de11fea7605c instanceof iNormalizeOutRestriction) {$v2063c1608d6e0baf80249c42e2be5804 = $v3dadfaeb46ec74762b37de11fea7605c->normalizeOut($v2063c1608d6e0baf80249c42e2be5804, $this->object_id);}}return $v2063c1608d6e0baf80249c42e2be5804;}public function getName() {return $this->field->getName();}public function getTitle() {return $this->field->getTitle();}public function validateValue($v2063c1608d6e0baf80249c42e2be5804) {if ((is_null($v2063c1608d6e0baf80249c42e2be5804) || $v2063c1608d6e0baf80249c42e2be5804 === false || $v2063c1608d6e0baf80249c42e2be5804 === "") && $this->field->getIsRequired()) {throw new valueRequiredException(getLabel('error-value-required', null, $this->getTitle()));}if ($v2063c1608d6e0baf80249c42e2be5804 && $v6b1a57fa235477758817df3c91158006 = $this->field->getRestrictionId()) {$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v6b1a57fa235477758817df3c91158006);if ($v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) {if ($v3dadfaeb46ec74762b37de11fea7605c instanceof iNormalizeInRestriction) {$v2063c1608d6e0baf80249c42e2be5804 = $v3dadfaeb46ec74762b37de11fea7605c->normalizeIn($v2063c1608d6e0baf80249c42e2be5804, $this->object_id);}if ($v3dadfaeb46ec74762b37de11fea7605c->validate($v2063c1608d6e0baf80249c42e2be5804, $this->object_id) === false) {throw new wrongValueException(getLabel($v3dadfaeb46ec74762b37de11fea7605c->getErrorMessage(), null, $this->getTitle()));}}}return $v2063c1608d6e0baf80249c42e2be5804;}public function setValue($v2063c1608d6e0baf80249c42e2be5804) {$v2063c1608d6e0baf80249c42e2be5804 = $this->validateValue($v2063c1608d6e0baf80249c42e2be5804);if (!is_array($v2063c1608d6e0baf80249c42e2be5804)) {$v2063c1608d6e0baf80249c42e2be5804 = Array($v2063c1608d6e0baf80249c42e2be5804);}$vfb5eb12472d87d2d7be0b9ca6a410c2b = array(1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20,21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31);$v240bf022e685b0ee30ad9fe9e1fb5d5b = '';foreach ($vfb5eb12472d87d2d7be0b9ca6a410c2b as $v97bff26855a8bfa63e05d5477e794b24) {$v240bf022e685b0ee30ad9fe9e1fb5d5b = $v240bf022e685b0ee30ad9fe9e1fb5d5b . chr($v97bff26855a8bfa63e05d5477e794b24);}foreach ($v2063c1608d6e0baf80249c42e2be5804 as &$v9e3669d19b675bd57058fd4664205d2a) {if (is_string($v9e3669d19b675bd57058fd4664205d2a)) {$v9e3669d19b675bd57058fd4664205d2a = preg_replace("/[" . $v240bf022e685b0ee30ad9fe9e1fb5d5b . "]/isu", "", $v9e3669d19b675bd57058fd4664205d2a);}}$v17f71d965fe9589ddbd11caf7182243e = $this->getDataType();if ($v17f71d965fe9589ddbd11caf7182243e === 'date') {foreach ($v2063c1608d6e0baf80249c42e2be5804 as $v8dcd0fced6cad049fa9d12a0e56b5bb6=>$ve0c750ab2ba65ff988478860712c5ff2) {if (!($ve0c750ab2ba65ff988478860712c5ff2 instanceof umiDate)) {$v2063c1608d6e0baf80249c42e2be5804[$v8dcd0fced6cad049fa9d12a0e56b5bb6] = new umiDate(intval($ve0c750ab2ba65ff988478860712c5ff2));}}}$this->value = $v2063c1608d6e0baf80249c42e2be5804;return $this->setIsUpdated();}public function resetValue() {$this->value = Array();$this->setIsUpdated();}protected function loadInfo() {$v06e3d36fa30cea095545139854ad1fb9 = $this->field;$v3fa9d6639f24f9bb4bf81ac6bdbdbc8c = umiFieldTypesCollection::getInstance();$v1e3f04102267eaf5e8d0ca424fd5c561 = $v06e3d36fa30cea095545139854ad1fb9->getFieldTypeId();$v519504d7d4beb745dac24ccfb6c1d7c9 = $v3fa9d6639f24f9bb4bf81ac6bdbdbc8c->getFieldType($v1e3f04102267eaf5e8d0ca424fd5c561);$this->field_type = $v519504d7d4beb745dac24ccfb6c1d7c9;$this->value = $this->loadValue();}protected function save() {$va8cfde6331bd59eb2ac96f8911c4b666 = umiObjectsCollection::getInstance()->getObject($this->id);if ($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) {if ($va8cfde6331bd59eb2ac96f8911c4b666->checkSelf() == false) {cacheFrontend::getInstance()->del($va8cfde6331bd59eb2ac96f8911c4b666->getId(), "object");return false;}}cacheFrontend::getInstance()->del($this->getId(), "property");if (self::$USE_TRANSACTIONS) {l_mysql_query("START TRANSACTION /* Saving property for object {$this->id} */");}$result = $this->saveValue();if (self::$USE_TRANSACTIONS) {l_mysql_query("COMMIT");}if (isset(umiObjectProperty::$dataCache[$this->object_id])) {unset(umiObjectProperty::$dataCache[$this->object_id]);}$this->loadInfo();return $result;}public function getIsMultiple() {return $this->field_type->getIsMultiple();}public function getIsUnsigned() {return $this->field_type->getIsUnsigned();}public function getDataType() {return $this->field_type->getDataType();}public function getIsLocked() {return $this->field->getIsLocked();}public function getIsInheritable() {return $this->field->getIsInheritable();}public function getIsVisible() {return $this->field->getIsVisible();}public static function filterInputString($vb45cffe084dd3d20d928bee85e7b0f21) {$vb45cffe084dd3d20d928bee85e7b0f21 = l_mysql_real_escape_string($vb45cffe084dd3d20d928bee85e7b0f21);if (isset($_SERVER['DOCUMENT_ROOT']) && cmsController::getInstance()->getCurrentMode() != "admin" && !umiObjectProperty::$IGNORE_FILTER_INPUT_STRING && !(defined("CRON") && CRON)) {$vb45cffe084dd3d20d928bee85e7b0f21 = str_replace(array("&#037;", "&#37;"), "%", $vb45cffe084dd3d20d928bee85e7b0f21);$vb45cffe084dd3d20d928bee85e7b0f21 = htmlspecialchars(htmlspecialchars_decode($vb45cffe084dd3d20d928bee85e7b0f21), ENT_NOQUOTES);$vb45cffe084dd3d20d928bee85e7b0f21 = str_replace("%", "&#37;", $vb45cffe084dd3d20d928bee85e7b0f21);}return $vb45cffe084dd3d20d928bee85e7b0f21;}public static function filterOutputString($vb45cffe084dd3d20d928bee85e7b0f21) {return $vb45cffe084dd3d20d928bee85e7b0f21;}public static function filterCDATA($vb45cffe084dd3d20d928bee85e7b0f21) {$vb45cffe084dd3d20d928bee85e7b0f21 = str_replace("]]>", "]]&gt;", $vb45cffe084dd3d20d928bee85e7b0f21);return $vb45cffe084dd3d20d928bee85e7b0f21;}protected function setObjectIsUpdated() {if ($va8cfde6331bd59eb2ac96f8911c4b666 = $this->getObject()) {$va8cfde6331bd59eb2ac96f8911c4b666->setIsUpdated();return true;}else {return false;}}protected function getPropData() {$v0fea6a13c52b4d4725368f24b045ca84 = &umiObjectProperty::$dataCache;if (defined("DISABLE_GETVAL_OPT") && DISABLE_GETVAL_OPT) {return false;}$v945100186b119048837b9859c2c46410 = $this->field_id;$v16b2b26000987faccb260b9d39df1269 = $this->object_id;if (!isset($v0fea6a13c52b4d4725368f24b045ca84[$v16b2b26000987faccb260b9d39df1269])) {$v8d777f385d3dfec8815d20f7496026dc = array();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT field_id, int_val, varchar_val, text_val, rel_val, tree_val, float_val FROM {$this->tableName} WHERE obj_id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_assoc($result)) {$v8d777f385d3dfec8815d20f7496026dc[$vf1965a857bc285d26fe22023aa5ab50d['field_id']]['int_val'][] = $vf1965a857bc285d26fe22023aa5ab50d['int_val'];$v8d777f385d3dfec8815d20f7496026dc[$vf1965a857bc285d26fe22023aa5ab50d['field_id']]['varchar_val'][] = $vf1965a857bc285d26fe22023aa5ab50d['varchar_val'];$v8d777f385d3dfec8815d20f7496026dc[$vf1965a857bc285d26fe22023aa5ab50d['field_id']]['text_val'][] = $vf1965a857bc285d26fe22023aa5ab50d['text_val'];$v8d777f385d3dfec8815d20f7496026dc[$vf1965a857bc285d26fe22023aa5ab50d['field_id']]['rel_val'][] = $vf1965a857bc285d26fe22023aa5ab50d['rel_val'];$v8d777f385d3dfec8815d20f7496026dc[$vf1965a857bc285d26fe22023aa5ab50d['field_id']]['tree_val'][] = $vf1965a857bc285d26fe22023aa5ab50d['tree_val'];$v8d777f385d3dfec8815d20f7496026dc[$vf1965a857bc285d26fe22023aa5ab50d['field_id']]['float_val'][] = $vf1965a857bc285d26fe22023aa5ab50d['float_val'];}$v0fea6a13c52b4d4725368f24b045ca84[$v16b2b26000987faccb260b9d39df1269] = $v8d777f385d3dfec8815d20f7496026dc;if (sizeof($v0fea6a13c52b4d4725368f24b045ca84) >= 3) {foreach($v0fea6a13c52b4d4725368f24b045ca84 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v8277e0910d750195b448797616e091ad) {unset($v0fea6a13c52b4d4725368f24b045ca84[$v865c0c0b4ab0e063e5caa3387c1a8741]);break;}}}else {$v8d777f385d3dfec8815d20f7496026dc = $v0fea6a13c52b4d4725368f24b045ca84[$v16b2b26000987faccb260b9d39df1269];}if (isset($v8d777f385d3dfec8815d20f7496026dc[$v945100186b119048837b9859c2c46410])) {$result = $v8d777f385d3dfec8815d20f7496026dc[$v945100186b119048837b9859c2c46410];unset($v0fea6a13c52b4d4725368f24b045ca84[$v16b2b26000987faccb260b9d39df1269][$v945100186b119048837b9859c2c46410]);if (sizeof($v0fea6a13c52b4d4725368f24b045ca84[$v16b2b26000987faccb260b9d39df1269]) == 0){unset($v0fea6a13c52b4d4725368f24b045ca84[$v16b2b26000987faccb260b9d39df1269]);}return $result;}else {return false;}}public function getObject() {return umiObjectsCollection::getInstance()->getObject($this->object_id);}public function getObjectId() {return $this->object_id;}public function getField() {return $this->field;}protected static function unescapeFilePath($v6a2a431fe8b621037ea949531c28551d) {return str_replace("\\\\", "/", $v6a2a431fe8b621037ea949531c28551d);}protected function deleteCurrentRows() {$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND (field_id = '{$this->field_id}' OR field_id IS NULL)";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}}protected function fillNull() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$this->field_id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}else {list($v4a8a08f09d37b73795649038408b5f33) = mysql_fetch_row($result);}if ($v4a8a08f09d37b73795649038408b5f33 == 0) {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id) VALUES('{$this->object_id}', '{$this->field_id}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}else {return true;}}return true;}protected static function getClassNameByFieldId($v3aabf39f2d943fa886d86dcbbee4d910) {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();if (isset($v0fea6a13c52b4d4725368f24b045ca84[$v3aabf39f2d943fa886d86dcbbee4d910]) && !self::$IGNORE_CACHE) {return $v0fea6a13c52b4d4725368f24b045ca84[$v3aabf39f2d943fa886d86dcbbee4d910];}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);$ve2aeb4e882d60b1eb4b7c8cd97986a28 = $v06e3d36fa30cea095545139854ad1fb9->getFieldTypeId();$v833750ac635fcc57dc33ecafe365f9a7 = umiFieldTypesCollection::getInstance()->getFieldType($ve2aeb4e882d60b1eb4b7c8cd97986a28);$v5fd6df40d7c4dd7f503475344d8c145c = $v833750ac635fcc57dc33ecafe365f9a7->getDataType();$v8f7cd34efac0926458bbd05f62c13001 = Array(    'relation' => 'umiObjectPropertyRelation',    'wysiwyg' => 'umiObjectPropertyWYSIWYG',    'string' => 'umiObjectPropertyString',    'file' => 'umiObjectPropertyFile',    'img_file' => 'umiObjectPropertyImgFile',    'swf_file' => 'umiObjectPropertyImgFile',    'video_file' => 'umiObjectPropertyFile',    'boolean' => 'umiObjectPropertyBoolean',    'int' => 'umiObjectPropertyInt',    'text' => 'umiObjectPropertyText',    'date' => 'umiObjectPropertyDate',    'symlink' => 'umiObjectPropertySymlink',    'price' => 'umiObjectPropertyPrice',    'float' => 'umiObjectPropertyFloat',    'tags' => 'umiObjectPropertyTags',    'password' => 'umiObjectPropertyPassword',    'counter' => 'umiObjectPropertyCounter',    'optioned' => 'umiObjectPropertyOptioned'   );if (isset($v8f7cd34efac0926458bbd05f62c13001[$v5fd6df40d7c4dd7f503475344d8c145c])) {return $v0fea6a13c52b4d4725368f24b045ca84[$v3aabf39f2d943fa886d86dcbbee4d910] = $v8f7cd34efac0926458bbd05f62c13001[$v5fd6df40d7c4dd7f503475344d8c145c];}else {throw new coreException("Unhandled field of type \"{$v5fd6df40d7c4dd7f503475344d8c145c}\"");}}public static function objectsByValue($v0f728ec6147eaec54f5f45e37bce8ddd, $v2ef4385ee1f18f02679161fef2b094d9 = NULL, $v95fc2db4375309c569794b723adc3972 = false, $vf80384e7987156531edaa3afd549957d = true, $v8ef57923ab3049b18fb75541ff476ff7 = NULL) {$v30a7d3f52b5af853f2a7bba352210a34 = array();if (!(is_null($v2ef4385ee1f18f02679161fef2b094d9) || is_array($v2ef4385ee1f18f02679161fef2b094d9) || intval($v2ef4385ee1f18f02679161fef2b094d9) === -1 || strval($v2ef4385ee1f18f02679161fef2b094d9) === 'all' || strval($v2ef4385ee1f18f02679161fef2b094d9) == 'Все')) {$v2ef4385ee1f18f02679161fef2b094d9 = array($v2ef4385ee1f18f02679161fef2b094d9);}$v9effabcdaed14aab9cb00acddfa00fc9 = NULL;if ($v95fc2db4375309c569794b723adc3972) {if (is_null($v8ef57923ab3049b18fb75541ff476ff7)) {$v9effabcdaed14aab9cb00acddfa00fc9 = array(cmsController::getInstance()->getCurrentDomain()->getId());}elseif (intval($v8ef57923ab3049b18fb75541ff476ff7) === -1 || strval($v8ef57923ab3049b18fb75541ff476ff7) === 'all' || strval($v8ef57923ab3049b18fb75541ff476ff7) == 'Все') {$v9effabcdaed14aab9cb00acddfa00fc9 = array();}elseif (is_array($v8ef57923ab3049b18fb75541ff476ff7)) {$v9effabcdaed14aab9cb00acddfa00fc9 = array_map('intval', $v8ef57923ab3049b18fb75541ff476ff7);}else {$v9effabcdaed14aab9cb00acddfa00fc9 = array(intval($v8ef57923ab3049b18fb75541ff476ff7));}}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v0f728ec6147eaec54f5f45e37bce8ddd);if ($v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {$v5fd6df40d7c4dd7f503475344d8c145c = $v06e3d36fa30cea095545139854ad1fb9->getFieldType()->getDataType();$v8ae9391858dfdc11dbd8f15cf9b04a26 = umiFieldType::getDataTypeDB($v5fd6df40d7c4dd7f503475344d8c145c);}else {throw new coreException("Field #{$v945100186b119048837b9859c2c46410} not found");}$v6301cee35ea764a1e241978f93f01069 = umiSelectionsParser::getObjectTypeByFieldId($v0f728ec6147eaec54f5f45e37bce8ddd);$v80071f37861c360a27b7327e132c911a = umiBranch::getBranchedTableByTypeId($v6301cee35ea764a1e241978f93f01069);$v01b41e749613a642fc384ed8af3245fc = "{$v80071f37861c360a27b7327e132c911a} `o`";if ($v95fc2db4375309c569794b723adc3972) $v01b41e749613a642fc384ed8af3245fc .= ", cms3_hierarchy `h`";if ($v95fc2db4375309c569794b723adc3972) {$v7dd0d06edf4c4299ce1a5978eb469fd8 = "h.id";}else {$v7dd0d06edf4c4299ce1a5978eb469fd8 = "o.obj_id";}$vc3a74cf64b6ccb62fa49a21123cbc72f = ($v95fc2db4375309c569794b723adc3972 ? " AND h.obj_id = o.obj_id AND h.is_active=1 AND h.is_deleted=0" : "");if ($v95fc2db4375309c569794b723adc3972 && is_array($v9effabcdaed14aab9cb00acddfa00fc9) && count($v9effabcdaed14aab9cb00acddfa00fc9)) {$vc3a74cf64b6ccb62fa49a21123cbc72f .= " AND h.domain_id IN ('".implode("', '", $v9effabcdaed14aab9cb00acddfa00fc9)."')";}$v86f6d00b1c7dbb44f4cd5edf49c29aa0 = "";if (!(intval($v2ef4385ee1f18f02679161fef2b094d9) === -1 || strval($v2ef4385ee1f18f02679161fef2b094d9) === 'all' || strval($v2ef4385ee1f18f02679161fef2b094d9) === 'Âñå')) {$v86f6d00b1c7dbb44f4cd5edf49c29aa0 = " AND o.{$v8ae9391858dfdc11dbd8f15cf9b04a26} ".(is_null($v2ef4385ee1f18f02679161fef2b094d9) ? "IS NULL" : "IN ('".implode("', '", $v2ef4385ee1f18f02679161fef2b094d9)."')");}if ($vf80384e7987156531edaa3afd549957d) {$vf3e7552257b4e44beacffb073506f43d = "SELECT o.".$v8ae9391858dfdc11dbd8f15cf9b04a26." as `value`, COUNT(".$v7dd0d06edf4c4299ce1a5978eb469fd8.") as `items` FROM ".$v01b41e749613a642fc384ed8af3245fc." WHERE o.field_id = ".$v0f728ec6147eaec54f5f45e37bce8ddd.$v86f6d00b1c7dbb44f4cd5edf49c29aa0.$vc3a74cf64b6ccb62fa49a21123cbc72f." GROUP BY o.".$v8ae9391858dfdc11dbd8f15cf9b04a26." ORDER BY `items`";}else {$vf3e7552257b4e44beacffb073506f43d = "SELECT DISTINCT ".$v7dd0d06edf4c4299ce1a5978eb469fd8." as `item` FROM ".$v01b41e749613a642fc384ed8af3245fc." WHERE o.field_id = ".$v0f728ec6147eaec54f5f45e37bce8ddd.$v86f6d00b1c7dbb44f4cd5edf49c29aa0.$vc3a74cf64b6ccb62fa49a21123cbc72f;}$ve7d010371cfd5717d3d0b7d8e4c87803 = array();$v98291d7af1e21c41194125137e4f90ec = l_mysql_query($vf3e7552257b4e44beacffb073506f43d);$ved05f7aecf3d274bef532a3ade31ad02 = mysql_errno();$v89d8e64b77430ce4f0fe8ead989285bd = l_mysql_error();if ($v98291d7af1e21c41194125137e4f90ec === false || $ved05f7aecf3d274bef532a3ade31ad02) {throw new coreException("Error executing db query (errno ".$ved05f7aecf3d274bef532a3ade31ad02.", error ".$v89d8e64b77430ce4f0fe8ead989285bd.", query ".$vf3e7552257b4e44beacffb073506f43d.")");}else {while ($v7b93a31f8c7688c32c5a551b0e4937ee = mysql_fetch_assoc($v98291d7af1e21c41194125137e4f90ec)) {$ve7d010371cfd5717d3d0b7d8e4c87803[] = $v7b93a31f8c7688c32c5a551b0e4937ee;}}if ($vf80384e7987156531edaa3afd549957d) {$v30a7d3f52b5af853f2a7bba352210a34['values'] = array();$vae886317ab0305e3e6a1638659ea03fa = 0;$v663ccf380acaf3f549f1612654dc109d = 0;foreach ($ve7d010371cfd5717d3d0b7d8e4c87803 as $vabd12a9143f26fa85e562e69c01c48db) {$v97023380f9705264978115e6ce880ca5 = intval($vabd12a9143f26fa85e562e69c01c48db['items']);$v30a7d3f52b5af853f2a7bba352210a34['values'][] = array('value' => $vabd12a9143f26fa85e562e69c01c48db['value'], 'cnt' => $v97023380f9705264978115e6ce880ca5);if ($v97023380f9705264978115e6ce880ca5 > $vae886317ab0305e3e6a1638659ea03fa) $vae886317ab0305e3e6a1638659ea03fa = $v97023380f9705264978115e6ce880ca5;$v663ccf380acaf3f549f1612654dc109d += $v97023380f9705264978115e6ce880ca5;}$v30a7d3f52b5af853f2a7bba352210a34['max'] = $vae886317ab0305e3e6a1638659ea03fa;$v30a7d3f52b5af853f2a7bba352210a34['sum'] = $v663ccf380acaf3f549f1612654dc109d;}else {foreach ($ve7d010371cfd5717d3d0b7d8e4c87803 as $vabd12a9143f26fa85e562e69c01c48db) $v30a7d3f52b5af853f2a7bba352210a34[] = $vabd12a9143f26fa85e562e69c01c48db['item'];}return $v30a7d3f52b5af853f2a7bba352210a34;}protected function applyParams($vf09cc7ee3a9a93273f4b80601cafb00c, $v21ffce5b8a6cc8cc6a41448dd69623c9 = NULL) {return $vf09cc7ee3a9a93273f4b80601cafb00c;}protected function prepareRelationValue($v2063c1608d6e0baf80249c42e2be5804) {if (!$v2063c1608d6e0baf80249c42e2be5804) {return false;}$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$ve23ef6e93b070c8d28adc485c1f13b73 = self::$USE_FORCE_OBJECTS_CREATION;if (is_object($v2063c1608d6e0baf80249c42e2be5804)) {return $v2063c1608d6e0baf80249c42e2be5804->getId();}else {if (is_numeric($v2063c1608d6e0baf80249c42e2be5804) && $v5891da2d64975cae48d175d1e001f5da->isExists($v2063c1608d6e0baf80249c42e2be5804) && !$ve23ef6e93b070c8d28adc485c1f13b73) {return (int) $v2063c1608d6e0baf80249c42e2be5804;}else {if ($v051369818a8073bba5feeb0e957eb308 = $this->field->getGuideId()) {$vbb4744ed1cc7cb81da0e8cdd2e483cba = self::filterInputString($v2063c1608d6e0baf80249c42e2be5804);$v203545a9e649460edbff71e994cadaf2 = $this->translateI18n($vbb4744ed1cc7cb81da0e8cdd2e483cba);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_objects WHERE type_id = '{$v051369818a8073bba5feeb0e957eb308}' AND name = '{$v203545a9e649460edbff71e994cadaf2}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if (mysql_num_rows($result)) {list($v2063c1608d6e0baf80249c42e2be5804) = mysql_fetch_row($result);return $v2063c1608d6e0baf80249c42e2be5804;}else {if (!$ve23ef6e93b070c8d28adc485c1f13b73) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `id` FROM `cms3_object_types` WHERE `id` = '{$v051369818a8073bba5feeb0e957eb308}' AND `is_guidable`=1 AND `is_public`=1 LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if (!mysql_num_rows($result)) {return null;}}$v6b129fccdc94a378ccc9252d41faa842 = ($v203545a9e649460edbff71e994cadaf2 == $vbb4744ed1cc7cb81da0e8cdd2e483cba) ? $v2063c1608d6e0baf80249c42e2be5804 : $v203545a9e649460edbff71e994cadaf2;if ($v2063c1608d6e0baf80249c42e2be5804 = $v5891da2d64975cae48d175d1e001f5da->addObject($v6b129fccdc94a378ccc9252d41faa842, $v051369818a8073bba5feeb0e957eb308)) {return (int) $v2063c1608d6e0baf80249c42e2be5804;}else {throw new coreException("Can't create guide item");}}}}}return null;}};class umiObjectPropertyBoolean extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['int_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT int_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (!$v3a6d0284e743dc4a9b86f97d6dd1a3bf) continue;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = (int) $this->boolval($v3a6d0284e743dc4a9b86f97d6dd1a3bf, true);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, int_val) VALUES ('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}protected function boolval($v13b5bfe96f3e2fe411c9f66f4a582adf, $v2133fd717402a7966ee88d06f9e0b792=false) {$vc68271a63ddbc431c307beb7d2918275 = null;if (in_array($v13b5bfe96f3e2fe411c9f66f4a582adf,array('false', 'False', 'FALSE', 'no', 'No', 'n', 'N', '0', 'off', 'Off', 'OFF', false, 0, null), true)) {$vc68271a63ddbc431c307beb7d2918275 = false;}else if ($v2133fd717402a7966ee88d06f9e0b792) {if (in_array($v13b5bfe96f3e2fe411c9f66f4a582adf,array('true', 'True', 'TRUE', 'yes', 'Yes', 'y', 'Y', '1', 'on', 'On', 'ON', true, 1), true)) {$vc68271a63ddbc431c307beb7d2918275 = true;}}else {$vc68271a63ddbc431c307beb7d2918275 = ($v13b5bfe96f3e2fe411c9f66f4a582adf?true:false);}return $vc68271a63ddbc431c307beb7d2918275;}};class umiObjectPropertyCounter extends umiObjectProperty {protected $oldValue;protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT cnt FROM `cms3_object_content_cnt` WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {$v2817f701d5e1a1181e657251363295fd = (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}else {$v2817f701d5e1a1181e657251363295fd = 0;}$this->oldValue = $v2817f701d5e1a1181e657251363295fd;return Array($v2817f701d5e1a1181e657251363295fd);}protected function saveValue() {$v2063c1608d6e0baf80249c42e2be5804 = sizeof($this->value) ? (int) $this->value[0] : 0;$v945f3fc449518a73b9f5f32868db466c = $v2063c1608d6e0baf80249c42e2be5804 - $this->oldValue;if ((abs($v945f3fc449518a73b9f5f32868db466c) == 1) && $v2063c1608d6e0baf80249c42e2be5804 !== 0 && $this->oldValue) {$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE `cms3_object_content_cnt` SET cnt = cnt + ({$v945f3fc449518a73b9f5f32868db466c}) WHERE obj_id = '{$this->object_id}' AND field_id = '{$this->field_id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}else {$this->deleteCurrentRows();$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO `cms3_object_content_cnt` (obj_id, field_id, cnt) VALUES('{$this->object_id}', '{$this->field_id}', '{$v2063c1608d6e0baf80249c42e2be5804}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}}protected function deleteCurrentRows() {$v16b2b26000987faccb260b9d39df1269 = (int) $this->object_id;$v945100186b119048837b9859c2c46410 = (int) $this->field_id;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM `cms3_object_content_cnt` WHERE `obj_id` = {$v16b2b26000987faccb260b9d39df1269} AND `field_id` = {$v945100186b119048837b9859c2c46410}";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}protected function fillNull() {$v16b2b26000987faccb260b9d39df1269 = (int) $this->object_id;$v945100186b119048837b9859c2c46410 = (int) $this->field_id;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM `cms3_object_content_cnt` WHERE `obj_id` = {$v16b2b26000987faccb260b9d39df1269} AND `field_id` = {$v945100186b119048837b9859c2c46410}";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($ve2942a04780e223b215eb8b663cf5353) = mysql_fetch_row($result);if ($ve2942a04780e223b215eb8b663cf5353 == 0) {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO `cms3_object_content_cnt` (`obj_id`, `field_id`) VALUES ('{$v16b2b26000987faccb260b9d39df1269}', '{$v945100186b119048837b9859c2c46410}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}}};class umiObjectPropertyDate extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['int_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = new umiDate((int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT int_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = new umiDate((int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf === false || $v3a6d0284e743dc4a9b86f97d6dd1a3bf === "") {continue;}else {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = (is_object($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) ? (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf->timestamp : (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf == false) {continue;}}$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, int_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}};class umiObjectPropertyFile extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['text_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::unescapeFilePath($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v8c7dd922ad47494fc02c388e12c00eac = new umiFile(self::filterOutputString($v3a6d0284e743dc4a9b86f97d6dd1a3bf));if ($v8c7dd922ad47494fc02c388e12c00eac->getIsBroken()) continue;$v9b207167e5381c47682c6b4f58a623fb[] = $v8c7dd922ad47494fc02c388e12c00eac;}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT text_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v8c7dd922ad47494fc02c388e12c00eac = new umiFile($v3a6d0284e743dc4a9b86f97d6dd1a3bf);if ($v8c7dd922ad47494fc02c388e12c00eac->getIsBroken()) continue;$v9b207167e5381c47682c6b4f58a623fb[] = $v8c7dd922ad47494fc02c388e12c00eac;}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();if (is_null($this->value)) {return;}$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (!$v3a6d0284e743dc4a9b86f97d6dd1a3bf) continue;if (is_object($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {if (!@is_file($v3a6d0284e743dc4a9b86f97d6dd1a3bf->getFilePath())) {continue;}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = l_mysql_real_escape_string($v3a6d0284e743dc4a9b86f97d6dd1a3bf->getFilePath());}else {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = l_mysql_real_escape_string($v3a6d0284e743dc4a9b86f97d6dd1a3bf);}$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, text_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}};class umiObjectPropertyFloat extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['float_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = (float) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT float_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = (float) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf === false || $v3a6d0284e743dc4a9b86f97d6dd1a3bf === "") continue;if (strpos(".", $v3a6d0284e743dc4a9b86f97d6dd1a3bf) === false) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = str_replace(",", ".", $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = (float) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, float_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}};class umiObjectPropertyImgFile extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['text_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::unescapeFilePath($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vb798abe6e1b1318ee36b0dcb3fb9e4d3 = new umiImageFile(self::filterOutputString($v3a6d0284e743dc4a9b86f97d6dd1a3bf));if ($vb798abe6e1b1318ee36b0dcb3fb9e4d3->getIsBroken()) continue;$v9b207167e5381c47682c6b4f58a623fb[] = $vb798abe6e1b1318ee36b0dcb3fb9e4d3;}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT text_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::unescapeFilePath($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vb798abe6e1b1318ee36b0dcb3fb9e4d3 = new umiImageFile(self::filterOutputString($v3a6d0284e743dc4a9b86f97d6dd1a3bf));if ($vb798abe6e1b1318ee36b0dcb3fb9e4d3->getIsBroken()) continue;$v9b207167e5381c47682c6b4f58a623fb[] = $vb798abe6e1b1318ee36b0dcb3fb9e4d3;}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();if (is_null($this->value)) {return;}$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (!$v3a6d0284e743dc4a9b86f97d6dd1a3bf) continue;if (is_object($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {if (!@is_file($v3a6d0284e743dc4a9b86f97d6dd1a3bf->getFilePath())) {continue;}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = l_mysql_real_escape_string($v3a6d0284e743dc4a9b86f97d6dd1a3bf->getFilePath());}else {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = l_mysql_real_escape_string($v3a6d0284e743dc4a9b86f97d6dd1a3bf);}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::unescapeFilePath($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, text_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}};class umiObjectPropertyInt extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['int_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT int_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf === false || $v3a6d0284e743dc4a9b86f97d6dd1a3bf === "") continue;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, int_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}};class umiObjectPropertyOptioned extends umiObjectProperty {public function setValue($v2063c1608d6e0baf80249c42e2be5804) {if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {$v2063c1608d6e0baf80249c42e2be5804 = array_distinct($v2063c1608d6e0baf80249c42e2be5804);}parent::setValue($v2063c1608d6e0baf80249c42e2be5804);}protected function loadValue() {$vf09cc7ee3a9a93273f4b80601cafb00c = array();$v8d777f385d3dfec8815d20f7496026dc = $this->getPropData();if ($v8d777f385d3dfec8815d20f7496026dc == false) {$v8d777f385d3dfec8815d20f7496026dc = array();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT int_val, varchar_val, text_val, rel_val, tree_val, float_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$this->field_id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while ($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_assoc($result)) {foreach ($vf1965a857bc285d26fe22023aa5ab50d as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {$v8d777f385d3dfec8815d20f7496026dc[$v865c0c0b4ab0e063e5caa3387c1a8741][] = $v9e3669d19b675bd57058fd4664205d2a;}}}$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;while ($v2063c1608d6e0baf80249c42e2be5804 = $this->parsePropData($v8d777f385d3dfec8815d20f7496026dc, $v865c0c0b4ab0e063e5caa3387c1a8741)) {foreach ($v2063c1608d6e0baf80249c42e2be5804 as $ve358efa489f58062f10dd7316b65649e => $v9e3669d19b675bd57058fd4664205d2a) {$v2063c1608d6e0baf80249c42e2be5804[$ve358efa489f58062f10dd7316b65649e] = ($ve358efa489f58062f10dd7316b65649e == 'float') ? $this->filterFloat($v9e3669d19b675bd57058fd4664205d2a) : self::filterOutputString($v9e3669d19b675bd57058fd4664205d2a);}$vf09cc7ee3a9a93273f4b80601cafb00c[] = $v2063c1608d6e0baf80249c42e2be5804;$v865c0c0b4ab0e063e5caa3387c1a8741++;}return $vf09cc7ee3a9a93273f4b80601cafb00c;}protected function saveValue() {$this->deleteCurrentRows();foreach ($this->value as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v8d777f385d3dfec8815d20f7496026dc) {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO `{$this->tableName}` (`obj_id`, `field_id`, `int_val`, `varchar_val`, `rel_val`, `tree_val`, `float_val`) VALUES ('{$this->object_id}', '{$this->field_id}', ";$v2817f701d5e1a1181e657251363295fd = 0;if ($v481f44389b52d587646c4a792551b4dc = (int) getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'int')) {$vac5c74b64b4b8352ef2f181affb5ac2a .= "'{$v481f44389b52d587646c4a792551b4dc}', ";++$v2817f701d5e1a1181e657251363295fd;}else {$vac5c74b64b4b8352ef2f181affb5ac2a .= "NULL, ";}if ($v32f5f5d74be991e6f2147a3dce8f7c4a = (string) getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'varchar')) {$v32f5f5d74be991e6f2147a3dce8f7c4a = self::filterInputString($v32f5f5d74be991e6f2147a3dce8f7c4a);$vac5c74b64b4b8352ef2f181affb5ac2a .= "'{$v32f5f5d74be991e6f2147a3dce8f7c4a}', ";++$v2817f701d5e1a1181e657251363295fd;}else {$vac5c74b64b4b8352ef2f181affb5ac2a .= "NULL, ";}if ($va3c2d20026816e57d6022b2034f48e88 = (int) $this->prepareRelationValue(getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'rel'))) {$vac5c74b64b4b8352ef2f181affb5ac2a .= "'{$va3c2d20026816e57d6022b2034f48e88}', ";++$v2817f701d5e1a1181e657251363295fd;}else {$vac5c74b64b4b8352ef2f181affb5ac2a .= "NULL, ";}$this->values[$v3c6e0b8a9c15224a8228b9a98ca1531d]['rel'] = $va3c2d20026816e57d6022b2034f48e88;if ($vfec328f17e29d6639c673223e83cdac4 = (int) getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'tree')) {$vac5c74b64b4b8352ef2f181affb5ac2a .= "'{$vfec328f17e29d6639c673223e83cdac4}', ";++$v2817f701d5e1a1181e657251363295fd;}else {$vac5c74b64b4b8352ef2f181affb5ac2a .= "NULL, ";}if ($v9ec90e82509332a2d6e51de04dbbe788 = (float) getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'float')) {$vac5c74b64b4b8352ef2f181affb5ac2a .= "'{$v9ec90e82509332a2d6e51de04dbbe788}'";++$v2817f701d5e1a1181e657251363295fd;}else {$vac5c74b64b4b8352ef2f181affb5ac2a .= "NULL";}$vac5c74b64b4b8352ef2f181affb5ac2a .= ")";if ($v2817f701d5e1a1181e657251363295fd < 2) {continue;}l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}}protected function parsePropData($v8d777f385d3dfec8815d20f7496026dc, $v6a992d5529f459a44fee58c733255e86) {$result = Array();$vca66516bb4d6585b92b5fee0264db0d7 = false;foreach ($v8d777f385d3dfec8815d20f7496026dc as $vdf5feafab86601ea0e1e6fe6e20df6c5 => $vf09cc7ee3a9a93273f4b80601cafb00c) {if (isset($vf09cc7ee3a9a93273f4b80601cafb00c[$v6a992d5529f459a44fee58c733255e86])) {$vdf5feafab86601ea0e1e6fe6e20df6c5 = $this->decodeContentType($vdf5feafab86601ea0e1e6fe6e20df6c5);$result[$vdf5feafab86601ea0e1e6fe6e20df6c5] = $vf09cc7ee3a9a93273f4b80601cafb00c[$v6a992d5529f459a44fee58c733255e86];$vca66516bb4d6585b92b5fee0264db0d7 = true;}}return $vca66516bb4d6585b92b5fee0264db0d7 ? $result : false;}protected function decodeContentType($vdf5feafab86601ea0e1e6fe6e20df6c5) {if (substr($vdf5feafab86601ea0e1e6fe6e20df6c5, -4) == '_val') {$vdf5feafab86601ea0e1e6fe6e20df6c5 = substr($vdf5feafab86601ea0e1e6fe6e20df6c5, 0, strlen($vdf5feafab86601ea0e1e6fe6e20df6c5) - 4);}return $vdf5feafab86601ea0e1e6fe6e20df6c5;}protected function applyParams($vf09cc7ee3a9a93273f4b80601cafb00c, $v21ffce5b8a6cc8cc6a41448dd69623c9 = NULL) {$vb2c97ae425dd751b0e48a3acae79cf4a = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'filter');$v927f8c827f23f513d40e3dc9cd23e52f = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'field-type');if (!is_null($vb2c97ae425dd751b0e48a3acae79cf4a)) {$result = Array();foreach ($vf09cc7ee3a9a93273f4b80601cafb00c as $v6a992d5529f459a44fee58c733255e86 => $v2063c1608d6e0baf80249c42e2be5804) {foreach ($vb2c97ae425dd751b0e48a3acae79cf4a as $v833750ac635fcc57dc33ecafe365f9a7 => $v24b86e853ae3f6cdeaa0f580056a545c) {if (isset($v2063c1608d6e0baf80249c42e2be5804[$v833750ac635fcc57dc33ecafe365f9a7]) && $v2063c1608d6e0baf80249c42e2be5804[$v833750ac635fcc57dc33ecafe365f9a7] == $v24b86e853ae3f6cdeaa0f580056a545c) {$result[] = $v2063c1608d6e0baf80249c42e2be5804;}}}$vf09cc7ee3a9a93273f4b80601cafb00c = $result;}if (!is_null($v927f8c827f23f513d40e3dc9cd23e52f)) {foreach ($vf09cc7ee3a9a93273f4b80601cafb00c as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v2063c1608d6e0baf80249c42e2be5804) {$vf09cc7ee3a9a93273f4b80601cafb00c[$v865c0c0b4ab0e063e5caa3387c1a8741] = getArrayKey($v2063c1608d6e0baf80249c42e2be5804, $v927f8c827f23f513d40e3dc9cd23e52f);}}return $vf09cc7ee3a9a93273f4b80601cafb00c;}protected function filterFloat($v2063c1608d6e0baf80249c42e2be5804) {return round($v2063c1608d6e0baf80249c42e2be5804, 2);}};class umiObjectPropertyPassword extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['varchar_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT varchar_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (strlen($v3a6d0284e743dc4a9b86f97d6dd1a3bf) == 0) continue;$this->deleteCurrentRows();$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::filterInputString($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, varchar_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}};class umiObjectPropertyPrice extends umiObjectPropertyFloat {protected $dbValue;protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = parent::loadValue();$v78a5eb43deef9a7b5b9ce157b9d52ac4 = 0;if (is_array($v9b207167e5381c47682c6b4f58a623fb) && isset($v9b207167e5381c47682c6b4f58a623fb[0])) {list($v78a5eb43deef9a7b5b9ce157b9d52ac4) = $v9b207167e5381c47682c6b4f58a623fb;}$this->dbValue = $v78a5eb43deef9a7b5b9ce157b9d52ac4;if ($v3766293ae0857925595a6f0bf40531a8 = cmsController::getInstance()->getModule("eshop")) {$v78a5eb43deef9a7b5b9ce157b9d52ac4 = $v3766293ae0857925595a6f0bf40531a8->calculateDiscount($this->object_id, $v78a5eb43deef9a7b5b9ce157b9d52ac4);}$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("umiObjectProperty_loadPriceValue");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_id", $this->object_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("price", $v78a5eb43deef9a7b5b9ce157b9d52ac4);$v161c9aaa4fe035e7b2f465bc59f3ab45->call();$v9b207167e5381c47682c6b4f58a623fb = Array($v78a5eb43deef9a7b5b9ce157b9d52ac4);return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf === false || $v3a6d0284e743dc4a9b86f97d6dd1a3bf === "") continue;if (strpos(".", $v3a6d0284e743dc4a9b86f97d6dd1a3bf) === false) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = str_replace(",", ".", $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = abs((float) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf > 999999999.99) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = 999999999.99;}$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, float_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if ($v56bd7107802ebe56c6918992f0608ec6 = l_mysql_error()) {throw new coreException($v56bd7107802ebe56c6918992f0608ec6);}++$v2817f701d5e1a1181e657251363295fd;}$this->dbValue = $this->value;if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}public function __wakeup() {if ($this->dbValue) {$v78a5eb43deef9a7b5b9ce157b9d52ac4 = $this->dbValue;if ($v3766293ae0857925595a6f0bf40531a8 = cmsController::getInstance()->getModule("eshop")) {$v78a5eb43deef9a7b5b9ce157b9d52ac4 = $v3766293ae0857925595a6f0bf40531a8->calculateDiscount($this->object_id, $v78a5eb43deef9a7b5b9ce157b9d52ac4);}$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("umiObjectProperty_loadPriceValue");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_id", $this->object_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("price", $v78a5eb43deef9a7b5b9ce157b9d52ac4);$v161c9aaa4fe035e7b2f465bc59f3ab45->call();$v2063c1608d6e0baf80249c42e2be5804 = Array($v78a5eb43deef9a7b5b9ce157b9d52ac4);$this->value = $v2063c1608d6e0baf80249c42e2be5804;}}};class umiObjectPropertyRelation extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['rel_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}return $v9b207167e5381c47682c6b4f58a623fb;}if ($this->getIsMultiple()) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT rel_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}'";}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT rel_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";}$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();if (is_null($this->value)) {return;}$vfa816edb83e95bf0c8da580bdfd491ef = Array();foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (!$v3a6d0284e743dc4a9b86f97d6dd1a3bf) continue;if (is_string($v3a6d0284e743dc4a9b86f97d6dd1a3bf) && strpos($v3a6d0284e743dc4a9b86f97d6dd1a3bf, "|") !== false) {$v2e3a8d3f3d1c742f7234c3d6dd74cc3c = explode("|", $v3a6d0284e743dc4a9b86f97d6dd1a3bf);foreach ($v2e3a8d3f3d1c742f7234c3d6dd74cc3c as $v9e3669d19b675bd57058fd4664205d2a) {$v9e3669d19b675bd57058fd4664205d2a = trim($v9e3669d19b675bd57058fd4664205d2a);if ($v9e3669d19b675bd57058fd4664205d2a) {$vfa816edb83e95bf0c8da580bdfd491ef[] = $v9e3669d19b675bd57058fd4664205d2a;}unset($v9e3669d19b675bd57058fd4664205d2a);}unset($v2e3a8d3f3d1c742f7234c3d6dd74cc3c);$this->getField()->setFieldTypeId(umiFieldTypesCollection::getInstance()->getFieldTypeByDataType('relation',1)->getId());}else {$vfa816edb83e95bf0c8da580bdfd491ef[] = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}}$this->value = $vfa816edb83e95bf0c8da580bdfd491ef;unset($vfa816edb83e95bf0c8da580bdfd491ef);$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $this->prepareRelationValue($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$this->values[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}if (!$v3a6d0284e743dc4a9b86f97d6dd1a3bf) continue;$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, rel_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}};class umiObjectPropertyString extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['varchar_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT varchar_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (strlen($v3a6d0284e743dc4a9b86f97d6dd1a3bf) == 0) continue;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::filterInputString($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, varchar_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}}class umiObjectPropertySymlink extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['tree_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement( (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf );if ($v8e2dcfd7e7e24b1ca76c1193f645902b === false) continue;if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive() == false) continue;$v9b207167e5381c47682c6b4f58a623fb[] = $v8e2dcfd7e7e24b1ca76c1193f645902b;}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT tree_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement( (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf );if ($v8e2dcfd7e7e24b1ca76c1193f645902b === false) continue;if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive() == false) continue;$v9b207167e5381c47682c6b4f58a623fb[] = $v8e2dcfd7e7e24b1ca76c1193f645902b;}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_object($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = (int) $v3a6d0284e743dc4a9b86f97d6dd1a3bf->getId();}else {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = intval($v3a6d0284e743dc4a9b86f97d6dd1a3bf);}if (!$v3a6d0284e743dc4a9b86f97d6dd1a3bf) continue;$this->value[$v865c0c0b4ab0e063e5caa3387c1a8741] = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, tree_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}};class umiObjectPropertyTags extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['varchar_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT varchar_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();if (sizeof($this->value) == 1) {$v2063c1608d6e0baf80249c42e2be5804 = trim($this->value[0], ",");$v2063c1608d6e0baf80249c42e2be5804 = preg_replace("/[^A-Za-z0-9А-Яа-яЁё'\-$%_,\s]/u", "", $v2063c1608d6e0baf80249c42e2be5804);$v2063c1608d6e0baf80249c42e2be5804 =  explode(",", $v2063c1608d6e0baf80249c42e2be5804);}else {$v2063c1608d6e0baf80249c42e2be5804 = array_map( create_function('$a', " return preg_replace(\"/[^A-Za-z0-9А-Яа-яЁё'\\-\\$%_,\s]?/u\", \"\", \$a); ") , $this->value);}$v2817f701d5e1a1181e657251363295fd = 0;foreach ($v2063c1608d6e0baf80249c42e2be5804 as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = trim($v3a6d0284e743dc4a9b86f97d6dd1a3bf);if (strlen($v3a6d0284e743dc4a9b86f97d6dd1a3bf) == 0) continue;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::filterInputString($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, varchar_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}};class umiObjectPropertyText extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['text_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT text_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();$v2817f701d5e1a1181e657251363295fd = 0;foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf == "<p />" || $v3a6d0284e743dc4a9b86f97d6dd1a3bf == "&nbsp;") {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = "";}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::filterInputString($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$this->tableName} (obj_id, field_id, text_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);++$v2817f701d5e1a1181e657251363295fd;}if (!$v2817f701d5e1a1181e657251363295fd) {$this->fillNull();}}public function __wakeup() {foreach ($this->value as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if (is_string($v9e3669d19b675bd57058fd4664205d2a)) {$this->value[$v865c0c0b4ab0e063e5caa3387c1a8741] = str_replace("&#037;", "%", $v9e3669d19b675bd57058fd4664205d2a);}}}};class umiObjectPropertyWYSIWYG extends umiObjectPropertyText {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = Array();$v3aabf39f2d943fa886d86dcbbee4d910 = $this->field_id;if ($v8d777f385d3dfec8815d20f7496026dc = $this->getPropData()) {foreach ($v8d777f385d3dfec8815d20f7496026dc['text_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;if (str_replace("&nbsp;", "", trim($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) == "") continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT text_val FROM {$this->tableName} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v3aabf39f2d943fa886d86dcbbee4d910}' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);while (list($v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_row($result)) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;if (str_replace("&nbsp;", "", trim($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) == "") continue;$v9b207167e5381c47682c6b4f58a623fb[] = self::filterOutputString((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {foreach ($this->value as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v2063c1608d6e0baf80249c42e2be5804) {$v2063c1608d6e0baf80249c42e2be5804 = str_replace(array('&lt;!--', '--&gt;'), array('<!--', '-->'),  $v2063c1608d6e0baf80249c42e2be5804);$v2063c1608d6e0baf80249c42e2be5804 = preg_replace('/<!--\[if(.*?)>(.*?)<!(-*)\[endif\][\s]*-->/mis', '', $v2063c1608d6e0baf80249c42e2be5804);$this->value[$v865c0c0b4ab0e063e5caa3387c1a8741] = $v2063c1608d6e0baf80249c42e2be5804;}parent::saveValue();}};interface iBackupModel {public function getChanges($veca07335a33c5aeb5e1bc7c98b4b9d80 = "");public function save($vf33a4e939ffe21234596860b7249c246 = "");public function rollback($v3d477c1c43140638c8738b94181f5b18);public function addLogMessage($v7552cd149af7495ee7d8225974e50f80);public function fakeBackup($v7552cd149af7495ee7d8225974e50f80);};class backupModel extends singleton implements iBackupModel {protected function __construct() {}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function getChanges($vf33a4e939ffe21234596860b7249c246 = false) {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();if (!$vb1444fb0c07653567ad325aa25d4e37a->getVal("modules/backup/enabled")) {return false;}$vaa9f73eea60a006820d0f8768bc8a3fc = (int) $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/backup/max_save_actions");$vb37057aff71d268f8b562c7dd23453a6 = (int) $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/backup/max_timelimit");$v305d28898e362717b3ad3d0181c15636 = $vb37057aff71d268f8b562c7dd23453a6 * 3600 * 24;$vf33a4e939ffe21234596860b7249c246 = (int) $vf33a4e939ffe21234596860b7249c246;$vaa9f73eea60a006820d0f8768bc8a3fc = ($vaa9f73eea60a006820d0f8768bc8a3fc > 2) ? $vaa9f73eea60a006820d0f8768bc8a3fc : 2;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, ctime, changed_module, user_id, is_active FROM cms_backup WHERE param='" . $vf33a4e939ffe21234596860b7249c246 . "' AND (" . time() . "-ctime)<" . $v305d28898e362717b3ad3d0181c15636 . " ORDER BY ctime DESC LIMIT {$vaa9f73eea60a006820d0f8768bc8a3fc}";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if (mysql_num_rows($result) < 2) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, ctime, changed_module, user_id, is_active FROM cms_backup WHERE param='" . $vf33a4e939ffe21234596860b7249c246 . "' ORDER BY ctime DESC LIMIT 2";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}$v21ffce5b8a6cc8cc6a41448dd69623c9 = array();$vdf347a373b8f92aa0ae3dd920a5ec2f6 = array();while(list($v5de09a8d1a309a8103bba960e16f1ab4, $v8c1eddb947fad440954f3c703d4df808, $vcd5b6c7221daa58d6e8c27bd85d9df56, $ve8701ad48ba05a91604e480dd60899a3, $v4264c638e0098acb172519b0436db099) = mysql_fetch_row($result)) {$v8bc182b015e0e0749de8158e4343b3da = $this->getChangeInfo($v5de09a8d1a309a8103bba960e16f1ab4, $v8c1eddb947fad440954f3c703d4df808, $vcd5b6c7221daa58d6e8c27bd85d9df56, $vf33a4e939ffe21234596860b7249c246, $ve8701ad48ba05a91604e480dd60899a3, $v4264c638e0098acb172519b0436db099);if (count($v8bc182b015e0e0749de8158e4343b3da)) $vdf347a373b8f92aa0ae3dd920a5ec2f6[] = $v8bc182b015e0e0749de8158e4343b3da;}$v21ffce5b8a6cc8cc6a41448dd69623c9['nodes:revision'] = $vdf347a373b8f92aa0ae3dd920a5ec2f6;return $v21ffce5b8a6cc8cc6a41448dd69623c9;}protected function getChangeInfo($v5de09a8d1a309a8103bba960e16f1ab4, $v8c1eddb947fad440954f3c703d4df808, $vcd5b6c7221daa58d6e8c27bd85d9df56, $vf33a4e939ffe21234596860b7249c246, $ve8701ad48ba05a91604e480dd60899a3, $v4264c638e0098acb172519b0436db099) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v8bc182b015e0e0749de8158e4343b3da = array();$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($vf33a4e939ffe21234596860b7249c246);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$v8bc182b015e0e0749de8158e4343b3da['attribute:changetime'] = $v8c1eddb947fad440954f3c703d4df808;$v8bc182b015e0e0749de8158e4343b3da['attribute:user-id'] = $ve8701ad48ba05a91604e480dd60899a3;if (strlen($vcd5b6c7221daa58d6e8c27bd85d9df56) == 0) {$v8bc182b015e0e0749de8158e4343b3da['attribute:is-void'] = true;}if ($v4264c638e0098acb172519b0436db099) {$v8bc182b015e0e0749de8158e4343b3da['attribute:active'] = "active";}$v8bc182b015e0e0749de8158e4343b3da['date'] = new umiDate($v8c1eddb947fad440954f3c703d4df808);$v8bc182b015e0e0749de8158e4343b3da['author'] = selector::get('object')->id($ve8701ad48ba05a91604e480dd60899a3);$v8bc182b015e0e0749de8158e4343b3da['link'] = "/admin/backup/rollback/{$v5de09a8d1a309a8103bba960e16f1ab4}/";$v854203cccade0bbe21be239a208aea49 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getModule();$v2fa70149e2a7e75da2b0303d0a36a944 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getMethod();$v22884db148f0ffb0d830ba431102b0b5 = $v8b1dc169bf460ee884fceef66c6607d6->getModule($v854203cccade0bbe21be239a208aea49);if ($v22884db148f0ffb0d830ba431102b0b5 instanceof def_module) {$v807765384d9d5527da8848df14a4f02f = $v22884db148f0ffb0d830ba431102b0b5->getEditLink($vf33a4e939ffe21234596860b7249c246, $v2fa70149e2a7e75da2b0303d0a36a944);if (isset($v807765384d9d5527da8848df14a4f02f[1])) {$v8bc182b015e0e0749de8158e4343b3da['page'] = array();$v8bc182b015e0e0749de8158e4343b3da['page']['attribute:name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();$v8bc182b015e0e0749de8158e4343b3da['page']['attribute:edit-link'] = $v807765384d9d5527da8848df14a4f02f[1];$v8bc182b015e0e0749de8158e4343b3da['page']['attribute:link'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->link;}}}return $v8bc182b015e0e0749de8158e4343b3da;}public function getAllChanges() {if (!regedit::getInstance()->getVal("modules/backup/enabled")) {return false;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, ctime, changed_module, param, user_id, is_active FROM cms_backup ORDER BY ctime DESC LIMIT 100";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v21ffce5b8a6cc8cc6a41448dd69623c9 = array();$vdf347a373b8f92aa0ae3dd920a5ec2f6 = array();while (list($v5de09a8d1a309a8103bba960e16f1ab4, $v8c1eddb947fad440954f3c703d4df808, $vcd5b6c7221daa58d6e8c27bd85d9df56, $vf33a4e939ffe21234596860b7249c246, $ve8701ad48ba05a91604e480dd60899a3, $v4264c638e0098acb172519b0436db099) = mysql_fetch_row($result)) {$v8bc182b015e0e0749de8158e4343b3da = $this->getChangeInfo($v5de09a8d1a309a8103bba960e16f1ab4, $v8c1eddb947fad440954f3c703d4df808, $vcd5b6c7221daa58d6e8c27bd85d9df56, $vf33a4e939ffe21234596860b7249c246, $ve8701ad48ba05a91604e480dd60899a3, $v4264c638e0098acb172519b0436db099);if (count($v8bc182b015e0e0749de8158e4343b3da)) {$vdf347a373b8f92aa0ae3dd920a5ec2f6 = array_merge($vdf347a373b8f92aa0ae3dd920a5ec2f6, array($v8bc182b015e0e0749de8158e4343b3da));}}$v21ffce5b8a6cc8cc6a41448dd69623c9['nodes:revision'] = $vdf347a373b8f92aa0ae3dd920a5ec2f6;return $v21ffce5b8a6cc8cc6a41448dd69623c9;}public function save($vf33a4e939ffe21234596860b7249c246 = "", $vad0c3358f1a712601256bfc6e9ee9830 = "", $v05dd82e678780573a4af462d35d7f06d = "") {if (!regedit::getInstance()->getVal("//modules/backup/enabled")) {return false;}if (getRequest('rollbacked')) {return false;}$this->restoreIncrement();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if (!$vad0c3358f1a712601256bfc6e9ee9830) {$vad0c3358f1a712601256bfc6e9ee9830 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentModule();}$v05dd82e678780573a4af462d35d7f06d = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentMethod();$v1d0c3e03c46ba6aa6adb5394fecfc396 = ($v8b1dc169bf460ee884fceef66c6607d6->getModule('users')) ? $v1d0c3e03c46ba6aa6adb5394fecfc396 = $v8b1dc169bf460ee884fceef66c6607d6->getModule('users')->user_id : 0;$v8c1eddb947fad440954f3c703d4df808 = time();if(!$vad0c3358f1a712601256bfc6e9ee9830) {$vad0c3358f1a712601256bfc6e9ee9830 = getRequest('module');}if(!$v05dd82e678780573a4af462d35d7f06d) {$v05dd82e678780573a4af462d35d7f06d = getRequest('method');}foreach ($_REQUEST as $v7efdfc94655a25dcea3ec85e9bb703fa => $vde3ec0aa2234aa1e3ee275bbc715c6c9) {if ($v7efdfc94655a25dcea3ec85e9bb703fa == "save-mode") {continue;}$_temp[$v7efdfc94655a25dcea3ec85e9bb703fa] = (!is_array($vde3ec0aa2234aa1e3ee275bbc715c6c9)) ? base64_encode($vde3ec0aa2234aa1e3ee275bbc715c6c9) : $vde3ec0aa2234aa1e3ee275bbc715c6c9;}if (isset($_temp['data']['new'])) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($vf33a4e939ffe21234596860b7249c246);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$_temp['data'][$v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectId()] = $_temp['data']['new'];unset($_temp['data']['new']);}}$vab4d0a658aef644a039b90c2067b45c0 = serialize($_temp);$vab4d0a658aef644a039b90c2067b45c0 = l_mysql_real_escape_string($vab4d0a658aef644a039b90c2067b45c0);$vf33a4e939ffe21234596860b7249c246 = l_mysql_real_escape_string($vf33a4e939ffe21234596860b7249c246);$vad0c3358f1a712601256bfc6e9ee9830 = l_mysql_real_escape_string($vad0c3358f1a712601256bfc6e9ee9830);$v05dd82e678780573a4af462d35d7f06d = l_mysql_real_escape_string($v05dd82e678780573a4af462d35d7f06d);$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms_backup SET is_active='0' WHERE param='" . $vf33a4e939ffe21234596860b7249c246 . "'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO cms_backup (ctime, changed_module, changed_method, param, param0, user_id, is_active)
				VALUES('{$v8c1eddb947fad440954f3c703d4df808}', '{$vad0c3358f1a712601256bfc6e9ee9830}', '{$v05dd82e678780573a4af462d35d7f06d}', '{$vf33a4e939ffe21234596860b7249c246}', '{$vab4d0a658aef644a039b90c2067b45c0}', '{$v1d0c3e03c46ba6aa6adb5394fecfc396}', '1')
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vaa9f73eea60a006820d0f8768bc8a3fc = regedit::getInstance()->getVal("//modules/backup/max_save_actions");$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT COUNT(*) FROM cms_backup WHERE param='" . $vf33a4e939ffe21234596860b7249c246 . "' ORDER BY ctime DESC";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($vaacd38cfef1bec4d335a62835fda0839) = mysql_fetch_row($result);$v626726e60bd1215f36719a308a25b798 = $vaacd38cfef1bec4d335a62835fda0839 - $vaa9f73eea60a006820d0f8768bc8a3fc;if ($v626726e60bd1215f36719a308a25b798 < 0) {$v626726e60bd1215f36719a308a25b798 = 0;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms_backup WHERE param='" . $vf33a4e939ffe21234596860b7249c246 . "' ORDER BY ctime DESC LIMIT 2";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v975736d9abdba70140122f735ae3078e = array();while (list($v6854af81e6aa52bea3d9bd1afbff5cab) = mysql_fetch_row($result)) {$v975736d9abdba70140122f735ae3078e[] = $v6854af81e6aa52bea3d9bd1afbff5cab;}$v0b951629e3502f9eedc07d60d307de11 = "";if (count($v975736d9abdba70140122f735ae3078e)) {$v0b951629e3502f9eedc07d60d307de11 = "AND id NOT IN (" . implode(", ", $v975736d9abdba70140122f735ae3078e) . ")";}$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms_backup WHERE param='" . $vf33a4e939ffe21234596860b7249c246 . "' {$v0b951629e3502f9eedc07d60d307de11} ORDER BY ctime ASC LIMIT " . ($v626726e60bd1215f36719a308a25b798);l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vb37057aff71d268f8b562c7dd23453a6 = regedit::getInstance()->getVal("//modules/backup/max_timelimit");$v305d28898e362717b3ad3d0181c15636 = $vb37057aff71d268f8b562c7dd23453a6*3600*24;$vac5c74b64b4b8352ef2f181affb5ac2a="DELETE FROM cms_backup WHERE param='" . $vf33a4e939ffe21234596860b7249c246 . "' AND (" . time() . "-ctime)>" . $v305d28898e362717b3ad3d0181c15636 . " {$v0b951629e3502f9eedc07d60d307de11} ORDER BY ctime ASC";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function rollback($v5de09a8d1a309a8103bba960e16f1ab4) {if(!regedit::getInstance()->getVal("//modules/backup/enabled")) {return false;}$v5de09a8d1a309a8103bba960e16f1ab4 = (int) $v5de09a8d1a309a8103bba960e16f1ab4;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT param, param0, changed_module, changed_method FROM cms_backup WHERE id='$v5de09a8d1a309a8103bba960e16f1ab4' LIMIT 1";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(list($v7057e8409c7c531a1a6e9ac3df4ed549, $v8d777f385d3dfec8815d20f7496026dc, $vcd5b6c7221daa58d6e8c27bd85d9df56, $v4f808c2668c4318a25f5068ad02f465f) = mysql_fetch_row($result)) {$vdec2d7edd1187a6ec1061702b907a633 = $v7057e8409c7c531a1a6e9ac3df4ed549;$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms_backup SET is_active='0' WHERE param='" . $vdec2d7edd1187a6ec1061702b907a633 . "'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms_backup SET is_active='1' WHERE id='" . $v5de09a8d1a309a8103bba960e16f1ab4 . "'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$_temp = unserialize($v8d777f385d3dfec8815d20f7496026dc);$_REQUEST = Array();foreach($_temp as $v7efdfc94655a25dcea3ec85e9bb703fa => $vde3ec0aa2234aa1e3ee275bbc715c6c9) {if(!is_array($vde3ec0aa2234aa1e3ee275bbc715c6c9)) {$vde3ec0aa2234aa1e3ee275bbc715c6c9 = base64_decode($vde3ec0aa2234aa1e3ee275bbc715c6c9);}else {foreach($vde3ec0aa2234aa1e3ee275bbc715c6c9 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {$vde3ec0aa2234aa1e3ee275bbc715c6c9[$v865c0c0b4ab0e063e5caa3387c1a8741] = $v9e3669d19b675bd57058fd4664205d2a;}}$_REQUEST[$v7efdfc94655a25dcea3ec85e9bb703fa] = $vde3ec0aa2234aa1e3ee275bbc715c6c9;$_POST[$v7efdfc94655a25dcea3ec85e9bb703fa] = $vde3ec0aa2234aa1e3ee275bbc715c6c9;}$_REQUEST['rollbacked'] = true;$_REQUEST['save-mode'] = getLabel('label-save');if($vd4354742148a6751285cf836bd208112 = cmsController::getInstance()->getModule($vcd5b6c7221daa58d6e8c27bd85d9df56)) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$v807765384d9d5527da8848df14a4f02f = $vd4354742148a6751285cf836bd208112->getEditLink($v7057e8409c7c531a1a6e9ac3df4ed549, $v8e2dcfd7e7e24b1ca76c1193f645902b->getMethod());if(sizeof($v807765384d9d5527da8848df14a4f02f) >= 2) {$v6e8e7b349ee8e52e4f20489290e3ac27 = $v807765384d9d5527da8848df14a4f02f[1];$_REQUEST['referer'] = $v6e8e7b349ee8e52e4f20489290e3ac27;$v6e8e7b349ee8e52e4f20489290e3ac27 = trim($v6e8e7b349ee8e52e4f20489290e3ac27, "/") . "/do";if(preg_match("/admin\/[A-z]+\/([^\/]+)\//", $v6e8e7b349ee8e52e4f20489290e3ac27, $vc68271a63ddbc431c307beb7d2918275)) {if(isset($vc68271a63ddbc431c307beb7d2918275[1])) {$v4f808c2668c4318a25f5068ad02f465f = $vc68271a63ddbc431c307beb7d2918275[1];}}$_REQUEST['path'] = $v6e8e7b349ee8e52e4f20489290e3ac27;$_REQUEST['param0'] = $v7057e8409c7c531a1a6e9ac3df4ed549;$_REQUEST['param1'] = "do";}}return $vd4354742148a6751285cf836bd208112->cms_callMethod($v4f808c2668c4318a25f5068ad02f465f, Array());}else {throw new requreMoreAdminPermissionsException("You can't rollback this action. No permission to this module.");}}}public function addLogMessage($v7552cd149af7495ee7d8225974e50f80) {if(!regedit::getInstance()->getVal("//modules/backup/enabled")) {return false;}$this->restoreIncrement();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v1d0c3e03c46ba6aa6adb5394fecfc396 = ($v8b1dc169bf460ee884fceef66c6607d6->getModule('users')) ? $v8b1dc169bf460ee884fceef66c6607d6->getModule('users')->user_id : 0;$v07cc694b9b3fc636710fa08b6922c42b = time();$veca07335a33c5aeb5e1bc7c98b4b9d80 = (int) $v7552cd149af7495ee7d8225974e50f80;$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms_backup (ctime, param, user_id, param0) VALUES('{$v07cc694b9b3fc636710fa08b6922c42b}', '{$veca07335a33c5aeb5e1bc7c98b4b9d80}', '{$v1d0c3e03c46ba6aa6adb5394fecfc396}', '{$v07cc694b9b3fc636710fa08b6922c42b}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function fakeBackup($v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = selector::get('page')->id($v7552cd149af7495ee7d8225974e50f80);if (!($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiEntinty)) {return false;}$v539f42cd378873bb0f9889eff317bafa = $_REQUEST;$va8cfde6331bd59eb2ac96f8911c4b666 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();$v599dcce2998a6b40b1e38e8c6006cb0a = selector::get('object-type')->id($va8cfde6331bd59eb2ac96f8911c4b666->getTypeId());$_REQUEST['name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->name;$_REQUEST['alt-name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->altName;$_REQUEST['active'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->isActive;foreach ($v599dcce2998a6b40b1e38e8c6006cb0a->getAllFields() as $v06e3d36fa30cea095545139854ad1fb9) {$v972bf3f05d14ffbdb817bef60638ff00 = $v06e3d36fa30cea095545139854ad1fb9->getName();$v2063c1608d6e0baf80249c42e2be5804 = $this->fakeBackupValue($va8cfde6331bd59eb2ac96f8911c4b666, $v06e3d36fa30cea095545139854ad1fb9);if (is_null($v2063c1608d6e0baf80249c42e2be5804)) {continue;}$_REQUEST['data'][$va8cfde6331bd59eb2ac96f8911c4b666->id][$v972bf3f05d14ffbdb817bef60638ff00] = $v2063c1608d6e0baf80249c42e2be5804;}$this->save($v7552cd149af7495ee7d8225974e50f80, $v8e2dcfd7e7e24b1ca76c1193f645902b->getModule());$_REQUEST = $v539f42cd378873bb0f9889eff317bafa;return true;}protected function fakeBackupValue(iUmiObject $va8cfde6331bd59eb2ac96f8911c4b666, iUmiField $v06e3d36fa30cea095545139854ad1fb9) {$v2063c1608d6e0baf80249c42e2be5804 = $va8cfde6331bd59eb2ac96f8911c4b666->getValue($v06e3d36fa30cea095545139854ad1fb9->getName());switch($v06e3d36fa30cea095545139854ad1fb9->getDataType()) {case 'file':    case 'img_file':    case 'swf_file':     return ($v2063c1608d6e0baf80249c42e2be5804 instanceof iUmiFile) ? $v2063c1608d6e0baf80249c42e2be5804->getFilePath() : '';case 'boolean':     return $v2063c1608d6e0baf80249c42e2be5804 ? '1' : '0';case 'date':     return ($v2063c1608d6e0baf80249c42e2be5804 instanceof umiDate) ? $v2063c1608d6e0baf80249c42e2be5804->getFormattedDate('U') : NULL;case 'tags':     return is_array($v2063c1608d6e0baf80249c42e2be5804) ? implode(", ", $v2063c1608d6e0baf80249c42e2be5804) : NULL;default:     return (string) $v2063c1608d6e0baf80249c42e2be5804;}}protected function restoreIncrement() {$v1804956abd21cd701c0e7931d7ebf5df = l_mysql_query("SELECT max( id ) FROM `cms_backup`");$ve674db5dfaf0af7ad4edaefc84d799a9 = mysql_fetch_row($v1804956abd21cd701c0e7931d7ebf5df);$v604fe262b965cdecbfe3856ae4ff1a3d = $ve674db5dfaf0af7ad4edaefc84d799a9[0] + 1;$result = l_mysql_query("SHOW TABLE STATUS LIKE 'cms_backup'");$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_array($result);$v8c36426826ccf38cedc202042ef32a38 = isset($vf1965a857bc285d26fe22023aa5ab50d['Auto_increment']) ? (int) $vf1965a857bc285d26fe22023aa5ab50d['Auto_increment'] : false;if($v8c36426826ccf38cedc202042ef32a38 !== false && $v8c36426826ccf38cedc202042ef32a38 != $v604fe262b965cdecbfe3856ae4ff1a3d){l_mysql_query("ALTER TABLE `cms_backup` AUTO_INCREMENT={$v604fe262b965cdecbfe3856ae4ff1a3d}");}}};class xslTemplater extends singleton {protected function __construct() {}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return umiTemplater::create('XSLT', null);}}abstract class translatorWrapper {public $isFull = false;public static $showEmptyFields = false;abstract public function translate($v8d777f385d3dfec8815d20f7496026dc);final static public function get($va8cfde6331bd59eb2ac96f8911c4b666) {if(is_object($va8cfde6331bd59eb2ac96f8911c4b666) == false) {throw new coreException("Object required to apply class translation");}$v6f66e878c62db60568a3487869695820 = self::getClassAlias($va8cfde6331bd59eb2ac96f8911c4b666);if($v7c27535f88bae9519ceb14a8983c57ff = self::loadWrapper($v6f66e878c62db60568a3487869695820)) {return $v7c27535f88bae9519ceb14a8983c57ff;}else {throw new coreException("Can't load translation wrapper for class \"{$v6f66e878c62db60568a3487869695820}\"");}}final static protected function loadWrapper($v6f66e878c62db60568a3487869695820) {static $v2430fe39e225818bd957ed4cb53eb770 = array(), $v2245023265ae4cf87d02c8b6ba991139;if(isset($v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820])) {return $v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820];}if(is_null($v2245023265ae4cf87d02c8b6ba991139)) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();}$v46d111d8fa2089a051889becc4736cc4 = $v6f66e878c62db60568a3487869695820 . 'Wrapper';if (!class_exists($v46d111d8fa2089a051889becc4736cc4)) {$v47826cacc65c665212b821e6ff80b9b0 = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.kernel') . 'utils/translators/wrappers/' . $v6f66e878c62db60568a3487869695820 . 'Wrapper.php';if(is_file($v47826cacc65c665212b821e6ff80b9b0) == false) {$v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = false;throw new coreException("Can't load file \"{$v47826cacc65c665212b821e6ff80b9b0}\" to translate object of class \"{$v6f66e878c62db60568a3487869695820}\"");}require $v47826cacc65c665212b821e6ff80b9b0;}if(!class_exists($v46d111d8fa2089a051889becc4736cc4)) {$v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = false;throw new coreException("Translation wrapper class \"{$v46d111d8fa2089a051889becc4736cc4}\" not found");}$v7c27535f88bae9519ceb14a8983c57ff = new $v46d111d8fa2089a051889becc4736cc4($v607f2f3099f2a347b327caa70e0be4b2);if($v7c27535f88bae9519ceb14a8983c57ff instanceof translatorWrapper == false) {$v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = false;throw new coreException("Translation wrapper class \"{$v46d111d8fa2089a051889becc4736cc4}\" should be instance of translatorWrapper");}return $v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = $v7c27535f88bae9519ceb14a8983c57ff;}protected static function getClassAlias($va8cfde6331bd59eb2ac96f8911c4b666) {$v1cd3953490871ffe86ea722016f59722 = array(    'baseRestriction', 'publicException'   );$v9299da2529c98fccce0e32b476ba3266 = array(    'umiObjectProperty' => array(     'umiObjectPropertyPrice',      'umiObjectPropertyFloat',      'umiObjectPropertyTags',      'umiObjectPropertyBoolean',      'umiObjectPropertyImgFile',      'umiObjectPropertyRelation',      'umiObjectPropertyText',      'umiObjectPropertyDate',      'umiObjectPropertyInt',      'umiObjectPropertyString',      'umiObjectPropertyWYSIWYG',      'umiObjectPropertyFile',      'umiObjectPropertyPassword',      'umiObjectPropertySymlink',     'umiObjectPropertyCounter',      'umiObjectPropertyOptioned'    ),        'umiFile' => array(     'umiImageFile'    )   );$v6f66e878c62db60568a3487869695820 = get_class($va8cfde6331bd59eb2ac96f8911c4b666);foreach($v9299da2529c98fccce0e32b476ba3266 as $vcc638e7ca262bd8afdee0b624fd6627f => $v724874d1be77f450a09b305fc1534afb) {if(in_array($v6f66e878c62db60568a3487869695820, $v724874d1be77f450a09b305fc1534afb)) {return $vcc638e7ca262bd8afdee0b624fd6627f;}}foreach($v1cd3953490871ffe86ea722016f59722 as $vc0449d20a20339c3c91f487349f9ef14) {if(in_array($vc0449d20a20339c3c91f487349f9ef14, class_parents($va8cfde6331bd59eb2ac96f8911c4b666))) {return $vc0449d20a20339c3c91f487349f9ef14;}}return $v6f66e878c62db60568a3487869695820;}};class xmlTranslator implements iXmlTranslator {public static $showHiddenFieldGroups = false;public static $showUnsecureFields = false;protected $domDocument = false;protected $currentPageTranslated = false;protected static $shortKeys = array(   '@' => 'attribute',   '#' => 'node',   '+' => 'nodes',   '%' => 'xlink',   '*' => 'comment'  );public function __construct(DOMDocument $vc2d66aafee5d0e58e7682dd3e7b5d7f6) {$this->domDocument = $vc2d66aafee5d0e58e7682dd3e7b5d7f6;}public function translateToXml(DOMElement $v173a1756d2d82394cb803161f70f9a38, $v56491f2e1c74898e18bb6e47d2425b19) {return $this->chooseTranslator($v173a1756d2d82394cb803161f70f9a38, $v56491f2e1c74898e18bb6e47d2425b19);}public function chooseTranslator(DOMElement $v173a1756d2d82394cb803161f70f9a38, $v56491f2e1c74898e18bb6e47d2425b19, $ve30d41e6c131a13252ce15184b24d99b = false) {switch(gettype($v56491f2e1c74898e18bb6e47d2425b19)) {case "array": {$this->translateArray($v173a1756d2d82394cb803161f70f9a38, $v56491f2e1c74898e18bb6e47d2425b19);break;}case "object": {$v7c27535f88bae9519ceb14a8983c57ff = translatorWrapper::get($v56491f2e1c74898e18bb6e47d2425b19);$v7c27535f88bae9519ceb14a8983c57ff->isFull = $ve30d41e6c131a13252ce15184b24d99b;$this->chooseTranslator($v173a1756d2d82394cb803161f70f9a38, $v7c27535f88bae9519ceb14a8983c57ff->translate($v56491f2e1c74898e18bb6e47d2425b19));break;}default: {$this->translateBasic($v173a1756d2d82394cb803161f70f9a38, $v56491f2e1c74898e18bb6e47d2425b19);break;}}}public static function isParseTPLMacrosesAllowed() {static $v22ee71e9dcc9ca12fc313c6e1ce3f806;if (is_bool($v22ee71e9dcc9ca12fc313c6e1ce3f806)) return $v22ee71e9dcc9ca12fc313c6e1ce3f806;$v22ee71e9dcc9ca12fc313c6e1ce3f806 = true;if (cmsController::getInstance()->getCurrentMode() == "admin") {$v22ee71e9dcc9ca12fc313c6e1ce3f806 = false;}elseif (defined('XML_MACROSES_DISABLE') && XML_MACROSES_DISABLE) {$v9cf41e5f460b6ae5505f9809fe9f5d37 = mainConfiguration::getInstance()->get('kernel', 'xml-macroses.allowed');$v22ee71e9dcc9ca12fc313c6e1ce3f806 = (is_array($v9cf41e5f460b6ae5505f9809fe9f5d37) && count($v9cf41e5f460b6ae5505f9809fe9f5d37));}return $v22ee71e9dcc9ca12fc313c6e1ce3f806;}public static function getAllowedTplMacroses() {if (defined('XML_MACROSES_DISABLE') && XML_MACROSES_DISABLE) {return mainConfiguration::getInstance()->get('kernel', 'xml-macroses.allowed');}else {return null;}}public static function executeMacroses($v56491f2e1c74898e18bb6e47d2425b19, $vaf0bf69b4590545119c86ee0e59c088d = false, $v5d8603331b744a86bd36e07552225714 = false) {if (self::isParseTPLMacrosesAllowed()) {if (strpos($v56491f2e1c74898e18bb6e47d2425b19, '%') === false) return $v56491f2e1c74898e18bb6e47d2425b19;$v8980246496f088322ddf9eca96750755 = umiTemplater::create('TPL');$v8980246496f088322ddf9eca96750755->executeOnlyAllowedMacroses(self::getAllowedTplMacroses());$v8980246496f088322ddf9eca96750755->setScope($vaf0bf69b4590545119c86ee0e59c088d, $v5d8603331b744a86bd36e07552225714);$v56491f2e1c74898e18bb6e47d2425b19 = $v8980246496f088322ddf9eca96750755->parse(array(), $v56491f2e1c74898e18bb6e47d2425b19);}return $v56491f2e1c74898e18bb6e47d2425b19;}protected function translateBasic(DOMElement $v173a1756d2d82394cb803161f70f9a38, $v56491f2e1c74898e18bb6e47d2425b19) {$vdd988cfd769c9f7fbd795a0f5da8e751 = $this->domDocument;$v56491f2e1c74898e18bb6e47d2425b19 = self::executeMacroses($v56491f2e1c74898e18bb6e47d2425b19);$v8e2dcfd7e7e24b1ca76c1193f645902b = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode($v56491f2e1c74898e18bb6e47d2425b19);$v173a1756d2d82394cb803161f70f9a38->appendChild($v8e2dcfd7e7e24b1ca76c1193f645902b);}protected function translateArray(DOMElement $v173a1756d2d82394cb803161f70f9a38, $v56491f2e1c74898e18bb6e47d2425b19) {$vdd988cfd769c9f7fbd795a0f5da8e751 = $this->domDocument;foreach($v56491f2e1c74898e18bb6e47d2425b19 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if($this->isKeySubnodes($v3c6e0b8a9c15224a8228b9a98ca1531d)) {$v3c6e0b8a9c15224a8228b9a98ca1531d = $this->getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d);$v9b207167e5381c47682c6b4f58a623fb[$v3c6e0b8a9c15224a8228b9a98ca1531d] = Array();$v9b207167e5381c47682c6b4f58a623fb[$v3c6e0b8a9c15224a8228b9a98ca1531d]['nodes:item'] = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v9b207167e5381c47682c6b4f58a623fb;unset($v9b207167e5381c47682c6b4f58a623fb);}switch(true) {case $this->isKeyANull($v3c6e0b8a9c15224a8228b9a98ca1531d): {break;}case $this->isKeyAFull($v3c6e0b8a9c15224a8228b9a98ca1531d): {$v3c6e0b8a9c15224a8228b9a98ca1531d = $this->getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d);if($v3c6e0b8a9c15224a8228b9a98ca1531d == false) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $v173a1756d2d82394cb803161f70f9a38;}else {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement($v3c6e0b8a9c15224a8228b9a98ca1531d);}$this->chooseTranslator($v8e2dcfd7e7e24b1ca76c1193f645902b, $v3a6d0284e743dc4a9b86f97d6dd1a3bf, true);if($v3c6e0b8a9c15224a8228b9a98ca1531d != false) {$v173a1756d2d82394cb803161f70f9a38->appendChild($v8e2dcfd7e7e24b1ca76c1193f645902b);}break;}case $this->isKeyAnAttribute($v3c6e0b8a9c15224a8228b9a98ca1531d): {$v3c6e0b8a9c15224a8228b9a98ca1531d = $this->getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d);if($v3a6d0284e743dc4a9b86f97d6dd1a3bf === "" || is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf) || is_array($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) break;$v173a1756d2d82394cb803161f70f9a38->setAttribute($v3c6e0b8a9c15224a8228b9a98ca1531d, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);break;}case $this->isKeyANode($v3c6e0b8a9c15224a8228b9a98ca1531d): {$v36c4536996ca5615dcf9911f068786dc = $vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode((string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v173a1756d2d82394cb803161f70f9a38->appendChild($v36c4536996ca5615dcf9911f068786dc);break;}case $this->isKeyNodes($v3c6e0b8a9c15224a8228b9a98ca1531d): {$v3c6e0b8a9c15224a8228b9a98ca1531d = $this->getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d);if(is_array($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {foreach($v3a6d0284e743dc4a9b86f97d6dd1a3bf as $vf19e92e810d08b6cf2d0265b779064d9) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement($v3c6e0b8a9c15224a8228b9a98ca1531d);$this->chooseTranslator($v8e2dcfd7e7e24b1ca76c1193f645902b, $vf19e92e810d08b6cf2d0265b779064d9);$v173a1756d2d82394cb803161f70f9a38->appendChild($v8e2dcfd7e7e24b1ca76c1193f645902b);}}break;}case $this->isKeyXml($v3c6e0b8a9c15224a8228b9a98ca1531d): {$v3c6e0b8a9c15224a8228b9a98ca1531d = $this->getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d);$v3a6d0284e743dc4a9b86f97d6dd1a3bf = html_entity_decode($v3a6d0284e743dc4a9b86f97d6dd1a3bf, ENT_COMPAT, "utf-8");$v3a6d0284e743dc4a9b86f97d6dd1a3bf = str_replace('&', '&amp;', $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v75e4635b97622e5504161a4a8ba7bea8 = @secure_load_simple_xml($v3a6d0284e743dc4a9b86f97d6dd1a3bf);if($v75e4635b97622e5504161a4a8ba7bea8 !== false) {if($vce2efc879f403662a84494ec120a1543 = dom_import_simplexml($v75e4635b97622e5504161a4a8ba7bea8)) {$vce2efc879f403662a84494ec120a1543 = $vdd988cfd769c9f7fbd795a0f5da8e751->importNode($vce2efc879f403662a84494ec120a1543, true);$v173a1756d2d82394cb803161f70f9a38->appendChild($vce2efc879f403662a84494ec120a1543);}break;}else {$v173a1756d2d82394cb803161f70f9a38->appendChild($vdd988cfd769c9f7fbd795a0f5da8e751->createTextNode($v3a6d0284e743dc4a9b86f97d6dd1a3bf));break;}}case $this->isKeyXLink($v3c6e0b8a9c15224a8228b9a98ca1531d): {$v3c6e0b8a9c15224a8228b9a98ca1531d = $this->getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d);$v173a1756d2d82394cb803161f70f9a38->setAttribute("xlink:" . $v3c6e0b8a9c15224a8228b9a98ca1531d, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);break;}case $this->isKeyComment($v3c6e0b8a9c15224a8228b9a98ca1531d): {$v173a1756d2d82394cb803161f70f9a38->appendChild(new DOMComment(' ' . $v3a6d0284e743dc4a9b86f97d6dd1a3bf . ' '));break;}default: {if($v3c6e0b8a9c15224a8228b9a98ca1531d === 0) {throw new coreException("Can't translate to xml key {$v3c6e0b8a9c15224a8228b9a98ca1531d} with value {$v3a6d0284e743dc4a9b86f97d6dd1a3bf}");break;}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement($v3c6e0b8a9c15224a8228b9a98ca1531d);$this->chooseTranslator($v8e2dcfd7e7e24b1ca76c1193f645902b, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v173a1756d2d82394cb803161f70f9a38->appendChild($v8e2dcfd7e7e24b1ca76c1193f645902b);break;}}}}protected function isKeyANull($v3c6e0b8a9c15224a8228b9a98ca1531d) {return $this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) == "void";}protected function isKeyAFull($v3c6e0b8a9c15224a8228b9a98ca1531d) {return $this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) == "full";}protected function isKeyAnAttribute($v3c6e0b8a9c15224a8228b9a98ca1531d) {$v518d8dec3947df909fe6e4c9940f98a6 = $this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d);return ($v518d8dec3947df909fe6e4c9940f98a6 == "attr" || $v518d8dec3947df909fe6e4c9940f98a6 == "attribute");}protected function isKeyANode($v3c6e0b8a9c15224a8228b9a98ca1531d) {return ($this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) == "node");}protected function isKeyNodes($v3c6e0b8a9c15224a8228b9a98ca1531d) {return ($this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) == "nodes"  || $this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) == "list");}protected function isKeySubnodes($v3c6e0b8a9c15224a8228b9a98ca1531d) {return ($this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) == "subnodes");}protected function isKeyXml($v3c6e0b8a9c15224a8228b9a98ca1531d) {return ($this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) == "xml");}protected function isKeyXLink($v3c6e0b8a9c15224a8228b9a98ca1531d) {return ($this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) == "xlink");}protected function isKeyComment($v3c6e0b8a9c15224a8228b9a98ca1531d) {return ($this->getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) == "comment");}public static function getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d) {$v8b04d5e3775d298e78455efc5ca404d5 = substr($v3c6e0b8a9c15224a8228b9a98ca1531d, 0, 1);if(isset(self::$shortKeys[$v8b04d5e3775d298e78455efc5ca404d5])) {return substr($v3c6e0b8a9c15224a8228b9a98ca1531d, 1);}if($v5e0bdcbddccca4d66d74ba8c1cee1a68 = strpos($v3c6e0b8a9c15224a8228b9a98ca1531d, ":")) {++$v5e0bdcbddccca4d66d74ba8c1cee1a68;}else {$v5e0bdcbddccca4d66d74ba8c1cee1a68 = 0;}return substr($v3c6e0b8a9c15224a8228b9a98ca1531d, $v5e0bdcbddccca4d66d74ba8c1cee1a68);}public static function getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d) {$v8b04d5e3775d298e78455efc5ca404d5 = substr($v3c6e0b8a9c15224a8228b9a98ca1531d, 0, 1);if(isset(self::$shortKeys[$v8b04d5e3775d298e78455efc5ca404d5])) {return self::$shortKeys[$v8b04d5e3775d298e78455efc5ca404d5];}if($v5e0bdcbddccca4d66d74ba8c1cee1a68 = strpos($v3c6e0b8a9c15224a8228b9a98ca1531d, ":")) {return substr($v3c6e0b8a9c15224a8228b9a98ca1531d, 0, $v5e0bdcbddccca4d66d74ba8c1cee1a68);}else {return false;}}};class baseRestrictionWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(baseRestriction $v3dadfaeb46ec74762b37de11fea7605c) {return array(    'attribute:id'    => $v3dadfaeb46ec74762b37de11fea7605c->getId(),    'attribute:name'   => $v3dadfaeb46ec74762b37de11fea7605c->getClassName(),    'attribute:field-type-id' => $v3dadfaeb46ec74762b37de11fea7605c->getFieldTypeId(),    'node:title'    => $v3dadfaeb46ec74762b37de11fea7605c->getTitle()   );}};class domainMirrowWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iDomainMirrow $v15515d42c0242547a1c1972abb21cfad) {return array(    'attribute:id'  => $v15515d42c0242547a1c1972abb21cfad->getId(),    'attribute:host' => $v15515d42c0242547a1c1972abb21cfad->getHost(),   );}};class domainWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iDomain $vad5f82e879a9c5d6b5b442eb37e50551) {return array(    'attribute:id'  => $vad5f82e879a9c5d6b5b442eb37e50551->getId(),    'attribute:host' => $vad5f82e879a9c5d6b5b442eb37e50551->getHost(),    'attribute:lang-id' => $vad5f82e879a9c5d6b5b442eb37e50551->getDefaultLangId(),    'attribute:is-default'=> $vad5f82e879a9c5d6b5b442eb37e50551->getIsDefault()   );}};class langWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iLang $v7572559ca86e781ba8fe8073a0b725c6) {$v26b75b176d665f24a5fd22a2ad815763 = array();$v26b75b176d665f24a5fd22a2ad815763['attribute:id'] = $v7572559ca86e781ba8fe8073a0b725c6->getId();$v26b75b176d665f24a5fd22a2ad815763['attribute:prefix'] = $v7572559ca86e781ba8fe8073a0b725c6->getPrefix();if ($v7572559ca86e781ba8fe8073a0b725c6->getIsDefault()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:is-default'] = 1;}$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vf585b7f018bb4ced15a03683a733e50b = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();if($vf585b7f018bb4ced15a03683a733e50b == $v7572559ca86e781ba8fe8073a0b725c6->getId()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:is-current'] = 1;}$v26b75b176d665f24a5fd22a2ad815763['node:title'] = $v7572559ca86e781ba8fe8073a0b725c6->getTitle();return $v26b75b176d665f24a5fd22a2ad815763;}};class publicExceptionWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(publicException $v42552b1f133f9f8eb406d4f306ea9fd1) {return array(    'error' => array(     'node:msg' => def_module::parseTPLMacroses($v42552b1f133f9f8eb406d4f306ea9fd1->getMessage())    )   );}};class templateWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iTemplate $v66f6181bcb4cff4cd38fbc804a036db6) {$v26b75b176d665f24a5fd22a2ad815763 = Array();$v26b75b176d665f24a5fd22a2ad815763['attribute:id'] = $v66f6181bcb4cff4cd38fbc804a036db6->getId();$v26b75b176d665f24a5fd22a2ad815763['attribute:title'] = $v66f6181bcb4cff4cd38fbc804a036db6->getTitle();$v26b75b176d665f24a5fd22a2ad815763['attribute:name'] = $v66f6181bcb4cff4cd38fbc804a036db6->getName();$v26b75b176d665f24a5fd22a2ad815763['attribute:type'] = $v66f6181bcb4cff4cd38fbc804a036db6->getType();$v26b75b176d665f24a5fd22a2ad815763['attribute:filename'] = $v66f6181bcb4cff4cd38fbc804a036db6->getFilename();$v26b75b176d665f24a5fd22a2ad815763['attribute:domain-id'] = $v66f6181bcb4cff4cd38fbc804a036db6->getDomainId();$v26b75b176d665f24a5fd22a2ad815763['attribute:lang-id'] = $v66f6181bcb4cff4cd38fbc804a036db6->getLangId();if($v66f6181bcb4cff4cd38fbc804a036db6->getIsDefault()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:is-default'] = true;}return $v26b75b176d665f24a5fd22a2ad815763;}};class umiDateWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iUmiDate $v5fc732311905cb27e82d67f4f6511f7f) {return array(    'attribute:unix-timestamp' => $v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate('U'),    'attribute:rfc'    => $v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate('r'),    'attribute:formatted-date'  => $v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate("d.m.Y H:i"),    'node:std'     => $v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate()   );}};class umiFieldsGroupWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}public function translateProperties(iUmiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, iUmiObject $va8cfde6331bd59eb2ac96f8911c4b666) {$v47db2588331bbe530c80dd001fc60aed = $vdb0f6f37ebeb6ea09489124345af2a45->getId();$va2b861d0e7719d9108522aacfd4181bc = $vdb0f6f37ebeb6ea09489124345af2a45->getName();$v033db9a44bb2ef53effec0ac7c905c8c = $vdb0f6f37ebeb6ea09489124345af2a45->getTitle();$v71ea3b11aebda17ad80b6499a6ab6fb0 = array();$v71ea3b11aebda17ad80b6499a6ab6fb0['attribute:id'] = $v47db2588331bbe530c80dd001fc60aed;$v71ea3b11aebda17ad80b6499a6ab6fb0['attribute:name'] = $va2b861d0e7719d9108522aacfd4181bc;$v71ea3b11aebda17ad80b6499a6ab6fb0['title'] = $v033db9a44bb2ef53effec0ac7c905c8c;$vd05b6ed7d2345020440df396d6da7f73 = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();$v71ea3b11aebda17ad80b6499a6ab6fb0['nodes:property'] = Array();$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$vb116c0edc58650200e8613da6ced1228 = false;foreach($vd05b6ed7d2345020440df396d6da7f73 as $v945100186b119048837b9859c2c46410 => $v06e3d36fa30cea095545139854ad1fb9) {$v972bf3f05d14ffbdb817bef60638ff00 = $v06e3d36fa30cea095545139854ad1fb9->getName();$v1a8db4c996d8ed8289da5f957879ab94 = $va8cfde6331bd59eb2ac96f8911c4b666->getPropByName($v972bf3f05d14ffbdb817bef60638ff00);if(is_null($v1a8db4c996d8ed8289da5f957879ab94)) continue;$v84b711c462ff4413ba5f54eef508bc85 = translatorWrapper::get($v1a8db4c996d8ed8289da5f957879ab94)->translate($v1a8db4c996d8ed8289da5f957879ab94);if(!empty($v84b711c462ff4413ba5f54eef508bc85)) {$vb116c0edc58650200e8613da6ced1228 = true;$v71ea3b11aebda17ad80b6499a6ab6fb0['nodes:property'][(getRequest('jsonMode') == "force" ? $v865c0c0b4ab0e063e5caa3387c1a8741++ : ++$v865c0c0b4ab0e063e5caa3387c1a8741)] = $v84b711c462ff4413ba5f54eef508bc85;}}return ($vb116c0edc58650200e8613da6ced1228) ? $v71ea3b11aebda17ad80b6499a6ab6fb0 : array();}protected function translateData(iUmiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45) {$v26b75b176d665f24a5fd22a2ad815763 = array(    'attribute:id'  => $vdb0f6f37ebeb6ea09489124345af2a45->getId(),    'attribute:name' => $vdb0f6f37ebeb6ea09489124345af2a45->getName(),    'attribute:title' => $vdb0f6f37ebeb6ea09489124345af2a45->getTitle()   );if($vdb0f6f37ebeb6ea09489124345af2a45->getIsVisible()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:visible'] = "visible";}if($vdb0f6f37ebeb6ea09489124345af2a45->getIsLocked()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:locked'] = "locked";}$v26b75b176d665f24a5fd22a2ad815763['nodes:field'] = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();return $v26b75b176d665f24a5fd22a2ad815763;}};class umiFieldTypeWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iUmiFieldType $v833750ac635fcc57dc33ecafe365f9a7) {$v26b75b176d665f24a5fd22a2ad815763 = array(    'attribute:id'   => $v833750ac635fcc57dc33ecafe365f9a7->getId(),    'attribute:name'  => $v833750ac635fcc57dc33ecafe365f9a7->getName(),    'attribute:data-type' => $v833750ac635fcc57dc33ecafe365f9a7->getDataType()   );if($v833750ac635fcc57dc33ecafe365f9a7->getIsMultiple()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:multiple'] = "multiple";}return $v26b75b176d665f24a5fd22a2ad815763;}};class umiFieldWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}public function translateData(iUmiField $v06e3d36fa30cea095545139854ad1fb9) {$v26b75b176d665f24a5fd22a2ad815763 = array(    'attribute:id'    => $v06e3d36fa30cea095545139854ad1fb9->getId(),    'attribute:name'   => $v06e3d36fa30cea095545139854ad1fb9->getName(),    'attribute:title'   => $v06e3d36fa30cea095545139854ad1fb9->getTitle(),    'attribute:field-type-id' => $v06e3d36fa30cea095545139854ad1fb9->getFieldTypeId()   );if($v06e3d36fa30cea095545139854ad1fb9->getIsVisible()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:visible'] = "visible";}if($v06e3d36fa30cea095545139854ad1fb9->getIsInheritable()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:inheritable'] = "inheritable";}if($v06e3d36fa30cea095545139854ad1fb9->getIsLocked()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:locked'] = "locked";}if($v06e3d36fa30cea095545139854ad1fb9->getIsInFilter()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:filterable'] = "filterable";}if($v06e3d36fa30cea095545139854ad1fb9->getIsInSearch()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:indexable'] = "indexable";}if($v051369818a8073bba5feeb0e957eb308 = $v06e3d36fa30cea095545139854ad1fb9->getGuideId()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:guide-id'] = $v051369818a8073bba5feeb0e957eb308;}if($v6a2139364f96787c8ce1bbb0070b898c = $v06e3d36fa30cea095545139854ad1fb9->getTip()) {$v26b75b176d665f24a5fd22a2ad815763['tip'] = $v6a2139364f96787c8ce1bbb0070b898c;}if($v06e3d36fa30cea095545139854ad1fb9->getIsRequired()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:required'] = "required";}if($v6b1a57fa235477758817df3c91158006 = $v06e3d36fa30cea095545139854ad1fb9->getRestrictionId()) {$v26b75b176d665f24a5fd22a2ad815763['restriction'] = baseRestriction::get($v6b1a57fa235477758817df3c91158006);}$v26b75b176d665f24a5fd22a2ad815763['type'] = $v06e3d36fa30cea095545139854ad1fb9->getFieldType();return $v26b75b176d665f24a5fd22a2ad815763;}};class umiFileWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iUmiFile $v8c7dd922ad47494fc02c388e12c00eac) {$v26b75b176d665f24a5fd22a2ad815763 = array(    'attribute:path' => $v8c7dd922ad47494fc02c388e12c00eac->getFilePath(),    'attribute:size' => $v8c7dd922ad47494fc02c388e12c00eac->getSize(),    'attribute:ext'  => $v8c7dd922ad47494fc02c388e12c00eac->getExt(),    'node:src'   => $v8c7dd922ad47494fc02c388e12c00eac->getFilePath(true)   );if(get_class($v8c7dd922ad47494fc02c388e12c00eac) === "umiImageFile") {$v26b75b176d665f24a5fd22a2ad815763['attribute:width'] = $v8c7dd922ad47494fc02c388e12c00eac->getWidth();$v26b75b176d665f24a5fd22a2ad815763['attribute:height'] = $v8c7dd922ad47494fc02c388e12c00eac->getHeight();}return $v26b75b176d665f24a5fd22a2ad815763;}};class umiHierarchyElementWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iUmiHierarchyElement $v8e2dcfd7e7e24b1ca76c1193f645902b) {$v7552cd149af7495ee7d8225974e50f80 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();$v26b75b176d665f24a5fd22a2ad815763 = array();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v26b75b176d665f24a5fd22a2ad815763['@id'] = $v7552cd149af7495ee7d8225974e50f80;$v26b75b176d665f24a5fd22a2ad815763['@parentId'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();$v26b75b176d665f24a5fd22a2ad815763['@link'] = $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById($v7552cd149af7495ee7d8225974e50f80);if($vf62baf4c4ead98d50d516eca0ac5a746 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsDefault()) {$v26b75b176d665f24a5fd22a2ad815763['@is-default'] = $vf62baf4c4ead98d50d516eca0ac5a746;}if($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsVisible()) {$v26b75b176d665f24a5fd22a2ad815763['@is-visible'] = $ve1c6c9ef2fcbe75f26f815c4ef2e60b4;}if($v4264c638e0098acb172519b0436db099 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive()) {$v26b75b176d665f24a5fd22a2ad815763['@is-active'] = $v4264c638e0098acb172519b0436db099;}if($vf49e2553045b3240a95c36854d36dddc = $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsDeleted()) {$v26b75b176d665f24a5fd22a2ad815763['@is-deleted'] = $vf49e2553045b3240a95c36854d36dddc;}$v840767d63139b4dca4928d5ec734c79e = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getValue("lockuser");if($v840767d63139b4dca4928d5ec734c79e > 0) {$v31e6b624e5c05c45b0f1e8a7f59801ba = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getValue("locktime");$vcdd638e00095e76c42db80d69dfdec30 = $v8b1dc169bf460ee884fceef66c6607d6->getModule("users")->user_id;$vd5034fb9092631c8a2869ebb11b5c591 = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/lock_duration");if ($v31e6b624e5c05c45b0f1e8a7f59801ba && ($v31e6b624e5c05c45b0f1e8a7f59801ba->timestamp + $vd5034fb9092631c8a2869ebb11b5c591) > time()) {if ($vcdd638e00095e76c42db80d69dfdec30!= $v840767d63139b4dca4928d5ec734c79e) {$v797bf25c165393c1aa5fd92576e0f011['user-id'] = $v840767d63139b4dca4928d5ec734c79e;$v0db00a6b60c9e7fa0cda63a96270ca2b = $v5891da2d64975cae48d175d1e001f5da->getObject($v840767d63139b4dca4928d5ec734c79e);$v797bf25c165393c1aa5fd92576e0f011['login'] = $v0db00a6b60c9e7fa0cda63a96270ca2b->getValue("login");$v797bf25c165393c1aa5fd92576e0f011['lname'] = $v0db00a6b60c9e7fa0cda63a96270ca2b->getValue("lname");$v797bf25c165393c1aa5fd92576e0f011['fname'] = $v0db00a6b60c9e7fa0cda63a96270ca2b->getValue("fname");$v797bf25c165393c1aa5fd92576e0f011['father-name'] = $v0db00a6b60c9e7fa0cda63a96270ca2b->getValue("father_name");$v797bf25c165393c1aa5fd92576e0f011 ['locktime'] = $v31e6b624e5c05c45b0f1e8a7f59801ba->getFormattedDate();$v797bf25c165393c1aa5fd92576e0f011 ['@ts'] = $v31e6b624e5c05c45b0f1e8a7f59801ba->timestamp;$v26b75b176d665f24a5fd22a2ad815763['locked-by'] = $v797bf25c165393c1aa5fd92576e0f011;}}else {$va8cfde6331bd59eb2ac96f8911c4b666 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();$va8cfde6331bd59eb2ac96f8911c4b666->setValue("lockuser", null);$va8cfde6331bd59eb2ac96f8911c4b666->setValue("locktime", null);$va8cfde6331bd59eb2ac96f8911c4b666->commit();$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();}}$v71860c77c6745379b0d44304d66b6a13 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();$vac89cc3bb8407b8f6f24df3d2f088752 = $v71860c77c6745379b0d44304d66b6a13->getValue("expiration_date");$ve7e2aab29960a1faeb82a86368ea4b58 = $v71860c77c6745379b0d44304d66b6a13->getValue("publish_status");$vdbf113427c1e27923793e77460b11ee7 = $v5891da2d64975cae48d175d1e001f5da->getObject($ve7e2aab29960a1faeb82a86368ea4b58);$v9acb44549b41563697bb490144ec6258 = array();if ($vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/expiration_control")) {if ($vdbf113427c1e27923793e77460b11ee7) {$v9acb44549b41563697bb490144ec6258['attribute:id'] = strlen($vfa816edb83e95bf0c8da580bdfd491ef = $vdbf113427c1e27923793e77460b11ee7->getValue("publish_status_id")) ? $vfa816edb83e95bf0c8da580bdfd491ef : 'page_status_publish';$v9acb44549b41563697bb490144ec6258['node:name'] = $vdbf113427c1e27923793e77460b11ee7->getName();$v018e77635d40709feb0c09c6fb84ee00['status'] = $v9acb44549b41563697bb490144ec6258;if ($vac89cc3bb8407b8f6f24df3d2f088752) {$v018e77635d40709feb0c09c6fb84ee00['attribute:ts'] = $vac89cc3bb8407b8f6f24df3d2f088752->timestamp;$v018e77635d40709feb0c09c6fb84ee00['date'] = $vac89cc3bb8407b8f6f24df3d2f088752->getFormattedDate();$v018e77635d40709feb0c09c6fb84ee00['comments'] = $v71860c77c6745379b0d44304d66b6a13->getValue("publish_comments");}}else {$v9acb44549b41563697bb490144ec6258['@id'] = 'page_status_publish';$v9acb44549b41563697bb490144ec6258['#name'] = getLabel ('object-status-publish');$v018e77635d40709feb0c09c6fb84ee00['status'] = $v9acb44549b41563697bb490144ec6258;$v018e77635d40709feb0c09c6fb84ee00['@ts'] = "";}$v26b75b176d665f24a5fd22a2ad815763['expiration'] = $v018e77635d40709feb0c09c6fb84ee00;}if(!is_null(getRequest('virtuals'))) {$v08a0dea3e6dbfe263d3379b421a06959 = $vb81ca7c0ccaa77e7aa91936ab0070695->checkIsVirtual(array($v7552cd149af7495ee7d8225974e50f80 => false));if(isset($v08a0dea3e6dbfe263d3379b421a06959[$v7552cd149af7495ee7d8225974e50f80]) && $v08a0dea3e6dbfe263d3379b421a06959[$v7552cd149af7495ee7d8225974e50f80]) {$v26b75b176d665f24a5fd22a2ad815763['virtual-copy'] = array('attribute:count' => $v08a0dea3e6dbfe263d3379b421a06959[$v7552cd149af7495ee7d8225974e50f80]);}}$v26b75b176d665f24a5fd22a2ad815763['@object-id'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getId();$v26b75b176d665f24a5fd22a2ad815763['@object-guid'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getGUID();$v26b75b176d665f24a5fd22a2ad815763['@type-id'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getTypeId();$v26b75b176d665f24a5fd22a2ad815763['@type-guid'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getTypeGUID();$v26b75b176d665f24a5fd22a2ad815763['@update-time'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getUpdatetime();$v26b75b176d665f24a5fd22a2ad815763['@alt-name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getAltName();if(!is_null(getRequest('templates'))) {$v26b75b176d665f24a5fd22a2ad815763['@template-id'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTplId();$v26b75b176d665f24a5fd22a2ad815763['@domain-id'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();$v26b75b176d665f24a5fd22a2ad815763['@lang-id'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();}if(!is_null(getRequest('childs'))) {$vadce578d04ed03c31f6ac59451fcf8e4 = $vb81ca7c0ccaa77e7aa91936ab0070695->getChildsCount($v7552cd149af7495ee7d8225974e50f80, true, true, 1);$v26b75b176d665f24a5fd22a2ad815763['childs'] = $vadce578d04ed03c31f6ac59451fcf8e4;}if(!is_null(getRequest('permissions'))) {$vfd7b7118ef3b11157505a66f465d672f = permissionsCollection::getInstance();$v61b9295e93e2ba331ea1e6f1b79f459d = $vfd7b7118ef3b11157505a66f465d672f->isAllowedObject($vfd7b7118ef3b11157505a66f465d672f->getUserId(), $v7552cd149af7495ee7d8225974e50f80);$v26b75b176d665f24a5fd22a2ad815763['permissions'] = ($v61b9295e93e2ba331ea1e6f1b79f459d[4] ? 16 : 0) |             ($v61b9295e93e2ba331ea1e6f1b79f459d[3] ?  8 : 0) |             ($v61b9295e93e2ba331ea1e6f1b79f459d[2] ?  4 : 0) |             ($v61b9295e93e2ba331ea1e6f1b79f459d[1] ?  2 : 0) |             ($v61b9295e93e2ba331ea1e6f1b79f459d[0] ?  1 : 0);}$v0715f6d9497f93911417c9c324265771 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId();$vb946c44d711ade3b061653732977d043 = $v6942e8fa62b3cc9d93881a58210e2fd7->getType($v0715f6d9497f93911417c9c324265771);if(!is_null(getRequest('links')) && !$v8e2dcfd7e7e24b1ca76c1193f645902b->isDeleted) {$v5cd36db381c0678623647c8c221e158e = $vb946c44d711ade3b061653732977d043->getName();if($v35360fb26b66092afbb3474e0dfe5c73 = $v8b1dc169bf460ee884fceef66c6607d6->getModule($v5cd36db381c0678623647c8c221e158e)) {$v807765384d9d5527da8848df14a4f02f = $v35360fb26b66092afbb3474e0dfe5c73->getEditLink($v7552cd149af7495ee7d8225974e50f80, $vb946c44d711ade3b061653732977d043->getExt());if(is_array($v807765384d9d5527da8848df14a4f02f)) {if($v807765384d9d5527da8848df14a4f02f[0]) {$v26b75b176d665f24a5fd22a2ad815763['create-link'] = $v807765384d9d5527da8848df14a4f02f[0];}if($v807765384d9d5527da8848df14a4f02f[1]) {$v26b75b176d665f24a5fd22a2ad815763['edit-link'] = $v807765384d9d5527da8848df14a4f02f[1];}}}}if($vb946c44d711ade3b061653732977d043 instanceof iUmiHierarchyType) {$v26b75b176d665f24a5fd22a2ad815763['basetype'] = $vb946c44d711ade3b061653732977d043;}$v26b75b176d665f24a5fd22a2ad815763['name'] = str_replace(array("<",">"), array('&lt;', '&gt;'),$v8e2dcfd7e7e24b1ca76c1193f645902b->getName());if($this->isFull == false) {$v26b75b176d665f24a5fd22a2ad815763['xlink:href'] = "upage://" . $v7552cd149af7495ee7d8225974e50f80;return $v26b75b176d665f24a5fd22a2ad815763;}$va8cfde6331bd59eb2ac96f8911c4b666 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();$v6301cee35ea764a1e241978f93f01069 = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();$v726e8e4809d4c1b28a6549d86436a124 = $v0e8133eb006c0f85ed9444ae07a60842->getType($v6301cee35ea764a1e241978f93f01069);$v143fdbfa2afa490e521056bd5040d5fd = $v726e8e4809d4c1b28a6549d86436a124->getFieldsGroupsList();$v26b75b176d665f24a5fd22a2ad815763['properties'] = array('nodes:group' => array());$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;foreach($v143fdbfa2afa490e521056bd5040d5fd as $vdb0f6f37ebeb6ea09489124345af2a45) {$v03f2ce8694aef1464a97f254c78a26ae = translatorWrapper::get($vdb0f6f37ebeb6ea09489124345af2a45);$vb1a1a039830b9d5ddf71ccd5304e9e50 = $v03f2ce8694aef1464a97f254c78a26ae->translateProperties($vdb0f6f37ebeb6ea09489124345af2a45, $va8cfde6331bd59eb2ac96f8911c4b666);if(!empty($vb1a1a039830b9d5ddf71ccd5304e9e50)) {$v26b75b176d665f24a5fd22a2ad815763['properties']['nodes:group'][(getRequest('jsonMode') == "force" ? $v865c0c0b4ab0e063e5caa3387c1a8741++ : ++$v865c0c0b4ab0e063e5caa3387c1a8741)] = $vb1a1a039830b9d5ddf71ccd5304e9e50;}}return $v26b75b176d665f24a5fd22a2ad815763;}}class umiHierarchyTypeWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iUmiHierarchyType $v599dcce2998a6b40b1e38e8c6006cb0a) {return array(    'attribute:id'  => $v599dcce2998a6b40b1e38e8c6006cb0a->getId(),    'attribute:module' => $v599dcce2998a6b40b1e38e8c6006cb0a->getName(),    'attribute:method' => $v599dcce2998a6b40b1e38e8c6006cb0a->getExt(),    'node:title'  => $v599dcce2998a6b40b1e38e8c6006cb0a->getTitle()   );}}class umiObjectPropertyWrapper extends translatorWrapper {public static $showEmptyFields = false;public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iUmiObjectProperty $v1a8db4c996d8ed8289da5f957879ab94) {$v26b75b176d665f24a5fd22a2ad815763 = array();$v2063c1608d6e0baf80249c42e2be5804 = $v1a8db4c996d8ed8289da5f957879ab94->getValue();$v06e3d36fa30cea095545139854ad1fb9 = $v1a8db4c996d8ed8289da5f957879ab94->getField();$v945100186b119048837b9859c2c46410 = $v06e3d36fa30cea095545139854ad1fb9->getId();$v972bf3f05d14ffbdb817bef60638ff00 = $v06e3d36fa30cea095545139854ad1fb9->getName();$v6d58e323dd91f19ec80d313941942f94 = $v06e3d36fa30cea095545139854ad1fb9->getTitle();$v833750ac635fcc57dc33ecafe365f9a7 = $v06e3d36fa30cea095545139854ad1fb9->getFieldType();$v5fd6df40d7c4dd7f503475344d8c145c = $v833750ac635fcc57dc33ecafe365f9a7->getDataType();if(($v5fd6df40d7c4dd7f503475344d8c145c == "password" && !xmlTranslator::$showUnsecureFields) || (in_array($v972bf3f05d14ffbdb817bef60638ff00, array('user_dock', 'user_settings_data', 'activate_code')) && !xmlTranslator::$showUnsecureFields)) {return false;}$v74f510617fc594986f85795a43ecb7cd = (is_object($v2063c1608d6e0baf80249c42e2be5804)) || (is_array($v2063c1608d6e0baf80249c42e2be5804) && !empty($v2063c1608d6e0baf80249c42e2be5804)) || (!is_array($v2063c1608d6e0baf80249c42e2be5804) && strlen($v2063c1608d6e0baf80249c42e2be5804));if($v74f510617fc594986f85795a43ecb7cd || self::$showEmptyFields || translatorWrapper::$showEmptyFields) {$v26b75b176d665f24a5fd22a2ad815763['@id'] = $v945100186b119048837b9859c2c46410;$v26b75b176d665f24a5fd22a2ad815763['@name'] = $v972bf3f05d14ffbdb817bef60638ff00;$v26b75b176d665f24a5fd22a2ad815763['@type'] = $v5fd6df40d7c4dd7f503475344d8c145c;if($v5fd6df40d7c4dd7f503475344d8c145c == 'relation' && $v06e3d36fa30cea095545139854ad1fb9->getFieldType()->getIsMultiple()) {$v26b75b176d665f24a5fd22a2ad815763['@multiple'] = 'multiple';}$v26b75b176d665f24a5fd22a2ad815763['title'] = $v6d58e323dd91f19ec80d313941942f94;if ($v5fd6df40d7c4dd7f503475344d8c145c == 'price') {$v05c08ca192baab52e722f628f416fb2b = regedit::getInstance()->getVal("//modules/eshop/default_currency_code");if ($v05c08ca192baab52e722f628f416fb2b) {$vf82265ccceac13b2f40ccd9e81cbd263 = umiBasket::getInstance()->getCurrencyIdBySId($v05c08ca192baab52e722f628f416fb2b);if ($vf82265ccceac13b2f40ccd9e81cbd263) {$v1af0389838508d7016a9841eb6273962 = umiObjectsCollection::getInstance()->getObject($vf82265ccceac13b2f40ccd9e81cbd263);if ($v1af0389838508d7016a9841eb6273962) {$v26b75b176d665f24a5fd22a2ad815763['currency'] = array(         '@id' => $vf82265ccceac13b2f40ccd9e81cbd263,         '@code' => $v1af0389838508d7016a9841eb6273962->getValue('eshop_currency_letter_code'),         '@symbol' => $v1af0389838508d7016a9841eb6273962->getValue('eshop_currency_symbol'),         '@rate' => $v1af0389838508d7016a9841eb6273962->getValue('eshop_currency_exchange_rate')        );$v26b75b176d665f24a5fd22a2ad815763['curSymb'] = $v1af0389838508d7016a9841eb6273962->getValue("eshop_currency_symbol");}}}}if ($v5fd6df40d7c4dd7f503475344d8c145c == 'string') {$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v06e3d36fa30cea095545139854ad1fb9->getRestrictionId());if($v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) {$v26b75b176d665f24a5fd22a2ad815763['@restriction'] = $v3dadfaeb46ec74762b37de11fea7605c->getClassName();}}$v26b75b176d665f24a5fd22a2ad815763['value'] = array();switch($v5fd6df40d7c4dd7f503475344d8c145c) {case "symlink": {$v26b75b176d665f24a5fd22a2ad815763['value']['nodes:page'] = array();foreach($v2063c1608d6e0baf80249c42e2be5804 as $v8e2dcfd7e7e24b1ca76c1193f645902b) {$v26b75b176d665f24a5fd22a2ad815763['value']['nodes:page'][] = $v8e2dcfd7e7e24b1ca76c1193f645902b;}break;}case "relation": {$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$v26b75b176d665f24a5fd22a2ad815763['value']['nodes:item'] = array();if(is_array($v2063c1608d6e0baf80249c42e2be5804)) {foreach($v2063c1608d6e0baf80249c42e2be5804 as $v16b2b26000987faccb260b9d39df1269) {$v26b75b176d665f24a5fd22a2ad815763['value']['nodes:item'][] = $v5891da2d64975cae48d175d1e001f5da->getObject($v16b2b26000987faccb260b9d39df1269);}}else {$v26b75b176d665f24a5fd22a2ad815763['value']['item'] = $v5891da2d64975cae48d175d1e001f5da->getObject($v2063c1608d6e0baf80249c42e2be5804);}break;}case "date": {if($v2063c1608d6e0baf80249c42e2be5804 instanceof iUmiDate) {$v1b299b309feb62d3291407caed9cf4fa = array('get_editable_region', 'save_editable_region');$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v1ddcb92ade31c8fbd370001f9b29a7d9 = (in_array($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMethod (), $v1b299b309feb62d3291407caed9cf4fa)) ? false : 'r';$v26b75b176d665f24a5fd22a2ad815763['value']['@formatted-date'] = $v2063c1608d6e0baf80249c42e2be5804->getFormattedDate("d.m.Y H:i");$v26b75b176d665f24a5fd22a2ad815763['value']['@unix-timestamp'] = $v2063c1608d6e0baf80249c42e2be5804->getFormattedDate("U");$v26b75b176d665f24a5fd22a2ad815763['value']['#rfc'] = $v2063c1608d6e0baf80249c42e2be5804->getDateTimeStamp() > 0 ? $v2063c1608d6e0baf80249c42e2be5804->getFormattedDate($v1ddcb92ade31c8fbd370001f9b29a7d9) : "";}break;}case "optioned": {$v93da65a9fd0004d9477aeac024e08e15 = array();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();foreach($v2063c1608d6e0baf80249c42e2be5804 as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {$v5ecf0a02e02bd528df985f4f51a5af41 = array();foreach($v3a6d0284e743dc4a9b86f97d6dd1a3bf as $v599dcce2998a6b40b1e38e8c6006cb0a => $v2d79067f0fcb37a2c56a7c466f56f0ae) {switch ($v599dcce2998a6b40b1e38e8c6006cb0a) {case "tree": {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v2d79067f0fcb37a2c56a7c466f56f0ae);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {$v5ecf0a02e02bd528df985f4f51a5af41['page'] = $v8e2dcfd7e7e24b1ca76c1193f645902b;}break;}case "rel": {$va8cfde6331bd59eb2ac96f8911c4b666 = $v5891da2d64975cae48d175d1e001f5da->getObject($v2d79067f0fcb37a2c56a7c466f56f0ae);if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof iUmiObject) {$v5ecf0a02e02bd528df985f4f51a5af41['object'] = $va8cfde6331bd59eb2ac96f8911c4b666;}break;}default:          $v5ecf0a02e02bd528df985f4f51a5af41['@' . $v599dcce2998a6b40b1e38e8c6006cb0a] = $v2d79067f0fcb37a2c56a7c466f56f0ae;}}$v93da65a9fd0004d9477aeac024e08e15[] = $v5ecf0a02e02bd528df985f4f51a5af41;}$v26b75b176d665f24a5fd22a2ad815763['value']['nodes:option'] = $v93da65a9fd0004d9477aeac024e08e15;break;}case "price":      $v26b75b176d665f24a5fd22a2ad815763['value']['xlink:href'] = 'udata://emarket/price/' . $v1a8db4c996d8ed8289da5f957879ab94->getObjectId();default: {if(is_array($v2063c1608d6e0baf80249c42e2be5804)) {unset($v26b75b176d665f24a5fd22a2ad815763['value']);$v26b75b176d665f24a5fd22a2ad815763['nodes:value'] = $v2063c1608d6e0baf80249c42e2be5804;if($v5fd6df40d7c4dd7f503475344d8c145c == 'tags') {$v26b75b176d665f24a5fd22a2ad815763['combined'] = implode(', ', $v2063c1608d6e0baf80249c42e2be5804);;}}else {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v2063c1608d6e0baf80249c42e2be5804 = xmlTranslator::executeMacroses($v2063c1608d6e0baf80249c42e2be5804, false, $v1a8db4c996d8ed8289da5f957879ab94->getObjectId());if(defined("XML_PROP_VALUE_MODE") && $v5fd6df40d7c4dd7f503475344d8c145c == "wysiwyg" && $v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() != "admin") {if(XML_PROP_VALUE_MODE == "XML") {$v26b75b176d665f24a5fd22a2ad815763['value'] = Array("xml:xvalue" => "<xvalue>" . $v2063c1608d6e0baf80249c42e2be5804 . "</xvalue>");break;}}if($v2063c1608d6e0baf80249c42e2be5804 && in_array($v5fd6df40d7c4dd7f503475344d8c145c, array('img_file', 'swf_file', 'file'))) {$v2063c1608d6e0baf80249c42e2be5804 = $v2063c1608d6e0baf80249c42e2be5804->getFilePath(true);$vcaf9b6b99962bf5c2264824231d7a40c = getPathInfo($v2063c1608d6e0baf80249c42e2be5804);$v2f0056df010e0231e4cca0e382df44fc = "|^".CURRENT_WORKING_DIR."|";$v2063c1608d6e0baf80249c42e2be5804  = preg_replace($v2f0056df010e0231e4cca0e382df44fc, "", $v2063c1608d6e0baf80249c42e2be5804);$v26b75b176d665f24a5fd22a2ad815763['value']['@path'] = '.' . $v2063c1608d6e0baf80249c42e2be5804;$v26b75b176d665f24a5fd22a2ad815763['value']['@folder'] = preg_replace($v2f0056df010e0231e4cca0e382df44fc, "", $vcaf9b6b99962bf5c2264824231d7a40c['dirname']);$v26b75b176d665f24a5fd22a2ad815763['value']['@name'] = $vcaf9b6b99962bf5c2264824231d7a40c['filename'];$v26b75b176d665f24a5fd22a2ad815763['value']['@ext'] = $vcaf9b6b99962bf5c2264824231d7a40c['extension'];if(in_array($v5fd6df40d7c4dd7f503475344d8c145c, array('img_file', 'swf_file'))) {$v47c80780ab608cc046f2a6e6f071feb6 = getimagesize('.' . $v2063c1608d6e0baf80249c42e2be5804);if(is_array($v47c80780ab608cc046f2a6e6f071feb6)) {$v26b75b176d665f24a5fd22a2ad815763['value']['@width'] = $v47c80780ab608cc046f2a6e6f071feb6[0];$v26b75b176d665f24a5fd22a2ad815763['value']['@height'] = $v47c80780ab608cc046f2a6e6f071feb6[1];}}}$v26b75b176d665f24a5fd22a2ad815763['value']['#value'] = $v2063c1608d6e0baf80249c42e2be5804;}break;}}}return $v26b75b176d665f24a5fd22a2ad815763;}};class umiObjectTypeWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iUmiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a) {$v26b75b176d665f24a5fd22a2ad815763 = Array();$v26b75b176d665f24a5fd22a2ad815763['attribute:id'] = $v599dcce2998a6b40b1e38e8c6006cb0a->getId();$v26b75b176d665f24a5fd22a2ad815763['attribute:guid'] = $v599dcce2998a6b40b1e38e8c6006cb0a->getGUID();$v26b75b176d665f24a5fd22a2ad815763['attribute:title'] = $v599dcce2998a6b40b1e38e8c6006cb0a->getName();$v26b75b176d665f24a5fd22a2ad815763['attribute:parent-id'] = $v599dcce2998a6b40b1e38e8c6006cb0a->getParentId();if(!is_null(getRequest('childs'))) {$v26b75b176d665f24a5fd22a2ad815763['attribute:parentId'] = $v599dcce2998a6b40b1e38e8c6006cb0a->getParentId();}if($v599dcce2998a6b40b1e38e8c6006cb0a->getIsGuidable()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:guide'] = "guide";}if($v599dcce2998a6b40b1e38e8c6006cb0a->getIsPublic()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:public'] = "public";}if($v599dcce2998a6b40b1e38e8c6006cb0a->getIsLocked()) {$v26b75b176d665f24a5fd22a2ad815763['attribute:locked'] = "locked";}$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId();$v89b0b9deff65f8b9cd1f71bc74ce36ba = umiHierarchyTypesCollection::getInstance()->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);$v26b75b176d665f24a5fd22a2ad815763['base'] = $v89b0b9deff65f8b9cd1f71bc74ce36ba;if(!is_null(getRequest('childs'))) {$vadce578d04ed03c31f6ac59451fcf8e4 = umiObjectTypesCollection::getInstance()->getSubTypesList($v599dcce2998a6b40b1e38e8c6006cb0a->getId());$v26b75b176d665f24a5fd22a2ad815763['childs'] = sizeof($vadce578d04ed03c31f6ac59451fcf8e4);}if(!is_null(getRequest('links'))) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vd2541807149c8b40d74fc542ad179083 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentModule();$v22884db148f0ffb0d830ba431102b0b5 = $v8b1dc169bf460ee884fceef66c6607d6->getModule($vd2541807149c8b40d74fc542ad179083);if($v22884db148f0ffb0d830ba431102b0b5 instanceof def_module) {$v807765384d9d5527da8848df14a4f02f = $v22884db148f0ffb0d830ba431102b0b5->getObjectTypeEditLink($v599dcce2998a6b40b1e38e8c6006cb0a->getId());$v26b75b176d665f24a5fd22a2ad815763['create-link'] = $v807765384d9d5527da8848df14a4f02f['create-link'];$v26b75b176d665f24a5fd22a2ad815763['edit-link'] = $v807765384d9d5527da8848df14a4f02f['edit-link'];}}if($this->isFull) {$vea68f744cedffb995847405018cd8f7f = Array();$vea68f744cedffb995847405018cd8f7f['nodes:group'] = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroupsList(xmlTranslator::$showHiddenFieldGroups);$v26b75b176d665f24a5fd22a2ad815763['fieldgroups'] = $vea68f744cedffb995847405018cd8f7f;}return $v26b75b176d665f24a5fd22a2ad815763;}};class umiObjectWrapper extends translatorWrapper {public function translate($v8d777f385d3dfec8815d20f7496026dc) {return $this->translateData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateData(iUmiObject $va8cfde6331bd59eb2ac96f8911c4b666) {$v16b2b26000987faccb260b9d39df1269 = $va8cfde6331bd59eb2ac96f8911c4b666->getId();$v26b75b176d665f24a5fd22a2ad815763 = Array();$v26b75b176d665f24a5fd22a2ad815763['attribute:id'] = $v16b2b26000987faccb260b9d39df1269;$v26b75b176d665f24a5fd22a2ad815763['attribute:guid'] = $va8cfde6331bd59eb2ac96f8911c4b666->getGUID();$v26b75b176d665f24a5fd22a2ad815763['attribute:name'] = $va8cfde6331bd59eb2ac96f8911c4b666->getName();$v26b75b176d665f24a5fd22a2ad815763['attribute:type-id'] = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();$v26b75b176d665f24a5fd22a2ad815763['attribute:type-guid'] = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeGUID();$vb0ab4f7791b60b1e8ea01057b77873b0 = $va8cfde6331bd59eb2ac96f8911c4b666->getOwnerId();if($vb0ab4f7791b60b1e8ea01057b77873b0) {$v26b75b176d665f24a5fd22a2ad815763['attribute:ownerId'] = $vb0ab4f7791b60b1e8ea01057b77873b0;}if($this->isFull === false) {$v26b75b176d665f24a5fd22a2ad815763['xlink:href'] = "uobject://" . $v16b2b26000987faccb260b9d39df1269;return $v26b75b176d665f24a5fd22a2ad815763;}$v6301cee35ea764a1e241978f93f01069 = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();$v726e8e4809d4c1b28a6549d86436a124 = umiObjectTypesCollection::getInstance()->getType($v6301cee35ea764a1e241978f93f01069);$v143fdbfa2afa490e521056bd5040d5fd = $v726e8e4809d4c1b28a6549d86436a124->getFieldsGroupsList();if(!is_null(getRequest('links'))) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vef8eea3357eeef6f5ddb3d707ff0e8e8 = umiHierarchyTypesCollection::getInstance();$v9b81909fd0da3add2602a8d0ede0e4e7    = umiObjectTypesCollection::getInstance();$v641ee90996ed9781bf72b559b9c90742 = $v726e8e4809d4c1b28a6549d86436a124;$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;do {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v641ee90996ed9781bf72b559b9c90742->getHierarchyTypeId();$v89b0b9deff65f8b9cd1f71bc74ce36ba   = $vef8eea3357eeef6f5ddb3d707ff0e8e8->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if($v641ee90996ed9781bf72b559b9c90742->getParentId()) {$v641ee90996ed9781bf72b559b9c90742 = $v9b81909fd0da3add2602a8d0ede0e4e7->getType($v641ee90996ed9781bf72b559b9c90742->getParentId());break;}if($v641ee90996ed9781bf72b559b9c90742->getParentId() == 0) break;}while(!$v89b0b9deff65f8b9cd1f71bc74ce36ba && $v641ee90996ed9781bf72b559b9c90742);if($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {$v52a43e48ec4649dee819dadabcab1bde = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getName();$vddaa6e8c8c412299272e183087b8f7b6 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getExt();if($ve52043002b9b5525cbc3f3bee69ff9b4 = $v8b1dc169bf460ee884fceef66c6607d6->getModule($v52a43e48ec4649dee819dadabcab1bde)) {$v2a304a1348456ccd2234cd71a81bd338 = $ve52043002b9b5525cbc3f3bee69ff9b4->getObjectEditLink($v16b2b26000987faccb260b9d39df1269, $vddaa6e8c8c412299272e183087b8f7b6);if($v2a304a1348456ccd2234cd71a81bd338 !== false) {$v26b75b176d665f24a5fd22a2ad815763['edit-link'] = $v2a304a1348456ccd2234cd71a81bd338;}}}if(!isset($v26b75b176d665f24a5fd22a2ad815763['edit-link']) &&    $v8b1dc169bf460ee884fceef66c6607d6->getCurrentModule() == 'data' && $v8b1dc169bf460ee884fceef66c6607d6->getCurrentMethod() == 'guide_items') {$v764b2484f7ecf6b627a89fd3f7fe9f3d = $v8b1dc169bf460ee884fceef66c6607d6->getModule('data');$v26b75b176d665f24a5fd22a2ad815763['edit-link'] = $v764b2484f7ecf6b627a89fd3f7fe9f3d->getObjectEditLink($v16b2b26000987faccb260b9d39df1269);}}$v26b75b176d665f24a5fd22a2ad815763['properties'] = Array();$v26b75b176d665f24a5fd22a2ad815763['properties']['nodes:group'] = Array();$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;foreach($v143fdbfa2afa490e521056bd5040d5fd as $vdb0f6f37ebeb6ea09489124345af2a45) {$v71ea3b11aebda17ad80b6499a6ab6fb0 = Array();$v03f2ce8694aef1464a97f254c78a26ae = translatorWrapper::get($vdb0f6f37ebeb6ea09489124345af2a45);$v71ea3b11aebda17ad80b6499a6ab6fb0 = $v03f2ce8694aef1464a97f254c78a26ae->translateProperties($vdb0f6f37ebeb6ea09489124345af2a45, $va8cfde6331bd59eb2ac96f8911c4b666);if(!empty($v71ea3b11aebda17ad80b6499a6ab6fb0)) {$v26b75b176d665f24a5fd22a2ad815763['properties']['nodes:group'][(getRequest('jsonMode') == "force" ? $v865c0c0b4ab0e063e5caa3387c1a8741++ : ++$v865c0c0b4ab0e063e5caa3387c1a8741)] = $v71ea3b11aebda17ad80b6499a6ab6fb0;}}if(sizeof($v26b75b176d665f24a5fd22a2ad815763['properties']['nodes:group']) == 0) {unset($v26b75b176d665f24a5fd22a2ad815763['properties']);}return $v26b75b176d665f24a5fd22a2ad815763;}};interface iUmiExporter {public function __construct($v599dcce2998a6b40b1e38e8c6006cb0a);static public function get($v6f66e878c62db60568a3487869695820);public function getFileExt();}abstract class umiExporter implements iUmiExporter {protected $type = "";protected $file_path = false;protected $complete = false;protected $source_name = false;protected $completed = true;abstract public function export($v01af57e4ae6d799566f5695b3679756b, $v0ffd3a2a5f2d87ab40f10ed134424250);abstract public function setOutputBuffer();final static public function get($v6f66e878c62db60568a3487869695820) {if($v7c27535f88bae9519ceb14a8983c57ff = self::loadWrapper($v6f66e878c62db60568a3487869695820)) {return $v7c27535f88bae9519ceb14a8983c57ff;}else {throw new publicException("Can't load exporter for type \"{$v6f66e878c62db60568a3487869695820}\"");}}public function __construct($v599dcce2998a6b40b1e38e8c6006cb0a) {$this->type = $v599dcce2998a6b40b1e38e8c6006cb0a;}public function getFileExt() {return "xml";}public function setSourceName($vaf721e88e6c0a612be51c329cb2bc12a = false) {$this->source_name = $vaf721e88e6c0a612be51c329cb2bc12a;}public function getSourceName() {return $this->source_name ? $this->source_name : $this->type;}public function getIsCompleted() {return $this->completed;}final static private function loadWrapper($v6f66e878c62db60568a3487869695820) {static $v2430fe39e225818bd957ed4cb53eb770 = array(), $v2245023265ae4cf87d02c8b6ba991139;if(isset($v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820])) {return $v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820];}if(is_null($v2245023265ae4cf87d02c8b6ba991139)) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();}$v46d111d8fa2089a051889becc4736cc4 = $v6f66e878c62db60568a3487869695820 . 'Exporter';$v47826cacc65c665212b821e6ff80b9b0 = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.kernel') . 'subsystems/export/exporters/' . $v46d111d8fa2089a051889becc4736cc4 . '.php';if(is_file($v47826cacc65c665212b821e6ff80b9b0) == false) {$v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = false;throw new publicException("Can't load exporter \"{$v47826cacc65c665212b821e6ff80b9b0}\" for \"{$v6f66e878c62db60568a3487869695820}\" file type");}require $v47826cacc65c665212b821e6ff80b9b0;if(!class_exists($v46d111d8fa2089a051889becc4736cc4)) {$v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = false;throw new publicException("Exporter class \"{$v46d111d8fa2089a051889becc4736cc4}\" not found");}$v7c27535f88bae9519ceb14a8983c57ff = new $v46d111d8fa2089a051889becc4736cc4($v6f66e878c62db60568a3487869695820);if($v7c27535f88bae9519ceb14a8983c57ff instanceof self == false) {$v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = false;throw new publicException("Exporter class \"{$v46d111d8fa2089a051889becc4736cc4}\" should be instance of umiExporter");}return $v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = $v7c27535f88bae9519ceb14a8983c57ff;}protected function getUmiDump($v92ec19ffde05e15769b1bb3ee05ad745, $vaf721e88e6c0a612be51c329cb2bc12a = false) {if (!$vaf721e88e6c0a612be51c329cb2bc12a) {$vaf721e88e6c0a612be51c329cb2bc12a = $this->getSourceName();}$ved780287e302ec3b9fd3c5e78771919f = new xmlExporter($vaf721e88e6c0a612be51c329cb2bc12a);$ved780287e302ec3b9fd3c5e78771919f->addBranches($v92ec19ffde05e15769b1bb3ee05ad745);$ved780287e302ec3b9fd3c5e78771919f->setIgnoreRelations();$result = $ved780287e302ec3b9fd3c5e78771919f->execute();return $result->saveXML();}protected function getUmiDumpObjects($v5891da2d64975cae48d175d1e001f5da, $vaf721e88e6c0a612be51c329cb2bc12a = false) {if (!$vaf721e88e6c0a612be51c329cb2bc12a) {$vaf721e88e6c0a612be51c329cb2bc12a = $this->getSourceName();}$ved780287e302ec3b9fd3c5e78771919f = new xmlExporter($vaf721e88e6c0a612be51c329cb2bc12a);$ved780287e302ec3b9fd3c5e78771919f->addObjects($v5891da2d64975cae48d175d1e001f5da);$ved780287e302ec3b9fd3c5e78771919f->setIgnoreRelations();$result = $ved780287e302ec3b9fd3c5e78771919f->execute();return $result->saveXML();}}interface iXmlExporter {}class xmlExporter implements iXmlExporter {const VERSION = "2.0";protected static $ROOT_PAGE_TYPE_ID;protected $source_id, $source_name;protected $files, $types, $langs, $domains, $templates, $elements, $branches, $objects, $restrictions, $registry, $data_types, $directories;protected $exported_files = array(), $exported_types = array(), $exported_langs = array(), $exported_domains = array(), $exported_templates = array(), $exported_elements = array(), $exported_objects = array(), $exported_restrictions = array(), $exported_registry_items = array(), $restricted_fields = array(), $exported_data_types = array(), $exported_dirs = array();protected $excludedElements = array();protected $limit, $position = 0, $break = false;protected $translator;protected $destination;protected $completed = false;protected $doc;protected $root;protected $meta_container, $files_container, $types_container, $data_types_container, $pages_container, $objects_container, $relations_container, $restrictions_container, $registry_container, $dirs_container, $hierarchy_container;protected $export_log = array();protected $showAllFields = false;protected $ignoreRelations = false;protected $saveRelations = array();protected $oldGetLinks = NULL;public function __construct($vaf721e88e6c0a612be51c329cb2bc12a, $vd80c2a24a1dcebf784b89d42f66190a2 = false) {$this->relations = umiImportRelations::getInstance();$this->source_name = $vaf721e88e6c0a612be51c329cb2bc12a;$this->source_id = $this->relations->addNewSource($vaf721e88e6c0a612be51c329cb2bc12a);$this->limit = is_numeric($vd80c2a24a1dcebf784b89d42f66190a2) ? $vd80c2a24a1dcebf784b89d42f66190a2 : false;self::$ROOT_PAGE_TYPE_ID = umiObjectTypesCollection::getInstance()->getTypeIdByGUID('root-pages-type');}public function setIgnoreRelations($v621ddfd2ea41b75c6051189a7a012196 = array()) {$this->ignoreRelations = true;$this->saveRelations = $v621ddfd2ea41b75c6051189a7a012196;}public function setShowAllFields($v999429990f5610353c3b2ccfd54b5ad4 = false) {$this->showAllFields = $v999429990f5610353c3b2ccfd54b5ad4;}public function getExportLog() {return $this->export_log;}protected function writeLog($v78e731027d8fd50ed642340b7c9a63b3) {if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $v78e731027d8fd50ed642340b7c9a63b3 . "\n\r";else $this->export_log[] = $v78e731027d8fd50ed642340b7c9a63b3;}protected function reportError($vcb5e100e5a9a3e7f6d1fd97512215282) {if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $vcb5e100e5a9a3e7f6d1fd97512215282 . "\n\r";else $this->export_log[] = "<font style='color:red''>" . $vcb5e100e5a9a3e7f6d1fd97512215282 . "</font>";}protected function saveState () {if (file_exists(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name)) && $this->break === false) {unlink(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name));}if ($this->break === true) {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->exported_types, 'found');foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {unset($this->exported_types[$v2063c1608d6e0baf80249c42e2be5804]);}$v14f802e1fba977727845e8872c1743a7 = array_keys($this->exported_elements, 'found');foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {unset($this->exported_elements[$v2063c1608d6e0baf80249c42e2be5804]);}$v14f802e1fba977727845e8872c1743a7 = array_keys($this->exported_objects, 'found');foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {unset($this->exported_objects[$v2063c1608d6e0baf80249c42e2be5804]);}$vf1f713c9e000f5d3f280adbd124df4f5 = array(     'exported_files' => $this->exported_files,     'exported_types' => $this->exported_types,     'exported_langs' => $this->exported_langs,     'exported_domains' => $this->exported_domains,     'exported_templates' => $this->exported_templates,     'exported_elements' => $this->exported_elements,     'exported_objects' => $this->exported_objects,     'restricted_fields' =>$this->restricted_fields,     'restrictions' => $this->restrictions,     'exported_restrictions' => $this->exported_restrictions,     'exported_registry_items'=> $this->exported_registry_items,     'exported_data_types'=> $this->exported_data_types,     'exported_dirs'=> $this->exported_dirs    );file_put_contents(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name),  serialize($vf1f713c9e000f5d3f280adbd124df4f5));}}public function getExportedElements() {return $this->exported_elements;}public function addElements($v6a7f245843454cf4f28ad7c5e2572aa2) {foreach ($v6a7f245843454cf4f28ad7c5e2572aa2 as $v65c10911d8b8591219a21ebacf46da01) {if ($v65c10911d8b8591219a21ebacf46da01 instanceof umiHierarchyElement) $v65c10911d8b8591219a21ebacf46da01 = $v65c10911d8b8591219a21ebacf46da01->getId();$this->elements[] = $v65c10911d8b8591219a21ebacf46da01;}}public function addBranches($v92ec19ffde05e15769b1bb3ee05ad745) {foreach ($v92ec19ffde05e15769b1bb3ee05ad745 as $v65c10911d8b8591219a21ebacf46da01) {if ($v65c10911d8b8591219a21ebacf46da01 instanceof umiHierarchyElement) $v65c10911d8b8591219a21ebacf46da01 = $v65c10911d8b8591219a21ebacf46da01->getId();$this->branches[] = $v65c10911d8b8591219a21ebacf46da01;}}public function excludeBranches(array $v92ec19ffde05e15769b1bb3ee05ad745) {foreach ($v92ec19ffde05e15769b1bb3ee05ad745 as $v7552cd149af7495ee7d8225974e50f80) {if ($v7552cd149af7495ee7d8225974e50f80 instanceof umiHierarchyElement) $v7552cd149af7495ee7d8225974e50f80 = $v7552cd149af7495ee7d8225974e50f80->getId();$this->excludedElements[$v7552cd149af7495ee7d8225974e50f80] = $v7552cd149af7495ee7d8225974e50f80;$vadce578d04ed03c31f6ac59451fcf8e4 = umiHierarchy::getInstance()->getChildIds($v7552cd149af7495ee7d8225974e50f80, true, true);foreach ($vadce578d04ed03c31f6ac59451fcf8e4 as $vf4f40123eb510dd3290125b38f4eb898) {$this->excludedElements[$vf4f40123eb510dd3290125b38f4eb898] = $vf4f40123eb510dd3290125b38f4eb898;}}}public function addObjects($v5891da2d64975cae48d175d1e001f5da) {foreach ($v5891da2d64975cae48d175d1e001f5da as $vbe8f80182e0c983916da7338c2c1c040) {if ($vbe8f80182e0c983916da7338c2c1c040 instanceof umiObject) $vbe8f80182e0c983916da7338c2c1c040 = $vbe8f80182e0c983916da7338c2c1c040->getId();if ($vbe8f80182e0c983916da7338c2c1c040) $this->objects[] = $vbe8f80182e0c983916da7338c2c1c040;}}public function addTypes($vd14a8022b085f9ef19d479cbdd581127) {foreach ($vd14a8022b085f9ef19d479cbdd581127 as $v599dcce2998a6b40b1e38e8c6006cb0a) {if ($v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) $v599dcce2998a6b40b1e38e8c6006cb0a = $v599dcce2998a6b40b1e38e8c6006cb0a->getId();$this->types[] = $v599dcce2998a6b40b1e38e8c6006cb0a;}}public function addRestrictions($v81e12dac658cfd4c590486dd6f7523cf) {foreach ($v81e12dac658cfd4c590486dd6f7523cf as $v3dadfaeb46ec74762b37de11fea7605c) {if ($v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) $v3dadfaeb46ec74762b37de11fea7605c = $v3dadfaeb46ec74762b37de11fea7605c->getId();$this->restrictions[] = $v3dadfaeb46ec74762b37de11fea7605c;}}public function addRegistry($v13872c0118a4316afd1e99295017d654 = array()) {foreach ($v13872c0118a4316afd1e99295017d654 as $vd6fe1d0be6347b8ef2427fa629c04485) {$this->registry[] = $vd6fe1d0be6347b8ef2427fa629c04485;}}public function setDestination($v6990a54322d9232390a784c5c9247dd6) {if (!is_dir($v6990a54322d9232390a784c5c9247dd6)) {$this->reportError("Destination folder does not exist");return false;}$this->destination = $v6990a54322d9232390a784c5c9247dd6;}public function addFiles($v04e502ffc79d50c43b2400a707036667 = array()) {foreach ($v04e502ffc79d50c43b2400a707036667 as $v1910059f421bfea36ecd0274f22185ad) {if (is_file($v1910059f421bfea36ecd0274f22185ad)) $this->files[] = new umiFile($v1910059f421bfea36ecd0274f22185ad);else {$this->reportError("File {$v1910059f421bfea36ecd0274f22185ad} doesn't exist");}}}public function addDirs($v04e502ffc79d50c43b2400a707036667 = array()) {foreach ($v04e502ffc79d50c43b2400a707036667 as $v1910059f421bfea36ecd0274f22185ad) {if (is_dir($v1910059f421bfea36ecd0274f22185ad)) $this->directories[] = new umiDirectory($v1910059f421bfea36ecd0274f22185ad);else {$this->reportError("Folder {$v1910059f421bfea36ecd0274f22185ad} doesn't exist");}}}public function addDomains($ve4e46deb7f9cc58c7abfb32e5570b6f3 = array()) {foreach ($ve4e46deb7f9cc58c7abfb32e5570b6f3 as $vad5f82e879a9c5d6b5b442eb37e50551) {if($vad5f82e879a9c5d6b5b442eb37e50551 instanceof domain) $this->domains[] = $vad5f82e879a9c5d6b5b442eb37e50551;}}public function addLangs($v5a05866850c28651fe234659f6c92ada = array()) {foreach ($v5a05866850c28651fe234659f6c92ada as $v7572559ca86e781ba8fe8073a0b725c6) {if($v7572559ca86e781ba8fe8073a0b725c6 instanceof lang) $v7572559ca86e781ba8fe8073a0b725c6 = $v7572559ca86e781ba8fe8073a0b725c6->getId();$this->langs[] = $v7572559ca86e781ba8fe8073a0b725c6;}}public function addTemplates($vfed36e93a0509e20f2dc96cbbd85b678 = array()) {foreach ($vfed36e93a0509e20f2dc96cbbd85b678 as $v66f6181bcb4cff4cd38fbc804a036db6) {if($v66f6181bcb4cff4cd38fbc804a036db6 instanceof template) $v66f6181bcb4cff4cd38fbc804a036db6 = $v66f6181bcb4cff4cd38fbc804a036db6->getId();$this->templates[] = $v66f6181bcb4cff4cd38fbc804a036db6;}}public function addDataTypes($v276d269c22fa4df82a9c11c55c2ff5d0 = array()) {foreach ($v276d269c22fa4df82a9c11c55c2ff5d0 as $v17f71d965fe9589ddbd11caf7182243e) {if($v17f71d965fe9589ddbd11caf7182243e instanceof umiFieldType) $this->data_types[] = $v17f71d965fe9589ddbd11caf7182243e->getId();}}public function isCompleted() {return $this->completed;}public function execute() {if(!is_null(getRequest('links'))) {$this->oldGetLinks = getRequest('links');unset($_REQUEST['links']);}$this->position = 0;$this->break = false;$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument("1.0", "utf-8");$v9a09b4dfda82e3e665e31092d1c3ec8d->formatOutput = XML_FORMAT_OUTPUT;$v63a9f0ea7bb98050796b649e85481845 = $v9a09b4dfda82e3e665e31092d1c3ec8d->createElement("umidump");$v63a9f0ea7bb98050796b649e85481845->setAttribute('xmlns:xlink', 'http://www.w3.org/TR/xlink');$v0cc175b9c0f1b6a831c399e269772661 = $v9a09b4dfda82e3e665e31092d1c3ec8d->createAttribute("version");$v0cc175b9c0f1b6a831c399e269772661->appendChild($v9a09b4dfda82e3e665e31092d1c3ec8d->createTextNode(self::VERSION));$v63a9f0ea7bb98050796b649e85481845->appendChild($v0cc175b9c0f1b6a831c399e269772661);$v9a09b4dfda82e3e665e31092d1c3ec8d->appendChild($v63a9f0ea7bb98050796b649e85481845);$this->translator = new xmlTranslator($v9a09b4dfda82e3e665e31092d1c3ec8d);if ($this->showAllFields) {$ved2767f3d8b91be52c4cb22eb81a04b3 = xmlTranslator::$showHiddenFieldGroups;xmlTranslator::$showHiddenFieldGroups = true;$vcf90eeb77dd5c141a9e9b72790489e27 = xmlTranslator::$showUnsecureFields;xmlTranslator::$showUnsecureFields = true;}$v07d2e301ed1b9e6b89b58497f1810239 = umiObjectProperty::$IGNORE_CACHE;umiObjectProperty::$IGNORE_CACHE = true;$this->doc = $v9a09b4dfda82e3e665e31092d1c3ec8d;$this->root = $v63a9f0ea7bb98050796b649e85481845;if (file_exists(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name))) {$vf1f713c9e000f5d3f280adbd124df4f5 = unserialize(file_get_contents(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name)));$this->exported_files = $vf1f713c9e000f5d3f280adbd124df4f5['exported_files'];$this->exported_types = $vf1f713c9e000f5d3f280adbd124df4f5['exported_types'];$this->exported_langs = $vf1f713c9e000f5d3f280adbd124df4f5['exported_langs'];$this->exported_domains = $vf1f713c9e000f5d3f280adbd124df4f5['exported_domains'];$this->exported_templates = $vf1f713c9e000f5d3f280adbd124df4f5['exported_templates'];$this->exported_elements = $vf1f713c9e000f5d3f280adbd124df4f5['exported_elements'];$this->exported_objects = $vf1f713c9e000f5d3f280adbd124df4f5['exported_objects'];$this->exported_restrictions = $vf1f713c9e000f5d3f280adbd124df4f5['exported_restrictions'];$this->restricted_fields = $vf1f713c9e000f5d3f280adbd124df4f5['restricted_fields'];$this->restrictions = $vf1f713c9e000f5d3f280adbd124df4f5['restrictions'];$this->exported_registry_items = $vf1f713c9e000f5d3f280adbd124df4f5['exported_registry_items'];$this->exported_data_types = $vf1f713c9e000f5d3f280adbd124df4f5['exported_data_types'];$this->exported_dirs = $vf1f713c9e000f5d3f280adbd124df4f5['exported_dirs'];}$this->createGrid();if ($this->directories && !$this->break) $this->exportDirs();if ($this->files && !$this->break) $this->exportFiles();if ($this->langs && !$this->break) $this->exportLangs();if ($this->domains && !$this->break) $this->exportDomains();if ($this->templates && !$this->break) $this->exportTemplates();if ($this->data_types && !$this->break) $this->exportDataTypes();if ($this->types && !$this->break) $this->exportTypes();if ($this->elements && !$this->break) $this->exportElements();if ($this->objects && !$this->break) $this->exportObjects();if ($this->branches && !$this->break) $this->exportBranches();if ($this->restrictions && !$this->break) $this->exportRestrictions();if ($this->registry && !$this->break) $this->exportRegs();$v8277e0910d750195b448797616e091ad = $this->doc;$v6f8f57715090da2632453988d9a1501b = $this->meta_container;$this->completed = !$this->break;if (count($this->branches) && $this->completed) {$v92ec19ffde05e15769b1bb3ee05ad745 = array();foreach ($this->branches as $v09fd5b139469053e6cd6e28cf8725337) {if (isset($this->exported_elements[$v09fd5b139469053e6cd6e28cf8725337]) && $this->exported_elements[$v09fd5b139469053e6cd6e28cf8725337] != 'found') {$v09fd5b139469053e6cd6e28cf8725337 = $this->exported_elements[$v09fd5b139469053e6cd6e28cf8725337];}$v92ec19ffde05e15769b1bb3ee05ad745[] = $v09fd5b139469053e6cd6e28cf8725337;}$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('branches');$this->translateEntity(array('nodes:id' => $v92ec19ffde05e15769b1bb3ee05ad745), $v7b8b965ad4bca0e41ab51de7b31363a1);$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);}$this->saveState();if ($this->showAllFields) {xmlTranslator::$showHiddenFieldGroups = $ved2767f3d8b91be52c4cb22eb81a04b3;xmlTranslator::$showUnsecureFields = $vcf90eeb77dd5c141a9e9b72790489e27;}umiObjectProperty::$IGNORE_CACHE = $v07d2e301ed1b9e6b89b58497f1810239;if(!is_null($this->oldGetLinks)) $_REQUEST['links'] = $this->oldGetLinks;return $this->doc;}protected function createDateSection($vd7e6d55ba379a13d08c25d15faf2a23b, DOMElement $v5f0b6ebc4bea10285ba2b8a6ce78b863) {$v8277e0910d750195b448797616e091ad = $this->doc;$v5fc732311905cb27e82d67f4f6511f7f = new umiDate($vd7e6d55ba379a13d08c25d15faf2a23b);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('timestamp');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createTextNode($v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate("U")));$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('rfc');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createTextNode($v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate("r")));$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('utc');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createTextNode($v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate(DATE_ATOM)));$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);return $v5f0b6ebc4bea10285ba2b8a6ce78b863;}protected function createGrid() {$v8277e0910d750195b448797616e091ad = $this->doc;$v6f8f57715090da2632453988d9a1501b = $v8277e0910d750195b448797616e091ad->createElement("meta");$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$vad5f82e879a9c5d6b5b442eb37e50551 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain();$v7572559ca86e781ba8fe8073a0b725c6 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang();$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('site-name');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createCDATASection(def_module::parseTPLMacroses(macros_sitename())));$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('domain');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createCDATASection($vad5f82e879a9c5d6b5b442eb37e50551->getHost()));$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('lang');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createCDATASection($v7572559ca86e781ba8fe8073a0b725c6->getPrefix()));$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('source-name');$v3a6d0284e743dc4a9b86f97d6dd1a3bf = strlen($this->source_name) ? $this->source_name : md5($vad5f82e879a9c5d6b5b442eb37e50551->getId() . $v7572559ca86e781ba8fe8073a0b725c6->getId());$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createCDATASection($v3a6d0284e743dc4a9b86f97d6dd1a3bf));$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('generate-time');$this->createDateSection(time(), $v7b8b965ad4bca0e41ab51de7b31363a1);$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$this->root->appendChild($v6f8f57715090da2632453988d9a1501b);$this->meta_container = $v6f8f57715090da2632453988d9a1501b;$this->registry_container = $v8277e0910d750195b448797616e091ad->createElement('registry');$this->root->appendChild($this->registry_container);$this->dirs_container = $v8277e0910d750195b448797616e091ad->createElement('directories');$this->root->appendChild($this->dirs_container);$this->files_container = $v8277e0910d750195b448797616e091ad->createElement('files');$this->root->appendChild($this->files_container);$this->langs_container = $v8277e0910d750195b448797616e091ad->createElement('langs');$this->root->appendChild($this->langs_container);$this->domains_container = $v8277e0910d750195b448797616e091ad->createElement('domains');$this->root->appendChild($this->domains_container);$this->templates_container = $v8277e0910d750195b448797616e091ad->createElement('templates');$this->root->appendChild($this->templates_container);$this->data_types_container = $v8277e0910d750195b448797616e091ad->createElement('datatypes');$this->root->appendChild($this->data_types_container);$this->types_container = $v8277e0910d750195b448797616e091ad->createElement('types');$this->root->appendChild($this->types_container);$this->objects_container = $v8277e0910d750195b448797616e091ad->createElement('objects');$this->root->appendChild($this->objects_container);$this->pages_container = $v8277e0910d750195b448797616e091ad->createElement('pages');$this->root->appendChild($this->pages_container);$this->relations_container = $v8277e0910d750195b448797616e091ad->createElement('relations');$this->root->appendChild($this->relations_container);$this->options_container = $v8277e0910d750195b448797616e091ad->createElement('options');$this->root->appendChild($this->options_container);$this->restrictions_container = $v8277e0910d750195b448797616e091ad->createElement('restrictions');$this->root->appendChild($this->restrictions_container);$this->permissions_container = $v8277e0910d750195b448797616e091ad->createElement('permissions');$this->root->appendChild($this->permissions_container);$this->hierarchy_container = $v8277e0910d750195b448797616e091ad->createElement('hierarchy');$this->root->appendChild($this->hierarchy_container);}protected function translateEntity($vf5e638cc78dd325906c1298a0c21fb6b, $v5f0b6ebc4bea10285ba2b8a6ce78b863) {$result = $this->translator->chooseTranslator($v5f0b6ebc4bea10285ba2b8a6ce78b863, $vf5e638cc78dd325906c1298a0c21fb6b, true);}protected function exportFile(umiFile $v8c7dd922ad47494fc02c388e12c00eac) {$vd6fe1d0be6347b8ef2427fa629c04485 = $v8c7dd922ad47494fc02c388e12c00eac->getFilePath();if (isset($this->exported_files[$vd6fe1d0be6347b8ef2427fa629c04485])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v5b063e275d506f65ebf1b02d926f19a4 = $v8c7dd922ad47494fc02c388e12c00eac->getFileName();$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('file');$this->files_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->translateEntity($v8c7dd922ad47494fc02c388e12c00eac, $v4a8a08f09d37b73795649038408b5f33);$v0800fc577294c34e0b28ad2839435945 = md5_file($vd6fe1d0be6347b8ef2427fa629c04485);$v4493ba1ac6e2a63455acda96db3da768 = $this->doc->createAttribute("hash");$v4a8a08f09d37b73795649038408b5f33->appendChild($v4493ba1ac6e2a63455acda96db3da768);$va14ef8ab1dc3a33642fcbdc20b856dbb = $this->doc->createTextNode("{$v0800fc577294c34e0b28ad2839435945}");$v4493ba1ac6e2a63455acda96db3da768->appendChild($va14ef8ab1dc3a33642fcbdc20b856dbb);$v5b063e275d506f65ebf1b02d926f19a4 = $v8c7dd922ad47494fc02c388e12c00eac->getFileName();$vc29a0c0bef824ee1691bc91da9b60bb7 = $this->doc->createAttribute("name");$v4a8a08f09d37b73795649038408b5f33->appendChild($vc29a0c0bef824ee1691bc91da9b60bb7);$v7affb12a524a065ba5ff47dc80e5bd68 = $this->doc->createTextNode("{$v5b063e275d506f65ebf1b02d926f19a4}");$vc29a0c0bef824ee1691bc91da9b60bb7->appendChild($v7affb12a524a065ba5ff47dc80e5bd68);if ($this->destination) {$v47826cacc65c665212b821e6ff80b9b0 = $this->destination . $v8c7dd922ad47494fc02c388e12c00eac->getFilePath(true);$vaedcc8bf00dbfd959b5898fe1e21c7ab = dirname($v47826cacc65c665212b821e6ff80b9b0);if (!file_exists($vaedcc8bf00dbfd959b5898fe1e21c7ab)) mkdir($vaedcc8bf00dbfd959b5898fe1e21c7ab, 0777, true);if (copy($vd6fe1d0be6347b8ef2427fa629c04485, $v47826cacc65c665212b821e6ff80b9b0)) {chmod($v47826cacc65c665212b821e6ff80b9b0, 0777);}else {$this->reportError("File \"{$vd6fe1d0be6347b8ef2427fa629c04485} \" cannot be copied to \"{$v47826cacc65c665212b821e6ff80b9b0}\"");}}else {$this->reportError('Files cannot be copied because destination folder isn\'t defined');}$this->exported_files[$vd6fe1d0be6347b8ef2427fa629c04485] = $vd6fe1d0be6347b8ef2427fa629c04485;$this->position++;return true;}protected function exportDir(umiDirectory $v5f8f22b8cdbaeee8cf857673a9b6ba20) {$vd6fe1d0be6347b8ef2427fa629c04485 = $v5f8f22b8cdbaeee8cf857673a9b6ba20->getPath();$v651fd5d791e56187822de080423fe012 = ltrim($vd6fe1d0be6347b8ef2427fa629c04485, '.');if (isset($this->exported_dirs[$vd6fe1d0be6347b8ef2427fa629c04485])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('directory', $v651fd5d791e56187822de080423fe012);$this->dirs_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$v4a8a08f09d37b73795649038408b5f33->setAttribute('path', $vd6fe1d0be6347b8ef2427fa629c04485);$v4a8a08f09d37b73795649038408b5f33->setAttribute('name', $v5f8f22b8cdbaeee8cf857673a9b6ba20->getName());$this->exported_dirs[$vd6fe1d0be6347b8ef2427fa629c04485] = $vd6fe1d0be6347b8ef2427fa629c04485;$this->position++;return true;}protected function exportFiles() {foreach ($this->files as $v8c7dd922ad47494fc02c388e12c00eac) {$this->exportFile($v8c7dd922ad47494fc02c388e12c00eac);}if ($this->destination) {$vf35596be31d40176826fce6b837a9ddc = new umiDirectory($this->destination);$v00c9a807e725e6d86bde261aa73866a8 = $vf35596be31d40176826fce6b837a9ddc->getFSObjects(2);foreach ($v00c9a807e725e6d86bde261aa73866a8 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v736007832d2167baaae763fd3a3f3cf1) {chmod($v736007832d2167baaae763fd3a3f3cf1, 0777);}}}protected function exportDirs() {foreach ($this->directories as $v5f8f22b8cdbaeee8cf857673a9b6ba20) {$this->exportDir($v5f8f22b8cdbaeee8cf857673a9b6ba20);}}protected function exportLang($vf585b7f018bb4ced15a03683a733e50b) {if (isset($this->exported_langs[$vf585b7f018bb4ced15a03683a733e50b])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v7572559ca86e781ba8fe8073a0b725c6 = langsCollection::getInstance()->getLang($vf585b7f018bb4ced15a03683a733e50b);$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('lang');$this->translateEntity($v7572559ca86e781ba8fe8073a0b725c6, $v4a8a08f09d37b73795649038408b5f33);$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);if ($v392cdf2310e931972f2459edc1ea2ff2 === false) {$this->relations->setLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b, $vf585b7f018bb4ced15a03683a733e50b);$v392cdf2310e931972f2459edc1ea2ff2 = $vf585b7f018bb4ced15a03683a733e50b;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $v392cdf2310e931972f2459edc1ea2ff2);}$this->langs_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_langs[$vf585b7f018bb4ced15a03683a733e50b] = $v392cdf2310e931972f2459edc1ea2ff2;$this->position++;return true;}protected function exportLangs() {foreach ($this->langs as $v7572559ca86e781ba8fe8073a0b725c6) {$this->exportLang($v7572559ca86e781ba8fe8073a0b725c6);}}protected function exportDomain(domain $vad5f82e879a9c5d6b5b442eb37e50551) {$v72ee76c5c29383b7c9f9225c1fa4d10b = $vad5f82e879a9c5d6b5b442eb37e50551->getId();if (isset($this->exported_domains[$v72ee76c5c29383b7c9f9225c1fa4d10b])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('domain');$this->translateEntity($vad5f82e879a9c5d6b5b442eb37e50551, $v4a8a08f09d37b73795649038408b5f33);$v0bb5aff4a4154504d1117c453c35edd8 = $this->relations->getOldDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b);if ($v0bb5aff4a4154504d1117c453c35edd8 === false) {$this->relations->setDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b, $v72ee76c5c29383b7c9f9225c1fa4d10b);$v0bb5aff4a4154504d1117c453c35edd8 = $v72ee76c5c29383b7c9f9225c1fa4d10b;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $v0bb5aff4a4154504d1117c453c35edd8);}$vf585b7f018bb4ced15a03683a733e50b = $vad5f82e879a9c5d6b5b442eb37e50551->getDefaultLangId();if ($this->exportLang($vf585b7f018bb4ced15a03683a733e50b)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);$v4a8a08f09d37b73795649038408b5f33->setAttribute('lang-id', $v392cdf2310e931972f2459edc1ea2ff2);$v4b9c7061b34a64924383494f4cd28b13 = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrowsList();foreach ($v4b9c7061b34a64924383494f4cd28b13 as $v95be0a2e6132b4fa2294808f7dbcc52a) {$v6f8f57715090da2632453988d9a1501b = $this->doc->createElement('domain-mirror');$v4a8a08f09d37b73795649038408b5f33->appendChild($v6f8f57715090da2632453988d9a1501b);$this->translateEntity($v95be0a2e6132b4fa2294808f7dbcc52a, $v6f8f57715090da2632453988d9a1501b);$v1834e28d86200a836697541c12fa09bd = $v95be0a2e6132b4fa2294808f7dbcc52a->getId();$ve788cc9c8ff1d105698156a7628ff6ef = $this->relations->getOldDomainMirrorIdRelation($this->source_id, $v1834e28d86200a836697541c12fa09bd);if ($ve788cc9c8ff1d105698156a7628ff6ef === false) {$this->relations->setDomainMirrorIdRelation($this->source_id, $v1834e28d86200a836697541c12fa09bd, $v1834e28d86200a836697541c12fa09bd);$ve788cc9c8ff1d105698156a7628ff6ef = $v1834e28d86200a836697541c12fa09bd;}else {$v6f8f57715090da2632453988d9a1501b->setAttribute('id', $ve788cc9c8ff1d105698156a7628ff6ef);}}$this->domains_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_domains[$v72ee76c5c29383b7c9f9225c1fa4d10b] = $v0bb5aff4a4154504d1117c453c35edd8;$this->position++;return true;}protected function exportDomains() {foreach ($this->domains as $vad5f82e879a9c5d6b5b442eb37e50551) {$this->exportDomain($vad5f82e879a9c5d6b5b442eb37e50551);}}protected function exportTemplate($v3200a31fc05da4e9d5a0465c36822e2f) {$v66f6181bcb4cff4cd38fbc804a036db6 = templatesCollection::getInstance()->getTemplate($v3200a31fc05da4e9d5a0465c36822e2f);if (isset($this->exported_templates[$v3200a31fc05da4e9d5a0465c36822e2f])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('template');$this->translateEntity($v66f6181bcb4cff4cd38fbc804a036db6, $v4a8a08f09d37b73795649038408b5f33);$vd01a3cac3018d018ad8bef5c05012c94 = $this->relations->getOldTemplateIdRelation($this->source_id, $v3200a31fc05da4e9d5a0465c36822e2f);if ($vd01a3cac3018d018ad8bef5c05012c94 === false) {$this->relations->setTemplateIdRelation($this->source_id, $v3200a31fc05da4e9d5a0465c36822e2f, $v3200a31fc05da4e9d5a0465c36822e2f);$vd01a3cac3018d018ad8bef5c05012c94 = $v3200a31fc05da4e9d5a0465c36822e2f;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $vd01a3cac3018d018ad8bef5c05012c94);}$vf585b7f018bb4ced15a03683a733e50b = $v66f6181bcb4cff4cd38fbc804a036db6->getLangId();if($this->exportLang($vf585b7f018bb4ced15a03683a733e50b)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);$v4a8a08f09d37b73795649038408b5f33->setAttribute('lang-id', $v392cdf2310e931972f2459edc1ea2ff2);$v72ee76c5c29383b7c9f9225c1fa4d10b = $v66f6181bcb4cff4cd38fbc804a036db6->getDomainId();$vad5f82e879a9c5d6b5b442eb37e50551 = domainsCollection::getInstance()->getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);if ($this->exportDomain($vad5f82e879a9c5d6b5b442eb37e50551)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v0bb5aff4a4154504d1117c453c35edd8 = $this->relations->getOldDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b);$v4a8a08f09d37b73795649038408b5f33->setAttribute('domain-id', $v0bb5aff4a4154504d1117c453c35edd8);$this->templates_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_templates[$v3200a31fc05da4e9d5a0465c36822e2f] = $vd01a3cac3018d018ad8bef5c05012c94;$this->position++;return true;}protected function exportTemplates() {foreach ($this->templates as $v66f6181bcb4cff4cd38fbc804a036db6) {$this->exportTemplate($v66f6181bcb4cff4cd38fbc804a036db6);}}protected function exportDataType($v94757cae63fd3e398c0811a976dd6bbe) {$v599dcce2998a6b40b1e38e8c6006cb0a = umiFieldTypesCollection::getInstance()->getFieldType($v94757cae63fd3e398c0811a976dd6bbe);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiFieldType) return false;if (isset($this->exported_data_types[$v94757cae63fd3e398c0811a976dd6bbe])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('datatype');$this->data_types_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->translateEntity($v599dcce2998a6b40b1e38e8c6006cb0a, $v4a8a08f09d37b73795649038408b5f33);$v4a8a08f09d37b73795649038408b5f33->removeAttribute('id');$this->exported_data_types[$v94757cae63fd3e398c0811a976dd6bbe] = $v94757cae63fd3e398c0811a976dd6bbe;}protected function exportType($v94757cae63fd3e398c0811a976dd6bbe) {$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) return false;if (isset($this->exported_types[$v94757cae63fd3e398c0811a976dd6bbe])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$this->exported_types[$v94757cae63fd3e398c0811a976dd6bbe] = 'found';$v2e3c048401582f4247d7ccac43657d2d = $v599dcce2998a6b40b1e38e8c6006cb0a->getParentId();if ($v2e3c048401582f4247d7ccac43657d2d) {if ($this->exportType($v2e3c048401582f4247d7ccac43657d2d)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('type');$this->translateEntity($v599dcce2998a6b40b1e38e8c6006cb0a, $v4a8a08f09d37b73795649038408b5f33);$va240be392fd0549ece5558553983d79b = $this->relations->getOldTypeIdRelation($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe);if (!$va240be392fd0549ece5558553983d79b) {$va240be392fd0549ece5558553983d79b = ($v94757cae63fd3e398c0811a976dd6bbe == self::$ROOT_PAGE_TYPE_ID) ? '{root-pages-type}' : $v94757cae63fd3e398c0811a976dd6bbe;$this->relations->setTypeIdRelation($this->source_id, $va240be392fd0549ece5558553983d79b, $v94757cae63fd3e398c0811a976dd6bbe);}$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $va240be392fd0549ece5558553983d79b);$v2e3c048401582f4247d7ccac43657d2d = $v599dcce2998a6b40b1e38e8c6006cb0a->getParentId();if ($v2e3c048401582f4247d7ccac43657d2d) {$vd3fbb9ff0b93cc92c5414344402a74bb = $this->relations->getOldTypeIdRelation($this->source_id, $v2e3c048401582f4247d7ccac43657d2d);if ($vd3fbb9ff0b93cc92c5414344402a74bb === false) {$vd3fbb9ff0b93cc92c5414344402a74bb = ($v2e3c048401582f4247d7ccac43657d2d == self::$ROOT_PAGE_TYPE_ID) ? '{root-pages-type}' : $v2e3c048401582f4247d7ccac43657d2d;$this->relations->setTypeIdRelation($this->source_id, $vd3fbb9ff0b93cc92c5414344402a74bb, $v2e3c048401582f4247d7ccac43657d2d);}$v4a8a08f09d37b73795649038408b5f33->setAttribute('parent-id', $vd3fbb9ff0b93cc92c5414344402a74bb);}$v3643b86326b2ffcc0a085b4dd3a4309b = new DOMXPath($this->doc);if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("base", $v4a8a08f09d37b73795649038408b5f33)->length) {$v593616de15330c0fb2d55e55410bf994 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("base", $v4a8a08f09d37b73795649038408b5f33)->item(0);$v593616de15330c0fb2d55e55410bf994->removeAttribute('id');}if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("fieldgroups/group", $v4a8a08f09d37b73795649038408b5f33)->length) {foreach($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("fieldgroups/group", $v4a8a08f09d37b73795649038408b5f33) as $vdb0f6f37ebeb6ea09489124345af2a45) {$v47db2588331bbe530c80dd001fc60aed = $vdb0f6f37ebeb6ea09489124345af2a45->getAttribute('id');$v7617417dc7eb3bbc463bf3c66d341d7b = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroup($v47db2588331bbe530c80dd001fc60aed, true);if ($v7617417dc7eb3bbc463bf3c66d341d7b->getIsActive()) {$vdb0f6f37ebeb6ea09489124345af2a45->setAttribute('active', 'active');}else {$vdb0f6f37ebeb6ea09489124345af2a45->setAttribute('active', '0');}if(!$v7617417dc7eb3bbc463bf3c66d341d7b->getIsVisible()) {$vdb0f6f37ebeb6ea09489124345af2a45->setAttribute('visible', '0');}$vdb0f6f37ebeb6ea09489124345af2a45->removeAttribute('id');}}$v5df80bc8ce306a564d91fa6a4da3d95b = array();$v8797e64b0b663bbad43134e3003a4ef4 = umiFieldsCollection::getInstance();$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("fieldgroups/group/field", $v4a8a08f09d37b73795649038408b5f33);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v06e3d36fa30cea095545139854ad1fb9) {$v3aabf39f2d943fa886d86dcbbee4d910 = intval($v06e3d36fa30cea095545139854ad1fb9->getAttribute('id'));$v73f329f154a663bfda020aadcdd0b775 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('name');$v528ca8fdf35a8b13b093b5786a22c0bf = $this->relations->getOldFieldName($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe, $v3aabf39f2d943fa886d86dcbbee4d910);if ($v528ca8fdf35a8b13b093b5786a22c0bf === false) {$this->relations->setFieldIdRelation($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe, $v73f329f154a663bfda020aadcdd0b775, $v3aabf39f2d943fa886d86dcbbee4d910);$v528ca8fdf35a8b13b093b5786a22c0bf = $v73f329f154a663bfda020aadcdd0b775;}else {$v06e3d36fa30cea095545139854ad1fb9->setAttribute('name', $v528ca8fdf35a8b13b093b5786a22c0bf);}if($v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('restriction')->length) {$v23604f9ddf406aa61ce8b1eaf9f6d39a = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('restriction')->item(0);$v228c63e369a5906eb7f0500a13729edc = $v23604f9ddf406aa61ce8b1eaf9f6d39a->getAttribute('id');$this->restrictions[] = $v228c63e369a5906eb7f0500a13729edc;$this->restricted_fields[] = array(      'restriction-id' => $v228c63e369a5906eb7f0500a13729edc,      'field-name' => $v528ca8fdf35a8b13b093b5786a22c0bf,      'type-id' => $va240be392fd0549ece5558553983d79b     );$v23604f9ddf406aa61ce8b1eaf9f6d39a->removeAttribute('field-type-id');}$v051369818a8073bba5feeb0e957eb308 = $v06e3d36fa30cea095545139854ad1fb9->hasAttribute('guide-id') ? $v06e3d36fa30cea095545139854ad1fb9->getAttribute('guide-id') : false;if ($v051369818a8073bba5feeb0e957eb308 && (!$this->ignoreRelations || in_array('guides', $this->saveRelations))) {if ($this->exportType($v051369818a8073bba5feeb0e957eb308)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('objects');$v8be74552df93e31bbdd6b36ed74bdb6a->types('object-type')->id($v051369818a8073bba5feeb0e957eb308);$v8be74552df93e31bbdd6b36ed74bdb6a->option('return')->value('id');foreach ($v8be74552df93e31bbdd6b36ed74bdb6a->result as $v9b207167e5381c47682c6b4f58a623fb) {if (is_array($this->objects) && !in_array($v9b207167e5381c47682c6b4f58a623fb['id'], $this->objects)) {$this->objects[] = $v9b207167e5381c47682c6b4f58a623fb['id'];}}$vd4276536125c741369298bfbf2817a8a = $this->relations->getOldTypeIdRelation($this->source_id, $v051369818a8073bba5feeb0e957eb308);$v06e3d36fa30cea095545139854ad1fb9->setAttribute('guide-id', $vd4276536125c741369298bfbf2817a8a);$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('type-id', $va240be392fd0549ece5558553983d79b);$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);$vb2f5ff47436671b6e533d8dc3614845d = $this->doc->createElement('guide');$vb2f5ff47436671b6e533d8dc3614845d->setAttribute('id', $vd4276536125c741369298bfbf2817a8a);$v4b43b0aee35624cd95b910189b3dc231->appendChild($vb2f5ff47436671b6e533d8dc3614845d);$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if ($v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('type')->length){$v519504d7d4beb745dac24ccfb6c1d7c9 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('type')->item(0);$v519504d7d4beb745dac24ccfb6c1d7c9->removeAttribute('id');}$vce6ba6b4afd61be6d0f21f1e2a995213 = $v8797e64b0b663bbad43134e3003a4ef4->getField($v3aabf39f2d943fa886d86dcbbee4d910);if ($vce6ba6b4afd61be6d0f21f1e2a995213->getIsSystem()) {$v06e3d36fa30cea095545139854ad1fb9->setAttribute('system', 'system');}$v06e3d36fa30cea095545139854ad1fb9->removeAttribute('field-type-id');}foreach ($v5df80bc8ce306a564d91fa6a4da3d95b as $v4b43b0aee35624cd95b910189b3dc231) {$this->relations_container->appendChild($v4b43b0aee35624cd95b910189b3dc231);}$this->types_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_types[$v94757cae63fd3e398c0811a976dd6bbe] = $va240be392fd0549ece5558553983d79b;$this->position++;return true;}protected function exportRestriction($v228c63e369a5906eb7f0500a13729edc) {if (isset($this->exported_restrictions[$v228c63e369a5906eb7f0500a13729edc])) return false;$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v228c63e369a5906eb7f0500a13729edc);if (!$v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) return false;$vf3ecaaa779127f3ec136cca581bfaf46 = $v3dadfaeb46ec74762b37de11fea7605c->getClassName();$vf52176cf6508ff07e507a49978c0fc2f = $v3dadfaeb46ec74762b37de11fea7605c->getTitle();$v94757cae63fd3e398c0811a976dd6bbe = $v3dadfaeb46ec74762b37de11fea7605c->getFieldTypeId();$v599dcce2998a6b40b1e38e8c6006cb0a = umiFieldTypesCollection::getInstance()->getFieldType($v94757cae63fd3e398c0811a976dd6bbe);$v17f71d965fe9589ddbd11caf7182243e = $v599dcce2998a6b40b1e38e8c6006cb0a->getDataType();$v96a76ec43956dac431b643cbd544dd08 = $v599dcce2998a6b40b1e38e8c6006cb0a->getIsMultiple();$v6896b87ef0ed896869194f78f21380e7 = $this->relations->getOldRestrictionIdRelation($this->source_id, $v228c63e369a5906eb7f0500a13729edc);if (!$v6896b87ef0ed896869194f78f21380e7) {$this->relations->setRestrictionIdRelation($this->source_id, $v228c63e369a5906eb7f0500a13729edc, $v228c63e369a5906eb7f0500a13729edc);$v6896b87ef0ed896869194f78f21380e7 = $v228c63e369a5906eb7f0500a13729edc;}$vd95679752134a2d9eb61dbd7b91c4bcc = $this->doc->createElement('restriction');$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('id', $v6896b87ef0ed896869194f78f21380e7);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('prefix', $vf3ecaaa779127f3ec136cca581bfaf46);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('title', $vf52176cf6508ff07e507a49978c0fc2f);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('field-type', $v17f71d965fe9589ddbd11caf7182243e);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('is-multiple', $v96a76ec43956dac431b643cbd544dd08);foreach ($this->restricted_fields as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {if ($v2063c1608d6e0baf80249c42e2be5804['restriction-id'] == $v228c63e369a5906eb7f0500a13729edc) {$v8fa14cdd754f91cc6554c9e71929cce7 = $this->doc->createElement('field');$v8fa14cdd754f91cc6554c9e71929cce7->setAttribute('field-name', $v2063c1608d6e0baf80249c42e2be5804['field-name']);$v8fa14cdd754f91cc6554c9e71929cce7->setAttribute('type-id', $v2063c1608d6e0baf80249c42e2be5804['type-id']);$vd95679752134a2d9eb61dbd7b91c4bcc->appendChild($v8fa14cdd754f91cc6554c9e71929cce7);}}$this->restrictions_container->appendChild($vd95679752134a2d9eb61dbd7b91c4bcc);$this->exported_restrictions[$v228c63e369a5906eb7f0500a13729edc] = $v6896b87ef0ed896869194f78f21380e7;$this->position++;return true;}protected function exportReg($vd6fe1d0be6347b8ef2427fa629c04485) {if (isset($this->exported_registry_items[$vd6fe1d0be6347b8ef2427fa629c04485])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$vd6fe1d0be6347b8ef2427fa629c04485 = trim($vd6fe1d0be6347b8ef2427fa629c04485, "/");$v3c6e0b8a9c15224a8228b9a98ca1531d = $vb1444fb0c07653567ad325aa25d4e37a->getKey($vd6fe1d0be6347b8ef2427fa629c04485);$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $vb1444fb0c07653567ad325aa25d4e37a->getVal($vd6fe1d0be6347b8ef2427fa629c04485);if (!$v3c6e0b8a9c15224a8228b9a98ca1531d) return false;if(strrpos($vd6fe1d0be6347b8ef2427fa629c04485, '/') != false) {$v6b3e5c01522ed94ff36d244b4401bd17 = substr_replace($vd6fe1d0be6347b8ef2427fa629c04485, '', strrpos($vd6fe1d0be6347b8ef2427fa629c04485, '/'));if ($this->exportReg($v6b3e5c01522ed94ff36d244b4401bd17)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}}$v865c0c0b4ab0e063e5caa3387c1a8741 = $this->doc->createElement('key');$this->registry_container->appendChild($v865c0c0b4ab0e063e5caa3387c1a8741);$v865c0c0b4ab0e063e5caa3387c1a8741->setAttribute('path', $vd6fe1d0be6347b8ef2427fa629c04485);$v865c0c0b4ab0e063e5caa3387c1a8741->setAttribute('val', $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$this->exported_registry_items[$vd6fe1d0be6347b8ef2427fa629c04485] = $vd6fe1d0be6347b8ef2427fa629c04485;$this->position++;return true;}protected function exportRestrictions() {if (!$this->ignoreRelations || in_array('restrictions', $this->saveRelations)){foreach ($this->restrictions as $v3dadfaeb46ec74762b37de11fea7605c) {$this->exportRestriction($v3dadfaeb46ec74762b37de11fea7605c);}}}protected function exportTypes() {foreach ($this->types as $v599dcce2998a6b40b1e38e8c6006cb0a) {$this->exportType($v599dcce2998a6b40b1e38e8c6006cb0a);}}protected function exportBranches() {foreach ($this->branches as $v9603a224b40d7b67210b78f2e390d00f) {if ($this->break) break;$this->exportBranch($v9603a224b40d7b67210b78f2e390d00f);}}protected function exportBranch($v7057e8409c7c531a1a6e9ac3df4ed549) {if (isset($this->excludedElements[$v7057e8409c7c531a1a6e9ac3df4ed549])) return false;$this->exportElement($v7057e8409c7c531a1a6e9ac3df4ed549);$vadce578d04ed03c31f6ac59451fcf8e4 = umiHierarchy::getInstance()->getChilds($v7057e8409c7c531a1a6e9ac3df4ed549, true, true, 1);foreach ($vadce578d04ed03c31f6ac59451fcf8e4 as $vf36263a38d7de5cdaa953c1e2b2f79b5 => $vfa816edb83e95bf0c8da580bdfd491ef) {if ($this->break) return false;$this->exportElement($vf36263a38d7de5cdaa953c1e2b2f79b5);$this->exportBranch($vf36263a38d7de5cdaa953c1e2b2f79b5);}}protected function exportElement($v7057e8409c7c531a1a6e9ac3df4ed549) {umiHierarchy::getInstance()->clearCache();if (isset($this->excludedElements[$v7057e8409c7c531a1a6e9ac3df4ed549])) return false;if (isset($this->exported_elements[$v7057e8409c7c531a1a6e9ac3df4ed549])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true, true);if (!$v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) return false;$this->exported_elements[$v7057e8409c7c531a1a6e9ac3df4ed549] = 'found';$v94757cae63fd3e398c0811a976dd6bbe = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectTypeId();if ($this->exportType($v94757cae63fd3e398c0811a976dd6bbe)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('page');$this->translateEntity($v8e2dcfd7e7e24b1ca76c1193f645902b, $v4a8a08f09d37b73795649038408b5f33);$v4a8a08f09d37b73795649038408b5f33->removeAttribute('update-time');$vf585b7f018bb4ced15a03683a733e50b = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();if (!$this->ignoreRelations || in_array('langs', $this->saveRelations)) {if ($this->exportLang($vf585b7f018bb4ced15a03683a733e50b)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);}else {$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);if ($v392cdf2310e931972f2459edc1ea2ff2 === false) {$this->relations->setLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b, $vf585b7f018bb4ced15a03683a733e50b);$v392cdf2310e931972f2459edc1ea2ff2 = $vf585b7f018bb4ced15a03683a733e50b;}}$v4a8a08f09d37b73795649038408b5f33->setAttribute('lang-id', $v392cdf2310e931972f2459edc1ea2ff2);$v72ee76c5c29383b7c9f9225c1fa4d10b = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();if (!$this->ignoreRelations || in_array('domains', $this->saveRelations)) {$vad5f82e879a9c5d6b5b442eb37e50551 = domainsCollection::getInstance()->getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);if ($this->exportDomain($vad5f82e879a9c5d6b5b442eb37e50551)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v0bb5aff4a4154504d1117c453c35edd8 = $this->relations->getOldDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b);}else {$v0bb5aff4a4154504d1117c453c35edd8 = $this->relations->getOldDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b);if ($v0bb5aff4a4154504d1117c453c35edd8 === false) {$this->relations->setDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b, $v72ee76c5c29383b7c9f9225c1fa4d10b);$v0bb5aff4a4154504d1117c453c35edd8 = $v72ee76c5c29383b7c9f9225c1fa4d10b;}}$v4a8a08f09d37b73795649038408b5f33->setAttribute('domain-id', $v0bb5aff4a4154504d1117c453c35edd8);$vd02e12eb6d6c3f6ebd763197df01e211   = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTplId();if (!$this->ignoreRelations || in_array('templates', $this->saveRelations)) {if ($this->exportTemplate($vd02e12eb6d6c3f6ebd763197df01e211)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$vd01a3cac3018d018ad8bef5c05012c94 = $this->relations->getOldTemplateIdRelation($this->source_id, $vd02e12eb6d6c3f6ebd763197df01e211);}else {$vd01a3cac3018d018ad8bef5c05012c94 = $this->relations->getOldTemplateIdRelation($this->source_id, $vd02e12eb6d6c3f6ebd763197df01e211);if ($vd01a3cac3018d018ad8bef5c05012c94 === false) {$this->relations->setTemplateIdRelation($this->source_id, $vd02e12eb6d6c3f6ebd763197df01e211, $vd02e12eb6d6c3f6ebd763197df01e211);$vd01a3cac3018d018ad8bef5c05012c94 = $vd02e12eb6d6c3f6ebd763197df01e211;}}$vf9bdb7221804d6d17b654ec67c5a0735  = templatesCollection::getInstance()->getTemplate($vd02e12eb6d6c3f6ebd763197df01e211)->getFilename();$v557c9fc3c1f769c263ae2d3113ff1501 = $this->doc->createElement('template');$v557c9fc3c1f769c263ae2d3113ff1501->setAttribute("id", $vd01a3cac3018d018ad8bef5c05012c94);$v557c9fc3c1f769c263ae2d3113ff1501->appendChild($this->doc->createTextNode($vf9bdb7221804d6d17b654ec67c5a0735));$v4a8a08f09d37b73795649038408b5f33->appendChild($v557c9fc3c1f769c263ae2d3113ff1501);$v13fba93b98196f2395dec474c9ba27e5 = $this->relations->getOldIdRelation($this->source_id, $v7057e8409c7c531a1a6e9ac3df4ed549);if ($v13fba93b98196f2395dec474c9ba27e5 === false) {$this->relations->setIdRelation($this->source_id, $v7057e8409c7c531a1a6e9ac3df4ed549, $v7057e8409c7c531a1a6e9ac3df4ed549);$v13fba93b98196f2395dec474c9ba27e5 = $v7057e8409c7c531a1a6e9ac3df4ed549;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $v13fba93b98196f2395dec474c9ba27e5);}$v6be379826b20cc58475f636e33f4606b = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();if ($v6be379826b20cc58475f636e33f4606b) {$v65dce76bfdfbc3dfd9962e8d154dab64 = $this->relations->getOldIdRelation($this->source_id, $v6be379826b20cc58475f636e33f4606b);if ($v65dce76bfdfbc3dfd9962e8d154dab64 === false) {$this->relations->setIdRelation($this->source_id, $v6be379826b20cc58475f636e33f4606b, $v6be379826b20cc58475f636e33f4606b);$v65dce76bfdfbc3dfd9962e8d154dab64 = $v6be379826b20cc58475f636e33f4606b;}$v4a8a08f09d37b73795649038408b5f33->setAttribute('parentId', $v65dce76bfdfbc3dfd9962e8d154dab64);}$v3643b86326b2ffcc0a085b4dd3a4309b = new DOMXPath($this->doc);if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("basetype", $v4a8a08f09d37b73795649038408b5f33)->length) {$v593616de15330c0fb2d55e55410bf994 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("basetype", $v4a8a08f09d37b73795649038408b5f33)->item(0);$v593616de15330c0fb2d55e55410bf994->removeAttribute('id');}$va240be392fd0549ece5558553983d79b = $this->relations->getOldTypeIdRelation($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe);$v4a8a08f09d37b73795649038408b5f33->setAttribute('type-id', $va240be392fd0549ece5558553983d79b);$vaf31437ce61345f416579830a98c91e5 = $v4a8a08f09d37b73795649038408b5f33->getAttribute('object-id');if (!$this->ignoreRelations || in_array('objects', $this->saveRelations)) {if ($this->exportObject($vaf31437ce61345f416579830a98c91e5)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $this->relations->getOldObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5);}else {$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $this->relations->getOldObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5);if ($vdad7dfa79a52fb5c76dff4c6bc0ddfe4 === false) {$this->relations->setObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5, $vaf31437ce61345f416579830a98c91e5);$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $vaf31437ce61345f416579830a98c91e5;}}$v4a8a08f09d37b73795649038408b5f33->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group", $v4a8a08f09d37b73795649038408b5f33)->length) {foreach($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group", $v4a8a08f09d37b73795649038408b5f33) as $vdb0f6f37ebeb6ea09489124345af2a45)     if($vdb0f6f37ebeb6ea09489124345af2a45->hasAttribute('id')) $vdb0f6f37ebeb6ea09489124345af2a45->removeAttribute('id');}$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group/property", $v4a8a08f09d37b73795649038408b5f33);$v5df80bc8ce306a564d91fa6a4da3d95b = array();$vc639bc918ec583ce6a914b6bbb29095d = array();foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v06e3d36fa30cea095545139854ad1fb9) {$v3aabf39f2d943fa886d86dcbbee4d910 = intval($v06e3d36fa30cea095545139854ad1fb9->getAttribute('id'));$v528ca8fdf35a8b13b093b5786a22c0bf = $this->relations->getOldFieldName($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe, $v3aabf39f2d943fa886d86dcbbee4d910);if ($v528ca8fdf35a8b13b093b5786a22c0bf) {$v06e3d36fa30cea095545139854ad1fb9->setAttribute('name', $v528ca8fdf35a8b13b093b5786a22c0bf);}$v519504d7d4beb745dac24ccfb6c1d7c9 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('type');if (!$this->ignoreRelations || in_array('fields_relations', $this->saveRelations)) {if ($v519504d7d4beb745dac24ccfb6c1d7c9 == 'relation') {$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('page-id', $v13fba93b98196f2395dec474c9ba27e5 );$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9)) return true;$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if ($v519504d7d4beb745dac24ccfb6c1d7c9 == 'symlink') {$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('page-id', $v13fba93b98196f2395dec474c9ba27e5);$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9)) return true;$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if($v519504d7d4beb745dac24ccfb6c1d7c9 == 'optioned') {$ve1671797c52e15f763380b45e841ec32  = $this->doc->createElement('entity');$ve1671797c52e15f763380b45e841ec32->setAttribute('page-id', $v13fba93b98196f2395dec474c9ba27e5);$ve1671797c52e15f763380b45e841ec32->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportOption($v06e3d36fa30cea095545139854ad1fb9, $ve1671797c52e15f763380b45e841ec32)) return true;$vc639bc918ec583ce6a914b6bbb29095d[] = $ve1671797c52e15f763380b45e841ec32;}}if (!$this->ignoreRelations || in_array('files', $this->saveRelations)) {if($v519504d7d4beb745dac24ccfb6c1d7c9 == 'file' || $v519504d7d4beb745dac24ccfb6c1d7c9 == 'swf_file' || $v519504d7d4beb745dac24ccfb6c1d7c9 == 'img_file') {$v97fd815a3803a0588876bdd862014fed = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('value')->item(0)->nodeValue;if (file_exists(CURRENT_WORKING_DIR . $v97fd815a3803a0588876bdd862014fed)) {$v8c7dd922ad47494fc02c388e12c00eac = new umiFile(CURRENT_WORKING_DIR . $v97fd815a3803a0588876bdd862014fed);$this->exportFile($v8c7dd922ad47494fc02c388e12c00eac);}elseif (file_exists('./' . $v97fd815a3803a0588876bdd862014fed)) {$v8c7dd922ad47494fc02c388e12c00eac = new umiFile('./' . $v97fd815a3803a0588876bdd862014fed);$this->exportFile($v8c7dd922ad47494fc02c388e12c00eac);}}}}$v9f5a2d64925838158f3ef0a206b58c00 = array();if (!$this->ignoreRelations || in_array('permissions', $this->saveRelations)) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance()->getRecordedPermissions($v7057e8409c7c531a1a6e9ac3df4ed549);if(is_array($v41275a535677f79ff347e01bc530c176)) {$v83878c91171338902e0fe0fb97a8c47a = $this->doc->createElement('permission');$v83878c91171338902e0fe0fb97a8c47a->setAttribute('page-id', $v13fba93b98196f2395dec474c9ba27e5);foreach ($v41275a535677f79ff347e01bc530c176 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {$vd95679752134a2d9eb61dbd7b91c4bcc = $this->doc->createElement('owner');if ($this->exportObject($v3c6e0b8a9c15224a8228b9a98ca1531d)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v27742af9ed1c41ae081ab4e34d376042 = $this->relations->getOldObjectIdRelation($this->source_id, $v3c6e0b8a9c15224a8228b9a98ca1531d);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('id', $v27742af9ed1c41ae081ab4e34d376042);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('level', $v2063c1608d6e0baf80249c42e2be5804);$v83878c91171338902e0fe0fb97a8c47a->appendChild($vd95679752134a2d9eb61dbd7b91c4bcc);}$v9f5a2d64925838158f3ef0a206b58c00[] = $v83878c91171338902e0fe0fb97a8c47a;}}foreach ($v5df80bc8ce306a564d91fa6a4da3d95b as $v4b43b0aee35624cd95b910189b3dc231) {$this->relations_container->appendChild($v4b43b0aee35624cd95b910189b3dc231);}foreach ($vc639bc918ec583ce6a914b6bbb29095d as $ve1671797c52e15f763380b45e841ec32) {$this->options_container->appendChild($ve1671797c52e15f763380b45e841ec32);}foreach ($v9f5a2d64925838158f3ef0a206b58c00 as $v83878c91171338902e0fe0fb97a8c47a) {$this->permissions_container->appendChild($v83878c91171338902e0fe0fb97a8c47a);}if (!$this->ignoreRelations || in_array('hierarchy', $this->saveRelations)) {$v8bef1cc20ada3bef55fdf132cb2a1cb9 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getOrd();$v2510c39011c5be704182423e3a695e91 = $this->doc->createElement('relation');$v2510c39011c5be704182423e3a695e91->setAttribute('id', $v13fba93b98196f2395dec474c9ba27e5);$v2510c39011c5be704182423e3a695e91->setAttribute('ord', $v8bef1cc20ada3bef55fdf132cb2a1cb9);if($v6be379826b20cc58475f636e33f4606b) {$v2510c39011c5be704182423e3a695e91->setAttribute('parent-id', $v65dce76bfdfbc3dfd9962e8d154dab64);}else {$v2510c39011c5be704182423e3a695e91->setAttribute('parent-id', 0);}$this->hierarchy_container->appendChild($v2510c39011c5be704182423e3a695e91);}$this->pages_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_elements[$v7057e8409c7c531a1a6e9ac3df4ed549] = $v13fba93b98196f2395dec474c9ba27e5;$this->position++;return true;}protected function exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9) {$vb3b32a2d422265cd25c3323ed0157f81 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('page');foreach ($vb3b32a2d422265cd25c3323ed0157f81 as $v71860c77c6745379b0d44304d66b6a13) {if ($this->exportElement($v71860c77c6745379b0d44304d66b6a13->getAttribute('id'))){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getOldIdRelation($this->source_id, $v71860c77c6745379b0d44304d66b6a13->getAttribute('id'));$vb2f5ff47436671b6e533d8dc3614845d = $this->doc->createElement('page');$vb2f5ff47436671b6e533d8dc3614845d->setAttribute('id', $v1a63c8004d716c8b91f5b7af780555b9);$v71860c77c6745379b0d44304d66b6a13->setAttribute('id', $v1a63c8004d716c8b91f5b7af780555b9);if ($this->exportType($v71860c77c6745379b0d44304d66b6a13->getAttribute('type-id'))){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getOldTypeIdRelation($this->source_id, $v71860c77c6745379b0d44304d66b6a13->getAttribute('type-id'));$v71860c77c6745379b0d44304d66b6a13->setAttribute('type-id', $v94757cae63fd3e398c0811a976dd6bbe);$v6be379826b20cc58475f636e33f4606b = $v71860c77c6745379b0d44304d66b6a13->getAttribute('parentId');if ($this->exportElement($v6be379826b20cc58475f636e33f4606b)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v65dce76bfdfbc3dfd9962e8d154dab64 = $this->relations->getOldIdRelation($this->source_id, $v6be379826b20cc58475f636e33f4606b);$v71860c77c6745379b0d44304d66b6a13->setAttribute('parentId', $v65dce76bfdfbc3dfd9962e8d154dab64);$vaf31437ce61345f416579830a98c91e5 = $v71860c77c6745379b0d44304d66b6a13->getAttribute('object-id');if ($this->exportObject($vaf31437ce61345f416579830a98c91e5)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $this->relations->getOldObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5);$v71860c77c6745379b0d44304d66b6a13->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);$v71860c77c6745379b0d44304d66b6a13->removeAttribute('xlink:href');$v71860c77c6745379b0d44304d66b6a13->removeAttribute('update-time');if($v71860c77c6745379b0d44304d66b6a13->getElementsByTagName('basetype')->length){$v593616de15330c0fb2d55e55410bf994 = $v71860c77c6745379b0d44304d66b6a13->getElementsByTagName('basetype')->item(0);$v593616de15330c0fb2d55e55410bf994->removeAttribute('id');}$v4b43b0aee35624cd95b910189b3dc231->appendChild($vb2f5ff47436671b6e533d8dc3614845d);}$v691d502cfd0e0626cd3b058e5682ad1c = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('item');foreach ($v691d502cfd0e0626cd3b058e5682ad1c as $v447b7147e84be512208dcc0995d67ebc) {$v82bfda7962fd12f51163ae45886c4c62 = $v447b7147e84be512208dcc0995d67ebc->getAttribute('id');if ($this->exportObject($v82bfda7962fd12f51163ae45886c4c62)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v4fa996b497da363e7b006f146bc31108 = $this->relations->getOldObjectIdRelation($this->source_id, $v82bfda7962fd12f51163ae45886c4c62);$v447b7147e84be512208dcc0995d67ebc->setAttribute('id', $v4fa996b497da363e7b006f146bc31108);$v7f6bf686f231a8b117f0fa7737fcd363 = $v447b7147e84be512208dcc0995d67ebc->getAttribute('type-id');if ($this->exportType($v7f6bf686f231a8b117f0fa7737fcd363)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v379ac7b9bf2e946893adc737ef1fb48a = $this->relations->getOldTypeIdRelation($this->source_id, $v7f6bf686f231a8b117f0fa7737fcd363);$v447b7147e84be512208dcc0995d67ebc->setAttribute('type-id', $v379ac7b9bf2e946893adc737ef1fb48a);if ($v447b7147e84be512208dcc0995d67ebc->hasAttribute('ownerId')) {$v19e1960ba1b0c19de1d0581ddfaf4e83 = $v447b7147e84be512208dcc0995d67ebc->getAttribute('ownerId');if ($this->exportObject($v19e1960ba1b0c19de1d0581ddfaf4e83)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$vdf509c0952bdcfb6fdc42144ea11b049 = $this->relations->getOldObjectIdRelation($this->source_id, $v19e1960ba1b0c19de1d0581ddfaf4e83);$v447b7147e84be512208dcc0995d67ebc->setAttribute('ownerId', $vdf509c0952bdcfb6fdc42144ea11b049);}$v447b7147e84be512208dcc0995d67ebc->removeAttribute('xlink:href');$vb2f5ff47436671b6e533d8dc3614845d = $this->doc->createElement('object');$vb2f5ff47436671b6e533d8dc3614845d->setAttribute('id', $v4fa996b497da363e7b006f146bc31108);$v4b43b0aee35624cd95b910189b3dc231->appendChild($vb2f5ff47436671b6e533d8dc3614845d);}return true;}protected function exportObject($vaf31437ce61345f416579830a98c91e5) {$vaf31437ce61345f416579830a98c91e5 = (int) $vaf31437ce61345f416579830a98c91e5;if (isset($this->exported_objects[$vaf31437ce61345f416579830a98c91e5])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$this->exported_objects[$vaf31437ce61345f416579830a98c91e5] = 'found';$va8cfde6331bd59eb2ac96f8911c4b666 = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);if (!$va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) return false;$v94757cae63fd3e398c0811a976dd6bbe = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();if ($this->exportType($v94757cae63fd3e398c0811a976dd6bbe)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('object');$this->translateEntity($va8cfde6331bd59eb2ac96f8911c4b666, $v4a8a08f09d37b73795649038408b5f33);$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $this->relations->getOldObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5);if ($vdad7dfa79a52fb5c76dff4c6bc0ddfe4 === false) {$this->relations->setObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5, $vaf31437ce61345f416579830a98c91e5);$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $vaf31437ce61345f416579830a98c91e5;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);}$v3643b86326b2ffcc0a085b4dd3a4309b = new DOMXPath($this->doc);$va240be392fd0549ece5558553983d79b = $this->relations->getOldTypeIdRelation($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe);$v4a8a08f09d37b73795649038408b5f33->setAttribute('type-id', $va240be392fd0549ece5558553983d79b);if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group", $v4a8a08f09d37b73795649038408b5f33)->length) {foreach($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group", $v4a8a08f09d37b73795649038408b5f33) as $vdb0f6f37ebeb6ea09489124345af2a45)     if($vdb0f6f37ebeb6ea09489124345af2a45->hasAttribute('id')) $vdb0f6f37ebeb6ea09489124345af2a45->removeAttribute('id');}$v5df80bc8ce306a564d91fa6a4da3d95b = array();$vc639bc918ec583ce6a914b6bbb29095d = array();$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group/property", $v4a8a08f09d37b73795649038408b5f33);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v06e3d36fa30cea095545139854ad1fb9) {$v3aabf39f2d943fa886d86dcbbee4d910 = intval($v06e3d36fa30cea095545139854ad1fb9->getAttribute('id'));$v528ca8fdf35a8b13b093b5786a22c0bf = $this->relations->getOldFieldName($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe, $v3aabf39f2d943fa886d86dcbbee4d910);if ($v528ca8fdf35a8b13b093b5786a22c0bf) {$v06e3d36fa30cea095545139854ad1fb9->setAttribute('name', $v528ca8fdf35a8b13b093b5786a22c0bf);}if(!$this->ignoreRelations || in_array('fields_relations', $this->saveRelations)) {if ($v06e3d36fa30cea095545139854ad1fb9->getAttribute('type') == 'relation') {$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9)) return true;$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if ($v06e3d36fa30cea095545139854ad1fb9->getAttribute('type') == 'symlink') {$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9)) return true;$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if($v06e3d36fa30cea095545139854ad1fb9->getAttribute('type') == 'optioned') {$ve1671797c52e15f763380b45e841ec32 = $this->doc->createElement('entity');$ve1671797c52e15f763380b45e841ec32->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);$ve1671797c52e15f763380b45e841ec32->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportOption($v06e3d36fa30cea095545139854ad1fb9, $ve1671797c52e15f763380b45e841ec32)) return true;$vc639bc918ec583ce6a914b6bbb29095d[] = $ve1671797c52e15f763380b45e841ec32;}}}$v9f5a2d64925838158f3ef0a206b58c00 = array();if(!$this->ignoreRelations || in_array('permissions', $this->saveRelations)) {$v83878c91171338902e0fe0fb97a8c47a = $this->doc->createElement('permission');$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `module`, `method`, `allow` FROM cms_permissions WHERE owner_id = '{$vaf31437ce61345f416579830a98c91e5}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb394126a0e52e75f1e3d535d0fb0d33c) = mysql_fetch_row($result)) {$v6f8f57715090da2632453988d9a1501b = $this->doc->createElement('module');$v6f8f57715090da2632453988d9a1501b->setAttribute('name', $v22884db148f0ffb0d830ba431102b0b5);$v6f8f57715090da2632453988d9a1501b->setAttribute('method', $vea9f6aca279138c58f705c8d4cb4b8ce);$v6f8f57715090da2632453988d9a1501b->setAttribute('allow', $vb394126a0e52e75f1e3d535d0fb0d33c);$v83878c91171338902e0fe0fb97a8c47a->appendChild($v6f8f57715090da2632453988d9a1501b);}$v83878c91171338902e0fe0fb97a8c47a->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);if ($v4a8a08f09d37b73795649038408b5f33->hasAttribute('ownerId')) {$v5e7b19364b8de2dedd3aa48cf62706e3 = $va8cfde6331bd59eb2ac96f8911c4b666->getOwnerId();if ($this->exportObject($v5e7b19364b8de2dedd3aa48cf62706e3)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v72df47727f5cd9aca03aad866944cc2a = $this->relations->getOldObjectIdRelation($this->source_id, $v5e7b19364b8de2dedd3aa48cf62706e3);$v4a8a08f09d37b73795649038408b5f33->setAttribute('ownerId', $v72df47727f5cd9aca03aad866944cc2a);$vd95679752134a2d9eb61dbd7b91c4bcc = $this->doc->createElement('owner');$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('id', $v72df47727f5cd9aca03aad866944cc2a);$v83878c91171338902e0fe0fb97a8c47a->appendChild($vd95679752134a2d9eb61dbd7b91c4bcc);}$v9f5a2d64925838158f3ef0a206b58c00[] = $v83878c91171338902e0fe0fb97a8c47a;}foreach ($v5df80bc8ce306a564d91fa6a4da3d95b as $v4b43b0aee35624cd95b910189b3dc231) {$this->relations_container->appendChild($v4b43b0aee35624cd95b910189b3dc231);}foreach ($vc639bc918ec583ce6a914b6bbb29095d as $ve1671797c52e15f763380b45e841ec32) {$this->options_container->appendChild($ve1671797c52e15f763380b45e841ec32);}foreach ($v9f5a2d64925838158f3ef0a206b58c00 as $v83878c91171338902e0fe0fb97a8c47a) {$this->permissions_container->appendChild($v83878c91171338902e0fe0fb97a8c47a);}$this->objects_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_objects[$vaf31437ce61345f416579830a98c91e5] = $vaf31437ce61345f416579830a98c91e5;$this->position++;return true;}protected function exportOption($v06e3d36fa30cea095545139854ad1fb9, $ve1671797c52e15f763380b45e841ec32) {$v93da65a9fd0004d9477aeac024e08e15 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option');foreach ($v93da65a9fd0004d9477aeac024e08e15 as $vef3e30e070f70244fd6578d88a6b77ac) {$vd95679752134a2d9eb61dbd7b91c4bcc = $this->doc->createElement('option');if($vef3e30e070f70244fd6578d88a6b77ac->hasAttributes()) {$v736b91750e516139acc13c5eb6564f92 = $vef3e30e070f70244fd6578d88a6b77ac->attributes;if(!is_null($v736b91750e516139acc13c5eb6564f92)) {foreach ($v736b91750e516139acc13c5eb6564f92 as $v6a992d5529f459a44fee58c733255e86 => $vd2eb444e35c0a71f0a85df8194acb5b6) {$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute($vd2eb444e35c0a71f0a85df8194acb5b6->name, $vd2eb444e35c0a71f0a85df8194acb5b6->value);}}}if($vef3e30e070f70244fd6578d88a6b77ac->getElementsByTagName('object')->length) {$va8cfde6331bd59eb2ac96f8911c4b666 = $vef3e30e070f70244fd6578d88a6b77ac->getElementsByTagName('object')->item(0);if ($this->exportObject($va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('id'))) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$vb80bb7740288fda1f201890375a60c8f = $this->relations->getOldObjectIdRelation($this->source_id, $va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('id'));$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('object-id' , $vb80bb7740288fda1f201890375a60c8f);$va8cfde6331bd59eb2ac96f8911c4b666->setAttribute('id', $vb80bb7740288fda1f201890375a60c8f);if ($this->exportType($va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('type-id'))) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getOldTypeIdRelation($this->source_id, $va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('type-id'));$va8cfde6331bd59eb2ac96f8911c4b666->setAttribute('type-id', $v94757cae63fd3e398c0811a976dd6bbe);if ($va8cfde6331bd59eb2ac96f8911c4b666->hasAttribute('ownerId')) {if ($v5e7b19364b8de2dedd3aa48cf62706e3 = $va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('ownerId')){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$this->exportObject($v5e7b19364b8de2dedd3aa48cf62706e3);$v72df47727f5cd9aca03aad866944cc2a = $this->relations->getOldObjectIdRelation($this->source_id, $v5e7b19364b8de2dedd3aa48cf62706e3);$va8cfde6331bd59eb2ac96f8911c4b666->setAttribute('ownerId', $v72df47727f5cd9aca03aad866944cc2a);$va8cfde6331bd59eb2ac96f8911c4b666->removeAttribute('xlink:href');}}if($vef3e30e070f70244fd6578d88a6b77ac->getElementsByTagName('page')->length) {$v71860c77c6745379b0d44304d66b6a13 = $vef3e30e070f70244fd6578d88a6b77ac->getElementsByTagName('page')->item(0);if ($this->exportPage($v71860c77c6745379b0d44304d66b6a13->getAttribute('id'))) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$vb80bb7740288fda1f201890375a60c8f = $this->relations->getOldIdRelation($this->source_id, $v71860c77c6745379b0d44304d66b6a13->getAttribute('id'));$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('page-id' , $vb80bb7740288fda1f201890375a60c8f);$v71860c77c6745379b0d44304d66b6a13->setAttribute('id', $vb80bb7740288fda1f201890375a60c8f);if ($this->exportType($v71860c77c6745379b0d44304d66b6a13->getAttribute('type-id'))) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getOldTypeIdRelation($this->source_id, $v71860c77c6745379b0d44304d66b6a13->getAttribute('type-id'));$v71860c77c6745379b0d44304d66b6a13->setAttribute('type-id', $v94757cae63fd3e398c0811a976dd6bbe);$v71860c77c6745379b0d44304d66b6a13->removeAttribute('xlink:href');$v71860c77c6745379b0d44304d66b6a13->removeAttribute('update-time');}$ve1671797c52e15f763380b45e841ec32->appendChild($vd95679752134a2d9eb61dbd7b91c4bcc);}return true;}protected function exportElements() {foreach ($this->elements as $v7057e8409c7c531a1a6e9ac3df4ed549) {if ($this->break) return;$this->exportElement($v7057e8409c7c531a1a6e9ac3df4ed549);}}protected function exportObjects() {foreach ($this->objects as $vaf31437ce61345f416579830a98c91e5) {if ($this->break) return;$this->exportObject($vaf31437ce61345f416579830a98c91e5);}}protected function exportRegs() {foreach ($this->registry as $v33c0ee425e2c0efe834afc1aa1e33a4c) {if ($this->break) return;$this->exportReg($v33c0ee425e2c0efe834afc1aa1e33a4c);}}protected function exportDataTypes() {foreach ($this->data_types as $v17f71d965fe9589ddbd11caf7182243e) {if ($this->break) return;$this->exportDataType($v17f71d965fe9589ddbd11caf7182243e);}}}interface iUmiXmlExporter {public function __construct();public function setElements($v6a7f245843454cf4f28ad7c5e2572aa2);public function setObjects($v5891da2d64975cae48d175d1e001f5da);public function run();public function getResultFile();public function saveResultFile($v47826cacc65c665212b821e6ff80b9b0);};class umiXmlExporter implements iUmiXmlExporter {private $objects, $elements, $dump, $source_id;public function __construct() {$this->source_id =  umiImportRelations::getInstance()->addNewSource(strtoupper(md5($this->getSiteName())));}public function setElements($v0565942fb39be0978d5774cfa5320fcb) {if(is_array($v0565942fb39be0978d5774cfa5320fcb)) {foreach ($v0565942fb39be0978d5774cfa5320fcb as $v65c10911d8b8591219a21ebacf46da01) $this->elements[] = ($v65c10911d8b8591219a21ebacf46da01 instanceof umiHierarchyElement) ? $v65c10911d8b8591219a21ebacf46da01->getId() : $v65c10911d8b8591219a21ebacf46da01;$this->fillObjects($this->elements);return true;}else {trigger_error("First argument must be an array.", E_USER_WARNING);return false;}}public function setObjects($v96c3e113f86dfac469d4412a3a3b2517) {if(is_array($v96c3e113f86dfac469d4412a3a3b2517)) {foreach ($v96c3e113f86dfac469d4412a3a3b2517 as $vbe8f80182e0c983916da7338c2c1c040) $this->objects[] = ($vbe8f80182e0c983916da7338c2c1c040 instanceof umiObject) ? $vbe8f80182e0c983916da7338c2c1c040->getId() : $vbe8f80182e0c983916da7338c2c1c040;return true;}else {trigger_error("First argument must be an array.", E_USER_WARNING);return false;}}public function run() {if (is_array($this->elements)) {$v6a7f245843454cf4f28ad7c5e2572aa2 = $this->parseElements();}else {$v6a7f245843454cf4f28ad7c5e2572aa2 = "";}$v5891da2d64975cae48d175d1e001f5da = $this->parseObjects();$vad5f82e879a9c5d6b5b442eb37e50551  = $this->getDomainPath() . "/";$v08b89d3caec7cf7e0564ae3bf9683308 = $this->getSiteName();$v0afd9202ba86aa11ce63ad7007e7990b = strtoupper(md5($v08b89d3caec7cf7e0564ae3bf9683308));$v5dc123223f4465124f5eab5e97d72725 = new umiDate(time());$vd1701d1bb6704c552b420dae7dd7f10b = $v5dc123223f4465124f5eab5e97d72725->getFormattedDate("U");$ve9a61fb3cc6ea8c818ee0df10f5a8347  = $v5dc123223f4465124f5eab5e97d72725->getFormattedDate("r");$ve76021b36d9fe4320c6fa8690f158a5a  = $v5dc123223f4465124f5eab5e97d72725->getFormattedDate(DATE_ATOM);$vb9ef165b255673dde47bff07f4390fb1 = '<' . '?xml version="1.0" encoding="utf-8"?' . '>';$vb9ef165b255673dde47bff07f4390fb1 .= <<<END

<umicmsDump>
	<siteName><![CDATA[{$v08b89d3caec7cf7e0564ae3bf9683308}]]></siteName>
	<domain>{$vad5f82e879a9c5d6b5b442eb37e50551}</domain>
	<sourceId><![CDATA[{$v0afd9202ba86aa11ce63ad7007e7990b}]]></sourceId>

	<generateTime>
			<timestamp><![CDATA[{$vd1701d1bb6704c552b420dae7dd7f10b}]]></timestamp>
			<RFC><![CDATA[{$ve9a61fb3cc6ea8c818ee0df10f5a8347}]]></RFC>
			<UTC><![CDATA[{$ve76021b36d9fe4320c6fa8690f158a5a}]]></UTC>
	</generateTime>

{$v6a7f245843454cf4f28ad7c5e2572aa2}

{$v5891da2d64975cae48d175d1e001f5da}

</umicmsDump>
END;$this->dump = $vb9ef165b255673dde47bff07f4390fb1;}public function getResultFile() {return $this->dump;}public function saveResultFile($v6a2a431fe8b621037ea949531c28551d) {file_put_contents($v6a2a431fe8b621037ea949531c28551d, $this->dump);chmod($v6a2a431fe8b621037ea949531c28551d, 0777);}protected function parseObjects() {$v5891da2d64975cae48d175d1e001f5da = "";static $vcf9f3fde7326f1d8e64205f0e07a3695 = 0;if(is_null($this->objects)) {return $v5891da2d64975cae48d175d1e001f5da;}foreach ($this->objects as $v865c0c0b4ab0e063e5caa3387c1a8741 => $vaf31437ce61345f416579830a98c91e5){$v5891da2d64975cae48d175d1e001f5da .= $this->parseObject($vaf31437ce61345f416579830a98c91e5);umiObjectsCollection::getInstance()->unloadObject($vaf31437ce61345f416579830a98c91e5);}return $v5891da2d64975cae48d175d1e001f5da;}protected function parseObject($vaf31437ce61345f416579830a98c91e5) {if(!($va8cfde6331bd59eb2ac96f8911c4b666 = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5))) {trigger_error("Can't load object #{$vaf31437ce61345f416579830a98c91e5}", E_USER_WARNING);return false;}$v8aa5703199edd89cb7041c8f375f2c0e  = $va8cfde6331bd59eb2ac96f8911c4b666->getName();$v87306dd4235ed712ebc07fe169b76f83  = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();$v975a727c9c61eaed4d1a08613b177ca8 = (int) $va8cfde6331bd59eb2ac96f8911c4b666->getIsLocked();$v267678086336c1646720ce11b42efe04 = $this->parsePropertyBlocks($va8cfde6331bd59eb2ac96f8911c4b666);$vd59a2244b2acdab008cbf3397e3f376a = $this->parseStoresBlock($va8cfde6331bd59eb2ac96f8911c4b666);$vda7a81e962241a2c5e2471dde07172ad = <<<END
	<object id="{$vaf31437ce61345f416579830a98c91e5}" typeId="{$v87306dd4235ed712ebc07fe169b76f83}" isLocked="{$v975a727c9c61eaed4d1a08613b177ca8}">
		<name><![CDATA[{$v8aa5703199edd89cb7041c8f375f2c0e}]]></name>

{$v267678086336c1646720ce11b42efe04}
{$vd59a2244b2acdab008cbf3397e3f376a}

	</object>


END;   unset($v267678086336c1646720ce11b42efe04);unset($va8cfde6331bd59eb2ac96f8911c4b666);return $vda7a81e962241a2c5e2471dde07172ad;}protected function parsePropertyBlocks(umiObject $va8cfde6331bd59eb2ac96f8911c4b666) {$v87306dd4235ed712ebc07fe169b76f83 = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();if(!$v87306dd4235ed712ebc07fe169b76f83) return false;$v7ae7003da59ae71dcc9f8638ef50593d = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);$v1471e4e05a4db95d353cc867fe317314 = $v7ae7003da59ae71dcc9f8638ef50593d->getFieldsGroupsList();$v1ec69b8024b343837d05dd646df226fc = "";foreach($v1471e4e05a4db95d353cc867fe317314 as $vdb0f6f37ebeb6ea09489124345af2a45) {$veeeb23fbd23e52a6a6ff78b9f18cbc4e  = $vdb0f6f37ebeb6ea09489124345af2a45->getName();$vd7362b6e3ba1f2a7c022a9d864601ecc  = $vdb0f6f37ebeb6ea09489124345af2a45->getTitle();$v2705faa7cf2cc5a2ad39111317b9cb84 = (int) $vdb0f6f37ebeb6ea09489124345af2a45->getIsLocked();$v5c836eaf9a3ec923fc13d2784e3168e9 = (int) $vdb0f6f37ebeb6ea09489124345af2a45->getIsVisible();if (in_array($veeeb23fbd23e52a6a6ff78b9f18cbc4e, array("locks", "rate_voters"))) {continue;}$v9ff69144c9c536063fb2753e2242da46 = $this->parseProperty($va8cfde6331bd59eb2ac96f8911c4b666, $vdb0f6f37ebeb6ea09489124345af2a45);$v1ec69b8024b343837d05dd646df226fc .= <<<END
		<propertiesBlock isLocked="{$v2705faa7cf2cc5a2ad39111317b9cb84}" isPublic="{$v5c836eaf9a3ec923fc13d2784e3168e9}">
			<name><![CDATA[{$veeeb23fbd23e52a6a6ff78b9f18cbc4e}]]></name>
			<title><![CDATA[{$vd7362b6e3ba1f2a7c022a9d864601ecc}]]></title>

{$v9ff69144c9c536063fb2753e2242da46}
		</propertiesBlock>


END;   unset($v9ff69144c9c536063fb2753e2242da46);}unset($v1471e4e05a4db95d353cc867fe317314);return $v1ec69b8024b343837d05dd646df226fc;}protected function parseStoresBlock(umiObject $va8cfde6331bd59eb2ac96f8911c4b666) {$v54ee9af2cf1cf33279404c601e2841a1 = $va8cfde6331bd59eb2ac96f8911c4b666->getValue("store_amounts");$vfbd79507bfe8e92ae14ee624160ad6d2 = umiObjectsCollection::getInstance();if(is_array($v54ee9af2cf1cf33279404c601e2841a1)) {$v61af09f34bc001f3b6d9139687a723fd = "";foreach($v54ee9af2cf1cf33279404c601e2841a1 as $vf00bed6045b135e90e5197e7d1e37941) {$vcc39dcf1a23d955276228b460fc4aabc = $vfbd79507bfe8e92ae14ee624160ad6d2->getObject($vf00bed6045b135e90e5197e7d1e37941);if (!$vcc39dcf1a23d955276228b460fc4aabc instanceof umiObject) continue;$v7473547c72c42fe58cd6ddf3e925b22b = $vcc39dcf1a23d955276228b460fc4aabc->getValue("store_id");$v8cd892b7b97ef9489ae4479d3f4ef0fc = $vfbd79507bfe8e92ae14ee624160ad6d2->getObject($v7473547c72c42fe58cd6ddf3e925b22b);if (!$v8cd892b7b97ef9489ae4479d3f4ef0fc instanceof umiObject) continue;$vb7cd129c427cf6ae86798630b98d06aa = $v8cd892b7b97ef9489ae4479d3f4ef0fc->getName();$ve9f40e1f1d1658681dad2dac4ae0971e = $vcc39dcf1a23d955276228b460fc4aabc->getValue("amount");$v61af09f34bc001f3b6d9139687a723fd .= <<<END

						<store id="{$vb7cd129c427cf6ae86798630b98d06aa}">
							<amount>{$ve9f40e1f1d1658681dad2dac4ae0971e}</amount>
						</store>

END;    }return <<<END
					<storesBlock>
						{$v61af09f34bc001f3b6d9139687a723fd}
					</storesBlock>
END;   }return "";}protected function parseProperty(umiObject $va8cfde6331bd59eb2ac96f8911c4b666, umiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45) {$v74693d2fc58b46bd06410f278e39aa71 = "";$vd05b6ed7d2345020440df396d6da7f73 = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();foreach($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {$v73f329f154a663bfda020aadcdd0b775  = $v06e3d36fa30cea095545139854ad1fb9->getName();$v133479bebf56554d434d59f53992e221  = $v06e3d36fa30cea095545139854ad1fb9->getTitle();$v5d17718c024b76565e2df33fced306ea  = $v06e3d36fa30cea095545139854ad1fb9->getTip();$ve2763042762c80c9a6b0be4da2cbe6f2 = (int) $v06e3d36fa30cea095545139854ad1fb9->getIsLocked();$v2dda6d1dda7c17f80b9a8f3e1bae58f9 = (int) $v06e3d36fa30cea095545139854ad1fb9->getIsVisible();$v4302d2aed2186d4c573c94c3833e5ea6 = (int) $v06e3d36fa30cea095545139854ad1fb9->getIsInSearch();$vde794a8a1ac8e400923460b137ddac76 = (int) $v06e3d36fa30cea095545139854ad1fb9->getIsInFilter();$v9e670cc5a0728bf2df6a7753fc9a40f4  = $v06e3d36fa30cea095545139854ad1fb9->getGuideId();$v519504d7d4beb745dac24ccfb6c1d7c9  = $v06e3d36fa30cea095545139854ad1fb9->getFieldType();$v5c4e252909242b24243818048235620d = (int) $v519504d7d4beb745dac24ccfb6c1d7c9->getIsMultiple();$v983560f49ede87197144b22c810a5087 = (string) $v519504d7d4beb745dac24ccfb6c1d7c9->getDataType();$vf09cc7ee3a9a93273f4b80601cafb00c = $this->parseValues($va8cfde6331bd59eb2ac96f8911c4b666, $v06e3d36fa30cea095545139854ad1fb9);$v74693d2fc58b46bd06410f278e39aa71 .= <<<END

			<property isLocked="{$ve2763042762c80c9a6b0be4da2cbe6f2}" isPublic="{$v2dda6d1dda7c17f80b9a8f3e1bae58f9}">
				<name><![CDATA[{$v73f329f154a663bfda020aadcdd0b775}]]></name>
				<title><![CDATA[{$v133479bebf56554d434d59f53992e221}]]></title>

				<fieldType><![CDATA[{$v983560f49ede87197144b22c810a5087}]]></fieldType>
				<isMultiple>{$v5c4e252909242b24243818048235620d}</isMultiple>
				<isIndexed>{$v4302d2aed2186d4c573c94c3833e5ea6}</isIndexed>
				<isFilterable>{$vde794a8a1ac8e400923460b137ddac76}</isFilterable>

				<guideId>{$v9e670cc5a0728bf2df6a7753fc9a40f4}</guideId>

				<tip><![CDATA[{$v5d17718c024b76565e2df33fced306ea}]]></tip>

				<values>
{$vf09cc7ee3a9a93273f4b80601cafb00c}
				</values>
			</property>
END;    unset($vf09cc7ee3a9a93273f4b80601cafb00c);}unset($vd05b6ed7d2345020440df396d6da7f73);return $v74693d2fc58b46bd06410f278e39aa71;}protected function parseValues(umiObject $va8cfde6331bd59eb2ac96f8911c4b666, umiField $v06e3d36fa30cea095545139854ad1fb9) {$v519504d7d4beb745dac24ccfb6c1d7c9  = $v06e3d36fa30cea095545139854ad1fb9->getFieldType();$v5c4e252909242b24243818048235620d = (int) $v519504d7d4beb745dac24ccfb6c1d7c9->getIsMultiple();$v983560f49ede87197144b22c810a5087 = (string) $v519504d7d4beb745dac24ccfb6c1d7c9->getDataType();$vf09cc7ee3a9a93273f4b80601cafb00c = $va8cfde6331bd59eb2ac96f8911c4b666->getValue($v06e3d36fa30cea095545139854ad1fb9->getName());$vf09cc7ee3a9a93273f4b80601cafb00c = (is_array($vf09cc7ee3a9a93273f4b80601cafb00c)) ? $vf09cc7ee3a9a93273f4b80601cafb00c : Array($vf09cc7ee3a9a93273f4b80601cafb00c);switch($v983560f49ede87197144b22c810a5087) {case "img_file": {$vde5b1cd11c4544e7f3fe792f2e0d8b8b = Array();foreach($vf09cc7ee3a9a93273f4b80601cafb00c as $vf19e92e810d08b6cf2d0265b779064d9) {if(!$vf19e92e810d08b6cf2d0265b779064d9) continue;$vde5b1cd11c4544e7f3fe792f2e0d8b8b[] = Array (          "value" => $vf19e92e810d08b6cf2d0265b779064d9->getFilePath()         );}break;}case "relation": {$vde5b1cd11c4544e7f3fe792f2e0d8b8b = Array();foreach($vf09cc7ee3a9a93273f4b80601cafb00c as $vf19e92e810d08b6cf2d0265b779064d9) {$vf19e92e810d08b6cf2d0265b779064d9 = umiObjectsCollection::getInstance()->getObject($vf19e92e810d08b6cf2d0265b779064d9);if(!$vf19e92e810d08b6cf2d0265b779064d9) continue;$v818ad5ef6588e140ecb9f81e810c028a = $vf19e92e810d08b6cf2d0265b779064d9->getId();if(!in_array($v818ad5ef6588e140ecb9f81e810c028a, $this->objects)) {$this->objects[] = $v818ad5ef6588e140ecb9f81e810c028a;}$vde5b1cd11c4544e7f3fe792f2e0d8b8b[] = Array (          "value" => $vf19e92e810d08b6cf2d0265b779064d9->getName(),          "id" => $vf19e92e810d08b6cf2d0265b779064d9->getId()         );}break;}case "symlink": {$vde5b1cd11c4544e7f3fe792f2e0d8b8b = Array();foreach($vf09cc7ee3a9a93273f4b80601cafb00c as $vf19e92e810d08b6cf2d0265b779064d9) {if(!$vf19e92e810d08b6cf2d0265b779064d9) continue;$vde5b1cd11c4544e7f3fe792f2e0d8b8b[] = Array (          "value" => $vf19e92e810d08b6cf2d0265b779064d9->getName(),          "id" => $vf19e92e810d08b6cf2d0265b779064d9->getId(),          "link" => $this->getDomainPath() . umiHierarchy::getInstance()->getPathById($vf19e92e810d08b6cf2d0265b779064d9->getId())         );}break;}case "date": {$vde5b1cd11c4544e7f3fe792f2e0d8b8b = Array();foreach($vf09cc7ee3a9a93273f4b80601cafb00c as $vf19e92e810d08b6cf2d0265b779064d9) {if(!$vf19e92e810d08b6cf2d0265b779064d9) continue;$vde5b1cd11c4544e7f3fe792f2e0d8b8b[] = Array (          "timestamp" => $vf19e92e810d08b6cf2d0265b779064d9->getFormattedDate("U"),          "RFC"  => $vf19e92e810d08b6cf2d0265b779064d9->getFormattedDate("r"),          "UTC"  => $vf19e92e810d08b6cf2d0265b779064d9->getFormattedDate(DATE_ATOM)         );}break;}default: {$vde5b1cd11c4544e7f3fe792f2e0d8b8b = Array();foreach($vf09cc7ee3a9a93273f4b80601cafb00c as $vf19e92e810d08b6cf2d0265b779064d9) {$vde5b1cd11c4544e7f3fe792f2e0d8b8b[] = Array (          "value" => $vf19e92e810d08b6cf2d0265b779064d9,          "id" => NULL         );}break;}}$vf09cc7ee3a9a93273f4b80601cafb00c = "";foreach($vde5b1cd11c4544e7f3fe792f2e0d8b8b as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if(array_key_exists('value',$v3a6d0284e743dc4a9b86f97d6dd1a3bf)) $v2063c1608d6e0baf80249c42e2be5804 = $v3a6d0284e743dc4a9b86f97d6dd1a3bf['value'];if(array_key_exists('id',$v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {if(array_key_exists('timestamp',$v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {$vf09cc7ee3a9a93273f4b80601cafb00c .= <<<END
							<value>
								<timestamp><![CDATA[{$v3a6d0284e743dc4a9b86f97d6dd1a3bf['timestamp']}]]></timestamp>
								<RFC><![CDATA[{$v3a6d0284e743dc4a9b86f97d6dd1a3bf['RFC']}]]></RFC>
								<UTC><![CDATA[{$v3a6d0284e743dc4a9b86f97d6dd1a3bf['UTC']}]]></UTC>
							</value>

END;     }else {$v7ffc4d510260a8544e5550e62ec56bc1 = !is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf['id']) ? ' id="' . $v3a6d0284e743dc4a9b86f97d6dd1a3bf['id'] . '"' : '';$vf09cc7ee3a9a93273f4b80601cafb00c .= <<<END
							<value{$v7ffc4d510260a8544e5550e62ec56bc1}><![CDATA[{$v2063c1608d6e0baf80249c42e2be5804}]]></value>

END;     }}else {if(array_key_exists('timestamp',$v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {$vf09cc7ee3a9a93273f4b80601cafb00c .= <<<END
							<value>
								<timestamp><![CDATA[{$v3a6d0284e743dc4a9b86f97d6dd1a3bf['timestamp']}]]></timestamp>
								<RFC><![CDATA[{$v3a6d0284e743dc4a9b86f97d6dd1a3bf['RFC']}]]></RFC>
								<UTC><![CDATA[{$v3a6d0284e743dc4a9b86f97d6dd1a3bf['UTC']}]]></UTC>
							</value>

END;     }else {$vf09cc7ee3a9a93273f4b80601cafb00c .= <<<END
							<value><![CDATA[{$v2063c1608d6e0baf80249c42e2be5804}]]></value>

END;     }if(!array_key_exists('value', $v3a6d0284e743dc4a9b86f97d6dd1a3bf)) continue;if(array_key_exists('timestamp',$v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {$vb80bb7740288fda1f201890375a60c8f = $v3a6d0284e743dc4a9b86f97d6dd1a3bf['id'];$v2a304a1348456ccd2234cd71a81bd338 = array_key_exists("link", $v3a6d0284e743dc4a9b86f97d6dd1a3bf) ? " link=\"{$v3a6d0284e743dc4a9b86f97d6dd1a3bf['link']}\"" : "";$vf09cc7ee3a9a93273f4b80601cafb00c .= <<<END
							<value id="{$vb80bb7740288fda1f201890375a60c8f}"{$v2a304a1348456ccd2234cd71a81bd338}><![CDATA[{$v2063c1608d6e0baf80249c42e2be5804}]]></value>
END;     }}}unset($vde5b1cd11c4544e7f3fe792f2e0d8b8b);return $vf09cc7ee3a9a93273f4b80601cafb00c;}protected function getDomainPath() {return "http://" . $_SERVER['HTTP_HOST'];}protected function getSiteName() {$va072dbbe3bd3b2f40eaf73aa4066ede7 = cmsController::getInstance();$v78e6dd7a49f5b0cb2106a3a434dd5c86     = $va072dbbe3bd3b2f40eaf73aa4066ede7->getCurrentLang()->getId();$v662cbf1253ac7d8750ed9190c52163e5   = $va072dbbe3bd3b2f40eaf73aa4066ede7->getCurrentDomain()->getId();$vb1444fb0c07653567ad325aa25d4e37a     = regedit::getInstance();$v851f5ac9941d720844d143ed9cfcf60a      = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/title_prefix/{$v78e6dd7a49f5b0cb2106a3a434dd5c86}/{$v662cbf1253ac7d8750ed9190c52163e5}");$vf418892c852ccf5c86998e89045e8063    = def_module::parseTPLMacroses(macros_sitename());if(strlen($v851f5ac9941d720844d143ed9cfcf60a))    return $v851f5ac9941d720844d143ed9cfcf60a . " " .$vf418892c852ccf5c86998e89045e8063;else    return $vf418892c852ccf5c86998e89045e8063;}protected function fillObjects($v0565942fb39be0978d5774cfa5320fcb) {foreach($v0565942fb39be0978d5774cfa5320fcb as $v7057e8409c7c531a1a6e9ac3df4ed549) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);if (!$v8e2dcfd7e7e24b1ca76c1193f645902b) continue;$vaf31437ce61345f416579830a98c91e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getId();if(!is_array($this->objects) || !in_array($vaf31437ce61345f416579830a98c91e5, $this->objects)) {$this->objects[] = $vaf31437ce61345f416579830a98c91e5;}}}protected function parseElements() {$v0565942fb39be0978d5774cfa5320fcb = $this->elements;$v6a7f245843454cf4f28ad7c5e2572aa2 = "";$va5d4db7ed95dbef22bdd6bd8036da60a = umiHierarchy::getInstance()->forceAbsolutePath(true);foreach($v0565942fb39be0978d5774cfa5320fcb as $v7057e8409c7c531a1a6e9ac3df4ed549) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);if(!$v8e2dcfd7e7e24b1ca76c1193f645902b) continue;$vb068931cc450442b63f5b3d276ea4297   = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();$vd84ff935144e00c3e1d395c2379aca47  = $v8e2dcfd7e7e24b1ca76c1193f645902b->getAltName();$v2a304a1348456ccd2234cd71a81bd338   = umiHierarchy::getInstance()->getPathById($v7057e8409c7c531a1a6e9ac3df4ed549);$v6be379826b20cc58475f636e33f4606b  = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();$v0715f6d9497f93911417c9c324265771 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId();$vb946c44d711ade3b061653732977d043  = umiHierarchyTypesCollection::getInstance()->getType($v0715f6d9497f93911417c9c324265771);$v571927edeba34435dcef63324b2a4f86 = $vb946c44d711ade3b061653732977d043->getTitle();$v5cde3b79e1c913665469de8dc2f1f8b6 = $vb946c44d711ade3b061653732977d043->getName();$v28843f287b7e7d3ee4ad0be8761e325d = $vb946c44d711ade3b061653732977d043->getExt();$vd02e12eb6d6c3f6ebd763197df01e211   = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTplId();$vf9bdb7221804d6d17b654ec67c5a0735  = templatesCollection::getInstance()->getTemplate($vd02e12eb6d6c3f6ebd763197df01e211)->getFilename();$v78e6dd7a49f5b0cb2106a3a434dd5c86  = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();$v7572559ca86e781ba8fe8073a0b725c6   = langsCollection::getInstance()->getLang($v78e6dd7a49f5b0cb2106a3a434dd5c86);$vff8b918bc674d6a658430241e4a74574  = $v7572559ca86e781ba8fe8073a0b725c6->getTitle();$v753527be46567ad90a4203cf4b40d70e  = $v7572559ca86e781ba8fe8073a0b725c6->getPrefix();$v662cbf1253ac7d8750ed9190c52163e5  = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();$vad5f82e879a9c5d6b5b442eb37e50551   = domainsCollection::getInstance()->getDomain($v662cbf1253ac7d8750ed9190c52163e5);$vf9b9218cbe221f8b9f1292474aa6f3e4  = $vad5f82e879a9c5d6b5b442eb37e50551->getHost();$vaf31437ce61345f416579830a98c91e5  = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getId();$ve1c6c9ef2fcbe75f26f815c4ef2e60b4  = (int) $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsVisible();$v4264c638e0098acb172519b0436db099  = (int) $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive();$v3e04dc2abd929a9d02e2e0fa41d24bf9  = new umiDate($v8e2dcfd7e7e24b1ca76c1193f645902b->getUpdateTime());$v2e10faa7211633841eebf971b7056c0b = $v3e04dc2abd929a9d02e2e0fa41d24bf9->getFormattedDate("U");$vd4f11866a8f58f1071bd3ae29c935c5a  = $v3e04dc2abd929a9d02e2e0fa41d24bf9->getFormattedDate("r");$vc10cb84e1a90ce84ef3ee424c2b1a2ef  = $v3e04dc2abd929a9d02e2e0fa41d24bf9->getFormattedDate(DATE_ATOM);$ve05b19ee2921f914301c26bcc4fc8d5a = umiImportRelations::getInstance()->getNewIdRelation($this->source_id, $v6be379826b20cc58475f636e33f4606b);$ve7398137766d8a8621035454620c1317 = umiImportRelations::getInstance()->getNewIdRelation($this->source_id, $v7057e8409c7c531a1a6e9ac3df4ed549);if ($v7057e8409c7c531a1a6e9ac3df4ed549 && !$ve7398137766d8a8621035454620c1317) {umiImportRelations::getInstance()->setIdRelation($this->source_id, $v7057e8409c7c531a1a6e9ac3df4ed549, $v7057e8409c7c531a1a6e9ac3df4ed549);$ve7398137766d8a8621035454620c1317 = $v7057e8409c7c531a1a6e9ac3df4ed549;}if ($v6be379826b20cc58475f636e33f4606b && !$ve05b19ee2921f914301c26bcc4fc8d5a) {umiImportRelations::getInstance()->setIdRelation($this->source_id, $v6be379826b20cc58475f636e33f4606b, $v6be379826b20cc58475f636e33f4606b);$ve05b19ee2921f914301c26bcc4fc8d5a = $v6be379826b20cc58475f636e33f4606b;}$v6a7f245843454cf4f28ad7c5e2572aa2 .= <<<END
	<element id="{$ve7398137766d8a8621035454620c1317}" parentId="{$ve05b19ee2921f914301c26bcc4fc8d5a}" objectId="{$vaf31437ce61345f416579830a98c91e5}" is_visible="{$ve1c6c9ef2fcbe75f26f815c4ef2e60b4}" is_active="{$v4264c638e0098acb172519b0436db099}">
		<name><![CDATA[{$vb068931cc450442b63f5b3d276ea4297}]]></name>
		<link><![CDATA[{$v2a304a1348456ccd2234cd71a81bd338}]]></link>
		<altName><![CDATA[{$vd84ff935144e00c3e1d395c2379aca47}]]></altName>

		<templateId><![CDATA[{$vd02e12eb6d6c3f6ebd763197df01e211}]]></templateId>
		<templatePath><![CDATA[{$vf9bdb7221804d6d17b654ec67c5a0735}]]></templatePath>
		<lang prefix="{$v753527be46567ad90a4203cf4b40d70e}"><![CDATA[{$vff8b918bc674d6a658430241e4a74574}]]></lang>
		<domain><![CDATA[{$vf9b9218cbe221f8b9f1292474aa6f3e4}]]></domain>

		<behaviour>
			<title><![CDATA[{$v571927edeba34435dcef63324b2a4f86}]]></title>
			<module><![CDATA[{$v5cde3b79e1c913665469de8dc2f1f8b6}]]></module>
			<method><![CDATA[{$v28843f287b7e7d3ee4ad0be8761e325d}]]></method>
		</behaviour>

		<updateTime>
				<timestamp><![CDATA[{$v2e10faa7211633841eebf971b7056c0b}]]></timestamp>
				<RFC><![CDATA[{$vd4f11866a8f58f1071bd3ae29c935c5a}]]></RFC>
				<UTC><![CDATA[{$vc10cb84e1a90ce84ef3ee424c2b1a2ef}]]></UTC>
		</updateTime>
	</element>


END;    unset($v8e2dcfd7e7e24b1ca76c1193f645902b);umiHierarchy::getInstance()->unloadElement($v7057e8409c7c531a1a6e9ac3df4ed549);}umiHierarchy::getInstance()->forceAbsolutePath($va5d4db7ed95dbef22bdd6bd8036da60a);unset($v0565942fb39be0978d5774cfa5320fcb);return $v6a7f245843454cf4f28ad7c5e2572aa2;}};interface iUmiXmlImporter {public function __construct();public function ignoreNewFields($v5227aad53a7f2572da72bc1a1c6d6ab0 = false);public function ignoreNewItems($vd621ea50e0b355d2e130b94c9772aa1b = false);public function loadXmlString($v58309fbfe87fa90ec9f4b9d78ead9d77);public function loadXmlFile($vcfe8c11ab13ccb7cbc8a5d0ca12a86c5);public function analyzeXml();public function importXml();public function getImportedElementsCount();};class umiXmlImporter implements iUmiXmlImporter {protected $ignore_new_fields = false,    $ignore_new_items = false,    $is_xml_analyzed = false;protected $xml;protected $xml_elements = Array(),    $xml_objects = Array(),    $xml_stores = Array(),    $xml_types = Array();protected $source_id = 1;protected $importedElements = 0,     $importedElementsArr = Array(),     $createdElements = 0,     $deletedElements = 0,     $updatedElements = 0,     $importErrors = 0;protected $importLog = array();protected $destination_element_id = 0;public function __construct() {}public function setDestinationElementId($v8e2dcfd7e7e24b1ca76c1193f645902b) {if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$this->destination_element_id = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();return true;}if (umiHierarchy::getInstance()->getElement($v8e2dcfd7e7e24b1ca76c1193f645902b) instanceof umiHierarchyElement) {$this->destination_element_id = $v8e2dcfd7e7e24b1ca76c1193f645902b;return true;}return false;}public function ignoreNewFields($v16766072928ade37ad6cfb3f5f3a1b92 = NULL) {$vee59c1569ba29f1d7595628815a773a5 = $this->ignore_new_fields;if(!is_null($v16766072928ade37ad6cfb3f5f3a1b92)) {$this->ignore_new_fields = (bool) $v16766072928ade37ad6cfb3f5f3a1b92;}return $vee59c1569ba29f1d7595628815a773a5;}public function ignoreNewItems($ve90cfd0adc4ee5f162118a96c60bc216 = NULL) {$vee59c1569ba29f1d7595628815a773a5 = $this->ignore_new_items;if(!is_null($ve90cfd0adc4ee5f162118a96c60bc216)) {$this->ignore_new_items = (bool) $ve90cfd0adc4ee5f162118a96c60bc216;}return $vee59c1569ba29f1d7595628815a773a5;}public function loadXmlString($v2d04a630b197c6991c3e00e003f88be4) {$v0f635d0e0f3874fff8b581c132e6c7a7 = simplexml_load_string($v2d04a630b197c6991c3e00e003f88be4);return $this->loadXml($v0f635d0e0f3874fff8b581c132e6c7a7);}public function loadXmlFile($va30c2e8bafac20e81c697b2396c8a3b0) {if(!is_file($va30c2e8bafac20e81c697b2396c8a3b0)) {trigger_error("XML file {$va30c2e8bafac20e81c697b2396c8a3b0} not found", E_USER_WARNING);return false;}if(!is_readable($va30c2e8bafac20e81c697b2396c8a3b0)) {trigger_error("XML file {$va30c2e8bafac20e81c697b2396c8a3b0} is not readable", E_USER_WARNING);return false;}$v0f635d0e0f3874fff8b581c132e6c7a7 = simplexml_load_file($va30c2e8bafac20e81c697b2396c8a3b0);return $this->loadXml($v0f635d0e0f3874fff8b581c132e6c7a7);}protected function loadXml($v0f635d0e0f3874fff8b581c132e6c7a7) {if(is_object($v0f635d0e0f3874fff8b581c132e6c7a7)) {$this->xml = $v0f635d0e0f3874fff8b581c132e6c7a7;return true;}else {trigger_error("Failed to read xml-content", E_USER_WARNING);return false;}}public function analyzeXml() {$va3e987edaf3270b0a5b8b012ea24688f = (string) $this->xml->sourceId;$this->source_id = umiImportRelations::getInstance()->addNewSource($va3e987edaf3270b0a5b8b012ea24688f);foreach($this->xml->element as $v6b5e36ca20d9b7f16d58365fbb6666cc) {$this->analyzeElementNode($v6b5e36ca20d9b7f16d58365fbb6666cc);}foreach($this->xml->object as $v6b5e36ca20d9b7f16d58365fbb6666cc) {$va9cecbe3552e2561ce80cf4fe36d259c = (string) $v6b5e36ca20d9b7f16d58365fbb6666cc->attributes()->id;if(array_key_exists($va9cecbe3552e2561ce80cf4fe36d259c, $this->xml_objects)) {$this->analyzeObjectNode($v6b5e36ca20d9b7f16d58365fbb6666cc);}}}protected function analyzeElementNode(SimpleXMLElement $vdafb8b287b8f84de951377d662f0bb07) {$v7057e8409c7c531a1a6e9ac3df4ed549 =  (string) $vdafb8b287b8f84de951377d662f0bb07->attributes()->id;$v99babaa1f2d4129d12be54e74769f513 = (string) $vdafb8b287b8f84de951377d662f0bb07->attributes()->parentId;$v95f4ed1eb77470b0ab298fe5f354a1d2 = (string) $vdafb8b287b8f84de951377d662f0bb07->attributes()->objectId;$v6047ed7401a9473da4179b068871e34f = (string) $vdafb8b287b8f84de951377d662f0bb07->altName;$v712546bad453a4d99cb79be316f6e64b = is_object($vdafb8b287b8f84de951377d662f0bb07->attributes()->is_visible) ? (string) $vdafb8b287b8f84de951377d662f0bb07->attributes()->is_visible : NULL;$v53f070b923b86cc3c1b95e9950674c7c = is_object($vdafb8b287b8f84de951377d662f0bb07->attributes()->is_active) ? (string) $vdafb8b287b8f84de951377d662f0bb07->attributes()->is_active : NULL;$v25f5c3dfce7a3048a8e9f70bad15bdd3 = is_object($vdafb8b287b8f84de951377d662f0bb07->attributes()->is_deleted) ? (string) $vdafb8b287b8f84de951377d662f0bb07->attributes()->is_deleted : NULL;if(in_array($v7057e8409c7c531a1a6e9ac3df4ed549, $this->importedElementsArr)) {return false;}$v22884db148f0ffb0d830ba431102b0b5 = $vdafb8b287b8f84de951377d662f0bb07->behaviour->module;$vea9f6aca279138c58f705c8d4cb4b8ce = $vdafb8b287b8f84de951377d662f0bb07->behaviour->method;$v108f182d36befa7e9828ecfa700cef7d = umiHierarchyTypesCollection::getInstance()->getTypeByName((string) $v22884db148f0ffb0d830ba431102b0b5, (string) $vea9f6aca279138c58f705c8d4cb4b8ce);if($v108f182d36befa7e9828ecfa700cef7d === false) {trigger_error("Unknown element's module/method", E_USER_ERROR);return false;}$v676e8343c1739a5f3d8893a0ebdf5d63 = (string) $vdafb8b287b8f84de951377d662f0bb07->templatePath;$v42e506e228f21138f6dda1d82cbba619 = $v108f182d36befa7e9828ecfa700cef7d->getId();$this->xml_elements[$v7057e8409c7c531a1a6e9ac3df4ed549] = Array(       "old_element_id" => $v7057e8409c7c531a1a6e9ac3df4ed549,       "old_parent_id" => $v99babaa1f2d4129d12be54e74769f513,       "old_element_object_id" => $v95f4ed1eb77470b0ab298fe5f354a1d2,       "element_hierarchy_type_id" => $v42e506e228f21138f6dda1d82cbba619,       "element_filepath" => $v676e8343c1739a5f3d8893a0ebdf5d63,       "old_element_alt_name" => $v6047ed7401a9473da4179b068871e34f,       "element_is_visible" => $v712546bad453a4d99cb79be316f6e64b,       "element_is_active" => $v53f070b923b86cc3c1b95e9950674c7c,       "element_is_deleted" => $v25f5c3dfce7a3048a8e9f70bad15bdd3       );$this->xml_objects[$v95f4ed1eb77470b0ab298fe5f354a1d2] = Array(       "old_element_id" => $v7057e8409c7c531a1a6e9ac3df4ed549,       "element_hierarcy_type_id" => $v42e506e228f21138f6dda1d82cbba619,       "is_linked" => true   );}protected function analyzeObjectNode(SimpleXMLElement $vbfb9b1cd25f05560dfdda8bca7dac185) {$vaf31437ce61345f416579830a98c91e5 = (string) $vbfb9b1cd25f05560dfdda8bca7dac185->attributes()->id;$v87306dd4235ed712ebc07fe169b76f83 = (string) $vbfb9b1cd25f05560dfdda8bca7dac185->attributes()->typeId;$vedc7225bd4c7ca9e2cab1d7126aa5c66 = (string) $vbfb9b1cd25f05560dfdda8bca7dac185->attributes()->typeName;$vac1626d9f9d3685491cc6c06cf195a3d = $this->xml_objects[$vaf31437ce61345f416579830a98c91e5];$vac1626d9f9d3685491cc6c06cf195a3d['old_object_id'] = $vaf31437ce61345f416579830a98c91e5;$vac1626d9f9d3685491cc6c06cf195a3d['old_type_id'] = $v87306dd4235ed712ebc07fe169b76f83;$vac1626d9f9d3685491cc6c06cf195a3d['type_name'] = $vedc7225bd4c7ca9e2cab1d7126aa5c66;$vac1626d9f9d3685491cc6c06cf195a3d['old_name'] = (string) $vbfb9b1cd25f05560dfdda8bca7dac185->name;$vac1626d9f9d3685491cc6c06cf195a3d['props'] = $this->analyzeObjectPropertiesBlockNode($vbfb9b1cd25f05560dfdda8bca7dac185->propertiesBlock, $v87306dd4235ed712ebc07fe169b76f83);if ($vbfb9b1cd25f05560dfdda8bca7dac185->storesBlock->store) {$this->analyzeObjectSoresInfo($vaf31437ce61345f416579830a98c91e5, $vbfb9b1cd25f05560dfdda8bca7dac185->storesBlock->store);}$this->xml_objects[$vaf31437ce61345f416579830a98c91e5] = $vac1626d9f9d3685491cc6c06cf195a3d;}protected function analyzeObjectPropertiesBlockNode(SimpleXMLElement $v198e8116ae17465abca88e97f359b81a, $v87306dd4235ed712ebc07fe169b76f83) {if(!array_key_exists($v87306dd4235ed712ebc07fe169b76f83, $this->xml_types)) {$this->xml_types[$v87306dd4235ed712ebc07fe169b76f83] = Array();$this->xml_types[$v87306dd4235ed712ebc07fe169b76f83]['is_base'] = true;$this->xml_types[$v87306dd4235ed712ebc07fe169b76f83]['props'] = Array();}$v1a9413baa5cb34046f8b2472dc0382c8 = Array();foreach($v198e8116ae17465abca88e97f359b81a as $vfe53ab6ad20b6c24efeeb7c181ad88c1) {$v271d58c8413c3b66c32d16e54cc452ba = (string) $vfe53ab6ad20b6c24efeeb7c181ad88c1->title;$v161c76bbd5a451c8a6b9eb76ee6b6498 = (string) $vfe53ab6ad20b6c24efeeb7c181ad88c1->name;$vf0f68d8e24c9280eacba0ba7c3ddc0a6 = (string) $vfe53ab6ad20b6c24efeeb7c181ad88c1->isPublic;foreach($vfe53ab6ad20b6c24efeeb7c181ad88c1->property as $v3694d39d4419096025f79a7e72a2a43f) {$vb93ab79a25fda37f76a5beb706e7999b = (string) $v3694d39d4419096025f79a7e72a2a43f->title;$vdfc394bd05a4b48161c790034af522a8 = (string) $v3694d39d4419096025f79a7e72a2a43f->name;$vfa041bc0a81b4595e902278f42cbf9d4 = (string) $v3694d39d4419096025f79a7e72a2a43f->tip;$v654741aedfca3e4fc2f0f0246e8c3bd8 = (string) $v3694d39d4419096025f79a7e72a2a43f->isMultiple;$vd32d563354e11708656be8c192a1b235 = (string) $v3694d39d4419096025f79a7e72a2a43f->isIndexed;$v57563115e8f09aa8368e898c2bfe62e0 = (string) $v3694d39d4419096025f79a7e72a2a43f->isFilterable;$v994d25f616e2141faa36e4eed03d7d47 = (string) $v3694d39d4419096025f79a7e72a2a43f->isPublic;$v994d25f616e2141faa36e4eed03d7d47 = (bool)  $v3694d39d4419096025f79a7e72a2a43f->isPublic;$v1568d7dc6933bac8766232a78173c400 = (string) $v3694d39d4419096025f79a7e72a2a43f->guideId;$ve48c0b9cb2ae62c695b02c2950304cc3 = (string) $v3694d39d4419096025f79a7e72a2a43f->fieldType;$v8b2a89413a23bcdc2fa4f48518266787 = $this->extractValues($v3694d39d4419096025f79a7e72a2a43f->values);$v52e3817fff5250b5391ef85b1ce23bdb = (string) $v3694d39d4419096025f79a7e72a2a43f->values->attributes()->currency_code;if(!$vdfc394bd05a4b48161c790034af522a8) {$vdfc394bd05a4b48161c790034af522a8 = translit::convert($vb93ab79a25fda37f76a5beb706e7999b);}$v410e0a26c217dfabf8a5653e8f9e68ef = Array();$v410e0a26c217dfabf8a5653e8f9e68ef['title'] = $vb93ab79a25fda37f76a5beb706e7999b;$v410e0a26c217dfabf8a5653e8f9e68ef['name'] = $vdfc394bd05a4b48161c790034af522a8;$v410e0a26c217dfabf8a5653e8f9e68ef['tip'] = $vfa041bc0a81b4595e902278f42cbf9d4;$v410e0a26c217dfabf8a5653e8f9e68ef['is_multiple'] = $v654741aedfca3e4fc2f0f0246e8c3bd8;$v410e0a26c217dfabf8a5653e8f9e68ef['is_filterable'] = $v57563115e8f09aa8368e898c2bfe62e0;$v410e0a26c217dfabf8a5653e8f9e68ef['guide_id'] = $v1568d7dc6933bac8766232a78173c400;$v410e0a26c217dfabf8a5653e8f9e68ef['field_type'] = $ve48c0b9cb2ae62c695b02c2950304cc3;$v410e0a26c217dfabf8a5653e8f9e68ef['values'] = $v8b2a89413a23bcdc2fa4f48518266787;$v410e0a26c217dfabf8a5653e8f9e68ef['currency_code'] = $v52e3817fff5250b5391ef85b1ce23bdb;$v410e0a26c217dfabf8a5653e8f9e68ef['is_public'] = $v994d25f616e2141faa36e4eed03d7d47;$v410e0a26c217dfabf8a5653e8f9e68ef['prop_block_title'] = $v271d58c8413c3b66c32d16e54cc452ba;$v410e0a26c217dfabf8a5653e8f9e68ef['prop_block_name'] = $v161c76bbd5a451c8a6b9eb76ee6b6498;$v410e0a26c217dfabf8a5653e8f9e68ef['prop_block_is_public'] = $vf0f68d8e24c9280eacba0ba7c3ddc0a6;$this->xml_types[$v87306dd4235ed712ebc07fe169b76f83]['props'][$vdfc394bd05a4b48161c790034af522a8] = $v410e0a26c217dfabf8a5653e8f9e68ef;$v1a9413baa5cb34046f8b2472dc0382c8[$vdfc394bd05a4b48161c790034af522a8] = $v410e0a26c217dfabf8a5653e8f9e68ef;}}return $v1a9413baa5cb34046f8b2472dc0382c8;}protected function analyzeObjectSoresInfo($va77b1053cb200e022574f213c7553d88, SimpleXMLElement $v95baf4199d5b9b51afa6d4dd8468adb2) {foreach ($v95baf4199d5b9b51afa6d4dd8468adb2 as $ved5882848050676ac4477bf1b46ca2b4) {$v5d7d58f9cd945f9f3eb551a83caa0c42 = (string) $ved5882848050676ac4477bf1b46ca2b4->attributes()->id;$vbd047b181e82cec3af1400e7ee193be5 = (int) $ved5882848050676ac4477bf1b46ca2b4->amount;if (strlen($v5d7d58f9cd945f9f3eb551a83caa0c42)) {$v5d7d58f9cd945f9f3eb551a83caa0c42 = $v5d7d58f9cd945f9f3eb551a83caa0c42;if (!isset($this->xml_stores[$va77b1053cb200e022574f213c7553d88])) $this->xml_stores[$va77b1053cb200e022574f213c7553d88] = array();$v57f6446eb03e6af4fa631be4795f0c9b = array();$v57f6446eb03e6af4fa631be4795f0c9b['old_store_id'] = $v5d7d58f9cd945f9f3eb551a83caa0c42;$v57f6446eb03e6af4fa631be4795f0c9b['amount'] = $vbd047b181e82cec3af1400e7ee193be5;$this->xml_stores[$va77b1053cb200e022574f213c7553d88][] = $v57f6446eb03e6af4fa631be4795f0c9b;}}}protected function extractValues($v60a3282b31e7a1e46163b55fce49cc71) {$v9b207167e5381c47682c6b4f58a623fb = Array();if (!$v60a3282b31e7a1e46163b55fce49cc71->value) return array();foreach($v60a3282b31e7a1e46163b55fce49cc71->value as $v67236e502346412a98a0bb965b7a59e6) {$vd7e6d55ba379a13d08c25d15faf2a23b = ((string) $v67236e502346412a98a0bb965b7a59e6->timestamp[0]);$v3a6d0284e743dc4a9b86f97d6dd1a3bf = ((string) $v67236e502346412a98a0bb965b7a59e6);if($vd7e6d55ba379a13d08c25d15faf2a23b) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = new umiDate();$v3a6d0284e743dc4a9b86f97d6dd1a3bf->setDateByTimeStamp($vd7e6d55ba379a13d08c25d15faf2a23b);}if($v3a6d0284e743dc4a9b86f97d6dd1a3bf) {$v9b207167e5381c47682c6b4f58a623fb[] = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}}return $v9b207167e5381c47682c6b4f58a623fb;}protected function detectBetterFieldType($v2063c1608d6e0baf80249c42e2be5804) {}protected function detectBetterObjectType($v0715f6d9497f93911417c9c324265771, $v5f6492d9717ccf1b8566bd4bc64110b6, $vb061ac7561555582525d2977444ea3f5 = "") {$vd05b6ed7d2345020440df396d6da7f73 = array_keys($this->xml_types[$v5f6492d9717ccf1b8566bd4bc64110b6]['props']);$v69203671ddb68b3848f87700fe06de55 = umiImportRelations::getInstance()->getNewTypeIdRelation($this->source_id, $v5f6492d9717ccf1b8566bd4bc64110b6);if($v69203671ddb68b3848f87700fe06de55) {return $v69203671ddb68b3848f87700fe06de55;}$vd14a8022b085f9ef19d479cbdd581127 = umiObjectTypesCollection::getInstance()->getTypesByHierarchyTypeId($v0715f6d9497f93911417c9c324265771);$v85a0d697cef37e3885323fd9088343b0 = umiObjectTypesCollection::getInstance()->getTypeByHierarchyTypeId($v0715f6d9497f93911417c9c324265771);foreach($vd14a8022b085f9ef19d479cbdd581127 as $v94757cae63fd3e398c0811a976dd6bbe => $v22178d66649d30b18a7e4e331dc778ce) {$v5cfd9480c9d94f569a3c2847c3eb9639 = $this->compareObjectTypeFields($v94757cae63fd3e398c0811a976dd6bbe, $vd05b6ed7d2345020440df396d6da7f73);if($v5cfd9480c9d94f569a3c2847c3eb9639 == 0) {$v69203671ddb68b3848f87700fe06de55 = $v94757cae63fd3e398c0811a976dd6bbe;break;}}if(!$v69203671ddb68b3848f87700fe06de55) {$v676c8cf12853cb65368bba87aead6387 = umiObjectTypesCollection::getInstance()->getType($v85a0d697cef37e3885323fd9088343b0)->getName();if (!$vb061ac7561555582525d2977444ea3f5 || !strlen($vb061ac7561555582525d2977444ea3f5)) $vb061ac7561555582525d2977444ea3f5 = "Подтип \"{$v676c8cf12853cb65368bba87aead6387}\" #{$v5f6492d9717ccf1b8566bd4bc64110b6}";$v69203671ddb68b3848f87700fe06de55 = umiObjectTypesCollection::getInstance()->addType($v85a0d697cef37e3885323fd9088343b0, $vb061ac7561555582525d2977444ea3f5);$v201620107bc2a3a690ce849a2380064a = umiObjectTypesCollection::getInstance()->getType($v69203671ddb68b3848f87700fe06de55);$v201620107bc2a3a690ce849a2380064a->setHierarchyTypeId($v0715f6d9497f93911417c9c324265771);$v201620107bc2a3a690ce849a2380064a->commit();}umiImportRelations::getInstance()->setTypeIdRelation($this->source_id, $v5f6492d9717ccf1b8566bd4bc64110b6, $v69203671ddb68b3848f87700fe06de55);return $v69203671ddb68b3848f87700fe06de55;}protected function compareObjectTypeFields($v87306dd4235ed712ebc07fe169b76f83, $vd05b6ed7d2345020440df396d6da7f73) {$v7ae7003da59ae71dcc9f8638ef50593d = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);if($v7ae7003da59ae71dcc9f8638ef50593d === false) {trigger_error("Object type #{$v87306dd4235ed712ebc07fe169b76f83} not found", E_USER_ERROR);return false;}$v5cfd9480c9d94f569a3c2847c3eb9639 = 0;foreach($vd05b6ed7d2345020440df396d6da7f73 as $v73f329f154a663bfda020aadcdd0b775) {if($v7ae7003da59ae71dcc9f8638ef50593d->getFieldId($v73f329f154a663bfda020aadcdd0b775) == false) {++$v5cfd9480c9d94f569a3c2847c3eb9639;}}return $v5cfd9480c9d94f569a3c2847c3eb9639;}protected function detectBetterTemplateId($v6a2a431fe8b621037ea949531c28551d) {if($v6a2a431fe8b621037ea949531c28551d) {$v662cbf1253ac7d8750ed9190c52163e5 = cmsController::getInstance()->getCurrentDomain()->getId();$v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$vfed36e93a0509e20f2dc96cbbd85b678 = templatesCollection::getInstance()->getTemplatesList($v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);foreach($vfed36e93a0509e20f2dc96cbbd85b678 as $v4f96c7bc828b57b4a3b2b327a7a183c6) {if($v4f96c7bc828b57b4a3b2b327a7a183c6->getFilename() == $v6a2a431fe8b621037ea949531c28551d) {return $v4f96c7bc828b57b4a3b2b327a7a183c6->getId();}}}return templatesCollection::getInstance()->getDefaultTemplate()->getId();}public function importXml() {foreach($this->xml_elements as $vfc07ae6b81515e9c73cb36ac08488ca1) {$v0715f6d9497f93911417c9c324265771 = $vfc07ae6b81515e9c73cb36ac08488ca1['element_hierarchy_type_id'];$va9cecbe3552e2561ce80cf4fe36d259c = $vfc07ae6b81515e9c73cb36ac08488ca1['old_element_object_id'];$v2741adf691b2acf0359a6a73234bc605 = $this->xml_objects[$va9cecbe3552e2561ce80cf4fe36d259c]['old_type_id'];$v22178d66649d30b18a7e4e331dc778ce =  $this->xml_objects[$va9cecbe3552e2561ce80cf4fe36d259c]['type_name'];$vfc07ae6b81515e9c73cb36ac08488ca1['old_type_id'] = $v2741adf691b2acf0359a6a73234bc605;$vfc07ae6b81515e9c73cb36ac08488ca1['new_type_id'] = $v69203671ddb68b3848f87700fe06de55 = $this->detectBetterObjectType($v0715f6d9497f93911417c9c324265771, $v2741adf691b2acf0359a6a73234bc605, $v22178d66649d30b18a7e4e331dc778ce);$vfc07ae6b81515e9c73cb36ac08488ca1['new_tpl_id'] = $ve274c3c0bb91d6582078fbbce8f388f6 = $this->detectBetterTemplateId($vfc07ae6b81515e9c73cb36ac08488ca1['element_filepath']);$vfc07ae6b81515e9c73cb36ac08488ca1['new_lang_id'] = cmsController::getInstance()->getCurrentLang()->getId() ;$vfc07ae6b81515e9c73cb36ac08488ca1['new_domain_id'] = cmsController::getInstance()->getCurrentDomain()->getId();$vfc07ae6b81515e9c73cb36ac08488ca1['element_name'] = $this->xml_objects[$va9cecbe3552e2561ce80cf4fe36d259c]['old_name'];$this->importElement($vfc07ae6b81515e9c73cb36ac08488ca1);}}protected function importElement($vfc07ae6b81515e9c73cb36ac08488ca1) {$this->importedElements += 1;$v2114c8075d855b3cea53d5d880c68948 = $vfc07ae6b81515e9c73cb36ac08488ca1['old_element_id'];$v75cacdb2219ff0da09cc2f909ea64759 = $vfc07ae6b81515e9c73cb36ac08488ca1['old_element_object_id'];$v777ccf80e4e83a9e7cdddd6ebc1edff7 = umiImportRelations::getInstance()->getNewIdRelation($this->source_id, $v2114c8075d855b3cea53d5d880c68948);$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("import_element");$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("new_element_id", $v777ccf80e4e83a9e7cdddd6ebc1edff7);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("old_element_id", $v2114c8075d855b3cea53d5d880c68948);$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("element_info", $vfc07ae6b81515e9c73cb36ac08488ca1);$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("props", $this->xml_objects[$v75cacdb2219ff0da09cc2f909ea64759]['props']);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);$v28b2e67839ab215dcac5f868963f2bcb = $vfc07ae6b81515e9c73cb36ac08488ca1['old_parent_id'];$this->importedElementsArr[] = $v2114c8075d855b3cea53d5d880c68948;$v10b04069381b2fef4e0a41e0ea65b914 = $vfc07ae6b81515e9c73cb36ac08488ca1['element_name'];$v9c668e7b8b95154aabe003bcfd8e15df = $vfc07ae6b81515e9c73cb36ac08488ca1['old_element_alt_name'];$v2741adf691b2acf0359a6a73234bc605 = $vfc07ae6b81515e9c73cb36ac08488ca1['old_type_id'];$v53f070b923b86cc3c1b95e9950674c7c = $vfc07ae6b81515e9c73cb36ac08488ca1['element_is_active'];$v712546bad453a4d99cb79be316f6e64b = $vfc07ae6b81515e9c73cb36ac08488ca1['element_is_visible'];$v25f5c3dfce7a3048a8e9f70bad15bdd3 = $vfc07ae6b81515e9c73cb36ac08488ca1['element_is_deleted'];if($v9c668e7b8b95154aabe003bcfd8e15df) {$vd84ff935144e00c3e1d395c2379aca47 = $v9c668e7b8b95154aabe003bcfd8e15df;}else {$vd84ff935144e00c3e1d395c2379aca47 = $v10b04069381b2fef4e0a41e0ea65b914;}$vd84ff935144e00c3e1d395c2379aca47 = translit::convert($vd84ff935144e00c3e1d395c2379aca47);if($v25f5c3dfce7a3048a8e9f70bad15bdd3 !== NULL) {if($v25f5c3dfce7a3048a8e9f70bad15bdd3) {umiHierarchy::getInstance()->delElement($v777ccf80e4e83a9e7cdddd6ebc1edff7);$this->importLog[] = "Element \"" . $v10b04069381b2fef4e0a41e0ea65b914 . "\" (" . $v2114c8075d855b3cea53d5d880c68948 . ") has been deleted";$this->deletedElements++;return true;}}if($v28b2e67839ab215dcac5f868963f2bcb === "0") {$v0a4066771994dd2315e8a742e4de72fc = $v28b2e67839ab215dcac5f868963f2bcb;}else {$v0a4066771994dd2315e8a742e4de72fc = umiImportRelations::getInstance()->getNewIdRelation($this->source_id, $v28b2e67839ab215dcac5f868963f2bcb);}if ($v0a4066771994dd2315e8a742e4de72fc === false) {$v0a4066771994dd2315e8a742e4de72fc = $this->destination_element_id;}$v3252048a9dc6701c34b83c15c5be40f7 = false;if ($v777ccf80e4e83a9e7cdddd6ebc1edff7 === false && $v0a4066771994dd2315e8a742e4de72fc !== false) {$v555b8759c62b778531f7d10a1cfc1252 = $vfc07ae6b81515e9c73cb36ac08488ca1['new_domain_id'];$ve795657a63adabb22cdc79a959474fdd = $vfc07ae6b81515e9c73cb36ac08488ca1['new_lang_id'];$v5b4c55fc70f920b984055561aff116b3 = $vfc07ae6b81515e9c73cb36ac08488ca1['element_hierarchy_type_id'];$ve274c3c0bb91d6582078fbbce8f388f6 = $vfc07ae6b81515e9c73cb36ac08488ca1['new_tpl_id'];$v69203671ddb68b3848f87700fe06de55 = $vfc07ae6b81515e9c73cb36ac08488ca1['new_type_id'];$v616300e8f201203152145e6776ad27d1 = umiImportRelations::getInstance()->getNewIdRelation($this->source_id, $v28b2e67839ab215dcac5f868963f2bcb);$v777ccf80e4e83a9e7cdddd6ebc1edff7 = umiHierarchy::getInstance()->addElement($v0a4066771994dd2315e8a742e4de72fc, $v5b4c55fc70f920b984055561aff116b3, $v10b04069381b2fef4e0a41e0ea65b914, $vd84ff935144e00c3e1d395c2379aca47, $v69203671ddb68b3848f87700fe06de55, $v555b8759c62b778531f7d10a1cfc1252, $ve795657a63adabb22cdc79a959474fdd, $ve274c3c0bb91d6582078fbbce8f388f6);umiImportRelations::getInstance()->setIdRelation($this->source_id, $v2114c8075d855b3cea53d5d880c68948, $v777ccf80e4e83a9e7cdddd6ebc1edff7);if ($v777ccf80e4e83a9e7cdddd6ebc1edff7) $v3252048a9dc6701c34b83c15c5be40f7 = true;}permissionsCollection::getInstance()->setDefaultPermissions($v777ccf80e4e83a9e7cdddd6ebc1edff7);$v691b2ea4f2db17699a29da0c302a91ea = umiHierarchy::getInstance()->getElement($v777ccf80e4e83a9e7cdddd6ebc1edff7, true, true);if (!$v691b2ea4f2db17699a29da0c302a91ea instanceof umiHierarchyElement) {$this->importLog[] = "Can't create element \"{$v10b04069381b2fef4e0a41e0ea65b914}\" ({$v2114c8075d855b3cea53d5d880c68948})";$this->importErrors++;return false;}$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("import_element");$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("process");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("new_element", $v691b2ea4f2db17699a29da0c302a91ea);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("old_element_id", $v2114c8075d855b3cea53d5d880c68948);$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("element_info", $vfc07ae6b81515e9c73cb36ac08488ca1);$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("props", $this->xml_objects[$v75cacdb2219ff0da09cc2f909ea64759]['props']);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);if($v53f070b923b86cc3c1b95e9950674c7c !== NULL) {$v691b2ea4f2db17699a29da0c302a91ea->setIsActive($v53f070b923b86cc3c1b95e9950674c7c);}if($v712546bad453a4d99cb79be316f6e64b !== NULL) {$v691b2ea4f2db17699a29da0c302a91ea->setIsVisible($v712546bad453a4d99cb79be316f6e64b);}if($vd84ff935144e00c3e1d395c2379aca47) {$v691b2ea4f2db17699a29da0c302a91ea->setAltName($vd84ff935144e00c3e1d395c2379aca47);}if ($v10b04069381b2fef4e0a41e0ea65b914) {$v691b2ea4f2db17699a29da0c302a91ea->setName($v10b04069381b2fef4e0a41e0ea65b914);}$v82e85d12802becdae851373fcc70c4ff = Array();$v50fe03ab7bf37089a7e88da9b31ffb3b = $this->xml_objects[$v75cacdb2219ff0da09cc2f909ea64759]['props'];foreach($v50fe03ab7bf37089a7e88da9b31ffb3b as $vdfc394bd05a4b48161c790034af522a8 => $v410e0a26c217dfabf8a5653e8f9e68ef) {$v2771be291c4a714ca95fd1f45a32403e = $v410e0a26c217dfabf8a5653e8f9e68ef['values'];$v519504d7d4beb745dac24ccfb6c1d7c9 = $v410e0a26c217dfabf8a5653e8f9e68ef['field_type'];if($v519504d7d4beb745dac24ccfb6c1d7c9 == "img_file") {if(isset($v2771be291c4a714ca95fd1f45a32403e[0])) {$v2771be291c4a714ca95fd1f45a32403e[0] = new umiImageFile($v2771be291c4a714ca95fd1f45a32403e[0]);}}$vdfc394bd05a4b48161c790034af522a8 = translit::convert($vdfc394bd05a4b48161c790034af522a8);if($v691b2ea4f2db17699a29da0c302a91ea->getObject()->getPropByName($vdfc394bd05a4b48161c790034af522a8)) {if ($v519504d7d4beb745dac24ccfb6c1d7c9 == 'price' && strlen($v410e0a26c217dfabf8a5653e8f9e68ef['currency_code'])) {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()->getModule('emarket');if ($vfcaea7edd270964cc145ea48e4367d43) {$v78a5eb43deef9a7b5b9ce157b9d52ac4 = isset($v2771be291c4a714ca95fd1f45a32403e[0]) ? floatval($v2771be291c4a714ca95fd1f45a32403e[0]) : 0;$v1af0389838508d7016a9841eb6273962 = $vfcaea7edd270964cc145ea48e4367d43->getCurrency($v410e0a26c217dfabf8a5653e8f9e68ef['currency_code']);if ($v1af0389838508d7016a9841eb6273962) {$v30de5920b8dd5258394e19caa86bbe80 = $vfcaea7edd270964cc145ea48e4367d43->formatCurrencyPrice(array($v78a5eb43deef9a7b5b9ce157b9d52ac4), $vfcaea7edd270964cc145ea48e4367d43->getDefaultCurrency(), $v1af0389838508d7016a9841eb6273962);$v2771be291c4a714ca95fd1f45a32403e = isset($v30de5920b8dd5258394e19caa86bbe80[0]) ? floatval($v30de5920b8dd5258394e19caa86bbe80[0]) : 0;}}}$v691b2ea4f2db17699a29da0c302a91ea->setValue($vdfc394bd05a4b48161c790034af522a8, $v2771be291c4a714ca95fd1f45a32403e);}else {$v82e85d12802becdae851373fcc70c4ff[] = $v410e0a26c217dfabf8a5653e8f9e68ef;}}$this->addMissedProps($v691b2ea4f2db17699a29da0c302a91ea, $v82e85d12802becdae851373fcc70c4ff, $v2741adf691b2acf0359a6a73234bc605);if(count($v82e85d12802becdae851373fcc70c4ff)) {$v691b2ea4f2db17699a29da0c302a91ea->getObject()->update();}foreach($v82e85d12802becdae851373fcc70c4ff as $v410e0a26c217dfabf8a5653e8f9e68ef) {$v2771be291c4a714ca95fd1f45a32403e = $v410e0a26c217dfabf8a5653e8f9e68ef['values'];$v519504d7d4beb745dac24ccfb6c1d7c9 = $v410e0a26c217dfabf8a5653e8f9e68ef['field_type'];if($v519504d7d4beb745dac24ccfb6c1d7c9 == "img_file") {if($v2771be291c4a714ca95fd1f45a32403e[0]) {$v2771be291c4a714ca95fd1f45a32403e[0] = new umiImageFile($v2771be291c4a714ca95fd1f45a32403e[0]);}}if(!$v410e0a26c217dfabf8a5653e8f9e68ef['name']) $v410e0a26c217dfabf8a5653e8f9e68ef['name'] = translit::convert($v410e0a26c217dfabf8a5653e8f9e68ef['title']);$v410e0a26c217dfabf8a5653e8f9e68ef['name'] = translit::convert($v410e0a26c217dfabf8a5653e8f9e68ef['name']);if(!$v691b2ea4f2db17699a29da0c302a91ea->setValue($v410e0a26c217dfabf8a5653e8f9e68ef['name'], $v2771be291c4a714ca95fd1f45a32403e)) {continue;}}$v691b2ea4f2db17699a29da0c302a91ea->commit();if ($v3252048a9dc6701c34b83c15c5be40f7) {$this->importLog[] = "Element \"" . $v10b04069381b2fef4e0a41e0ea65b914 . "\" (" . $v2114c8075d855b3cea53d5d880c68948 . ") has been created";$this->createdElements++;}else {$this->importLog[] = "Element \"" . $v10b04069381b2fef4e0a41e0ea65b914 . "\" (" . $v2114c8075d855b3cea53d5d880c68948 . ") has been updated";$this->updatedElements++;}$v5e949eb2c66f5d51b8a4d4185a693b3f = umiObjectProperty::$USE_FORCE_OBJECTS_CREATION;umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;$v9dfb9e2c355fe22768c93f6e0c33f1f9 = umiObjectTypesCollection::getInstance()->getBaseType("eshop", "store");$v6f95a0b0f896cf9349af3afc8a2752df = umiObjectTypesCollection::getInstance()->getBaseType("eshop", "store_relation");$va8973f92932ba8c02915c86424eb77b0 = cmsController::getInstance()->getModule("eshop");if ($va8973f92932ba8c02915c86424eb77b0 && $v9dfb9e2c355fe22768c93f6e0c33f1f9 && $v6f95a0b0f896cf9349af3afc8a2752df) {if (isset($this->xml_stores[$v75cacdb2219ff0da09cc2f909ea64759])) {foreach ($this->xml_stores[$v75cacdb2219ff0da09cc2f909ea64759] as $v57f6446eb03e6af4fa631be4795f0c9b) {$v4ab09853d1229afdaa2c4b00b44b4828 = $v57f6446eb03e6af4fa631be4795f0c9b['old_store_id'];$vbd047b181e82cec3af1400e7ee193be5 = $v57f6446eb03e6af4fa631be4795f0c9b['amount'];$vb137c8149c716d240351a4b96434a60c = $this->getStoreIdByName($v4ab09853d1229afdaa2c4b00b44b4828);if ($vb137c8149c716d240351a4b96434a60c === false) {$vb137c8149c716d240351a4b96434a60c = umiObjectsCollection::getInstance()->addObject($v4ab09853d1229afdaa2c4b00b44b4828, $v9dfb9e2c355fe22768c93f6e0c33f1f9);}$vd47cbc7965be6318a50b0b921e4de391 = umiObjectsCollection::getInstance()->getObject($vb137c8149c716d240351a4b96434a60c);if ($vd47cbc7965be6318a50b0b921e4de391 instanceof umiObject) {$vd47cbc7965be6318a50b0b921e4de391->setName($v4ab09853d1229afdaa2c4b00b44b4828);$vd47cbc7965be6318a50b0b921e4de391->commit();$va8973f92932ba8c02915c86424eb77b0->setStoreAmount($v691b2ea4f2db17699a29da0c302a91ea->getId(), $vb137c8149c716d240351a4b96434a60c, $vbd047b181e82cec3af1400e7ee193be5);}}}}umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = $v5e949eb2c66f5d51b8a4d4185a693b3f;$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("import_element");$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("new_element_id", $v777ccf80e4e83a9e7cdddd6ebc1edff7);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("old_element_id", $v2114c8075d855b3cea53d5d880c68948);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_info", $vfc07ae6b81515e9c73cb36ac08488ca1);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);umiHierarchy::getInstance()->unloadElement($v777ccf80e4e83a9e7cdddd6ebc1edff7);}protected function getStoreIdByName($vfc19ae0e7cb9076cc4077381bbe0b168) {$v87306dd4235ed712ebc07fe169b76f83 = umiObjectTypesCollection::getInstance()->getBaseType("eshop", "store");$v8be74552df93e31bbdd6b36ed74bdb6a = new umiSelection;$v8be74552df93e31bbdd6b36ed74bdb6a->setObjectTypeFilter();$v8be74552df93e31bbdd6b36ed74bdb6a->addObjectType($v87306dd4235ed712ebc07fe169b76f83);$v8be74552df93e31bbdd6b36ed74bdb6a->setPropertyFilter();$v8be74552df93e31bbdd6b36ed74bdb6a->addNameFilterEquals($vfc19ae0e7cb9076cc4077381bbe0b168);$result = umiSelectionsParser::runSelection($v8be74552df93e31bbdd6b36ed74bdb6a);return isset($result[0]) ? (int) $result[0] : false;}protected function addMissedProps(&$v691b2ea4f2db17699a29da0c302a91ea, $v82e85d12802becdae851373fcc70c4ff, $v2741adf691b2acf0359a6a73234bc605) {if (strlen($v2741adf691b2acf0359a6a73234bc605)) {$v87306dd4235ed712ebc07fe169b76f83 = umiImportRelations::getInstance()->getNewTypeIdRelation($this->source_id, $v2741adf691b2acf0359a6a73234bc605);}else {$v87306dd4235ed712ebc07fe169b76f83 = $v691b2ea4f2db17699a29da0c302a91ea->getObject()->getTypeId();}$v7ae7003da59ae71dcc9f8638ef50593d = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);foreach($v82e85d12802becdae851373fcc70c4ff as $v6184026d3eb247fb90d471744679ece5) {$v2726ffa1d364725a0e3166638138e8e7 = $v6184026d3eb247fb90d471744679ece5['prop_block_title'];$vdf8958b8370cd74e1a8c33230a569b10 = $v6184026d3eb247fb90d471744679ece5['prop_block_name'];$ve41aac3b363ca7b963226f92ecda32d5 = $v6184026d3eb247fb90d471744679ece5['prop_block_is_public'];if(!$vdf8958b8370cd74e1a8c33230a569b10) {if($v2726ffa1d364725a0e3166638138e8e7) {$vdf8958b8370cd74e1a8c33230a569b10 = translit::convert($v2726ffa1d364725a0e3166638138e8e7);}else {$v2726ffa1d364725a0e3166638138e8e7 = "Imported fields group";$vdf8958b8370cd74e1a8c33230a569b10 = "imported";}}if($v216c92e7f92d45ebbf45c075ceae8c05 = $v7ae7003da59ae71dcc9f8638ef50593d->getFieldsGroupByName($vdf8958b8370cd74e1a8c33230a569b10)) {}else {$vb2cd255a43fd56eb1b203b521fa0ef69 = $v7ae7003da59ae71dcc9f8638ef50593d->addFieldsGroup($vdf8958b8370cd74e1a8c33230a569b10, $vdf8958b8370cd74e1a8c33230a569b10, true, $ve41aac3b363ca7b963226f92ecda32d5);$v216c92e7f92d45ebbf45c075ceae8c05 = $v7ae7003da59ae71dcc9f8638ef50593d->getFieldsGroup($vb2cd255a43fd56eb1b203b521fa0ef69);$v216c92e7f92d45ebbf45c075ceae8c05->setTitle($v2726ffa1d364725a0e3166638138e8e7);$v216c92e7f92d45ebbf45c075ceae8c05->commit();}if(!$v6184026d3eb247fb90d471744679ece5['field_type']) {$v6184026d3eb247fb90d471744679ece5['field_type'] = "string";}$v1e3f04102267eaf5e8d0ca424fd5c561 = $this->getFieldTypeId($v6184026d3eb247fb90d471744679ece5['field_type'], $v6184026d3eb247fb90d471744679ece5['is_multiple']);if($v1e3f04102267eaf5e8d0ca424fd5c561 === false) continue;$v6184026d3eb247fb90d471744679ece5['name'] = (string) $v6184026d3eb247fb90d471744679ece5['name'];if(!$v6184026d3eb247fb90d471744679ece5['name']) {$v6184026d3eb247fb90d471744679ece5['name'] = translit::convert($v6184026d3eb247fb90d471744679ece5['title']);}$v6184026d3eb247fb90d471744679ece5['name'] = translit::convert($v6184026d3eb247fb90d471744679ece5['name']);if($v87306dd4235ed712ebc07fe169b76f83) {if(umiImportRelations::getInstance()->getNewFieldId($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6184026d3eb247fb90d471744679ece5['name'])) {continue;}}if($v6184026d3eb247fb90d471744679ece5['field_type'] == "relation") {$v051369818a8073bba5feeb0e957eb308 = self::getAutoGuideId($v6184026d3eb247fb90d471744679ece5['title']);}else {$v051369818a8073bba5feeb0e957eb308 = false;}$v3aabf39f2d943fa886d86dcbbee4d910 = umiFieldsCollection::getInstance()->addField($v6184026d3eb247fb90d471744679ece5['name'], $v6184026d3eb247fb90d471744679ece5['title'], $v1e3f04102267eaf5e8d0ca424fd5c561, $v6184026d3eb247fb90d471744679ece5['is_public'], false);$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);$v06e3d36fa30cea095545139854ad1fb9->setTip($v6184026d3eb247fb90d471744679ece5['tip']);if($v051369818a8073bba5feeb0e957eb308) {$v06e3d36fa30cea095545139854ad1fb9->setGuideId($v051369818a8073bba5feeb0e957eb308);}$v06e3d36fa30cea095545139854ad1fb9->commit();$v216c92e7f92d45ebbf45c075ceae8c05->attachField($v3aabf39f2d943fa886d86dcbbee4d910);if($v87306dd4235ed712ebc07fe169b76f83) {umiImportRelations::getInstance()->setFieldIdRelation($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6184026d3eb247fb90d471744679ece5['name'], $v3aabf39f2d943fa886d86dcbbee4d910);}}}protected function getFieldTypeId($v17f71d965fe9589ddbd11caf7182243e, $v96a76ec43956dac431b643cbd544dd08 = false) {$v3fa9d6639f24f9bb4bf81ac6bdbdbc8c = umiFieldTypesCollection::getInstance()->getFieldTypesList();foreach($v3fa9d6639f24f9bb4bf81ac6bdbdbc8c as $v519504d7d4beb745dac24ccfb6c1d7c9) {if($v519504d7d4beb745dac24ccfb6c1d7c9->getDataType() == $v17f71d965fe9589ddbd11caf7182243e && $v519504d7d4beb745dac24ccfb6c1d7c9->getIsMultiple() == $v96a76ec43956dac431b643cbd544dd08) {return $v519504d7d4beb745dac24ccfb6c1d7c9->getId();}}return false;}public function getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a) {$vcf4313ee98665bb3d4b717b344ba6999 = "Справочник для поля \"{$vd5d3db1765287eef77d7927cc956f50a}\"";$vb3827f7111095f5ba1a9f49988fe9382 = umiObjectTypesCollection::getInstance();$vf996b02003664796b93c4befef5536ee = $vb3827f7111095f5ba1a9f49988fe9382->getTypeIdByGUID('root-guides-type');$v2af1d1812273df0bd0f720da7068f8a6 = $vb3827f7111095f5ba1a9f49988fe9382->getChildClasses($vf996b02003664796b93c4befef5536ee);foreach($v2af1d1812273df0bd0f720da7068f8a6 as $vd4fd255f51559df00de5424b64292413) {$v793536b8480511c5e2975eba32738d1d = umiObjectTypesCollection::getInstance()->getType($vd4fd255f51559df00de5424b64292413);$vfd297f4a9a622aec6f6fb2589b9cda82 = $v793536b8480511c5e2975eba32738d1d->getName();if($vfd297f4a9a622aec6f6fb2589b9cda82 == $vcf4313ee98665bb3d4b717b344ba6999) {$v793536b8480511c5e2975eba32738d1d->setIsGuidable(true);return $vd4fd255f51559df00de5424b64292413;}}$v051369818a8073bba5feeb0e957eb308 = umiObjectTypesCollection::getInstance()->addType($vf996b02003664796b93c4befef5536ee, $vcf4313ee98665bb3d4b717b344ba6999);$va0c391dc49c440fc9962168353cedde3 = umiObjectTypesCollection::getInstance()->getType($v051369818a8073bba5feeb0e957eb308);$va0c391dc49c440fc9962168353cedde3->setIsGuidable(true);$va0c391dc49c440fc9962168353cedde3->setIsPublic(true);$va0c391dc49c440fc9962168353cedde3->commit();return $v051369818a8073bba5feeb0e957eb308;}public function getImportedElementsCount() {return $this->importedElements;}public function getCreatedElementsCount() {return $this->createdElements;}public function getUpdatedElementsCount() {return $this->updatedElements;}public function getDeletedElementsCount() {return $this->deletedElements;}public function getImportErrorsCount() {return $this->importErrors;}public function getImportLog() {return $this->importLog;}};interface iXmlImporter {public function __construct($vaf721e88e6c0a612be51c329cb2bc12a = false);public function loadXmlString($v2d04a630b197c6991c3e00e003f88be4);public function loadXmlFile($va30c2e8bafac20e81c697b2396c8a3b0);public function loadXmlDocument(DOMDocument $v9a09b4dfda82e3e665e31092d1c3ec8d);public function setDestinationElement($v8e2dcfd7e7e24b1ca76c1193f645902b);public function execute();}class xmlImporter implements iXmlImporter {const VERSION = "2.0";const ROOT_PAGE_TYPE_ID = 3;protected $doc, $parser;protected $relations, $source_id;protected $destination_element_id = 0;protected $update_ignore = false;protected $demosite_mode = false;protected $meta = array();public  $updated_types = 0, $created_types = 0,     $updated_languages = 0, $created_languages = 0,     $updated_domains = 0, $created_domains = 0,     $updated_domain_mirrors = 0, $created_domain_mirrors = 0,     $updated_templates = 0, $created_templates = 0,     $updated_objects = 0, $created_objects = 0, $deleted_objects = 0,     $updated_elements = 0, $created_elements = 0, $deleted_elements = 0,     $copied_files = 0,     $updated_relations = 0,     $created_restrictions = 0,     $created_registry_items = 0,     $created_permissions = 0,     $created_field_types = 0,     $created_dirs = 0,     $import_errors = 0;public $filesSource = false;public $ignoreParentGroups = true;public $auto_guide_creation = false;public $renameFiles = false;protected $import_log = array();protected $imported_elements = array();public function __construct($vaf721e88e6c0a612be51c329cb2bc12a = false) {if ($vaf721e88e6c0a612be51c329cb2bc12a) $this->meta['source-name'] = $vaf721e88e6c0a612be51c329cb2bc12a;$this->doc = new DomDocument("1.0", "utf-8");$this->relations = umiImportRelations::getInstance();}public function setUpdateIgnoreMode($vaae635b880d641a8298288912ea0dee8 = true) {$this->update_ignore = (bool) $vaae635b880d641a8298288912ea0dee8;}public function setAutoGuideCreation($v1584701c77c2a2d537c7b7410db75c5c = false) {$this->auto_guide_creation = (bool) $v1584701c77c2a2d537c7b7410db75c5c;}public function setRenameFiles($v82e493c80beeab7a6e841aa86ea2c6ad = false) {$this->renameFiles = (bool) $v82e493c80beeab7a6e841aa86ea2c6ad;}public function setDemositeMode ($vaf0ec91487469a949ca2e9ecad439be8 = true){$this->demosite_mode = $vaf0ec91487469a949ca2e9ecad439be8;}public function loadXmlString($v2d04a630b197c6991c3e00e003f88be4) {return secure_load_dom_document($v2d04a630b197c6991c3e00e003f88be4, $this->doc);}protected function getLabel($i18n) {$vd304ba20e96d87411588eeabac850e34 = false;if ($this->useI18n) {$vd304ba20e96d87411588eeabac850e34 = getLabel($i18n);}if (!$vd304ba20e96d87411588eeabac850e34 || $vd304ba20e96d87411588eeabac850e34 == $i18n) {$vd304ba20e96d87411588eeabac850e34 = str_replace('label-', '', $i18n);$vd304ba20e96d87411588eeabac850e34 = preg_replace("/(.*?)-[m,f,n]+$/", "$1", $vd304ba20e96d87411588eeabac850e34);$vd304ba20e96d87411588eeabac850e34 = str_replace('-', ' ', $vd304ba20e96d87411588eeabac850e34);}return $vd304ba20e96d87411588eeabac850e34;}public function loadXmlFile($va30c2e8bafac20e81c697b2396c8a3b0) {if(!is_file($va30c2e8bafac20e81c697b2396c8a3b0)) {throw new publicException($this->getLabel('label-cannot-read-file') . ' ' . $va30c2e8bafac20e81c697b2396c8a3b0);}return secure_load_dom_document(file_get_contents($va30c2e8bafac20e81c697b2396c8a3b0), $this->doc);}public function loadXmlDocument(DOMDocument $v9a09b4dfda82e3e665e31092d1c3ec8d) {$this->doc = $v9a09b4dfda82e3e665e31092d1c3ec8d;}public function setDestinationElement($v8e2dcfd7e7e24b1ca76c1193f645902b) {if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$this->destination_element_id = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();return true;}if (umiHierarchy::getInstance()->getElement($v8e2dcfd7e7e24b1ca76c1193f645902b, true, true) instanceof umiHierarchyElement) {$this->destination_element_id = $v8e2dcfd7e7e24b1ca76c1193f645902b;return true;}return false;}public function execute() {$va59fd5768bddc123092dddd6413dff0e = cmsController::$IGNORE_MICROCACHE;$v2b419278ae6ec25f1deac5b2319d2f2c = umiObjectProperty::$IGNORE_FILTER_INPUT_STRING;cmsController::$IGNORE_MICROCACHE = true;umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = true;$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if(!$v2245023265ae4cf87d02c8b6ba991139->get('kernel', 'import-auto-index')) {if(!defined('DISABLE_SEARCH_REINDEX')) {define('DISABLE_SEARCH_REINDEX', 1);}}$v62b7dedcccf830f9a5e3a602bbd23deb = umiObjectProperty::$USE_FORCE_OBJECTS_CREATION;if ($this->auto_guide_creation) {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = true;}else {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;}$this->parser = new DOMXPath($this->doc);$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/@version");$v2af72f100c356273d46284f6fd1dfc08 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";if ($v2af72f100c356273d46284f6fd1dfc08 != self::VERSION) {throw new publicException($this->getLabel("label-unknown-umidump-version"));}$this->parseMetaData();$this->source_id = $this->relations->getSourceId($this->meta['source-name']);if (!$this->source_id) {$this->source_id = $this->relations->addNewSource($this->meta['source-name']);}$this->useI18n = false;$this->importDirs();if ($this->filesSource) $this->importFiles();$this->useI18n = true;$this->importRegistry();$this->importLangs();$this->importDomains();$this->importTemplates();$this->importDataTypes();$this->importTypes();$this->importObjects();$this->importElements();$this->importRelations();$this->importOptions();$this->importRestrictions();$this->setDefaultPermissions();$this->importPermissions();$this->importHierarchy();umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = $v62b7dedcccf830f9a5e3a602bbd23deb;cmsController::$IGNORE_MICROCACHE = $va59fd5768bddc123092dddd6413dff0e;umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = $v2b419278ae6ec25f1deac5b2319d2f2c;}public function setFilesSource($vd2c10d5f8f2397b7c8ed983609e71e27) {if(!is_dir($vd2c10d5f8f2397b7c8ed983609e71e27)) {throw new coreException($this->getLabel("label-cannot-find-files-source"));}$this->filesSource = $vd2c10d5f8f2397b7c8ed983609e71e27;}public function setIgnoreParentGroups($va0913828f00eefe560bcf007c7ae015a) {$this->ignoreParentGroups = $va0913828f00eefe560bcf007c7ae015a;}protected function reportError($vcb5e100e5a9a3e7f6d1fd97512215282) {$this->import_errors++;if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $vcb5e100e5a9a3e7f6d1fd97512215282 . "\n\r";else $this->import_log[] = "<font style='color:red''>" . $vcb5e100e5a9a3e7f6d1fd97512215282 . "</font>";}protected function writeLog($v78e731027d8fd50ed642340b7c9a63b3) {if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $v78e731027d8fd50ed642340b7c9a63b3 . "\n\r";else $this->import_log[] = $v78e731027d8fd50ed642340b7c9a63b3;}public function getImportLog() {return $this->import_log;}protected function parseMetaData() {$v6f8f57715090da2632453988d9a1501b = $this->meta;$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/site-name");$v6f8f57715090da2632453988d9a1501b['site-name'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/domain");$v6f8f57715090da2632453988d9a1501b['domain'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/lang");$v6f8f57715090da2632453988d9a1501b['lang'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";if (!isset($v6f8f57715090da2632453988d9a1501b['source-name'])) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/source-name");$v6f8f57715090da2632453988d9a1501b['source-name'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : md5($v6f8f57715090da2632453988d9a1501b['domain']);}$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/generate-time/timestamp");$v6f8f57715090da2632453988d9a1501b['generated'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/branches/id");$v6f8f57715090da2632453988d9a1501b['branches'] = array();foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v36c4536996ca5615dcf9911f068786dc) {$v6f8f57715090da2632453988d9a1501b['branches'][] = $v36c4536996ca5615dcf9911f068786dc->nodeValue;}$this->meta = $v6f8f57715090da2632453988d9a1501b;}protected function importHierarchyType($v568e2307c59466ef505aab734d74f1f9, $va85c62c99bf80aeffb74914fb56a1942, $v42c20047918d7af7031377b1461d197a) {$vdb6d9b451b818ccc9a449383f2f0c450 = umiHierarchyTypesCollection::getInstance();$v89b0b9deff65f8b9cd1f71bc74ce36ba = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeByName($v568e2307c59466ef505aab734d74f1f9, $va85c62c99bf80aeffb74914fb56a1942);if (!$v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {$vb80bb7740288fda1f201890375a60c8f = $vdb6d9b451b818ccc9a449383f2f0c450->addType($v568e2307c59466ef505aab734d74f1f9, $v42c20047918d7af7031377b1461d197a, $va85c62c99bf80aeffb74914fb56a1942);$v89b0b9deff65f8b9cd1f71bc74ce36ba = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeByName($v568e2307c59466ef505aab734d74f1f9, $va85c62c99bf80aeffb74914fb56a1942);}if (!$v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {throw new coreException($this->getLabel("label-cannot-create-hierarchy-type") . "{$v568e2307c59466ef505aab734d74f1f9}/{$va85c62c99bf80aeffb74914fb56a1942} ({$v42c20047918d7af7031377b1461d197a})");}return $v89b0b9deff65f8b9cd1f71bc74ce36ba;}protected function importTypes() {$va3032d293cbe70eef8203ae3c3ecc30c = $this->parser->evaluate("/umidump/types/type");foreach ($va3032d293cbe70eef8203ae3c3ecc30c as $veea7dc04e9c0c2c050fea3f8340c661b) {$this->importType($veea7dc04e9c0c2c050fea3f8340c661b);}}protected function importType(DOMElement $veea7dc04e9c0c2c050fea3f8340c661b) {$v61ce6a78cb3c8547fed20990c92edfe3 = $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('id');$v22178d66649d30b18a7e4e331dc778ce = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('title') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('title') : null;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-type') . " \"{$v22178d66649d30b18a7e4e331dc778ce}\" " . $this->getLabel('label-with-empty-id'));return false;}$vd33d1e928d54a353100641ff7d704306 = $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('parent-id');$v7617e8d03bb811f5c37135234006b114 = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('guide') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('guide') : null;$v117256556af3bd1a0c9710a593d93814 = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('public') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('public') : null;$v1945c9a2a5e2ba6133f1db6757a35fcb = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('locked') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('locked') : null;$v1e0ca5b1252f1f6b1e0ac91be7e7219e = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('guid') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('guid') : null;$vdb6d9b451b818ccc9a449383f2f0c450 = umiObjectTypesCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v69203671ddb68b3848f87700fe06de55 = false;if (!is_null($v1e0ca5b1252f1f6b1e0ac91be7e7219e)) {$v69203671ddb68b3848f87700fe06de55 = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if ($v69203671ddb68b3848f87700fe06de55 && $v69203671ddb68b3848f87700fe06de55 != $this->relations->getNewTypeIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3)) {$this->relations->setTypeIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v69203671ddb68b3848f87700fe06de55);}}if (!$v69203671ddb68b3848f87700fe06de55) $v69203671ddb68b3848f87700fe06de55 = $this->relations->getNewTypeIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if ($v69203671ddb68b3848f87700fe06de55 && $this->update_ignore) {$this->writeLog($this->getLabel("label-datatype") . " \"" . $v22178d66649d30b18a7e4e331dc778ce . "\" ". $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getType($v69203671ddb68b3848f87700fe06de55);}if(!$v69203671ddb68b3848f87700fe06de55) {$vbb05d2aa96d31d1d44eb6ef550686607 = (trim($vd33d1e928d54a353100641ff7d704306, "{}") == 'root-pages-type') ? $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByGUID('root-pages-type') : $this->relations->getNewTypeIdRelation($this->source_id, $vd33d1e928d54a353100641ff7d704306);if (is_null($v22178d66649d30b18a7e4e331dc778ce)) {$v22178d66649d30b18a7e4e331dc778ce = "Type #" . $v61ce6a78cb3c8547fed20990c92edfe3;}$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("base", $veea7dc04e9c0c2c050fea3f8340c661b);$v593616de15330c0fb2d55e55410bf994 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0) : false;$v568e2307c59466ef505aab734d74f1f9 = $v593616de15330c0fb2d55e55410bf994 ? $v593616de15330c0fb2d55e55410bf994->getAttribute('module') : false;$va85c62c99bf80aeffb74914fb56a1942 = $v593616de15330c0fb2d55e55410bf994 ? $v593616de15330c0fb2d55e55410bf994->getAttribute('method') : false;$v42c20047918d7af7031377b1461d197a = $v593616de15330c0fb2d55e55410bf994->nodeValue;$v89b0b9deff65f8b9cd1f71bc74ce36ba = false;if (strlen($v568e2307c59466ef505aab734d74f1f9)) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = $this->importHierarchyType($v568e2307c59466ef505aab734d74f1f9, $va85c62c99bf80aeffb74914fb56a1942, $v42c20047918d7af7031377b1461d197a);$v75b212f033271dc4a7b372cebf3f0e9f = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeByHierarchyTypeId($v89b0b9deff65f8b9cd1f71bc74ce36ba->getId());$v152163c4320bc49594f3ac21600886b1 = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v75b212f033271dc4a7b372cebf3f0e9f);if (trim($vd33d1e928d54a353100641ff7d704306, "{}") == 'root-pages-type' && $v152163c4320bc49594f3ac21600886b1 instanceof umiObjectType) {$v69203671ddb68b3848f87700fe06de55 = $v152163c4320bc49594f3ac21600886b1->getId();}elseif (!$vbb05d2aa96d31d1d44eb6ef550686607 && $v152163c4320bc49594f3ac21600886b1 instanceof umiObjectType) {$vbb05d2aa96d31d1d44eb6ef550686607 = $v152163c4320bc49594f3ac21600886b1->getId();}}if (!$v69203671ddb68b3848f87700fe06de55) $v69203671ddb68b3848f87700fe06de55 = $vdb6d9b451b818ccc9a449383f2f0c450->addType(intval($vbb05d2aa96d31d1d44eb6ef550686607), trim($v22178d66649d30b18a7e4e331dc778ce), false, $this->ignoreParentGroups);$v599dcce2998a6b40b1e38e8c6006cb0a = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v69203671ddb68b3848f87700fe06de55);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba) $v599dcce2998a6b40b1e38e8c6006cb0a->setHierarchyTypeId($v89b0b9deff65f8b9cd1f71bc74ce36ba->getId());$ve2fa538867c3830a859a5b17ab24644b = true;if (!is_null($v1e0ca5b1252f1f6b1e0ac91be7e7219e)) $vdb6d9b451b818ccc9a449383f2f0c450->getType($v69203671ddb68b3848f87700fe06de55)->setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);$this->relations->setTypeIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v69203671ddb68b3848f87700fe06de55);}$v599dcce2998a6b40b1e38e8c6006cb0a = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v69203671ddb68b3848f87700fe06de55);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {$this->reportError($this->getLabel('label-cannot-detect-type') . $this->getLabel('label-datatype') . "{$v22178d66649d30b18a7e4e331dc778ce} ({$v61ce6a78cb3c8547fed20990c92edfe3})");return false;}if (!is_null($v22178d66649d30b18a7e4e331dc778ce)) $v599dcce2998a6b40b1e38e8c6006cb0a->setName(trim($v22178d66649d30b18a7e4e331dc778ce));if (!is_null($v117256556af3bd1a0c9710a593d93814)) $v599dcce2998a6b40b1e38e8c6006cb0a->setIsPublic($v117256556af3bd1a0c9710a593d93814 == 'public' || $v117256556af3bd1a0c9710a593d93814 == "1");if (!is_null($v7617e8d03bb811f5c37135234006b114)) $v599dcce2998a6b40b1e38e8c6006cb0a->setIsGuidable($v7617e8d03bb811f5c37135234006b114 == 'guide' || $v7617e8d03bb811f5c37135234006b114 == "1");if (!is_null($v1945c9a2a5e2ba6133f1db6757a35fcb)) $v599dcce2998a6b40b1e38e8c6006cb0a->setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb == 'locked' || $v1945c9a2a5e2ba6133f1db6757a35fcb == "1");$v599dcce2998a6b40b1e38e8c6006cb0a->commit();if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_types++;$this->writeLog($this->getLabel('label-datatype') . " \"" . $v22178d66649d30b18a7e4e331dc778ce . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel('label-has-been-created-m'));}else {$this->updated_types++;$this->writeLog($this->getLabel('label-datatype') . " \"" . $v22178d66649d30b18a7e4e331dc778ce . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel('label-has-been-updated-m'));}$this->importTypeGroups($v599dcce2998a6b40b1e38e8c6006cb0a, $veea7dc04e9c0c2c050fea3f8340c661b);return $v599dcce2998a6b40b1e38e8c6006cb0a;}protected function importTypeGroups(umiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a, DOMElement $veea7dc04e9c0c2c050fea3f8340c661b) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("fieldgroups/group", $veea7dc04e9c0c2c050fea3f8340c661b);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v562feb4548b66febf02774b4f339552e) {$this->importTypeGroup($v599dcce2998a6b40b1e38e8c6006cb0a, $v562feb4548b66febf02774b4f339552e);}}protected function importTypeGroup(umiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a, DOMElement $v562feb4548b66febf02774b4f339552e, $v329edef3a633f06f22708df738e30eb2 = true) {$v8fe62617c470a7a0465d0ccd7c6970f6 = $v562feb4548b66febf02774b4f339552e->getAttribute('name');if (!strlen($v8fe62617c470a7a0465d0ccd7c6970f6)) return false;$ve9ee6daff5c35c1c3ebd7adf00db810e = self::translateName($v8fe62617c470a7a0465d0ccd7c6970f6);$vd5d3db1765287eef77d7927cc956f50a = $v562feb4548b66febf02774b4f339552e->hasAttribute('title') ? $v562feb4548b66febf02774b4f339552e->getAttribute('title') : null;$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = $v562feb4548b66febf02774b4f339552e->hasAttribute('visible') ? $v562feb4548b66febf02774b4f339552e->getAttribute('visible') : null;$v1945c9a2a5e2ba6133f1db6757a35fcb = $v562feb4548b66febf02774b4f339552e->hasAttribute('locked') ? $v562feb4548b66febf02774b4f339552e->getAttribute('locked') : null;$v4264c638e0098acb172519b0436db099 = $v562feb4548b66febf02774b4f339552e->hasAttribute('active') ? $v562feb4548b66febf02774b4f339552e->getAttribute('active') : null;$vdb0f6f37ebeb6ea09489124345af2a45 = null;$v0e939a4ffd3aacd724dd3b50147b4353 = $this->relations->getNewGroupId($this->source_id, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v8fe62617c470a7a0465d0ccd7c6970f6);if ($v0e939a4ffd3aacd724dd3b50147b4353) $vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroup($v0e939a4ffd3aacd724dd3b50147b4353, true);if (!$v0e939a4ffd3aacd724dd3b50147b4353) {$vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroupByName($ve9ee6daff5c35c1c3ebd7adf00db810e, true);if ($vdb0f6f37ebeb6ea09489124345af2a45) $this->relations->setGroupIdRelation($this->source_id, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v8fe62617c470a7a0465d0ccd7c6970f6, $vdb0f6f37ebeb6ea09489124345af2a45->getId());}if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof umiFieldsGroup) {if (is_null($vd5d3db1765287eef77d7927cc956f50a)) {$vd5d3db1765287eef77d7927cc956f50a = "Group #" . $v8fe62617c470a7a0465d0ccd7c6970f6;}$v0e939a4ffd3aacd724dd3b50147b4353 = $v599dcce2998a6b40b1e38e8c6006cb0a->addFieldsGroup($ve9ee6daff5c35c1c3ebd7adf00db810e, trim($vd5d3db1765287eef77d7927cc956f50a), true, false);$this->relations->setGroupIdRelation($this->source_id, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v8fe62617c470a7a0465d0ccd7c6970f6, $v0e939a4ffd3aacd724dd3b50147b4353);$vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroup($v0e939a4ffd3aacd724dd3b50147b4353, true);}if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof umiFieldsGroup) {$this->reportError($this->getLabel('label-cannot-import-group') . "{$v8fe62617c470a7a0465d0ccd7c6970f6}:" . $this->getLabel('label-cannot-detect-group'));return false;}if (!is_null($vd5d3db1765287eef77d7927cc956f50a)) $vdb0f6f37ebeb6ea09489124345af2a45->setTitle(trim($vd5d3db1765287eef77d7927cc956f50a));if (!is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) $vdb0f6f37ebeb6ea09489124345af2a45->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == 'visible' || $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == '1');if (!is_null($v4264c638e0098acb172519b0436db099)) $vdb0f6f37ebeb6ea09489124345af2a45->setIsActive($v4264c638e0098acb172519b0436db099 == 'active' || $v4264c638e0098acb172519b0436db099 == '1');if (!is_null($v1945c9a2a5e2ba6133f1db6757a35fcb)) $vdb0f6f37ebeb6ea09489124345af2a45->setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb == 'locked' || $v1945c9a2a5e2ba6133f1db6757a35fcb == '1');$vdb0f6f37ebeb6ea09489124345af2a45->commit();if ($v329edef3a633f06f22708df738e30eb2) $this->importGroupFields($vdb0f6f37ebeb6ea09489124345af2a45, $v562feb4548b66febf02774b4f339552e);return $vdb0f6f37ebeb6ea09489124345af2a45;}protected function importGroupFields(umiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, DOMElement $v562feb4548b66febf02774b4f339552e) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("field", $v562feb4548b66febf02774b4f339552e);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v3906452ac57c71c3f053666f9c0e8355) {$this->importField($vdb0f6f37ebeb6ea09489124345af2a45, $v3906452ac57c71c3f053666f9c0e8355);}}protected function getFieldByName(umiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, $vb068931cc450442b63f5b3d276ea4297) {$vd05b6ed7d2345020440df396d6da7f73 = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getName() == $vb068931cc450442b63f5b3d276ea4297) return $v06e3d36fa30cea095545139854ad1fb9;}return false;}protected function importFieldType($vfaf701ce237284ac6be752513db01dcd) {$vb068931cc450442b63f5b3d276ea4297 = $vfaf701ce237284ac6be752513db01dcd->getAttribute('name');$v17f71d965fe9589ddbd11caf7182243e = $vfaf701ce237284ac6be752513db01dcd->getAttribute('data-type');$vce495ab8d79db0d37413d8e95b54e606 = $vfaf701ce237284ac6be752513db01dcd->getAttribute('multiple') == 1 || $vfaf701ce237284ac6be752513db01dcd->getAttribute('multiple') == "multiple";if (!strlen($v17f71d965fe9589ddbd11caf7182243e)) return false;$vdb6d9b451b818ccc9a449383f2f0c450 = umiFieldTypesCollection::getInstance();$v519504d7d4beb745dac24ccfb6c1d7c9 = $vdb6d9b451b818ccc9a449383f2f0c450->getFieldTypeByDataType($v17f71d965fe9589ddbd11caf7182243e, $vce495ab8d79db0d37413d8e95b54e606);$ve2fa538867c3830a859a5b17ab24644b = false;if (!$v519504d7d4beb745dac24ccfb6c1d7c9 instanceof  umiFieldType) {$v1e3f04102267eaf5e8d0ca424fd5c561 = $vdb6d9b451b818ccc9a449383f2f0c450->addFieldType($vb068931cc450442b63f5b3d276ea4297, $v17f71d965fe9589ddbd11caf7182243e);$v519504d7d4beb745dac24ccfb6c1d7c9 = $vdb6d9b451b818ccc9a449383f2f0c450->getFieldType($v1e3f04102267eaf5e8d0ca424fd5c561);$v519504d7d4beb745dac24ccfb6c1d7c9->setIsMultiple($vce495ab8d79db0d37413d8e95b54e606);$v519504d7d4beb745dac24ccfb6c1d7c9->commit();$ve2fa538867c3830a859a5b17ab24644b = true;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_field_types++;$this->writeLog($this->getLabel('label-field-type') . "\"" . $v519504d7d4beb745dac24ccfb6c1d7c9->getName() . "\"" . $this->getLabel('label-has-been-created-m'));}return $v519504d7d4beb745dac24ccfb6c1d7c9;}public function getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a) {$vcf4313ee98665bb3d4b717b344ba6999 = "Справочник для поля \"{$vd5d3db1765287eef77d7927cc956f50a}\"";$vdb6d9b451b818ccc9a449383f2f0c450 = umiObjectTypesCollection::getInstance();$va08f2aee9de301619776deb6fee83e50 = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByGUID('root-guides-type');$v2af1d1812273df0bd0f720da7068f8a6 = $vdb6d9b451b818ccc9a449383f2f0c450->getChildClasses($va08f2aee9de301619776deb6fee83e50);foreach($v2af1d1812273df0bd0f720da7068f8a6 as $vd4fd255f51559df00de5424b64292413) {$v793536b8480511c5e2975eba32738d1d = $vdb6d9b451b818ccc9a449383f2f0c450->getType($vd4fd255f51559df00de5424b64292413);$vfd297f4a9a622aec6f6fb2589b9cda82 = $v793536b8480511c5e2975eba32738d1d->getName();if($vfd297f4a9a622aec6f6fb2589b9cda82 == $vcf4313ee98665bb3d4b717b344ba6999) {$v793536b8480511c5e2975eba32738d1d->setIsGuidable(true);return $vd4fd255f51559df00de5424b64292413;}}$v051369818a8073bba5feeb0e957eb308 = $vdb6d9b451b818ccc9a449383f2f0c450->addType($va08f2aee9de301619776deb6fee83e50, $vcf4313ee98665bb3d4b717b344ba6999);$va0c391dc49c440fc9962168353cedde3 = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v051369818a8073bba5feeb0e957eb308);$va0c391dc49c440fc9962168353cedde3->setIsGuidable(true);$va0c391dc49c440fc9962168353cedde3->setIsPublic(true);$va0c391dc49c440fc9962168353cedde3->commit();return $v051369818a8073bba5feeb0e957eb308;}protected function importField(umiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, DOMElement $v3906452ac57c71c3f053666f9c0e8355) {$v6adb6b0ad1941d569b23e089910c5e74 = $v3906452ac57c71c3f053666f9c0e8355->getAttribute('name');if (!strlen($v6adb6b0ad1941d569b23e089910c5e74)) {$this->reportError($this->getLabel('label-cannot-import-field-with-empty-name'));return false;}$vd5d3db1765287eef77d7927cc956f50a = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('title') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('title') : null;$v6a2139364f96787c8ce1bbb0070b898c = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('tip') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('tip') : null;$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('visible') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('visible') : null;$v1945c9a2a5e2ba6133f1db6757a35fcb = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('locked') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('locked') : null;$vd5752333adc3a004f826f2ea2a41273a = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('inheritable') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('inheritable') : null;$ved5d0cbca24ec1fe6d0ab89a566dc9c1 = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('indexable') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('indexable') : null;$va0b3cf76e59b5c67b3ea226dd76adf9b = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('filterable') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('filterable') : null;$v0d2ac6f3b02c0de484369013b31f2ed7 = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('required') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('required') : null;$vc9409711ebff9250bd075037d3d18263 = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('system') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('system') : null;$v17d0db9e12e990d49216a42e1451f46e = self::translateName($v6adb6b0ad1941d569b23e089910c5e74);$v87306dd4235ed712ebc07fe169b76f83 = $vdb0f6f37ebeb6ea09489124345af2a45->getTypeId();$vdb6d9b451b818ccc9a449383f2f0c450 = umiFieldsCollection::getInstance();$v953e1ee8066af1b7e55300750533ddc8 = umiObjectTypesCollection::getInstance();$v06e3d36fa30cea095545139854ad1fb9 = null;$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("type", $v3906452ac57c71c3f053666f9c0e8355);$vfaf701ce237284ac6be752513db01dcd = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0): false;if (!$vfaf701ce237284ac6be752513db01dcd) {$this->reportError($this->getLabel('label-cannot-import-field') . " {$v6adb6b0ad1941d569b23e089910c5e74}: " . $this->getLabel('label-cannot-detect-datatype'));return false;}$v519504d7d4beb745dac24ccfb6c1d7c9 = $this->importFieldType($vfaf701ce237284ac6be752513db01dcd);if (!$v519504d7d4beb745dac24ccfb6c1d7c9 instanceof umiFieldType) {$this->reportError($this->getLabel('label-cannot-detect-field-type-for') . " {$v6adb6b0ad1941d569b23e089910c5e74}");return false;}$v1e3f04102267eaf5e8d0ca424fd5c561 = $v519504d7d4beb745dac24ccfb6c1d7c9->getId();$v7ae7003da59ae71dcc9f8638ef50593d = $v953e1ee8066af1b7e55300750533ddc8->getType($v87306dd4235ed712ebc07fe169b76f83);$v3aabf39f2d943fa886d86dcbbee4d910 = $v7ae7003da59ae71dcc9f8638ef50593d->getFieldId($v17d0db9e12e990d49216a42e1451f46e, false);if ($v3aabf39f2d943fa886d86dcbbee4d910) {$v06e3d36fa30cea095545139854ad1fb9 = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v3aabf39f2d943fa886d86dcbbee4d910);if($v06e3d36fa30cea095545139854ad1fb9 instanceof umiField && $v3aabf39f2d943fa886d86dcbbee4d910 != $this->relations->getNewFieldId($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74)){$this->relations->setFieldIdRelation($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74, $v3aabf39f2d943fa886d86dcbbee4d910);}}if(!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {$v2e3c048401582f4247d7ccac43657d2d = $v7ae7003da59ae71dcc9f8638ef50593d->getParentId();if ($v2e3c048401582f4247d7ccac43657d2d) {$v328a21868fce2b3f8569db40f1aa8a89 = $v953e1ee8066af1b7e55300750533ddc8->getType($v2e3c048401582f4247d7ccac43657d2d);$v1151783f57c3e0768f301e7fbf1c67f2 = $v328a21868fce2b3f8569db40f1aa8a89->getFieldId($v17d0db9e12e990d49216a42e1451f46e, false);if ($v1151783f57c3e0768f301e7fbf1c67f2) {$v239407987de466be3f94ce70d7139134 = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v1151783f57c3e0768f301e7fbf1c67f2, false);if ($v239407987de466be3f94ce70d7139134->getFieldTypeId() == $v1e3f04102267eaf5e8d0ca424fd5c561 && $v239407987de466be3f94ce70d7139134->getTitle() == $vd5d3db1765287eef77d7927cc956f50a) {$v06e3d36fa30cea095545139854ad1fb9 = $v239407987de466be3f94ce70d7139134;$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v1151783f57c3e0768f301e7fbf1c67f2);$this->relations->setFieldIdRelation($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74, $v06e3d36fa30cea095545139854ad1fb9->getId());}}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {$v3f5af10cbb47cb1b6fcf196befc17b95 = $v953e1ee8066af1b7e55300750533ddc8->getSubTypesList($v2e3c048401582f4247d7ccac43657d2d);foreach($v3f5af10cbb47cb1b6fcf196befc17b95 as $veb2c84964aa55a68255b7466cd21b62c) {if($veb2c84964aa55a68255b7466cd21b62c == $v87306dd4235ed712ebc07fe169b76f83) continue;$v4ae5fdeb89c7a5a5daf33112bda3f82b = $v953e1ee8066af1b7e55300750533ddc8->getType($veb2c84964aa55a68255b7466cd21b62c);if($v4ae5fdeb89c7a5a5daf33112bda3f82b instanceof umiObjectType == false) continue;if($v6270c3e00735121953b8585fd836af43 = $v4ae5fdeb89c7a5a5daf33112bda3f82b->getFieldId($v17d0db9e12e990d49216a42e1451f46e, false)) {$vd3b250b73d77cb502490809548ef475e = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v6270c3e00735121953b8585fd836af43);if($vd3b250b73d77cb502490809548ef475e instanceof umiField == false) continue;if ($vd3b250b73d77cb502490809548ef475e->getFieldTypeId() == $v1e3f04102267eaf5e8d0ca424fd5c561 && $vd3b250b73d77cb502490809548ef475e->getTitle() == $vd5d3db1765287eef77d7927cc956f50a) {$v06e3d36fa30cea095545139854ad1fb9 = $vd3b250b73d77cb502490809548ef475e;$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v6270c3e00735121953b8585fd836af43);$this->relations->setFieldIdRelation($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74, $v06e3d36fa30cea095545139854ad1fb9->getId());break;}}}}}}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {if (is_null($vd5d3db1765287eef77d7927cc956f50a)) {$vd5d3db1765287eef77d7927cc956f50a = $v6adb6b0ad1941d569b23e089910c5e74;}$v3aabf39f2d943fa886d86dcbbee4d910 = $vdb6d9b451b818ccc9a449383f2f0c450->addField($v17d0db9e12e990d49216a42e1451f46e, trim($vd5d3db1765287eef77d7927cc956f50a), $v1e3f04102267eaf5e8d0ca424fd5c561, false, false, false);$this->relations->setFieldIdRelation($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74, $v3aabf39f2d943fa886d86dcbbee4d910);$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v3aabf39f2d943fa886d86dcbbee4d910);$v06e3d36fa30cea095545139854ad1fb9 = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v3aabf39f2d943fa886d86dcbbee4d910);if (is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) $v06e3d36fa30cea095545139854ad1fb9->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4);if (is_null($va0b3cf76e59b5c67b3ea226dd76adf9b)) $v06e3d36fa30cea095545139854ad1fb9->setIsInFilter($va0b3cf76e59b5c67b3ea226dd76adf9b);if (is_null($ved5d0cbca24ec1fe6d0ab89a566dc9c1)) $v06e3d36fa30cea095545139854ad1fb9->setIsInSearch($ved5d0cbca24ec1fe6d0ab89a566dc9c1);}if (($v519504d7d4beb745dac24ccfb6c1d7c9->getDataType() == 'relation' || $v519504d7d4beb745dac24ccfb6c1d7c9->getDataType() == 'optioned') && $this->auto_guide_creation) {$v06e3d36fa30cea095545139854ad1fb9->setGuideId($this->getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a));}if ($v06e3d36fa30cea095545139854ad1fb9->getFieldTypeId() != $v1e3f04102267eaf5e8d0ca424fd5c561) $v06e3d36fa30cea095545139854ad1fb9->setFieldTypeId($v1e3f04102267eaf5e8d0ca424fd5c561);if (!is_null($vd5d3db1765287eef77d7927cc956f50a)) $v06e3d36fa30cea095545139854ad1fb9->setTitle(trim($vd5d3db1765287eef77d7927cc956f50a));if (!is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) $v06e3d36fa30cea095545139854ad1fb9->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == 'visible' || $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == "1");if (!is_null($ved5d0cbca24ec1fe6d0ab89a566dc9c1)) $v06e3d36fa30cea095545139854ad1fb9->setIsInSearch($ved5d0cbca24ec1fe6d0ab89a566dc9c1 == 'indexable' || $ved5d0cbca24ec1fe6d0ab89a566dc9c1 == "1");if (!is_null($va0b3cf76e59b5c67b3ea226dd76adf9b)) $v06e3d36fa30cea095545139854ad1fb9->setIsInFilter($va0b3cf76e59b5c67b3ea226dd76adf9b == 'filterable' || $va0b3cf76e59b5c67b3ea226dd76adf9b == "1");if (!is_null($v0d2ac6f3b02c0de484369013b31f2ed7)) $v06e3d36fa30cea095545139854ad1fb9->setIsRequired($v0d2ac6f3b02c0de484369013b31f2ed7 == 'required' || $v0d2ac6f3b02c0de484369013b31f2ed7 == "1");if (!is_null($vc9409711ebff9250bd075037d3d18263)) $v06e3d36fa30cea095545139854ad1fb9->setIsSystem($vc9409711ebff9250bd075037d3d18263 == 'system' || $vc9409711ebff9250bd075037d3d18263 == "1");if (!is_null($v6a2139364f96787c8ce1bbb0070b898c)) $v06e3d36fa30cea095545139854ad1fb9->setTip(trim($v6a2139364f96787c8ce1bbb0070b898c));if (!is_null($v1945c9a2a5e2ba6133f1db6757a35fcb)) $v06e3d36fa30cea095545139854ad1fb9->setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb == 'locked' || $v1945c9a2a5e2ba6133f1db6757a35fcb == "1");if (!is_null($vd5752333adc3a004f826f2ea2a41273a)) $v06e3d36fa30cea095545139854ad1fb9->setIsInheritable($vd5752333adc3a004f826f2ea2a41273a == 'inheritable' || $vd5752333adc3a004f826f2ea2a41273a == "1");$ve4c9479b11955648dad558fe717a4eb2 = $this->parser->evaluate("tip", $v3906452ac57c71c3f053666f9c0e8355);$v6a2139364f96787c8ce1bbb0070b898c = $ve4c9479b11955648dad558fe717a4eb2->length ? $ve4c9479b11955648dad558fe717a4eb2->item(0): false;if ($v6a2139364f96787c8ce1bbb0070b898c) $v06e3d36fa30cea095545139854ad1fb9->setTip($v6a2139364f96787c8ce1bbb0070b898c->nodeValue);$v06e3d36fa30cea095545139854ad1fb9->commit();return $v06e3d36fa30cea095545139854ad1fb9;}protected function importBranches() {foreach ($this->meta['branches'] as $vb80bb7740288fda1f201890375a60c8f) {$this->importBranch($vb80bb7740288fda1f201890375a60c8f);}}protected function importElements() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/pages/page");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importElement($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importBranch($vb80bb7740288fda1f201890375a60c8f) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/pages/page[@id = '" . $vb80bb7740288fda1f201890375a60c8f . "']");if (!$v1a13105b7e4eb5fb2e7c9515ac06aa48->length) return false;$this->importElement($v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0));$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/pages/page[@parentId = '" . $vb80bb7740288fda1f201890375a60c8f . "']");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$vf36263a38d7de5cdaa953c1e2b2f79b5 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');if ($vf36263a38d7de5cdaa953c1e2b2f79b5) $this->importBranch($vf36263a38d7de5cdaa953c1e2b2f79b5);}}protected function detectTemplateId($v6a2a431fe8b621037ea949531c28551d, $v662cbf1253ac7d8750ed9190c52163e5 = false, $v78e6dd7a49f5b0cb2106a3a434dd5c86 = false) {if($v6a2a431fe8b621037ea949531c28551d) {if ($v662cbf1253ac7d8750ed9190c52163e5 === false) $v662cbf1253ac7d8750ed9190c52163e5 = cmsController::getInstance()->getCurrentDomain()->getId();if ($v78e6dd7a49f5b0cb2106a3a434dd5c86 === false) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$vfed36e93a0509e20f2dc96cbbd85b678 = templatesCollection::getInstance()->getTemplatesList($v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);foreach($vfed36e93a0509e20f2dc96cbbd85b678 as $v4f96c7bc828b57b4a3b2b327a7a183c6) {if($v4f96c7bc828b57b4a3b2b327a7a183c6->getFilename() == $v6a2a431fe8b621037ea949531c28551d || (is_numeric($v6a2a431fe8b621037ea949531c28551d) && $v6a2a431fe8b621037ea949531c28551d == $v4f96c7bc828b57b4a3b2b327a7a183c6->getId())) {return $v4f96c7bc828b57b4a3b2b327a7a183c6->getId();}}}return false;}protected function importHierarchyRelation(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v3bd920688a19a611654416dbea871efa = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$vc02811e4c4fdd0b3549131ca8a2c74d1 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('parent-id');$v8bef1cc20ada3bef55fdf132cb2a1cb9 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('ord');$vf217d192b83450a454e357c127b20ff2 = false;$v7552cd149af7495ee7d8225974e50f80 = $this->relations->getNewIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);if (!$v7552cd149af7495ee7d8225974e50f80) return false;$vdb6d9b451b818ccc9a449383f2f0c450 = umiHierarchy::getInstance();$v8e2dcfd7e7e24b1ca76c1193f645902b = $vdb6d9b451b818ccc9a449383f2f0c450->getElement($v7552cd149af7495ee7d8225974e50f80, true, true);if (!$v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) return false;$vbfa030fe63bacd523dd70a76cfaed98a = false;if ($vc02811e4c4fdd0b3549131ca8a2c74d1) {$vbfa030fe63bacd523dd70a76cfaed98a = $this->relations->getNewIdRelation($this->source_id, $vc02811e4c4fdd0b3549131ca8a2c74d1);}if ($vbfa030fe63bacd523dd70a76cfaed98a === false) {$vbfa030fe63bacd523dd70a76cfaed98a = $this->destination_element_id;}if ($vbfa030fe63bacd523dd70a76cfaed98a != $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId()) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setRel($vbfa030fe63bacd523dd70a76cfaed98a);$vf217d192b83450a454e357c127b20ff2 = true;}if ($v8bef1cc20ada3bef55fdf132cb2a1cb9 && $v8bef1cc20ada3bef55fdf132cb2a1cb9 != $v8e2dcfd7e7e24b1ca76c1193f645902b->getOrd()) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setOrd($v8bef1cc20ada3bef55fdf132cb2a1cb9);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();}if ($vf217d192b83450a454e357c127b20ff2) {$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();return $vbfa030fe63bacd523dd70a76cfaed98a;}return false;}protected function importElement(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$v5f6492d9717ccf1b8566bd4bc64110b6 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('type-id');$vdff819de3d610895b1bdf4168281488c = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('update-only') == '1';$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('name');$vb068931cc450442b63f5b3d276ea4297 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : false;$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('template');$v66f6181bcb4cff4cd38fbc804a036db6 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : null;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError("Can't create element \"{$vb068931cc450442b63f5b3d276ea4297}\" with empty id");return false;}$vd84ff935144e00c3e1d395c2379aca47 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('alt-name');if (!strlen($vd84ff935144e00c3e1d395c2379aca47)) $vd84ff935144e00c3e1d395c2379aca47 = $vb068931cc450442b63f5b3d276ea4297;$v4264c638e0098acb172519b0436db099 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-active') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-active') : null;$vd33d1e928d54a353100641ff7d704306 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('parentId') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('parentId') : null;$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-visible') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-visible') : null;$vf49e2553045b3240a95c36854d36dddc = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-deleted') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-deleted') : null;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('lang-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('lang-id') : false;$v662cbf1253ac7d8750ed9190c52163e5 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('domain-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('domain-id') : false;$vf62baf4c4ead98d50d516eca0ac5a746 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-default') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-default') : false;if($v662cbf1253ac7d8750ed9190c52163e5) $v662cbf1253ac7d8750ed9190c52163e5 = $this->relations->getNewDomainIdRelation($this->source_id, $v662cbf1253ac7d8750ed9190c52163e5);if($v78e6dd7a49f5b0cb2106a3a434dd5c86) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = $this->relations->getNewLangIdRelation($this->source_id, $v78e6dd7a49f5b0cb2106a3a434dd5c86);$vdb6d9b451b818ccc9a449383f2f0c450 = umiHierarchy::getInstance();$v953e1ee8066af1b7e55300750533ddc8 = umiObjectTypesCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v7057e8409c7c531a1a6e9ac3df4ed549 = $this->relations->getNewIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if ($v7057e8409c7c531a1a6e9ac3df4ed549 && $this->update_ignore) {$this->writeLog("Element \"" . $vb068931cc450442b63f5b3d276ea4297 . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) already exists");return $vdb6d9b451b818ccc9a449383f2f0c450->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);}if (!$v7057e8409c7c531a1a6e9ac3df4ed549) {if ($vdff819de3d610895b1bdf4168281488c) {return false;}if (!$vb068931cc450442b63f5b3d276ea4297) $vb068931cc450442b63f5b3d276ea4297 = $v61ce6a78cb3c8547fed20990c92edfe3;if (!strlen($v5f6492d9717ccf1b8566bd4bc64110b6)) {$this->reportError($this->getLabel('label-cannot-create-element') . ": \"{$vb068931cc450442b63f5b3d276ea4297}\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) ." . $this->getLabel('label-cannot-detect-type'));return false;}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getNewTypeIdRelation($this->source_id, $v5f6492d9717ccf1b8566bd4bc64110b6);$v599dcce2998a6b40b1e38e8c6006cb0a = $v953e1ee8066af1b7e55300750533ddc8->getType($v94757cae63fd3e398c0811a976dd6bbe);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {$this->reportError($this->getLabel('label-cannot-create-element') . "\"{$vb068931cc450442b63f5b3d276ea4297}\" ($v61ce6a78cb3c8547fed20990c92edfe3): " . $this->getLabel('label-cannot-detect-type') . " #{$v5f6492d9717ccf1b8566bd4bc64110b6}");return false;}$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId();if ($vacf567c9c3d6cf7c6e2cc0ce108e0631) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = umiHierarchyTypesCollection::getInstance()->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule();if (!regedit::getInstance()->getVal("//modules/{$v22884db148f0ffb0d830ba431102b0b5}")) return false;}}$v6be379826b20cc58475f636e33f4606b = false;if ($vd33d1e928d54a353100641ff7d704306) $v6be379826b20cc58475f636e33f4606b = $this->relations->getNewIdRelation($this->source_id, $vd33d1e928d54a353100641ff7d704306);if ($v6be379826b20cc58475f636e33f4606b === false) $v6be379826b20cc58475f636e33f4606b = $this->destination_element_id;$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnAddElement");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("parent_id", $v6be379826b20cc58475f636e33f4606b);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("old_element_id", $v61ce6a78cb3c8547fed20990c92edfe3);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("type", $v599dcce2998a6b40b1e38e8c6006cb0a);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);$v7057e8409c7c531a1a6e9ac3df4ed549 = $vdb6d9b451b818ccc9a449383f2f0c450->addElement($v6be379826b20cc58475f636e33f4606b, $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId(), $vb068931cc450442b63f5b3d276ea4297, $vd84ff935144e00c3e1d395c2379aca47, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);$this->imported_elements[] = $v7057e8409c7c531a1a6e9ac3df4ed549;$this->relations->setIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v7057e8409c7c531a1a6e9ac3df4ed549);if (is_null($v4264c638e0098acb172519b0436db099)) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('default-active');if ($v1a13105b7e4eb5fb2e7c9515ac06aa48->length) $v4264c638e0098acb172519b0436db099 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue;}if (is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('default-visible');if ($v1a13105b7e4eb5fb2e7c9515ac06aa48->length) $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue;}if (is_null($v66f6181bcb4cff4cd38fbc804a036db6)) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('default-template');if ($v1a13105b7e4eb5fb2e7c9515ac06aa48->length) $v66f6181bcb4cff4cd38fbc804a036db6 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue;}$ve2fa538867c3830a859a5b17ab24644b = true;}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vdb6d9b451b818ccc9a449383f2f0c450->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true, true);if (!$v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) return false;if (!$ve2fa538867c3830a859a5b17ab24644b) {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnUpdateElement");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}if ($vb068931cc450442b63f5b3d276ea4297) $v8e2dcfd7e7e24b1ca76c1193f645902b->setName($vb068931cc450442b63f5b3d276ea4297);if (!is_null($v4264c638e0098acb172519b0436db099)) $v8e2dcfd7e7e24b1ca76c1193f645902b->setIsActive($v4264c638e0098acb172519b0436db099 == 'active' || $v4264c638e0098acb172519b0436db099 == '1');if (!is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) $v8e2dcfd7e7e24b1ca76c1193f645902b->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == 'visible' || $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == '1');if ($vf62baf4c4ead98d50d516eca0ac5a746) $v8e2dcfd7e7e24b1ca76c1193f645902b->setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746 == 'default' || $vf62baf4c4ead98d50d516eca0ac5a746 == '1');if (!is_null($v66f6181bcb4cff4cd38fbc804a036db6) && $vd02e12eb6d6c3f6ebd763197df01e211 = $this->detectTemplateId($v66f6181bcb4cff4cd38fbc804a036db6, $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86)) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setTplId($vd02e12eb6d6c3f6ebd763197df01e211);}if ($ve2fa538867c3830a859a5b17ab24644b) {$va9cecbe3552e2561ce80cf4fe36d259c = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('object-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('object-id') : null;if (!is_null($va9cecbe3552e2561ce80cf4fe36d259c)) {$vaf31437ce61345f416579830a98c91e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectId();$v5e3f5f5bf865de072ff1e4cd710d4a39 = $this->relations->getNewObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c);if ($v5e3f5f5bf865de072ff1e4cd710d4a39) {$va8cfde6331bd59eb2ac96f8911c4b666 = umiObjectsCollection::getInstance()->getObject($v5e3f5f5bf865de072ff1e4cd710d4a39);if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectTypeId() == $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId()) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setObject($va8cfde6331bd59eb2ac96f8911c4b666);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();umiObjectsCollection::getInstance()->delObject($vaf31437ce61345f416579830a98c91e5);}else {$this->relations->setObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c, $vaf31437ce61345f416579830a98c91e5);}}else {$this->relations->setObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c, $vaf31437ce61345f416579830a98c91e5);}}}if ($vf49e2553045b3240a95c36854d36dddc == 'deleted' || $vf49e2553045b3240a95c36854d36dddc == '1') $v8e2dcfd7e7e24b1ca76c1193f645902b->setIsDeleted(true);$this->importPropValues($v8e2dcfd7e7e24b1ca76c1193f645902b, $vcaf9b6b99962bf5c2264824231d7a40c, $ve2fa538867c3830a859a5b17ab24644b);if ($vf49e2553045b3240a95c36854d36dddc && ($vf49e2553045b3240a95c36854d36dddc == 'deleted' || $vf49e2553045b3240a95c36854d36dddc == '1')) {$this->deleted_elements++;$this->writeLog($this->getLabel("label-page") . " \"" . $v8e2dcfd7e7e24b1ca76c1193f645902b->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel("label-has-been-deleted-m"));}elseif ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_elements++;$this->writeLog($this->getLabel("label-page") . " \"" . $v8e2dcfd7e7e24b1ca76c1193f645902b->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel("label-has-been-created-f"));}elseif($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsUpdated()) {$this->updated_elements++;$this->writeLog($this->getLabel("label-page") . " \"" . $v8e2dcfd7e7e24b1ca76c1193f645902b->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel("label-has-been-updated-f"));}if ($ve2fa538867c3830a859a5b17ab24644b) {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnAddElement");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}else {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnUpdateElement");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$vdb6d9b451b818ccc9a449383f2f0c450->unloadElement($v7057e8409c7c531a1a6e9ac3df4ed549);return $v8e2dcfd7e7e24b1ca76c1193f645902b;}protected function importLang(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$vd5d3db1765287eef77d7927cc956f50a = $vcaf9b6b99962bf5c2264824231d7a40c->nodeValue;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-language') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" " . $this->getLabel('label-with-empty-id'));return false;}$vf62baf4c4ead98d50d516eca0ac5a746 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-default') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-default') : null;$v851f5ac9941d720844d143ed9cfcf60a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('prefix') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('prefix') : null;$vdb6d9b451b818ccc9a449383f2f0c450 = langsCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v468679bdf8f19aaf448fef664b7142b7 = $this->relations->getNewLangIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if (!$v468679bdf8f19aaf448fef664b7142b7) {if($v851f5ac9941d720844d143ed9cfcf60a) {$v468679bdf8f19aaf448fef664b7142b7 = $vdb6d9b451b818ccc9a449383f2f0c450->getLangId($v851f5ac9941d720844d143ed9cfcf60a);if ($v468679bdf8f19aaf448fef664b7142b7) $this->relations->setLangIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v468679bdf8f19aaf448fef664b7142b7);}}if (!$v468679bdf8f19aaf448fef664b7142b7) {if (!$vd5d3db1765287eef77d7927cc956f50a) $vd5d3db1765287eef77d7927cc956f50a = $v61ce6a78cb3c8547fed20990c92edfe3;$v468679bdf8f19aaf448fef664b7142b7 = $vdb6d9b451b818ccc9a449383f2f0c450->addLang($v851f5ac9941d720844d143ed9cfcf60a, $vd5d3db1765287eef77d7927cc956f50a);$this->relations->setLangIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v468679bdf8f19aaf448fef664b7142b7);$ve2fa538867c3830a859a5b17ab24644b = true;}$v8512ae7d57b1396273f76fe6ed341a23 = $vdb6d9b451b818ccc9a449383f2f0c450->getLang($v468679bdf8f19aaf448fef664b7142b7);if (!$v8512ae7d57b1396273f76fe6ed341a23 instanceof lang) {$this->reportError($this->getLabel('label-cannot-detect-language') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" ");return false;}if ($vd5d3db1765287eef77d7927cc956f50a) $v8512ae7d57b1396273f76fe6ed341a23->setTitle($vd5d3db1765287eef77d7927cc956f50a);if (!is_null($vf62baf4c4ead98d50d516eca0ac5a746) && $vf62baf4c4ead98d50d516eca0ac5a746) {$vdb6d9b451b818ccc9a449383f2f0c450->setDefault($v468679bdf8f19aaf448fef664b7142b7);}if (!is_null($v851f5ac9941d720844d143ed9cfcf60a)) $v8512ae7d57b1396273f76fe6ed341a23->setPrefix($v851f5ac9941d720844d143ed9cfcf60a);$v8512ae7d57b1396273f76fe6ed341a23->commit();if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_languages++;$this->writeLog($this->getLabel('label-language') . " \"" . $v8512ae7d57b1396273f76fe6ed341a23->getTitle() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-updated-m'));}elseif($v8512ae7d57b1396273f76fe6ed341a23->getIsUpdated()) {$this->updated_languages++;$this->writeLog($this->getLabel('label-language') . " \"" . $v8512ae7d57b1396273f76fe6ed341a23->getTitle() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-created-m'));}return $v8512ae7d57b1396273f76fe6ed341a23;}protected function importDomain(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-domain') . " \"{$v67b3dba8bc6778101892eb77249db32e}\" " . $this->getLabel('label-with-empty-id'));return false;}$v67b3dba8bc6778101892eb77249db32e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('host') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('host') : null;$v596c3edc46f1e96c9f90a4b4cef2ac35 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('lang-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('lang-id') : null;$vf62baf4c4ead98d50d516eca0ac5a746 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-default') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-default') : null;$vdb6d9b451b818ccc9a449383f2f0c450 = domainsCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v662cbf1253ac7d8750ed9190c52163e5 = $this->relations->getNewDomainIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if (!$v662cbf1253ac7d8750ed9190c52163e5) {if($v67b3dba8bc6778101892eb77249db32e) {$v662cbf1253ac7d8750ed9190c52163e5 = $vdb6d9b451b818ccc9a449383f2f0c450->getDomainId($v67b3dba8bc6778101892eb77249db32e);if ($v662cbf1253ac7d8750ed9190c52163e5) $this->relations->setDomainIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v662cbf1253ac7d8750ed9190c52163e5);}}if ($v662cbf1253ac7d8750ed9190c52163e5 && $this->update_ignore) {$this->writeLog($this->getLabel('label-domain') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) " . $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getDomain($v662cbf1253ac7d8750ed9190c52163e5);}if (!$v662cbf1253ac7d8750ed9190c52163e5) {if (!$v67b3dba8bc6778101892eb77249db32e) $v67b3dba8bc6778101892eb77249db32e = $v61ce6a78cb3c8547fed20990c92edfe3;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = false;if (!is_null($v596c3edc46f1e96c9f90a4b4cef2ac35)) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = $this->relations->getNewLangIdRelation($this->source_id, $v596c3edc46f1e96c9f90a4b4cef2ac35);if (!$v78e6dd7a49f5b0cb2106a3a434dd5c86) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = langsCollection::getInstance()->getDefaultLang()->getId();$v662cbf1253ac7d8750ed9190c52163e5 = $vdb6d9b451b818ccc9a449383f2f0c450->addDomain($v67b3dba8bc6778101892eb77249db32e, $v78e6dd7a49f5b0cb2106a3a434dd5c86);$this->relations->setDomainIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v662cbf1253ac7d8750ed9190c52163e5);$ve2fa538867c3830a859a5b17ab24644b = true;}$vad5f82e879a9c5d6b5b442eb37e50551 = $vdb6d9b451b818ccc9a449383f2f0c450->getDomain($v662cbf1253ac7d8750ed9190c52163e5);if (!$vad5f82e879a9c5d6b5b442eb37e50551 instanceof domain) {$this->reportError($this->getLabel('label-cannot-detect-domain') . " \"{$v67b3dba8bc6778101892eb77249db32e}\" ");return false;}if (!is_null($vf62baf4c4ead98d50d516eca0ac5a746) && $vf62baf4c4ead98d50d516eca0ac5a746) {if(!$vdb6d9b451b818ccc9a449383f2f0c450->getDefaultDomain()) $vdb6d9b451b818ccc9a449383f2f0c450->setDefaultDomain($v662cbf1253ac7d8750ed9190c52163e5);}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_domains++;$this->writeLog($this->getLabel('label-domain') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-created-m'));}elseif($vad5f82e879a9c5d6b5b442eb37e50551->getIsUpdated()) {$this->updated_domains++;$this->writeLog($this->getLabel('label-domain') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") has been " . $this->getLabel('label-has-been-updated-m'));}$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('domain-mirror');foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importDomainMirror($vcaf9b6b99962bf5c2264824231d7a40c, $vad5f82e879a9c5d6b5b442eb37e50551);}$vad5f82e879a9c5d6b5b442eb37e50551->commit();return $vad5f82e879a9c5d6b5b442eb37e50551;}protected function importDomainMirror(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c, domain $vad5f82e879a9c5d6b5b442eb37e50551) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$v67b3dba8bc6778101892eb77249db32e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('host') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('host') : null;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-domain-mirror') . " \"{$v67b3dba8bc6778101892eb77249db32e}\" " . $this->getLabel('label-with-empty-id'));return false;}$ve2fa538867c3830a859a5b17ab24644b = false;$v1834e28d86200a836697541c12fa09bd = $this->relations->getNewDomainMirrorIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if (!$v1834e28d86200a836697541c12fa09bd) {if (!is_null($v67b3dba8bc6778101892eb77249db32e)) {$v1834e28d86200a836697541c12fa09bd = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrowId($v67b3dba8bc6778101892eb77249db32e);if ($v1834e28d86200a836697541c12fa09bd) $this->relations->setDomainMirrorIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v1834e28d86200a836697541c12fa09bd);}}if ($v1834e28d86200a836697541c12fa09bd && $this->update_ignore) {$this->writeLog($this->getLabel('label-domain') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) " . $this->getLabel('label-already-exists'));return $vad5f82e879a9c5d6b5b442eb37e50551->getMirrow($v1834e28d86200a836697541c12fa09bd);}if (!$v1834e28d86200a836697541c12fa09bd) {if (is_null($v67b3dba8bc6778101892eb77249db32e)) $v67b3dba8bc6778101892eb77249db32e = $v61ce6a78cb3c8547fed20990c92edfe3;$v1834e28d86200a836697541c12fa09bd = $vad5f82e879a9c5d6b5b442eb37e50551->addMirrow($v67b3dba8bc6778101892eb77249db32e);$this->relations->setDomainMirrorIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v1834e28d86200a836697541c12fa09bd);$ve2fa538867c3830a859a5b17ab24644b = true;}$v95be0a2e6132b4fa2294808f7dbcc52a = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrow($v1834e28d86200a836697541c12fa09bd);if (!$v95be0a2e6132b4fa2294808f7dbcc52a instanceof domainMirrow) {$this->reportError($this->getLabel('label-cannot-detect-domain-mirror') . " \"{$v67b3dba8bc6778101892eb77249db32e}\"");return false;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_domain_mirrors++;$this->writeLog($this->getLabel('label-domain-mirror') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-created-n'));}elseif($v95be0a2e6132b4fa2294808f7dbcc52a->getIsUpdated()) {$this->updated_domain_mirrors++;$this->writeLog($this->getLabel('label-domain-mirror') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-updated-n'));}return $v95be0a2e6132b4fa2294808f7dbcc52a;}protected function importTemplate(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$vd5d3db1765287eef77d7927cc956f50a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('title') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('title') : null;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-template') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" " . $this->getLabel('label-with-empty-id'));return false;}$vdb6d9b451b818ccc9a449383f2f0c450 = templatesCollection::getInstance();$v435ed7e9f07f740abf511a62c00eef6e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('filename') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('filename') : null;$vee473c9da1c9449806dd22465b875ae8 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('domain-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('domain-id') : null;$v596c3edc46f1e96c9f90a4b4cef2ac35 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('lang-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('lang-id') : null;$vf62baf4c4ead98d50d516eca0ac5a746 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-default') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-default') : null;$vb068931cc450442b63f5b3d276ea4297 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') : null;$v599dcce2998a6b40b1e38e8c6006cb0a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('type') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('type') : null;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = false;$v662cbf1253ac7d8750ed9190c52163e5 = false;if (!is_null($v596c3edc46f1e96c9f90a4b4cef2ac35)) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = $this->relations->getNewLangIdRelation($this->source_id, $v596c3edc46f1e96c9f90a4b4cef2ac35);if (!is_null($vee473c9da1c9449806dd22465b875ae8)) $v662cbf1253ac7d8750ed9190c52163e5 = $this->relations->getNewDomainIdRelation($this->source_id, $vee473c9da1c9449806dd22465b875ae8);if(!$v78e6dd7a49f5b0cb2106a3a434dd5c86) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = langsCollection::getInstance()->getDefaultLang()->getId();if(!$v662cbf1253ac7d8750ed9190c52163e5) $v662cbf1253ac7d8750ed9190c52163e5 = domainsCollection::getInstance()->getDefaultTemplate()->getId();$ve2fa538867c3830a859a5b17ab24644b = false;$v74f5356453a69e438e0f58ef93103cc0 = $this->relations->getNewTemplateIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if ($v74f5356453a69e438e0f58ef93103cc0 && $this->update_ignore) {$this->writeLog($this->getLabel('label-template') . " \"" . $vd5d3db1765287eef77d7927cc956f50a . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) " . $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getTemplate($v74f5356453a69e438e0f58ef93103cc0);}if (!$v74f5356453a69e438e0f58ef93103cc0) {if (!$vd5d3db1765287eef77d7927cc956f50a) $vd5d3db1765287eef77d7927cc956f50a = $v61ce6a78cb3c8547fed20990c92edfe3;$v74f5356453a69e438e0f58ef93103cc0 = $this->detectTemplateId($v435ed7e9f07f740abf511a62c00eef6e, $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);if(!$v74f5356453a69e438e0f58ef93103cc0) $v74f5356453a69e438e0f58ef93103cc0 = $vdb6d9b451b818ccc9a449383f2f0c450->addTemplate($v435ed7e9f07f740abf511a62c00eef6e, $vd5d3db1765287eef77d7927cc956f50a);$this->relations->setTemplateIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v74f5356453a69e438e0f58ef93103cc0);$ve2fa538867c3830a859a5b17ab24644b = true;}$v66f6181bcb4cff4cd38fbc804a036db6 = $vdb6d9b451b818ccc9a449383f2f0c450->getTemplate($v74f5356453a69e438e0f58ef93103cc0);if (!$v66f6181bcb4cff4cd38fbc804a036db6 instanceof template) {$this->reportError($this->getLabel('label-cannot-detect-template') . "\"{$vd5d3db1765287eef77d7927cc956f50a}\"");return false;}if (!is_null($vf62baf4c4ead98d50d516eca0ac5a746)) $v66f6181bcb4cff4cd38fbc804a036db6->setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746);if (!is_null($vb068931cc450442b63f5b3d276ea4297)) $v66f6181bcb4cff4cd38fbc804a036db6->setName($vb068931cc450442b63f5b3d276ea4297);if (!is_null($v599dcce2998a6b40b1e38e8c6006cb0a)) $v66f6181bcb4cff4cd38fbc804a036db6->setType($v599dcce2998a6b40b1e38e8c6006cb0a);$v66f6181bcb4cff4cd38fbc804a036db6->setLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86);$v66f6181bcb4cff4cd38fbc804a036db6->setDomainId($v662cbf1253ac7d8750ed9190c52163e5);if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_templates++;$this->writeLog($this->getLabel('label-template') . " \"" . $vd5d3db1765287eef77d7927cc956f50a . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " .  $this->getLabel('label-has-been-created-m'));}elseif($v66f6181bcb4cff4cd38fbc804a036db6->getIsUpdated()) {$this->updated_templates++;$this->writeLog($this->getLabel('label-template') . " \"" . $vd5d3db1765287eef77d7927cc956f50a . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " .  $this->getLabel('label-has-been-updated-m'));}$v66f6181bcb4cff4cd38fbc804a036db6->commit();return $v66f6181bcb4cff4cd38fbc804a036db6;}protected function importRestriction(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$vd5d3db1765287eef77d7927cc956f50a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('title') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('title') : null;$v851f5ac9941d720844d143ed9cfcf60a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('prefix') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('prefix') : null;$v17f71d965fe9589ddbd11caf7182243e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('field-type') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('field-type') : null;$vce495ab8d79db0d37413d8e95b54e606 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-multiple') == 1 || $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-multiple') == "multiple";if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-restriction') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" " . $this->getLabel('label-with-empty-id'));return false;}$vdb6d9b451b818ccc9a449383f2f0c450 = umiFieldTypesCollection::getInstance();$v519504d7d4beb745dac24ccfb6c1d7c9 = $vdb6d9b451b818ccc9a449383f2f0c450->getFieldTypeByDataType($v17f71d965fe9589ddbd11caf7182243e, $vce495ab8d79db0d37413d8e95b54e606);$v94757cae63fd3e398c0811a976dd6bbe = $v519504d7d4beb745dac24ccfb6c1d7c9->getId();$ve2fa538867c3830a859a5b17ab24644b = false;$v228c63e369a5906eb7f0500a13729edc = false;if (!$vd5d3db1765287eef77d7927cc956f50a) $vd5d3db1765287eef77d7927cc956f50a = $v61ce6a78cb3c8547fed20990c92edfe3;if(baseRestriction::find($v851f5ac9941d720844d143ed9cfcf60a, $v94757cae63fd3e398c0811a976dd6bbe)) {$v228c63e369a5906eb7f0500a13729edc = baseRestriction::find($v851f5ac9941d720844d143ed9cfcf60a, $v94757cae63fd3e398c0811a976dd6bbe)->getId();if ($v228c63e369a5906eb7f0500a13729edc != $this->relations->getNewRestrictionIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3)) {$this->relations->setRestrictionIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v228c63e369a5906eb7f0500a13729edc);}}if (!$v228c63e369a5906eb7f0500a13729edc) $v228c63e369a5906eb7f0500a13729edc = $this->relations->getNewRestrictionIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if(!$v228c63e369a5906eb7f0500a13729edc) {$v228c63e369a5906eb7f0500a13729edc = baseRestriction::add($v851f5ac9941d720844d143ed9cfcf60a, $vd5d3db1765287eef77d7927cc956f50a, $v94757cae63fd3e398c0811a976dd6bbe);$this->relations->setRestrictionIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v228c63e369a5906eb7f0500a13729edc);$ve2fa538867c3830a859a5b17ab24644b = true;}$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v228c63e369a5906eb7f0500a13729edc);if (!$v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) {$this->reportError($this->getLabel('label-cannot-detect-restriction') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\"");return false;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_restrictions++;$this->writeLog($this->getLabel('label-restriction') . " \"" . $v3dadfaeb46ec74762b37de11fea7605c->getTitle() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-created-n'));}$vd05b6ed7d2345020440df396d6da7f73 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('field');foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v39b7b22d803b1a0270c9c6c6f8a3b4cb) {$v6adb6b0ad1941d569b23e089910c5e74 = $v39b7b22d803b1a0270c9c6c6f8a3b4cb->getAttribute('field-name');$v2741adf691b2acf0359a6a73234bc605 = $v39b7b22d803b1a0270c9c6c6f8a3b4cb->getAttribute('type-id');$v87306dd4235ed712ebc07fe169b76f83 = $this->relations->getNewTypeIdRelation($this->source_id, $v2741adf691b2acf0359a6a73234bc605);if (!$v87306dd4235ed712ebc07fe169b76f83) continue;$v3aabf39f2d943fa886d86dcbbee4d910 = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83)->getFieldId(self::translateName($v6adb6b0ad1941d569b23e089910c5e74), false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83)->getFieldId($v6adb6b0ad1941d569b23e089910c5e74, false);$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {$this->reportError($this->getLabel('label-cannot-set-restriction-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\": " . $this->getLabel('label-cannot-detect-field'));continue;}$v06e3d36fa30cea095545139854ad1fb9->setRestrictionId($v228c63e369a5906eb7f0500a13729edc);$v06e3d36fa30cea095545139854ad1fb9->setIsUpdated();$this->writeLog($this->getLabel('label-restriction') . " \"" . $v3dadfaeb46ec74762b37de11fea7605c->getTitle() . "\" " . $this->getLabel('label-has-been-set-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\"");}return $v3dadfaeb46ec74762b37de11fea7605c;}protected function importReg(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$vd6fe1d0be6347b8ef2427fa629c04485 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('path') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('path') : null;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('val') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('val') : null;$vd56f1805d22496cadf21ef1153ed9729 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('update') ? true : false;if (!strlen($vd6fe1d0be6347b8ef2427fa629c04485)) {$this->reportError($this->getLabel('label-cannot-create-registry-item-with-empty-path'));return false;}$ve2fa538867c3830a859a5b17ab24644b = false;$v0f81d52e06caaa4860887488d18271c7 = false;$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();if(!$vb1444fb0c07653567ad325aa25d4e37a->getKey($vd6fe1d0be6347b8ef2427fa629c04485)){$vb1444fb0c07653567ad325aa25d4e37a->setVal($vd6fe1d0be6347b8ef2427fa629c04485, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$ve2fa538867c3830a859a5b17ab24644b = true;$v64274c99ceefb2aaeacf6761a0c22bb7 = $vb1444fb0c07653567ad325aa25d4e37a->getKey($vd6fe1d0be6347b8ef2427fa629c04485);}elseif ($vd56f1805d22496cadf21ef1153ed9729) {$vb1444fb0c07653567ad325aa25d4e37a->setVal($vd6fe1d0be6347b8ef2427fa629c04485, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v0f81d52e06caaa4860887488d18271c7 = true;$v64274c99ceefb2aaeacf6761a0c22bb7 = $vb1444fb0c07653567ad325aa25d4e37a->getKey($vd6fe1d0be6347b8ef2427fa629c04485);}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_registry_items++;$this->writeLog($this->getLabel('label-registry-item') . " \"" . $vd6fe1d0be6347b8ef2427fa629c04485 . "\" (" . $v64274c99ceefb2aaeacf6761a0c22bb7 . ") " . $this->getLabel('label-has-been-created-f'));}elseif ($v0f81d52e06caaa4860887488d18271c7) {$this->writeLog("Registry item \"" . $vd6fe1d0be6347b8ef2427fa629c04485 . "\" (" . $v64274c99ceefb2aaeacf6761a0c22bb7 . ") has been updated");}}protected function importTypeRelation(umiField $v06e3d36fa30cea095545139854ad1fb9, DOMElement $vcaf9b6b99962bf5c2264824231d7a40c, umiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a) {$v8328b28850bcb3400e7349ac3d5602c6 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('guide');$vd535f8615f1de2e299e22535183a9d22 = $v8328b28850bcb3400e7349ac3d5602c6->length ? $v8328b28850bcb3400e7349ac3d5602c6->item(0)->getAttribute('id') : false;$v051369818a8073bba5feeb0e957eb308 = $this->relations->getNewTypeIdRelation($this->source_id, $vd535f8615f1de2e299e22535183a9d22);if(!$v051369818a8073bba5feeb0e957eb308) return false;if($v06e3d36fa30cea095545139854ad1fb9->getGuideId() != $v051369818a8073bba5feeb0e957eb308) {$v06e3d36fa30cea095545139854ad1fb9->setGuideId($v051369818a8073bba5feeb0e957eb308);$this->updated_relations++;$this->writeLog($this->getLabel('label-relation') . ': ' . $this->getLabel('label-datatype') . " (" . $v599dcce2998a6b40b1e38e8c6006cb0a->getName() . ") - " . $this->getLabel('label-field') . " (" . $v06e3d36fa30cea095545139854ad1fb9->getName() . ") - " . $this->getLabel('label-guide') . " ({$v051369818a8073bba5feeb0e957eb308}) " . $this->getLabel('label-has-been-updated-f'));$v06e3d36fa30cea095545139854ad1fb9->commit();}return true;}protected function importEntityRelation(umiField $v06e3d36fa30cea095545139854ad1fb9, DOMElement $vcaf9b6b99962bf5c2264824231d7a40c,  $vf5e638cc78dd325906c1298a0c21fb6b) {$v73f329f154a663bfda020aadcdd0b775 = $v06e3d36fa30cea095545139854ad1fb9->getName();$v7b8b965ad4bca0e41ab51de7b31363a1 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('object');$v8a835ad560df7fd10a6de48e2a41cab9 = array();foreach ($v7b8b965ad4bca0e41ab51de7b31363a1 as $vbe8f80182e0c983916da7338c2c1c040) {$vdfa97186b5b1022fcd7e8a1565ca0281 = $vbe8f80182e0c983916da7338c2c1c040->getAttribute('id');$v818ad5ef6588e140ecb9f81e810c028a = (int) $this->relations->getNewObjectIdRelation($this->source_id, $vdfa97186b5b1022fcd7e8a1565ca0281);if ($v818ad5ef6588e140ecb9f81e810c028a) $v8a835ad560df7fd10a6de48e2a41cab9[] = $v818ad5ef6588e140ecb9f81e810c028a;}$v83878c91171338902e0fe0fb97a8c47a = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('page');$va604734f6232fb47dbae6e45c3ea1267 = array();foreach ($v83878c91171338902e0fe0fb97a8c47a as $v235ec52392b77977539cf78b62e708d3) {$vbffcbc6014e374bbf5cdb7d4ae50793b = $v235ec52392b77977539cf78b62e708d3->getAttribute('id');$v90ebb72e4e25752c5cf4b97588aa65b8 = (int) $this->relations->getNewIdRelation($this->source_id, $vbffcbc6014e374bbf5cdb7d4ae50793b);if ($v90ebb72e4e25752c5cf4b97588aa65b8) $va604734f6232fb47dbae6e45c3ea1267[] = $v90ebb72e4e25752c5cf4b97588aa65b8;}$v0f81d52e06caaa4860887488d18271c7 = false;$v89111891eb7be9259794ada04dbf5856 = ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) ? "object" : "page";$vdffc4713b6bf326dc0d3e2805bc742fd = $vf5e638cc78dd325906c1298a0c21fb6b->getId();if (count($v8a835ad560df7fd10a6de48e2a41cab9)) {$v2063c1608d6e0baf80249c42e2be5804 = $vf5e638cc78dd325906c1298a0c21fb6b->getValue($v73f329f154a663bfda020aadcdd0b775);if(!is_array($v2063c1608d6e0baf80249c42e2be5804)) $v2063c1608d6e0baf80249c42e2be5804 = array($v2063c1608d6e0baf80249c42e2be5804);if(count(array_diff($v8a835ad560df7fd10a6de48e2a41cab9, $v2063c1608d6e0baf80249c42e2be5804))) {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v73f329f154a663bfda020aadcdd0b775, $v8a835ad560df7fd10a6de48e2a41cab9);$this->updated_relations++;$v0f81d52e06caaa4860887488d18271c7 = true;}}elseif (count($va604734f6232fb47dbae6e45c3ea1267)) {$v2063c1608d6e0baf80249c42e2be5804 = $vf5e638cc78dd325906c1298a0c21fb6b->getValue($v73f329f154a663bfda020aadcdd0b775);if(!is_array($v2063c1608d6e0baf80249c42e2be5804)) $v2063c1608d6e0baf80249c42e2be5804 = array($v2063c1608d6e0baf80249c42e2be5804);if(count(array_diff($va604734f6232fb47dbae6e45c3ea1267, $v2063c1608d6e0baf80249c42e2be5804))) {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v73f329f154a663bfda020aadcdd0b775, $va604734f6232fb47dbae6e45c3ea1267);$this->updated_relations++;$v0f81d52e06caaa4860887488d18271c7 = true;}}else {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v73f329f154a663bfda020aadcdd0b775, array());}if ($v0f81d52e06caaa4860887488d18271c7) {if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) {$this->writeLog($this->getLabel('label-values-for-field') . " ({$v73f329f154a663bfda020aadcdd0b775}) " . $this->getLabel('label-of-object') . " ({$vdffc4713b6bf326dc0d3e2805bc742fd}) " . $this->getLabel('label-have-been-updated'));}else {$this->writeLog($this->getLabel('label-values-for-field') . " ({$v73f329f154a663bfda020aadcdd0b775}) " . $this->getLabel('label-of-object') . " ({$vdffc4713b6bf326dc0d3e2805bc742fd}) " . $this->getLabel('label-have-been-updated'));}}$vf5e638cc78dd325906c1298a0c21fb6b->commit();if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) {umiObjectsCollection::getInstance()->unloadObject($vdffc4713b6bf326dc0d3e2805bc742fd);}else {umiHierarchy::getInstance()->unloadElement($vdffc4713b6bf326dc0d3e2805bc742fd);}return true;}protected function importRelation(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v5f6492d9717ccf1b8566bd4bc64110b6 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('type-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('type-id') : null;$ve6cdc29ecb7e2f6d140e54f2dd369628 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('page-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('page-id') : null;$va9cecbe3552e2561ce80cf4fe36d259c = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('object-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('object-id') : null;$v6adb6b0ad1941d569b23e089910c5e74 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('field-name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('field-name') : null;if (!strlen($v5f6492d9717ccf1b8566bd4bc64110b6) && !strlen($ve6cdc29ecb7e2f6d140e54f2dd369628) && !strlen($va9cecbe3552e2561ce80cf4fe36d259c)) {$this->reportError($this->getLabel('label-cannot-create-relation-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\":" . $this->getLabel('label-cannot-detect-entity'));return false;}$v94757cae63fd3e398c0811a976dd6bbe = null;$vf5e638cc78dd325906c1298a0c21fb6b = null;if (!is_null($v5f6492d9717ccf1b8566bd4bc64110b6)) {$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getNewTypeIdRelation($this->source_id, $v5f6492d9717ccf1b8566bd4bc64110b6);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);}elseif (!is_null($ve6cdc29ecb7e2f6d140e54f2dd369628)) {$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getNewIdRelation($this->source_id, $ve6cdc29ecb7e2f6d140e54f2dd369628);$vf5e638cc78dd325906c1298a0c21fb6b = umiHierarchy::getInstance()->getElement($v1a63c8004d716c8b91f5b7af780555b9, true, true);}elseif(!is_null($va9cecbe3552e2561ce80cf4fe36d259c)) {$vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);}if (!$vf5e638cc78dd325906c1298a0c21fb6b) {$this->reportError($this->getLabel('label-cannot-create-relation-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\": " . $this->getLabel('label-cannot-detect-entity'));return false;}if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiHierarchyElement) $v94757cae63fd3e398c0811a976dd6bbe = $vf5e638cc78dd325906c1298a0c21fb6b->getObjectTypeId();if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) $v94757cae63fd3e398c0811a976dd6bbe = $vf5e638cc78dd325906c1298a0c21fb6b->getTypeId();$v3aabf39f2d943fa886d86dcbbee4d910 = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe)->getFieldId(self::translateName($v6adb6b0ad1941d569b23e089910c5e74), false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe)->getFieldId($v6adb6b0ad1941d569b23e089910c5e74, false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) {$this->reportError($this->getLabel('label-cannot-create-relation-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\":" . $this->getLabel('label-cannot-detect-field'));return false;}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObjectType) {return $this->importTypeRelation($v06e3d36fa30cea095545139854ad1fb9, $vcaf9b6b99962bf5c2264824231d7a40c, $vf5e638cc78dd325906c1298a0c21fb6b);}else {return $this->importEntityRelation($v06e3d36fa30cea095545139854ad1fb9, $vcaf9b6b99962bf5c2264824231d7a40c, $vf5e638cc78dd325906c1298a0c21fb6b);}}protected function importPermission(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$ve6cdc29ecb7e2f6d140e54f2dd369628 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('page-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('page-id') : null;$va9cecbe3552e2561ce80cf4fe36d259c = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('object-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('object-id') : null;if (!strlen($ve6cdc29ecb7e2f6d140e54f2dd369628) && !strlen($va9cecbe3552e2561ce80cf4fe36d259c)) {$this->reportError($this->getLabel('label-cannot-create-permission') . ": " . $this->getLabel('label-cannot-detect-entity'));return false;}$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$vf5e638cc78dd325906c1298a0c21fb6b = null;if(!is_null($ve6cdc29ecb7e2f6d140e54f2dd369628)) {$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getNewIdRelation($this->source_id, $ve6cdc29ecb7e2f6d140e54f2dd369628);$vf5e638cc78dd325906c1298a0c21fb6b = umiHierarchy::getInstance()->getElement($v1a63c8004d716c8b91f5b7af780555b9, true, true);}elseif(!is_null($va9cecbe3552e2561ce80cf4fe36d259c)) {$vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);}if (!$vf5e638cc78dd325906c1298a0c21fb6b) {$this->reportError($this->getLabel('label-cannot-create-permission') . ": " . $this->getLabel('label-cannot-detect-entity'));return false;}$vdffc4713b6bf326dc0d3e2805bc742fd = $vf5e638cc78dd325906c1298a0c21fb6b->getId();$vd95679752134a2d9eb61dbd7b91c4bcc = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('owner');foreach ($vd95679752134a2d9eb61dbd7b91c4bcc as $v72122ce96bfec66e2396d2e25225d70a) {$v00cf378d42d732f83e6e38e7a3d0d1bd = $v72122ce96bfec66e2396d2e25225d70a->getAttribute('id');$v5e7b19364b8de2dedd3aa48cf62706e3 = (int) $this->relations->getNewObjectIdRelation($this->source_id, $v00cf378d42d732f83e6e38e7a3d0d1bd);$vc9e9a848920877e76685b2e4e76de38d = $v72122ce96bfec66e2396d2e25225d70a->hasAttribute('level') ? $v72122ce96bfec66e2396d2e25225d70a->getAttribute('level') : null;if(!is_null($vc9e9a848920877e76685b2e4e76de38d)) {$v41275a535677f79ff347e01bc530c176->setElementPermissions($v5e7b19364b8de2dedd3aa48cf62706e3, $vdffc4713b6bf326dc0d3e2805bc742fd, $vc9e9a848920877e76685b2e4e76de38d);$ve2fa538867c3830a859a5b17ab24644b = true;$this->created_permissions++;}else {$vf5e638cc78dd325906c1298a0c21fb6b->setOwnerId($v5e7b19364b8de2dedd3aa48cf62706e3);$vf5e638cc78dd325906c1298a0c21fb6b->setIsUpdated();$vf5e638cc78dd325906c1298a0c21fb6b->commit();$this->writeLog($this->getLabel('label-owner-for-entity') . " (" . $vdffc4713b6bf326dc0d3e2805bc742fd . ") ". $this->getLabel('label-has-been-updated-m'));$this->created_permissions++;}}$v6f8f57715090da2632453988d9a1501b = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('module');foreach ($v6f8f57715090da2632453988d9a1501b as $v22884db148f0ffb0d830ba431102b0b5) {$v854203cccade0bbe21be239a208aea49 = $v22884db148f0ffb0d830ba431102b0b5->getAttribute('name');$vea9f6aca279138c58f705c8d4cb4b8ce = $v22884db148f0ffb0d830ba431102b0b5->getAttribute('method');$vb394126a0e52e75f1e3d535d0fb0d33c = $v22884db148f0ffb0d830ba431102b0b5->getAttribute('allow');if ($vea9f6aca279138c58f705c8d4cb4b8ce == '' || is_null($vea9f6aca279138c58f705c8d4cb4b8ce)) {if (!$v41275a535677f79ff347e01bc530c176->isAllowedModule($vdffc4713b6bf326dc0d3e2805bc742fd, $v854203cccade0bbe21be239a208aea49)) {$v41275a535677f79ff347e01bc530c176->setModulesPermissions($vdffc4713b6bf326dc0d3e2805bc742fd, $v854203cccade0bbe21be239a208aea49);$this->writeLog($this->getLabel('label-permissions-for') . " " . $this->getLabel('label-module') . " \"{$v854203cccade0bbe21be239a208aea49}\" " . $this->getLabel('label-of-object') . " (" . $vdffc4713b6bf326dc0d3e2805bc742fd . ") " . $this->getLabel('label-have-been-updated'));$this->created_permissions++;}}else {if(!$v41275a535677f79ff347e01bc530c176->isAllowedMethod($vdffc4713b6bf326dc0d3e2805bc742fd, $v854203cccade0bbe21be239a208aea49, $vea9f6aca279138c58f705c8d4cb4b8ce)) {$v41275a535677f79ff347e01bc530c176->setModulesPermissions($vdffc4713b6bf326dc0d3e2805bc742fd, $v854203cccade0bbe21be239a208aea49, $vea9f6aca279138c58f705c8d4cb4b8ce);$this->writeLog($this->getLabel('label-permissions-for') . " " . $this->getLabel('label-module') . " \"{$v854203cccade0bbe21be239a208aea49}\" - " . $this->getLabel('label-method') . " \"{$vea9f6aca279138c58f705c8d4cb4b8ce}\" " . $this->getLabel('label-of-object') . " (" . $vdffc4713b6bf326dc0d3e2805bc742fd . ") " . $this->getLabel('label-have-been-updated'));$this->created_permissions++;}}}}protected function importOption(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$ve6cdc29ecb7e2f6d140e54f2dd369628 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('page-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('page-id') : null;$va9cecbe3552e2561ce80cf4fe36d259c = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('object-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('object-id') : null;$v6adb6b0ad1941d569b23e089910c5e74 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('field-name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('field-name') : null;if (!strlen($ve6cdc29ecb7e2f6d140e54f2dd369628) && !strlen($va9cecbe3552e2561ce80cf4fe36d259c)) {$this->reportError($this->getLabel('label-cannot-create-options-for-field') . " {$v6adb6b0ad1941d569b23e089910c5e74} " . $this->getLabel('label-cannot-detect-entity'));return false;}$vf5e638cc78dd325906c1298a0c21fb6b = null;if(!is_null($ve6cdc29ecb7e2f6d140e54f2dd369628)) {$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getNewIdRelation($this->source_id, $ve6cdc29ecb7e2f6d140e54f2dd369628);$vf5e638cc78dd325906c1298a0c21fb6b = umiHierarchy::getInstance()->getElement($v1a63c8004d716c8b91f5b7af780555b9, true, true);}elseif(!is_null($va9cecbe3552e2561ce80cf4fe36d259c)) {$vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);}if (!$vf5e638cc78dd325906c1298a0c21fb6b) {$this->reportError($this->getLabel('label-cannot-create-options-for-field') . " {$v6adb6b0ad1941d569b23e089910c5e74} " . $this->getLabel('label-cannot-detect-entity'));return false;}if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiHierarchyElement) $v94757cae63fd3e398c0811a976dd6bbe = $vf5e638cc78dd325906c1298a0c21fb6b->getObjectTypeId();if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) $v94757cae63fd3e398c0811a976dd6bbe = $vf5e638cc78dd325906c1298a0c21fb6b->getTypeId();$v3aabf39f2d943fa886d86dcbbee4d910 = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe)->getFieldId(self::translateName($v6adb6b0ad1941d569b23e089910c5e74), false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe)->getFieldId($v6adb6b0ad1941d569b23e089910c5e74, false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) {$this->reportError($this->getLabel('label-cannot-create-options-for-field') . " {$v6adb6b0ad1941d569b23e089910c5e74} " . $this->getLabel('label-cannot-detect-field'));return false;}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);$v73f329f154a663bfda020aadcdd0b775 = $v06e3d36fa30cea095545139854ad1fb9->getName();$vd95679752134a2d9eb61dbd7b91c4bcc =  $this->parser->evaluate("option", $vcaf9b6b99962bf5c2264824231d7a40c);$vf09cc7ee3a9a93273f4b80601cafb00c = array();foreach ($vd95679752134a2d9eb61dbd7b91c4bcc as $vef3e30e070f70244fd6578d88a6b77ac) {if($vef3e30e070f70244fd6578d88a6b77ac->hasAttributes()) {$v736b91750e516139acc13c5eb6564f92 = $vef3e30e070f70244fd6578d88a6b77ac->attributes;if(!is_null($v736b91750e516139acc13c5eb6564f92)) {$v2063c1608d6e0baf80249c42e2be5804 = array();foreach ($v736b91750e516139acc13c5eb6564f92 as $v6a992d5529f459a44fee58c733255e86 => $vd2eb444e35c0a71f0a85df8194acb5b6) {if($vd2eb444e35c0a71f0a85df8194acb5b6->name == 'object-id') {$vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $vd2eb444e35c0a71f0a85df8194acb5b6->value);if (!$vaf31437ce61345f416579830a98c91e5) {$this->reportError('ошибка');continue;}$vb068931cc450442b63f5b3d276ea4297 = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5)->getName();$v2063c1608d6e0baf80249c42e2be5804['rel'] = $vb068931cc450442b63f5b3d276ea4297;}elseif($vd2eb444e35c0a71f0a85df8194acb5b6->name == 'page-id') {$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getNewIdRelation($this->source_id, $vd2eb444e35c0a71f0a85df8194acb5b6->value);if (!$v1a63c8004d716c8b91f5b7af780555b9) {$this->reportError('ошибка');continue;}$vb068931cc450442b63f5b3d276ea4297 = umiHierarchy::getInstance()->getElement($v1a63c8004d716c8b91f5b7af780555b9, true, true)->getName();$v2063c1608d6e0baf80249c42e2be5804['rel'] = $vb068931cc450442b63f5b3d276ea4297;}else {$v2063c1608d6e0baf80249c42e2be5804[$vd2eb444e35c0a71f0a85df8194acb5b6->name] = $vd2eb444e35c0a71f0a85df8194acb5b6->value;}}$vf09cc7ee3a9a93273f4b80601cafb00c[] = $v2063c1608d6e0baf80249c42e2be5804;}}}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v73f329f154a663bfda020aadcdd0b775, $vf09cc7ee3a9a93273f4b80601cafb00c);$vf5e638cc78dd325906c1298a0c21fb6b->commit();}protected function importFile(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v435ed7e9f07f740abf511a62c00eef6e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') : null;$v166d2a3630c4f97c6ea560cc078ce94f = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('hash') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('hash') : null;$v857d5dae818a37d6732ac1faff247168 = $vcaf9b6b99962bf5c2264824231d7a40c->nodeValue;if(!($v857d5dae818a37d6732ac1faff247168)) {$this->reportError($this->getLabel('label-cannot-create-file-with-empty-path'));return false;}$v857d5dae818a37d6732ac1faff247168 = CURRENT_WORKING_DIR . $v857d5dae818a37d6732ac1faff247168;$va06276a5d4dfec1460f81219fda03a37 = dirname($v857d5dae818a37d6732ac1faff247168);if(!file_exists($va06276a5d4dfec1460f81219fda03a37)) mkdir($va06276a5d4dfec1460f81219fda03a37, 0777, true);$vba1383ce0ab1b09b605e4c7010356023 = $this->filesSource . $vcaf9b6b99962bf5c2264824231d7a40c->nodeValue;if (!file_exists($vba1383ce0ab1b09b605e4c7010356023)) {$this->reportError($this->getLabel('label-file') . " {$v435ed7e9f07f740abf511a62c00eef6e} " . $this->getLabel('label-does-not-exist'));return false;}if (copy($vba1383ce0ab1b09b605e4c7010356023, $v857d5dae818a37d6732ac1faff247168)) {$v18fbb70e19607c55d46df321d043feb2 = md5_file($v857d5dae818a37d6732ac1faff247168);if ($v166d2a3630c4f97c6ea560cc078ce94f != $v18fbb70e19607c55d46df321d043feb2) {$this->reportError($this->getLabel('label-file') . " {$v435ed7e9f07f740abf511a62c00eef6e} " . $this->getLabel('label-is-broken'));}else {if (defined("PHP_FILES_ACCESS_MODE") && strtolower(substr($v857d5dae818a37d6732ac1faff247168, -4, 4))==='.php') {chmod($v857d5dae818a37d6732ac1faff247168, PHP_FILES_ACCESS_MODE);}$this->copied_files++;$this->writeLog($this->getLabel('label-file') . " \"" . $v435ed7e9f07f740abf511a62c00eef6e . "\" (" . $v857d5dae818a37d6732ac1faff247168 . ") " . $this->getLabel('label-has-been-copied-m'));}}else $this->reportError($this->getLabel('label-cannot-copy-file') ." \"{$v435ed7e9f07f740abf511a62c00eef6e}\"");}protected function importDir(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$vb068931cc450442b63f5b3d276ea4297 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') : null;$vd6fe1d0be6347b8ef2427fa629c04485 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('path') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('path') : null;if(is_null($vd6fe1d0be6347b8ef2427fa629c04485)) {$this->reportError($this->getLabel('label-cannot-create-folder-with-empty-path'));return false;}else {$vd6fe1d0be6347b8ef2427fa629c04485 = CURRENT_WORKING_DIR . $vcaf9b6b99962bf5c2264824231d7a40c->nodeValue;}if(!file_exists($vd6fe1d0be6347b8ef2427fa629c04485)) {mkdir($vd6fe1d0be6347b8ef2427fa629c04485, 0777, true);$this->created_dirs++;$this->writeLog($this->getLabel('label-folder') . " \"" . $vb068931cc450442b63f5b3d276ea4297 . "\" (" . $vd6fe1d0be6347b8ef2427fa629c04485 . ") " . $this->getLabel('label-has-been-created-f'));}}protected function importObject(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError("Can't create object {$vb068931cc450442b63f5b3d276ea4297} with empty id");return false;}$v1e0ca5b1252f1f6b1e0ac91be7e7219e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('guid') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('guid') : null;$vb068931cc450442b63f5b3d276ea4297 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') : null;$v5f6492d9717ccf1b8566bd4bc64110b6 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('type-id');$vdff819de3d610895b1bdf4168281488c = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('update-only') == '1';$v1945c9a2a5e2ba6133f1db6757a35fcb = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('locked');$vdb6d9b451b818ccc9a449383f2f0c450 = umiObjectsCollection::getInstance();$v953e1ee8066af1b7e55300750533ddc8 = umiObjectTypesCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$vaf31437ce61345f416579830a98c91e5 = false;if (!is_null($v1e0ca5b1252f1f6b1e0ac91be7e7219e)) {$vaf31437ce61345f416579830a98c91e5 = $vdb6d9b451b818ccc9a449383f2f0c450->getObjectIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if ($vaf31437ce61345f416579830a98c91e5 && $vaf31437ce61345f416579830a98c91e5 != $this->relations->getNewObjectIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3)) {$this->relations->setObjectIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $vaf31437ce61345f416579830a98c91e5);}}if (!$vaf31437ce61345f416579830a98c91e5) $vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if ($vaf31437ce61345f416579830a98c91e5 && $this->update_ignore) {$this->writeLog($this->getLabel('label-object') .  " \"" . $vb068931cc450442b63f5b3d276ea4297 . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) " . $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getObject($vaf31437ce61345f416579830a98c91e5);}if (!$vaf31437ce61345f416579830a98c91e5) {if ($vdff819de3d610895b1bdf4168281488c) {return false;}if (!$vb068931cc450442b63f5b3d276ea4297) $vb068931cc450442b63f5b3d276ea4297 = $v61ce6a78cb3c8547fed20990c92edfe3;if (!strlen($v5f6492d9717ccf1b8566bd4bc64110b6)) {$this->reportError($this->getLabel('label-cannot-create-object') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}): " . $this->getLabel('label-cannot-detect-type'));return false;}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getNewTypeIdRelation($this->source_id, $v5f6492d9717ccf1b8566bd4bc64110b6);$v599dcce2998a6b40b1e38e8c6006cb0a = $v953e1ee8066af1b7e55300750533ddc8->getType($v94757cae63fd3e398c0811a976dd6bbe);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {$this->reportError($this->getLabel('label-cannot-create-object') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}): " . $this->getLabel('label-cannot-detect-type'). " #{$v5f6492d9717ccf1b8566bd4bc64110b6}");return false;}if ($this->demosite_mode) {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId();if ($vacf567c9c3d6cf7c6e2cc0ce108e0631) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = umiHierarchyTypesCollection::getInstance()->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule();if (!regedit::getInstance()->getVal("//modules/{$v22884db148f0ffb0d830ba431102b0b5}")) return false;}}}$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnAddObject");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("old_object_id", $v61ce6a78cb3c8547fed20990c92edfe3);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_info", $vcaf9b6b99962bf5c2264824231d7a40c);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("type", $v599dcce2998a6b40b1e38e8c6006cb0a);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);$vaf31437ce61345f416579830a98c91e5 = $vdb6d9b451b818ccc9a449383f2f0c450->addObject($vb068931cc450442b63f5b3d276ea4297, $v94757cae63fd3e398c0811a976dd6bbe, ($v1945c9a2a5e2ba6133f1db6757a35fcb == 'locked' || $v1945c9a2a5e2ba6133f1db6757a35fcb == '1'));$this->relations->setObjectIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $vaf31437ce61345f416579830a98c91e5);$ve2fa538867c3830a859a5b17ab24644b = true;}$va8cfde6331bd59eb2ac96f8911c4b666 = $vdb6d9b451b818ccc9a449383f2f0c450->getObject($vaf31437ce61345f416579830a98c91e5);if (!$va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) return false;if (!is_null($v1e0ca5b1252f1f6b1e0ac91be7e7219e)) $va8cfde6331bd59eb2ac96f8911c4b666->setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if (!$ve2fa538867c3830a859a5b17ab24644b) {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnUpdateObject");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("object", $va8cfde6331bd59eb2ac96f8911c4b666);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}if (!is_null($vb068931cc450442b63f5b3d276ea4297)) $va8cfde6331bd59eb2ac96f8911c4b666->setName($vb068931cc450442b63f5b3d276ea4297);$this->importPropValues($va8cfde6331bd59eb2ac96f8911c4b666, $vcaf9b6b99962bf5c2264824231d7a40c, $ve2fa538867c3830a859a5b17ab24644b);if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_objects++;$this->writeLog($this->getLabel('label-object') . " \"" . $va8cfde6331bd59eb2ac96f8911c4b666->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel('label-has-been-created-m'));}elseif($va8cfde6331bd59eb2ac96f8911c4b666->getIsUpdated()) {$this->updated_objects++;$this->writeLog($this->getLabel('label-object') . " \"" . $va8cfde6331bd59eb2ac96f8911c4b666->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel('label-has-been-updated-m'));}if ($ve2fa538867c3830a859a5b17ab24644b) {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnAddObject");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("object", $va8cfde6331bd59eb2ac96f8911c4b666);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}else {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnUpdateObject");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("object", $va8cfde6331bd59eb2ac96f8911c4b666);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}$va8cfde6331bd59eb2ac96f8911c4b666->commit();$vdb6d9b451b818ccc9a449383f2f0c450->unloadObject($vaf31437ce61345f416579830a98c91e5);return $va8cfde6331bd59eb2ac96f8911c4b666;}protected function importPropValues(umiEntinty $vf5e638cc78dd325906c1298a0c21fb6b, DOMElement $vcaf9b6b99962bf5c2264824231d7a40c, $vd08e820fd4eb48eede47aa5985d10cc8 = false) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("properties/group/property", $vcaf9b6b99962bf5c2264824231d7a40c);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v410e0a26c217dfabf8a5653e8f9e68ef) {try {$this->importPropValue($vf5e638cc78dd325906c1298a0c21fb6b, $v410e0a26c217dfabf8a5653e8f9e68ef, $vd08e820fd4eb48eede47aa5985d10cc8);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->writeLog("Can't set value #" . $vf5e638cc78dd325906c1298a0c21fb6b->getId() . "." . $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') . ": " . $ve1671797c52e15f763380b45e841ec32->getMessage());}}}protected static function translateName($vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = umiHierarchy::convertAltName($vb068931cc450442b63f5b3d276ea4297, "_");$vb068931cc450442b63f5b3d276ea4297 = umiObjectProperty::filterInputString($vb068931cc450442b63f5b3d276ea4297);if(!strlen($vb068931cc450442b63f5b3d276ea4297)) $vb068931cc450442b63f5b3d276ea4297 = '_';$vb068931cc450442b63f5b3d276ea4297 = substr($vb068931cc450442b63f5b3d276ea4297, 0, 64);return $vb068931cc450442b63f5b3d276ea4297;}protected function importPropValue(umiEntinty $vf5e638cc78dd325906c1298a0c21fb6b, DOMElement $vcaf9b6b99962bf5c2264824231d7a40c, $vd08e820fd4eb48eede47aa5985d10cc8 = false) {$v3a229433643cf8ea25f2a9b198ea70d8 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name');$vb068931cc450442b63f5b3d276ea4297 = self::translateName($v3a229433643cf8ea25f2a9b198ea70d8);$v1a13105b7e4eb5fb2e7c9515ac06aa48 =  $this->parser->evaluate("value", $vcaf9b6b99962bf5c2264824231d7a40c);if (!$v1a13105b7e4eb5fb2e7c9515ac06aa48->length && $vd08e820fd4eb48eede47aa5985d10cc8) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 =  $this->parser->evaluate("default-value", $vcaf9b6b99962bf5c2264824231d7a40c);}if (!$v1a13105b7e4eb5fb2e7c9515ac06aa48->length) {if ($vd08e820fd4eb48eede47aa5985d10cc8) $this->reportError($this->getLabel('label-property') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" " . $this->getLabel('label-has-no-values'));return false;}$v67236e502346412a98a0bb965b7a59e6 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0);$v94757cae63fd3e398c0811a976dd6bbe = ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiHierarchyElement) ? $vf5e638cc78dd325906c1298a0c21fb6b->getObjectTypeId() : $vf5e638cc78dd325906c1298a0c21fb6b->getTypeId();$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);$v3aabf39f2d943fa886d86dcbbee4d910 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($vb068931cc450442b63f5b3d276ea4297, false);$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField && $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('allow-runtime-add') == '1')  {$v562feb4548b66febf02774b4f339552e = $vcaf9b6b99962bf5c2264824231d7a40c->parentNode;$vdb0f6f37ebeb6ea09489124345af2a45 = $this->importTypeGroup($v599dcce2998a6b40b1e38e8c6006cb0a, $v562feb4548b66febf02774b4f339552e, false);if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof umiFieldsGroup) return false;$v06e3d36fa30cea095545139854ad1fb9 = $this->importField($vdb0f6f37ebeb6ea09489124345af2a45, $vcaf9b6b99962bf5c2264824231d7a40c);($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiHierarchyElement) ? $vf5e638cc78dd325906c1298a0c21fb6b->getObject()->update() : $vf5e638cc78dd325906c1298a0c21fb6b->update();}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) return false;switch($v06e3d36fa30cea095545139854ad1fb9->getDataType()) {case "optioned":    case "symlink":  {return false;}case "date": {$vd7e6d55ba379a13d08c25d15faf2a23b = intval($v67236e502346412a98a0bb965b7a59e6->getAttribute('unix-timestamp'));$v8059f160e1aa1f9d3921049ce93b00e1 = new umiDate();if ($vd7e6d55ba379a13d08c25d15faf2a23b) {$v8059f160e1aa1f9d3921049ce93b00e1->setDateByTimeStamp($vd7e6d55ba379a13d08c25d15faf2a23b);}else {$v8059f160e1aa1f9d3921049ce93b00e1->setDateByString($v67236e502346412a98a0bb965b7a59e6->nodeValue);}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v8059f160e1aa1f9d3921049ce93b00e1);break;}case "price": {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()->getModule('emarket');$v78a5eb43deef9a7b5b9ce157b9d52ac4 = $v67236e502346412a98a0bb965b7a59e6->nodeValue;$v78a5eb43deef9a7b5b9ce157b9d52ac4 = str_replace(',', '.', $v78a5eb43deef9a7b5b9ce157b9d52ac4);$v78a5eb43deef9a7b5b9ce157b9d52ac4 = floatval(preg_replace("/[^0-9.,]/", "", $v78a5eb43deef9a7b5b9ce157b9d52ac4));$v52e3817fff5250b5391ef85b1ce23bdb = $v67236e502346412a98a0bb965b7a59e6->hasAttribute('currency-code') ? $v67236e502346412a98a0bb965b7a59e6->getAttribute('currency-code') : $v67236e502346412a98a0bb965b7a59e6->getAttribute('currency_code');if (strlen($v52e3817fff5250b5391ef85b1ce23bdb) && $vfcaea7edd270964cc145ea48e4367d43) {$v1af0389838508d7016a9841eb6273962 = $vfcaea7edd270964cc145ea48e4367d43->getCurrency($v52e3817fff5250b5391ef85b1ce23bdb);if ($v1af0389838508d7016a9841eb6273962) {$result = $vfcaea7edd270964cc145ea48e4367d43->formatCurrencyPrice(array($v78a5eb43deef9a7b5b9ce157b9d52ac4), $vfcaea7edd270964cc145ea48e4367d43->getDefaultCurrency(), $v1af0389838508d7016a9841eb6273962);$v78a5eb43deef9a7b5b9ce157b9d52ac4 = $result[0];}}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v78a5eb43deef9a7b5b9ce157b9d52ac4);break;}case "file":    case "img_file":    case "video_file":    case "swf_file": {if ($this->renameFiles) {$v9d22547e12eafcfadf56ff88b9d67f4d = false;$vf83cd85f6404a7018af0fcf071f35751 = $vf5e638cc78dd325906c1298a0c21fb6b->getValue($vb068931cc450442b63f5b3d276ea4297);if ($vf83cd85f6404a7018af0fcf071f35751 instanceof umiFile) $v9d22547e12eafcfadf56ff88b9d67f4d = $vf83cd85f6404a7018af0fcf071f35751->getFilePath();$vbf0e61d0f411b035bf846149824fe352 = ltrim(trim($v67236e502346412a98a0bb965b7a59e6->nodeValue, "\r\n"), ".");$v435ed7e9f07f740abf511a62c00eef6e = basename($vbf0e61d0f411b035bf846149824fe352);$v736007832d2167baaae763fd3a3f3cf1    = dirname ($vbf0e61d0f411b035bf846149824fe352);$vabf77184f55403d75b9d51d79162a7ca = explode(".", $v435ed7e9f07f740abf511a62c00eef6e);$vabf77184f55403d75b9d51d79162a7ca = end($vabf77184f55403d75b9d51d79162a7ca);$vd70819bac4952f91adc9954c5b055aca = translit::convert(trim($vf5e638cc78dd325906c1298a0c21fb6b->getName(), "\r\n"));$v435ed7e9f07f740abf511a62c00eef6e = $vd70819bac4952f91adc9954c5b055aca;$ve2942a04780e223b215eb8b663cf5353 = 0;$v149603e6c03516362a8da23f624db945 = error_reporting(0);while(true) {if(!file_exists(CURRENT_WORKING_DIR.'/'.$vbf0e61d0f411b035bf846149824fe352)) {break(2);}else {if($v9d22547e12eafcfadf56ff88b9d67f4d) {$v46cd4eff50a3aca89f0fbc7ea6a79453 = CURRENT_WORKING_DIR . ltrim($v9d22547e12eafcfadf56ff88b9d67f4d, ".");if (file_exists($v46cd4eff50a3aca89f0fbc7ea6a79453)) unlink($v46cd4eff50a3aca89f0fbc7ea6a79453);}}if(!file_exists(CURRENT_WORKING_DIR.'/'.$v736007832d2167baaae763fd3a3f3cf1  . '/' .  $v435ed7e9f07f740abf511a62c00eef6e.'.'.$vabf77184f55403d75b9d51d79162a7ca)) {break;}$ve2942a04780e223b215eb8b663cf5353++;$v435ed7e9f07f740abf511a62c00eef6e = $vd70819bac4952f91adc9954c5b055aca . '_'.$ve2942a04780e223b215eb8b663cf5353;}$v435ed7e9f07f740abf511a62c00eef6e .= '.'.$vabf77184f55403d75b9d51d79162a7ca;rename(CURRENT_WORKING_DIR.'/'.$vbf0e61d0f411b035bf846149824fe352, CURRENT_WORKING_DIR.'/'.$v736007832d2167baaae763fd3a3f3cf1  . '/' .  $v435ed7e9f07f740abf511a62c00eef6e);error_reporting($v149603e6c03516362a8da23f624db945);$vbf0e61d0f411b035bf846149824fe352 = '.' . $v736007832d2167baaae763fd3a3f3cf1  . '/' .  $v435ed7e9f07f740abf511a62c00eef6e;$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $vbf0e61d0f411b035bf846149824fe352);}else {$v47826cacc65c665212b821e6ff80b9b0 = ltrim(trim($v67236e502346412a98a0bb965b7a59e6->nodeValue, "\r\n"), ".");$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, "." . $v47826cacc65c665212b821e6ff80b9b0);}break;}case "relation": {if($this->auto_guide_creation) {if ($vb068931cc450442b63f5b3d276ea4297 == 'payment_status_id' && $v599dcce2998a6b40b1e38e8c6006cb0a->getMethod() == 'order') {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()->getModule('emarket');if ($vfcaea7edd270964cc145ea48e4367d43) {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;$v903931b3a9d25a70683f51ab9d363d2e = $v67236e502346412a98a0bb965b7a59e6->nodeValue;$v70a17ffa722a3985b86d30b034ad06d7 = order::get($vf5e638cc78dd325906c1298a0c21fb6b->id);$v70a17ffa722a3985b86d30b034ad06d7->setPaymentStatus($v903931b3a9d25a70683f51ab9d363d2e);$v70a17ffa722a3985b86d30b034ad06d7->commit();umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = true;}}elseif ($vb068931cc450442b63f5b3d276ea4297 == 'status_id' && $v599dcce2998a6b40b1e38e8c6006cb0a->getMethod() == 'order') {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()->getModule('emarket');if ($vfcaea7edd270964cc145ea48e4367d43) {$v903931b3a9d25a70683f51ab9d363d2e = $v67236e502346412a98a0bb965b7a59e6->nodeValue;$v70a17ffa722a3985b86d30b034ad06d7 = order::get($vf5e638cc78dd325906c1298a0c21fb6b->id);$vc8db1069270b4aad8a8d03a1d939bc26 = $v70a17ffa722a3985b86d30b034ad06d7->getOrderStatus();$vf48da84a2621e8cad36af3c0af958502 = $v70a17ffa722a3985b86d30b034ad06d7->getCodeByStatus($vc8db1069270b4aad8a8d03a1d939bc26);if (!in_array($vf48da84a2621e8cad36af3c0af958502, array('ready', 'canceled', 'rejected'))) {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;$v70a17ffa722a3985b86d30b034ad06d7->setOrderStatus($v903931b3a9d25a70683f51ab9d363d2e);$v70a17ffa722a3985b86d30b034ad06d7->commit();umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = true;}}}else {$v691d502cfd0e0626cd3b058e5682ad1c = array();$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $v67236e502346412a98a0bb965b7a59e6->getElementsByTagName("item");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $ve795119eccc6565f098fca8454bad366) {$v691d502cfd0e0626cd3b058e5682ad1c[] = $ve795119eccc6565f098fca8454bad366->getAttribute('name');}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v691d502cfd0e0626cd3b058e5682ad1c);}}break;}case "tags": {$v1a13105b7e4eb5fb2e7c9515ac06aa48 =  $this->parser->evaluate("combined", $vcaf9b6b99962bf5c2264824231d7a40c);if ($v67236e502346412a98a0bb965b7a59e6 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)) $vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, trim($v67236e502346412a98a0bb965b7a59e6->nodeValue, "\r\n"));break;}case "string":    case "text":    case "wysiwyg":    case "boolean":    case "counter":    case "float":    case "int": {if ($vb068931cc450442b63f5b3d276ea4297 == 'payment_type_id' || $vb068931cc450442b63f5b3d276ea4297 == 'modificator_type_id' || $vb068931cc450442b63f5b3d276ea4297 == 'rule_type_id' || $vb068931cc450442b63f5b3d276ea4297 == 'delivery_type_id') {$v7f7cfde5ec586119b48911a2c75851e5 = $this->relations->getNewTypeIdRelation($this->source_id, $v67236e502346412a98a0bb965b7a59e6->nodeValue);if ($v7f7cfde5ec586119b48911a2c75851e5) $vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v7f7cfde5ec586119b48911a2c75851e5);break;}}default: {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, trim($v67236e502346412a98a0bb965b7a59e6->nodeValue, "\r\n"));break;}}}protected function importLangs() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/langs/lang");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importLang($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importObjects() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/objects/object");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importObject($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importDomains() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/domains/domain");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importDomain($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importTemplates() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/templates/template");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importTemplate($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importFiles() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/files/file");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importFile($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importDirs() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/directories/directory");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importDir($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importRelations () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/relations/relation");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importRelation($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importRestrictions () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/restrictions/restriction");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importRestriction($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importRegistry () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/registry/key");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importReg($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function setDefaultPermissions () {if(!count($this->imported_elements)) return;$vdb6d9b451b818ccc9a449383f2f0c450 = permissionsCollection::getInstance();foreach ($this->imported_elements as $v7057e8409c7c531a1a6e9ac3df4ed549) {$vdb6d9b451b818ccc9a449383f2f0c450->setDefaultPermissions($v7057e8409c7c531a1a6e9ac3df4ed549);}}protected function importPermissions () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/permissions/permission");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importPermission($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importOptions () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/options/entity");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importOption($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importDataTypes () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/datatypes/datatype");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importFieldType($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importHierarchy() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/hierarchy/relation");if($v1a13105b7e4eb5fb2e7c9515ac06aa48->length) {$vc68ad910ed49ac65f21f1bf2c5dbf912 = array();foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$vbfa030fe63bacd523dd70a76cfaed98a = $this->importHierarchyRelation($vcaf9b6b99962bf5c2264824231d7a40c);if ($vbfa030fe63bacd523dd70a76cfaed98a !== false) $vc68ad910ed49ac65f21f1bf2c5dbf912[$vbfa030fe63bacd523dd70a76cfaed98a] = $vbfa030fe63bacd523dd70a76cfaed98a;}foreach($vc68ad910ed49ac65f21f1bf2c5dbf912 as $vbfa030fe63bacd523dd70a76cfaed98a) {umiHierarchy::getInstance()->rebuildRelationNodes($vbfa030fe63bacd523dd70a76cfaed98a);}}}};interface iUmiImportRelations {public function getSourceId($v7c95caafbd5e4b5db3977617a0498de6);public function addNewSource($v7c95caafbd5e4b5db3977617a0498de6);public function setIdRelation($v52195dae0174459c5f066fa0df053c26, $v3bd920688a19a611654416dbea871efa, $v6c02b5bcb9b148d7b3321dfdb2ba85a0);public function getNewIdRelation($v52195dae0174459c5f066fa0df053c26, $v3bd920688a19a611654416dbea871efa);public function getOldIdRelation($v52195dae0174459c5f066fa0df053c26, $v6c02b5bcb9b148d7b3321dfdb2ba85a0);public function setTypeIdRelation($v52195dae0174459c5f066fa0df053c26, $v3bd920688a19a611654416dbea871efa, $v6c02b5bcb9b148d7b3321dfdb2ba85a0);public function getNewTypeIdRelation($v52195dae0174459c5f066fa0df053c26, $v3bd920688a19a611654416dbea871efa);public function getOldTypeIdRelation($v52195dae0174459c5f066fa0df053c26, $v6c02b5bcb9b148d7b3321dfdb2ba85a0);public function setFieldIdRelation($v52195dae0174459c5f066fa0df053c26, $v5f694956811487225d15e973ca38fbab, $vb5cf8e26a05f5b35fcd36ef010257265, $v91f4aa77405f5ac3f401e6b818402ddc);public function getNewFieldId($v52195dae0174459c5f066fa0df053c26, $v5f694956811487225d15e973ca38fbab, $vb5cf8e26a05f5b35fcd36ef010257265);public function getOldFieldName($v52195dae0174459c5f066fa0df053c26, $v5f694956811487225d15e973ca38fbab, $v91f4aa77405f5ac3f401e6b818402ddc);};class umiImportRelations extends singleton implements iUmiImportRelations {protected function __construct() {}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function getSourceId($vaf721e88e6c0a612be51c329cb2bc12a) {$vaf721e88e6c0a612be51c329cb2bc12a = l_mysql_real_escape_string($vaf721e88e6c0a612be51c329cb2bc12a);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms3_import_sources WHERE source_name = '{$vaf721e88e6c0a612be51c329cb2bc12a}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a,true);if(list($v0afd9202ba86aa11ce63ad7007e7990b) = mysql_fetch_row($result)) {return $v0afd9202ba86aa11ce63ad7007e7990b;}else {return false;}}public function addNewSource($vaf721e88e6c0a612be51c329cb2bc12a) {if($v0afd9202ba86aa11ce63ad7007e7990b = $this->getSourceId($vaf721e88e6c0a612be51c329cb2bc12a)) {return $v0afd9202ba86aa11ce63ad7007e7990b;}else {$vaf721e88e6c0a612be51c329cb2bc12a = l_mysql_real_escape_string($vaf721e88e6c0a612be51c329cb2bc12a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_sources (source_name) VALUES('{$vaf721e88e6c0a612be51c329cb2bc12a}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);return l_mysql_insert_id();}}public function setIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);if(!$ve1ecb99e7d44ff958e8773995f930c0c) {return false;}$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_relations WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND (new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' OR old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_relations (source_id, old_id, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v61ce6a78cb3c8547fed20990c92edfe3}', '{$ve1ecb99e7d44ff958e8773995f930c0c}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getNewIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_relations WHERE old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($ve1ecb99e7d44ff958e8773995f930c0c) = mysql_fetch_row($result)) {return (string) $ve1ecb99e7d44ff958e8773995f930c0c;}else {return false;}}public function getOldIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$ve1ecb99e7d44ff958e8773995f930c0c =  l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT old_id FROM cms3_import_relations WHERE new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v61ce6a78cb3c8547fed20990c92edfe3) = mysql_fetch_row($result)) {return (string) $v61ce6a78cb3c8547fed20990c92edfe3;}else {return false;}}public function setObjectIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);if(!$ve1ecb99e7d44ff958e8773995f930c0c) {return false;}$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_objects WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND (new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' OR old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_objects (source_id, old_id, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v61ce6a78cb3c8547fed20990c92edfe3}', '{$ve1ecb99e7d44ff958e8773995f930c0c}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getNewObjectIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_objects WHERE old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($ve1ecb99e7d44ff958e8773995f930c0c) = mysql_fetch_row($result)) {return (string) $ve1ecb99e7d44ff958e8773995f930c0c;}else {return false;}}public function getOldObjectIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT old_id FROM cms3_import_objects WHERE new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v61ce6a78cb3c8547fed20990c92edfe3) = mysql_fetch_row($result)) {return (string) $v61ce6a78cb3c8547fed20990c92edfe3;}else {return false;}}public function setTypeIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_types WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND (new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' OR old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_types (source_id, old_id, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v61ce6a78cb3c8547fed20990c92edfe3}', '{$ve1ecb99e7d44ff958e8773995f930c0c}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getNewTypeIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_types WHERE old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($ve1ecb99e7d44ff958e8773995f930c0c) = mysql_fetch_row($result)) {return (string) $ve1ecb99e7d44ff958e8773995f930c0c;}else {return false;}}public function getOldTypeIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT old_id FROM cms3_import_types WHERE new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v61ce6a78cb3c8547fed20990c92edfe3) = mysql_fetch_row($result)) {return (string) $v61ce6a78cb3c8547fed20990c92edfe3;}else {return false;}}public function setFieldIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v94757cae63fd3e398c0811a976dd6bbe, $v6adb6b0ad1941d569b23e089910c5e74, $v32efe3ba69eb769cff89b115a9760c26) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v94757cae63fd3e398c0811a976dd6bbe = l_mysql_real_escape_string($v94757cae63fd3e398c0811a976dd6bbe);$v6adb6b0ad1941d569b23e089910c5e74 = l_mysql_real_escape_string($v6adb6b0ad1941d569b23e089910c5e74);$v32efe3ba69eb769cff89b115a9760c26 = l_mysql_real_escape_string($v32efe3ba69eb769cff89b115a9760c26);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_fields WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}' AND (field_name = '{$v6adb6b0ad1941d569b23e089910c5e74}' OR new_id = '{$v32efe3ba69eb769cff89b115a9760c26}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_fields (source_id, type_id, field_name, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v94757cae63fd3e398c0811a976dd6bbe}', '{$v6adb6b0ad1941d569b23e089910c5e74}', '{$v32efe3ba69eb769cff89b115a9760c26}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return (string) $v32efe3ba69eb769cff89b115a9760c26;}public function getNewFieldId($v0afd9202ba86aa11ce63ad7007e7990b, $v94757cae63fd3e398c0811a976dd6bbe, $v6adb6b0ad1941d569b23e089910c5e74) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v94757cae63fd3e398c0811a976dd6bbe = l_mysql_real_escape_string($v94757cae63fd3e398c0811a976dd6bbe);$v6adb6b0ad1941d569b23e089910c5e74 = l_mysql_real_escape_string($v6adb6b0ad1941d569b23e089910c5e74);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_fields WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}' AND field_name = '{$v6adb6b0ad1941d569b23e089910c5e74}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v32efe3ba69eb769cff89b115a9760c26) = mysql_fetch_row($result)) {return (string) $v32efe3ba69eb769cff89b115a9760c26;}else {return false;}}public function getOldFieldName($v0afd9202ba86aa11ce63ad7007e7990b, $v94757cae63fd3e398c0811a976dd6bbe, $v32efe3ba69eb769cff89b115a9760c26) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v94757cae63fd3e398c0811a976dd6bbe = l_mysql_real_escape_string($v94757cae63fd3e398c0811a976dd6bbe);$v32efe3ba69eb769cff89b115a9760c26 = l_mysql_real_escape_string($v32efe3ba69eb769cff89b115a9760c26);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT field_name FROM cms3_import_fields WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}' AND new_id = '{$v32efe3ba69eb769cff89b115a9760c26}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v6adb6b0ad1941d569b23e089910c5e74) = mysql_fetch_row($result)) {return (string) $v6adb6b0ad1941d569b23e089910c5e74;}else {return false;}}public function setGroupIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v94757cae63fd3e398c0811a976dd6bbe, $v8fe62617c470a7a0465d0ccd7c6970f6, $v5f2444d49c5d43b9cf7a3d7174b983f1) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v94757cae63fd3e398c0811a976dd6bbe = l_mysql_real_escape_string($v94757cae63fd3e398c0811a976dd6bbe);$v8fe62617c470a7a0465d0ccd7c6970f6 = l_mysql_real_escape_string($v8fe62617c470a7a0465d0ccd7c6970f6);$v5f2444d49c5d43b9cf7a3d7174b983f1 = l_mysql_real_escape_string($v5f2444d49c5d43b9cf7a3d7174b983f1);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_groups WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}' AND (group_name = '{$v8fe62617c470a7a0465d0ccd7c6970f6}' OR new_id = '{$v5f2444d49c5d43b9cf7a3d7174b983f1}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_groups (source_id, type_id, group_name, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v94757cae63fd3e398c0811a976dd6bbe}', '{$v8fe62617c470a7a0465d0ccd7c6970f6}', '{$v5f2444d49c5d43b9cf7a3d7174b983f1}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return (string) $v5f2444d49c5d43b9cf7a3d7174b983f1;}public function getNewGroupId($v0afd9202ba86aa11ce63ad7007e7990b, $v94757cae63fd3e398c0811a976dd6bbe, $v8fe62617c470a7a0465d0ccd7c6970f6) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v94757cae63fd3e398c0811a976dd6bbe = l_mysql_real_escape_string($v94757cae63fd3e398c0811a976dd6bbe);$v8fe62617c470a7a0465d0ccd7c6970f6 = l_mysql_real_escape_string($v8fe62617c470a7a0465d0ccd7c6970f6);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_groups WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}' AND group_name = '{$v8fe62617c470a7a0465d0ccd7c6970f6}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v5f2444d49c5d43b9cf7a3d7174b983f1) = mysql_fetch_row($result)) {return (string) $v5f2444d49c5d43b9cf7a3d7174b983f1;}else {return false;}}public function getOldGroupName($v0afd9202ba86aa11ce63ad7007e7990b, $v94757cae63fd3e398c0811a976dd6bbe, $v5f2444d49c5d43b9cf7a3d7174b983f1) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v94757cae63fd3e398c0811a976dd6bbe = l_mysql_real_escape_string($v94757cae63fd3e398c0811a976dd6bbe);$v5f2444d49c5d43b9cf7a3d7174b983f1 = l_mysql_real_escape_string($v5f2444d49c5d43b9cf7a3d7174b983f1);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT group_name FROM cms3_import_groups WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND type_id = '{$v94757cae63fd3e398c0811a976dd6bbe}' AND new_id = '{$v5f2444d49c5d43b9cf7a3d7174b983f1}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v8fe62617c470a7a0465d0ccd7c6970f6) = mysql_fetch_row($result)) {return l_mysql_real_escape_string($v8fe62617c470a7a0465d0ccd7c6970f6);}else {return false;}}public function setDomainIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_domains WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND (new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' OR old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_domains (source_id, old_id, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v61ce6a78cb3c8547fed20990c92edfe3}', '{$ve1ecb99e7d44ff958e8773995f930c0c}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getNewDomainIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_domains WHERE old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($ve1ecb99e7d44ff958e8773995f930c0c) = mysql_fetch_row($result)) {return (string) $ve1ecb99e7d44ff958e8773995f930c0c;}else {return false;}}public function getOldDomainIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT old_id FROM cms3_import_domains WHERE new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v61ce6a78cb3c8547fed20990c92edfe3) = mysql_fetch_row($result)) {return (string) $v61ce6a78cb3c8547fed20990c92edfe3;}else {return false;}}public function setDomainMirrorIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_domain_mirrors WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND (new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' OR old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_domain_mirrors (source_id, old_id, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v61ce6a78cb3c8547fed20990c92edfe3}', '{$ve1ecb99e7d44ff958e8773995f930c0c}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getNewDomainMirrorIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_domain_mirrors WHERE old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($ve1ecb99e7d44ff958e8773995f930c0c) = mysql_fetch_row($result)) {return (string) $ve1ecb99e7d44ff958e8773995f930c0c;}else {return false;}}public function getOldDomainMirrorIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT old_id FROM cms3_import_domain_mirrors WHERE new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v61ce6a78cb3c8547fed20990c92edfe3) = mysql_fetch_row($result)) {return (string) $v61ce6a78cb3c8547fed20990c92edfe3;}else {return false;}}public function setLangIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_langs WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND (new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' OR old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_langs (source_id, old_id, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v61ce6a78cb3c8547fed20990c92edfe3}', '{$ve1ecb99e7d44ff958e8773995f930c0c}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getNewLangIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_langs WHERE old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($ve1ecb99e7d44ff958e8773995f930c0c) = mysql_fetch_row($result)) {return (string) $ve1ecb99e7d44ff958e8773995f930c0c;}else {return false;}}public function getOldLangIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT old_id FROM cms3_import_langs WHERE new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v61ce6a78cb3c8547fed20990c92edfe3) = mysql_fetch_row($result)) {return (string) $v61ce6a78cb3c8547fed20990c92edfe3;}else {return false;}}public function setTemplateIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_templates WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND (new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' OR old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_templates (source_id, old_id, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v61ce6a78cb3c8547fed20990c92edfe3}', '{$ve1ecb99e7d44ff958e8773995f930c0c}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getNewTemplateIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_templates WHERE old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($ve1ecb99e7d44ff958e8773995f930c0c) = mysql_fetch_row($result)) {return (string) $ve1ecb99e7d44ff958e8773995f930c0c;}else {return false;}}public function getOldTemplateIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT old_id FROM cms3_import_templates WHERE new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v61ce6a78cb3c8547fed20990c92edfe3) = mysql_fetch_row($result)) {return (string) $v61ce6a78cb3c8547fed20990c92edfe3;}else {return false;}}public function setRestrictionIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_import_restrictions WHERE source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}' AND (new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' OR old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_import_restrictions (source_id, old_id, new_id) VALUES('{$v0afd9202ba86aa11ce63ad7007e7990b}', '{$v61ce6a78cb3c8547fed20990c92edfe3}', '{$ve1ecb99e7d44ff958e8773995f930c0c}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getNewRestrictionIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $v61ce6a78cb3c8547fed20990c92edfe3) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$v61ce6a78cb3c8547fed20990c92edfe3 = l_mysql_real_escape_string($v61ce6a78cb3c8547fed20990c92edfe3);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT new_id FROM cms3_import_restrictions WHERE old_id = '{$v61ce6a78cb3c8547fed20990c92edfe3}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($ve1ecb99e7d44ff958e8773995f930c0c) = mysql_fetch_row($result)) {return (string) $ve1ecb99e7d44ff958e8773995f930c0c;}else {return false;}}public function getOldRestrictionIdRelation($v0afd9202ba86aa11ce63ad7007e7990b, $ve1ecb99e7d44ff958e8773995f930c0c) {$v0afd9202ba86aa11ce63ad7007e7990b = l_mysql_real_escape_string($v0afd9202ba86aa11ce63ad7007e7990b);$ve1ecb99e7d44ff958e8773995f930c0c = l_mysql_real_escape_string($ve1ecb99e7d44ff958e8773995f930c0c);$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT old_id FROM cms3_import_restrictions WHERE new_id = '{$ve1ecb99e7d44ff958e8773995f930c0c}' AND source_id = '{$v0afd9202ba86aa11ce63ad7007e7990b}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(list($v61ce6a78cb3c8547fed20990c92edfe3) = mysql_fetch_row($result)) {return (string) $v61ce6a78cb3c8547fed20990c92edfe3;}else {return false;}}};interface iUmiImportSplitter {public function __construct($v599dcce2998a6b40b1e38e8c6006cb0a);static public function get($v6f66e878c62db60568a3487869695820);public function load($v97fd815a3803a0588876bdd862014fed, $v471827d86551eb9b51f054d563c85636 = 100, $v7a86c157ee9713c34fbd7a1ee40f0c5a = 0);public function translate(DomDocument $v9a09b4dfda82e3e665e31092d1c3ec8d);public function getXML();public function getDocument();public function getOffset();}abstract class umiImportSplitter implements iUmiImportSplitter {protected $offset = 0;protected $block_size = 10;protected $type = "";protected $file_path = false;protected $complete = false;public $ignoreParentGroups = true;public $autoGuideCreation = false;public $renameFiles = false;abstract protected function readDataBlock();final static public function get($v6f66e878c62db60568a3487869695820) {if($v7c27535f88bae9519ceb14a8983c57ff = self::loadWrapper($v6f66e878c62db60568a3487869695820)) {return $v7c27535f88bae9519ceb14a8983c57ff;}else {throw new publicException("Can't load splitter for type \"{$v6f66e878c62db60568a3487869695820}\"");}}public function translate(DomDocument $v9a09b4dfda82e3e665e31092d1c3ec8d) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$vd0c75bac742760cf71fd76cd75d0c02a = CURRENT_WORKING_DIR . '/xsl/import/' . $this->type . '.xsl';if (!is_file($vd0c75bac742760cf71fd76cd75d0c02a)) {throw new publicException("Can't load translator {$vd0c75bac742760cf71fd76cd75d0c02a}");}$v640eac53ad75db5c49a9ec86390d8530 = umiTemplater::create('XSLT', $vd0c75bac742760cf71fd76cd75d0c02a);return $v640eac53ad75db5c49a9ec86390d8530->parse($v9a09b4dfda82e3e665e31092d1c3ec8d);}public function __construct($v599dcce2998a6b40b1e38e8c6006cb0a) {$this->type = $v599dcce2998a6b40b1e38e8c6006cb0a;}final static private function loadWrapper($v6f66e878c62db60568a3487869695820) {static $v2430fe39e225818bd957ed4cb53eb770 = array(), $v2245023265ae4cf87d02c8b6ba991139;if(isset($v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820])) {return $v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820];}if(is_null($v2245023265ae4cf87d02c8b6ba991139)) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();}$v46d111d8fa2089a051889becc4736cc4 = $v6f66e878c62db60568a3487869695820 . 'Splitter';$v47826cacc65c665212b821e6ff80b9b0 = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.kernel') . 'subsystems/import/splitters/' . $v46d111d8fa2089a051889becc4736cc4 . '.php';if(is_file($v47826cacc65c665212b821e6ff80b9b0) == false) {$v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = false;throw new publicException("Can't load splitter \"{$v47826cacc65c665212b821e6ff80b9b0}\" for \"{$v6f66e878c62db60568a3487869695820}\" file type");}require $v47826cacc65c665212b821e6ff80b9b0;if(!class_exists($v46d111d8fa2089a051889becc4736cc4)) {$v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = false;throw new publicException("Spliter class \"{$v46d111d8fa2089a051889becc4736cc4}\" not found");}$v7c27535f88bae9519ceb14a8983c57ff = new $v46d111d8fa2089a051889becc4736cc4($v6f66e878c62db60568a3487869695820);if($v7c27535f88bae9519ceb14a8983c57ff instanceof self == false) {$v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = false;throw new publicException("Splitter class \"{$v46d111d8fa2089a051889becc4736cc4}\" should be instance of umiImportSplitter");}return $v2430fe39e225818bd957ed4cb53eb770[$v6f66e878c62db60568a3487869695820] = $v7c27535f88bae9519ceb14a8983c57ff;}public function load($v97fd815a3803a0588876bdd862014fed, $v471827d86551eb9b51f054d563c85636 = 100, $v7a86c157ee9713c34fbd7a1ee40f0c5a = 0) {if (!is_file($v97fd815a3803a0588876bdd862014fed)) {throw new publicException("File " . $v97fd815a3803a0588876bdd862014fed . " does not exists.");}$this->block_size = (int) $v471827d86551eb9b51f054d563c85636;$this->offset = (int) $v7a86c157ee9713c34fbd7a1ee40f0c5a;$this->file_path = $v97fd815a3803a0588876bdd862014fed;}public function getIsComplete() {return $this->complete;}public function getXML() {$v9a09b4dfda82e3e665e31092d1c3ec8d = $this->readDataBlock();return $v9a09b4dfda82e3e665e31092d1c3ec8d ? $v9a09b4dfda82e3e665e31092d1c3ec8d->saveXML() : false;}public function getDocument() {$v9a09b4dfda82e3e665e31092d1c3ec8d = $this->readDataBlock();return $v9a09b4dfda82e3e665e31092d1c3ec8d;}public function getOffset() {return $this->offset;}public function getRenameFiles() {return (bool) $this->renameFiles;}}class umiDump20Splitter extends umiImportSplitter {protected function __getNodeParents(DOMNode $v8e2dcfd7e7e24b1ca76c1193f645902b) {$vc68ad910ed49ac65f21f1bf2c5dbf912 = array();$vc68ad910ed49ac65f21f1bf2c5dbf912[] = $v8e2dcfd7e7e24b1ca76c1193f645902b->nodeName;if (($vd0e45878043844ffc41aac437e86b602 = $v8e2dcfd7e7e24b1ca76c1193f645902b->parentNode) instanceof DOMElement) {$vc68ad910ed49ac65f21f1bf2c5dbf912 = array_merge($this->__getNodeParents($v8e2dcfd7e7e24b1ca76c1193f645902b->parentNode), $vc68ad910ed49ac65f21f1bf2c5dbf912);}return $vc68ad910ed49ac65f21f1bf2c5dbf912;}protected function __getNodePath(DOMNode $v8e2dcfd7e7e24b1ca76c1193f645902b) {return implode("/", $this->__getNodeParents($v8e2dcfd7e7e24b1ca76c1193f645902b));}protected function readDataBlock() {$v4b43b0aee35624cd95b910189b3dc231 = new XMLReader;$v4b43b0aee35624cd95b910189b3dc231->open($this->file_path);$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$vf7c163939469a0b7becb4e4e6a94efac = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.kernel') . 'subsystems/import/schemes/' . $this->type . '.xsd';if (is_file($vf7c163939469a0b7becb4e4e6a94efac)) {$v4b43b0aee35624cd95b910189b3dc231->setSchema($vf7c163939469a0b7becb4e4e6a94efac);}$v9a09b4dfda82e3e665e31092d1c3ec8d = new DomDocument("1.0", "utf-8");$v07214c6750d983a32e0a33da225c4efd = array(    'umidump/registry/key',    'umidump/files/file',    'umidump/directories/directory',    'umidump/langs/lang',    'umidump/domains/domain',    'umidump/templates/template',    'umidump/datatypes/datatype',    'umidump/types/type',    'umidump/pages/page',    'umidump/objects/object',    'umidump/relations/relation',    'umidump/options/entity',    'umidump/restrictions/restriction',    'umidump/permissions/permission',    'umidump/hierarchy/relation'   );$v95723b5e620e47cf613462b9f293282a = 0;$v4757fe07fd492a8be0ea6a760d683d6e = 0;$v5f0b6ebc4bea10285ba2b8a6ce78b863 = $v9a09b4dfda82e3e665e31092d1c3ec8d;$v7aa28ed115707345d0274032757e8991 = $v4b43b0aee35624cd95b910189b3dc231->read();while ($v7aa28ed115707345d0274032757e8991 && $v95723b5e620e47cf613462b9f293282a <= $this->block_size) {switch ($v4b43b0aee35624cd95b910189b3dc231->nodeType) {case XMLReader::ELEMENT: {$v3f02ab347aeca12e013036ce82046c38 = $this->__getNodePath($v5f0b6ebc4bea10285ba2b8a6ce78b863);if (in_array($v3f02ab347aeca12e013036ce82046c38 . "/" . $v4b43b0aee35624cd95b910189b3dc231->name, $v07214c6750d983a32e0a33da225c4efd)) {if ($v4757fe07fd492a8be0ea6a760d683d6e++ < $this->offset) {$v7aa28ed115707345d0274032757e8991 = $v4b43b0aee35624cd95b910189b3dc231->next();continue(2);}if (($v95723b5e620e47cf613462b9f293282a + 1) > $this->block_size) break(2);$v95723b5e620e47cf613462b9f293282a++;}$v65c10911d8b8591219a21ebacf46da01 = $v9a09b4dfda82e3e665e31092d1c3ec8d->createElement($v4b43b0aee35624cd95b910189b3dc231->name, $v4b43b0aee35624cd95b910189b3dc231->value);$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($v65c10911d8b8591219a21ebacf46da01);if (!$v4b43b0aee35624cd95b910189b3dc231->isEmptyElement) {$v5f0b6ebc4bea10285ba2b8a6ce78b863 = $v65c10911d8b8591219a21ebacf46da01;}if ($v4b43b0aee35624cd95b910189b3dc231->attributeCount) {while ($v4b43b0aee35624cd95b910189b3dc231->moveToNextAttribute()) {$v815be97df65d6c4b510cd07189c5347a = $v9a09b4dfda82e3e665e31092d1c3ec8d->createAttribute($v4b43b0aee35624cd95b910189b3dc231->name);$v815be97df65d6c4b510cd07189c5347a->appendChild($v9a09b4dfda82e3e665e31092d1c3ec8d->createTextNode($v4b43b0aee35624cd95b910189b3dc231->value));$v65c10911d8b8591219a21ebacf46da01->appendChild($v815be97df65d6c4b510cd07189c5347a);}}}break;case XMLReader::END_ELEMENT: {$v5f0b6ebc4bea10285ba2b8a6ce78b863 = $v5f0b6ebc4bea10285ba2b8a6ce78b863->parentNode;}break;case XMLReader::ATTRIBUTE: {$v815be97df65d6c4b510cd07189c5347a = $v9a09b4dfda82e3e665e31092d1c3ec8d->createAttribute($v4b43b0aee35624cd95b910189b3dc231->name);$v815be97df65d6c4b510cd07189c5347a->appendChild($v9a09b4dfda82e3e665e31092d1c3ec8d->createTextNode($v4b43b0aee35624cd95b910189b3dc231->value));$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($v815be97df65d6c4b510cd07189c5347a);}break;case XMLReader::TEXT: {$vc7824f3d4d5f7b2f22d034758c1e9454 =  $v9a09b4dfda82e3e665e31092d1c3ec8d->createTextNode($v4b43b0aee35624cd95b910189b3dc231->value);$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($vc7824f3d4d5f7b2f22d034758c1e9454);}break;case XMLReader::CDATA: {$vd9ef6bda8fb69f1c7e277bd1c2cd21d1 =  $v9a09b4dfda82e3e665e31092d1c3ec8d->createCDATASection($v4b43b0aee35624cd95b910189b3dc231->value);$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($vd9ef6bda8fb69f1c7e277bd1c2cd21d1);}break;case XMLReader::NONE:     default:    }$v7aa28ed115707345d0274032757e8991 = $v4b43b0aee35624cd95b910189b3dc231->read();}$this->offset += $v95723b5e620e47cf613462b9f293282a;if (!$v7aa28ed115707345d0274032757e8991) $this->complete = true;return $v9a09b4dfda82e3e665e31092d1c3ec8d;}public function translate(DomDocument $v9a09b4dfda82e3e665e31092d1c3ec8d) {return $v9a09b4dfda82e3e665e31092d1c3ec8d->saveXML();}}if (!class_exists("umiDump20Splitter")) include_once(dirname(__FILE__) . "/umiDump20Splitter.php");class transferSplitter extends umiDump20Splitter{protected function readDataBlock() {$v9a09b4dfda82e3e665e31092d1c3ec8d = parent::readDataBlock();if ($v9a09b4dfda82e3e665e31092d1c3ec8d->getElementsByTagName('domains')->length) {$ve4e46deb7f9cc58c7abfb32e5570b6f3 = $v9a09b4dfda82e3e665e31092d1c3ec8d->getElementsByTagName('domains')->item(0);if ($ve4e46deb7f9cc58c7abfb32e5570b6f3->getElementsByTagName('domain')->length) {$vad5f82e879a9c5d6b5b442eb37e50551 = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getElementsByTagName('domain')->item(0);$vfc4dd24e8dcaab0826b9ab09db0da5bf = false;$v72ee76c5c29383b7c9f9225c1fa4d10b = false;$v495a73fe6d3367859f634a689771d209 = getRequest('param0');if ($v495a73fe6d3367859f634a689771d209) {$v6a7f245843454cf4f28ad7c5e2572aa2 = umiObjectsCollection::getInstance()->getObject($v495a73fe6d3367859f634a689771d209)->elements;if (is_array($v6a7f245843454cf4f28ad7c5e2572aa2) && count($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v72ee76c5c29383b7c9f9225c1fa4d10b = $v6a7f245843454cf4f28ad7c5e2572aa2[0]->getDomainId();}}if ($v72ee76c5c29383b7c9f9225c1fa4d10b) {$vfc4dd24e8dcaab0826b9ab09db0da5bf = domainsCollection::getInstance()->getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);}else {$vfc4dd24e8dcaab0826b9ab09db0da5bf = domainsCollection::getInstance()->getDefaultDomain();}if ($vfc4dd24e8dcaab0826b9ab09db0da5bf instanceof domain) {$v9b98b21540033f68b145fb236bd91a73 = $vfc4dd24e8dcaab0826b9ab09db0da5bf->getHost();$vad5f82e879a9c5d6b5b442eb37e50551->setAttribute('host', $v9b98b21540033f68b145fb236bd91a73);}}}return $v9a09b4dfda82e3e665e31092d1c3ec8d;}}class baseModuleAdmin {protected   $dataTypes = array('list', 'message', 'form'),   $actionTypes = array('modify', 'create', 'view');public function setDataRange($vaa9f73eea60a006820d0f8768bc8a3fc, $v7a86c157ee9713c34fbd7a1ee40f0c5a = 0) {$this->limit = (int) $vaa9f73eea60a006820d0f8768bc8a3fc;$this->offset = (int) $v7a86c157ee9713c34fbd7a1ee40f0c5a;}public function setDataRangeByPerPage($v9d85c254b5062e518a134a61950999c3, $ve1ba980ce14a8c0d7e2779f895ab8695 = 0) {$this->setDataRange($v9d85c254b5062e518a134a61950999c3, $ve1ba980ce14a8c0d7e2779f895ab8695 * $v9d85c254b5062e518a134a61950999c3);}public function setDataType($v870b60148237c1452dfb337fdd19c314) {$this->limit = false;$this->offset = false;$this->dataType = $v870b60148237c1452dfb337fdd19c314;}public function setActionType($vc3e705290a2a0a940dc4a4859b9a2fbb) {$this->actionType = $vc3e705290a2a0a940dc4a4859b9a2fbb;}public function setData($v8d777f385d3dfec8815d20f7496026dc, $vfbb44b4487415b134bce9c790a27fe5e = false) {$this->total = $vfbb44b4487415b134bce9c790a27fe5e;$this->data = $v8d777f385d3dfec8815d20f7496026dc;}public function doData() {$v181746b262df9e42f6016b8637fc8c52 = array();$v181746b262df9e42f6016b8637fc8c52['attribute:type'] = $this->dataType;$v181746b262df9e42f6016b8637fc8c52['attribute:action'] = $this->actionType;if($this->total) {$v181746b262df9e42f6016b8637fc8c52['attribute:total'] = $this->total;if(!is_null($this->offset)) {$v181746b262df9e42f6016b8637fc8c52['attribute:offset'] = $this->offset;}if(!is_null($this->limit)) {$v181746b262df9e42f6016b8637fc8c52['attribute:limit'] = $this->limit;}}$v181746b262df9e42f6016b8637fc8c52 = array_merge($v181746b262df9e42f6016b8637fc8c52, $this->data);cmsController::getInstance()->setAdminDataSet($v181746b262df9e42f6016b8637fc8c52);}public function prepareData($ve62e4d22f2d8630f6e44e2b7c3f70ddc, $v599dcce2998a6b40b1e38e8c6006cb0a) {$v8d777f385d3dfec8815d20f7496026dc = array();$this->requireSlashEnding();switch($v599dcce2998a6b40b1e38e8c6006cb0a) {case "page": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataPage($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "pages": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataPages($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "object": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataObject($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "objects": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataObjects($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "type": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataType($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "field": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataField($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "group": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataGroup($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "types": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataTypes($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "hierarchy_types": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataHierarchyTypes($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "domains": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataDomains($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "domain_mirrows": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataDomainMirrows($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "templates": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataTemplates($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "template": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataTemplate($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "settings": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataSettings($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "modules": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataModules($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}case "langs": {$v8d777f385d3dfec8815d20f7496026dc = $this->prepareDataLangs($ve62e4d22f2d8630f6e44e2b7c3f70ddc);break;}default: {throw new coreException("Data type \"{$v599dcce2998a6b40b1e38e8c6006cb0a}\" is unknown.");}}return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataPage($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8e2dcfd7e7e24b1ca76c1193f645902b = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, "element");$v186ba0d5990f6e43e7ad46f0dbaa47fb = cmsController::getInstance()->getModule("users");if ($this->systemIsLocked($v8e2dcfd7e7e24b1ca76c1193f645902b, $v186ba0d5990f6e43e7ad46f0dbaa47fb->user_id)){throw new wrongElementTypeAdminException(getLabel("error-element-locked"));}$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("sysytemBeginPageEdit");$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("user_id", $v186ba0d5990f6e43e7ad46f0dbaa47fb->user_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("lock_time", time());$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v161c9aaa4fe035e7b2f465bc59f3ab45->call();$v8d777f385d3dfec8815d20f7496026dc = array();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v89e96bd1c461a4b70d8aaaba636b0f85 = $v8b1dc169bf460ee884fceef66c6607d6->getModule("data");$v71860c77c6745379b0d44304d66b6a13 = array();if($this->actionType == "create") {$v22884db148f0ffb0d830ba431102b0b5 = get_class($this);if(getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'module')) $v22884db148f0ffb0d830ba431102b0b5 = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'module');if($this->checkAllowedElementType($ve62e4d22f2d8630f6e44e2b7c3f70ddc) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}$vea9f6aca279138c58f705c8d4cb4b8ce = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['type'];if($vea9f6aca279138c58f705c8d4cb4b8ce == "page" && $v22884db148f0ffb0d830ba431102b0b5 == "content") {$vea9f6aca279138c58f705c8d4cb4b8ce = "";}if(is_numeric($vea9f6aca279138c58f705c8d4cb4b8ce)) {$v85a0d697cef37e3885323fd9088343b0 = $v94757cae63fd3e398c0811a976dd6bbe = $vea9f6aca279138c58f705c8d4cb4b8ce;}else {$v85a0d697cef37e3885323fd9088343b0 = $v94757cae63fd3e398c0811a976dd6bbe = umiObjectTypesCollection::getInstance()->getBaseType($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);}$vd0e45878043844ffc41aac437e86b602 = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['parent'];$vcfb14cbbb0da97c5d6fc00de2231984b = templatesCollection::getInstance()->getHierarchyTypeTemplate($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);if($vd0e45878043844ffc41aac437e86b602 instanceof iUmiHierarchyElement) {$v6be379826b20cc58475f636e33f4606b = $vd0e45878043844ffc41aac437e86b602->getId();$this->checkDomainPermissions($vd0e45878043844ffc41aac437e86b602->getDomainId());$this->checkElementPermissions($v6be379826b20cc58475f636e33f4606b);$v8b1dc169bf460ee884fceef66c6607d6->currentEditElementId = $v6be379826b20cc58475f636e33f4606b;$v5a509ca3ce95bc71bf833077b7d5a178 = umiHierarchy::getInstance()->getDominantTypeId($v6be379826b20cc58475f636e33f4606b);if($v5a509ca3ce95bc71bf833077b7d5a178) {$v94757cae63fd3e398c0811a976dd6bbe = $v5a509ca3ce95bc71bf833077b7d5a178;}if($vcfb14cbbb0da97c5d6fc00de2231984b !== false) {$vd02e12eb6d6c3f6ebd763197df01e211 = $vcfb14cbbb0da97c5d6fc00de2231984b;}else {$vb6aaa85825f7ae803766f43e00873d06 = umiHierarchy::getInstance()->getDominantTplId($v6be379826b20cc58475f636e33f4606b);if($vb6aaa85825f7ae803766f43e00873d06) {$vd02e12eb6d6c3f6ebd763197df01e211 = $vb6aaa85825f7ae803766f43e00873d06;}}}else {$v6be379826b20cc58475f636e33f4606b = 0;$this->checkDomainPermissions();$v5a509ca3ce95bc71bf833077b7d5a178 = umiHierarchy::getInstance()->getDominantTypeId(0);if($v5a509ca3ce95bc71bf833077b7d5a178) {$v94757cae63fd3e398c0811a976dd6bbe = $v5a509ca3ce95bc71bf833077b7d5a178;}$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();$v662cbf1253ac7d8750ed9190c52163e5 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();if($v84ad1b49a83349491077e094ad5c5d1b = $this->getFloatedDomain()) {$v662cbf1253ac7d8750ed9190c52163e5 = $v84ad1b49a83349491077e094ad5c5d1b;}if($vcfb14cbbb0da97c5d6fc00de2231984b !== false) {$vd02e12eb6d6c3f6ebd763197df01e211 = $vcfb14cbbb0da97c5d6fc00de2231984b;}else {$v5574e9581faeef63fc053e2f5de8ddc4 = templatesCollection::getInstance()->getDefaultTemplate($v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);if($v5574e9581faeef63fc053e2f5de8ddc4 instanceof iTemplate) {$vd02e12eb6d6c3f6ebd763197df01e211 = $v5574e9581faeef63fc053e2f5de8ddc4->getId();}else {throw new publicAdminException(getLabel('error-require-default-template'));}}}if($this->compareObjectTypeByHierarchy($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $v94757cae63fd3e398c0811a976dd6bbe) == false) {$v94757cae63fd3e398c0811a976dd6bbe = $v85a0d697cef37e3885323fd9088343b0;}if(isset($ve62e4d22f2d8630f6e44e2b7c3f70ddc['type_id'])) {$v94757cae63fd3e398c0811a976dd6bbe = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['type_id'];}elseif(isset($ve62e4d22f2d8630f6e44e2b7c3f70ddc['type-id'])) {$v94757cae63fd3e398c0811a976dd6bbe = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['type-id'];}if($v94757cae63fd3e398c0811a976dd6bbe > 0) {$v71860c77c6745379b0d44304d66b6a13['attribute:name'] = "";$v71860c77c6745379b0d44304d66b6a13['attribute:parentId'] = $v6be379826b20cc58475f636e33f4606b;$v71860c77c6745379b0d44304d66b6a13['attribute:type-id'] = $v94757cae63fd3e398c0811a976dd6bbe;$v71860c77c6745379b0d44304d66b6a13['attribute:tpl-id'] = $vd02e12eb6d6c3f6ebd763197df01e211;$v71860c77c6745379b0d44304d66b6a13['attribute:active'] = "active";$v71860c77c6745379b0d44304d66b6a13['basetype'] = umiHierarchyTypesCollection::getInstance()->getTypeByName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);$v71860c77c6745379b0d44304d66b6a13['properties'] = $v89e96bd1c461a4b70d8aaaba636b0f85->getCreateForm($v94757cae63fd3e398c0811a976dd6bbe, false, false, true);}else {throw new coreException("Give me a normal type to create ;)");}if($v22884db148f0ffb0d830ba431102b0b5 == 'content' && $vea9f6aca279138c58f705c8d4cb4b8ce == '') {$v71860c77c6745379b0d44304d66b6a13['attribute:visible'] = 'visible';}}else if ($this->actionType == "modify") {if($ve62e4d22f2d8630f6e44e2b7c3f70ddc instanceof umiHierarchyElement) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $ve62e4d22f2d8630f6e44e2b7c3f70ddc;}else if (is_array($ve62e4d22f2d8630f6e44e2b7c3f70ddc)){$v8e2dcfd7e7e24b1ca76c1193f645902b = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['element'];}else {throw new coreException("Unknown type of input data");}if($this->checkAllowedElementType($ve62e4d22f2d8630f6e44e2b7c3f70ddc) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}$this->checkDomainPermissions($v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId());$this->checkElementPermissions($v8e2dcfd7e7e24b1ca76c1193f645902b->getId());$v8b1dc169bf460ee884fceef66c6607d6->currentEditElementId = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();$v475d6424dac268bb5fffd0235530c333 = umiHierarchy::getInstance();$ve643579408c43692e50dcd8edaa5bfea = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();$v76cf2d727564f745b54f7ffb9a226c54 = array();$vbd0b3e6e8d0a4cf50d9e38ed509f257c = $v475d6424dac268bb5fffd0235530c333->getObjectInstances($v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectId(), true, true, true);foreach($vbd0b3e6e8d0a4cf50d9e38ed509f257c as $vb15d7cc6038948c5f9aae452c262d0cb) {$vc68ad910ed49ac65f21f1bf2c5dbf912 = $v475d6424dac268bb5fffd0235530c333->getAllParents($vb15d7cc6038948c5f9aae452c262d0cb);$v12cba3ee81cf4a793796a51b6327c678 = $v475d6424dac268bb5fffd0235530c333->getElement($vb15d7cc6038948c5f9aae452c262d0cb);$v6b46ec64d83b3d5240d6c377ca415894 = $v12cba3ee81cf4a793796a51b6327c678->getDomainId();$va75d1d700445be04abe0d9bffa8e9424 = domainsCollection::getInstance()->getDomain($v6b46ec64d83b3d5240d6c377ca415894)->getHost();$v578bcabba34ae79708b9373708b2d9d9 = '{0}';foreach($vc68ad910ed49ac65f21f1bf2c5dbf912 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $vbfa030fe63bacd523dd70a76cfaed98a) {if($vbfa030fe63bacd523dd70a76cfaed98a == 0) {if ($ve643579408c43692e50dcd8edaa5bfea != $v6b46ec64d83b3d5240d6c377ca415894) {$v22884db148f0ffb0d830ba431102b0b5 = 'content';$vea9f6aca279138c58f705c8d4cb4b8ce = 'sitetree';$v8fe2a2fba47bf0bc403ff51c9a19dd88 = 'tree-content-sitetree-' . $v6b46ec64d83b3d5240d6c377ca415894;$vc68ad910ed49ac65f21f1bf2c5dbf912[$v3c6e0b8a9c15224a8228b9a98ca1531d] = array(         '@id' => $v6b46ec64d83b3d5240d6c377ca415894,         '@parentId' => $v6b46ec64d83b3d5240d6c377ca415894,         '@name' => $va75d1d700445be04abe0d9bffa8e9424,         '@treeLink' => $v578bcabba34ae79708b9373708b2d9d9,         '@module' => $v22884db148f0ffb0d830ba431102b0b5,         '@method' => $vea9f6aca279138c58f705c8d4cb4b8ce,         '@settingsKey' => $v8fe2a2fba47bf0bc403ff51c9a19dd88,         );}else {unset($vc68ad910ed49ac65f21f1bf2c5dbf912[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}continue;}if (!$v7c48828dd9e17583e40ddf79bf66e099 = $v475d6424dac268bb5fffd0235530c333->getElement($vbfa030fe63bacd523dd70a76cfaed98a)) {continue;}$v578bcabba34ae79708b9373708b2d9d9 .= '{'.$v7c48828dd9e17583e40ddf79bf66e099->getId().'}';$v22884db148f0ffb0d830ba431102b0b5 = $v7c48828dd9e17583e40ddf79bf66e099->getHierarchyType()->getModule();$vea9f6aca279138c58f705c8d4cb4b8ce = regedit::getInstance()->getVal('//modules/' . $v22884db148f0ffb0d830ba431102b0b5 . '/default_method_admin');$v8fe2a2fba47bf0bc403ff51c9a19dd88 = 'tree-' . $v22884db148f0ffb0d830ba431102b0b5 . '-' . $vea9f6aca279138c58f705c8d4cb4b8ce;if ($v22884db148f0ffb0d830ba431102b0b5 == 'content') {$v8fe2a2fba47bf0bc403ff51c9a19dd88 .= '-' . $v6b46ec64d83b3d5240d6c377ca415894;}$vc68ad910ed49ac65f21f1bf2c5dbf912[$v3c6e0b8a9c15224a8228b9a98ca1531d] = array(       '@id' => $v7c48828dd9e17583e40ddf79bf66e099->getId(),       '@parentId' => $v7c48828dd9e17583e40ddf79bf66e099->getParentId(),       '@name' => $v7c48828dd9e17583e40ddf79bf66e099->getName(),       '@url' => $v475d6424dac268bb5fffd0235530c333->getPathById($v7c48828dd9e17583e40ddf79bf66e099->getId()),       '@treeLink' => $v578bcabba34ae79708b9373708b2d9d9,       '@module' => $v22884db148f0ffb0d830ba431102b0b5,       '@method' => $vea9f6aca279138c58f705c8d4cb4b8ce,       '@settingsKey' => $v8fe2a2fba47bf0bc403ff51c9a19dd88,       );}$v98248c827299f5fed27aa8d5a9494032 = false;if($v91b676ebf42c59c6703b609b8e709ff9 = $v8b1dc169bf460ee884fceef66c6607d6->getModule($v12cba3ee81cf4a793796a51b6327c678->getModule())) {$v807765384d9d5527da8848df14a4f02f = $v91b676ebf42c59c6703b609b8e709ff9->getEditLink($vb15d7cc6038948c5f9aae452c262d0cb, $v12cba3ee81cf4a793796a51b6327c678->getMethod());if(is_array($v807765384d9d5527da8848df14a4f02f) && $v807765384d9d5527da8848df14a4f02f[1]) {$v98248c827299f5fed27aa8d5a9494032 = $v807765384d9d5527da8848df14a4f02f[1];}}$v023e66ca4f5881e7e3e241f9c2ad8252 = array(       '@id' => $vb15d7cc6038948c5f9aae452c262d0cb,       '@name' => $v12cba3ee81cf4a793796a51b6327c678->getName() . (sizeof($vbd0b3e6e8d0a4cf50d9e38ed509f257c) > 1 ? getLabel('js-smc-virtual-copy') : ''),       '@edit-link' => $v98248c827299f5fed27aa8d5a9494032,       '@url' => $v475d6424dac268bb5fffd0235530c333->getPathById($vb15d7cc6038948c5f9aae452c262d0cb),       '@domain' => $va75d1d700445be04abe0d9bffa8e9424,       '@domain-id' => $v6b46ec64d83b3d5240d6c377ca415894,       'basetype' => $v12cba3ee81cf4a793796a51b6327c678->getHierarchyType(),       'parents' => array('nodes:item' => $vc68ad910ed49ac65f21f1bf2c5dbf912)      );if($vb15d7cc6038948c5f9aae452c262d0cb == $v8e2dcfd7e7e24b1ca76c1193f645902b->getId()) {array_unshift($v76cf2d727564f745b54f7ffb9a226c54, $v023e66ca4f5881e7e3e241f9c2ad8252);}else {$v76cf2d727564f745b54f7ffb9a226c54[] = $v023e66ca4f5881e7e3e241f9c2ad8252;}}$v71860c77c6745379b0d44304d66b6a13['copies'] = array('nodes:copy' => $v76cf2d727564f745b54f7ffb9a226c54);$vaf31437ce61345f416579830a98c91e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getId();$v71860c77c6745379b0d44304d66b6a13['attribute:id'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();$v71860c77c6745379b0d44304d66b6a13['attribute:parentId'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();$v71860c77c6745379b0d44304d66b6a13['attribute:object-id'] = $vaf31437ce61345f416579830a98c91e5;$v71860c77c6745379b0d44304d66b6a13['attribute:guid'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getGUID();$v71860c77c6745379b0d44304d66b6a13['attribute:type-id'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getTypeId();$v71860c77c6745379b0d44304d66b6a13['attribute:type-guid'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getTypeGUID();$v71860c77c6745379b0d44304d66b6a13['attribute:alt-name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getAltName();$v71860c77c6745379b0d44304d66b6a13['attribute:tpl-id'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTplId();if($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive()) {$v71860c77c6745379b0d44304d66b6a13['attribute:active'] = "active";}if($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsVisible()) {$v71860c77c6745379b0d44304d66b6a13['attribute:visible'] = "visible";}if($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsDefault()) {$v71860c77c6745379b0d44304d66b6a13['attribute:default'] = "default";}$v71860c77c6745379b0d44304d66b6a13['basetype'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getHierarchyType();$v71860c77c6745379b0d44304d66b6a13['name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();$v71860c77c6745379b0d44304d66b6a13['properties'] = $v89e96bd1c461a4b70d8aaaba636b0f85->getEditFormWithIgnorePermissions($vaf31437ce61345f416579830a98c91e5, false, false, true, true);}$v8d777f385d3dfec8815d20f7496026dc['page'] = $v71860c77c6745379b0d44304d66b6a13;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataPages($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$vb3b32a2d422265cd25c3323ed0157f81 = array();$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($ve62e4d22f2d8630f6e44e2b7c3f70ddc);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $ve62e4d22f2d8630f6e44e2b7c3f70ddc[$v865c0c0b4ab0e063e5caa3387c1a8741];if(is_numeric($v8e2dcfd7e7e24b1ca76c1193f645902b)) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v8e2dcfd7e7e24b1ca76c1193f645902b, false, true);}if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {if(getRequest('viewMode') == 'full') {$vb3b32a2d422265cd25c3323ed0157f81[] = array('full:' => $v8e2dcfd7e7e24b1ca76c1193f645902b);}else {$vb3b32a2d422265cd25c3323ed0157f81[] = $v8e2dcfd7e7e24b1ca76c1193f645902b;$vb81ca7c0ccaa77e7aa91936ab0070695->unloadElement($v8e2dcfd7e7e24b1ca76c1193f645902b->getId());}}}$v8d777f385d3dfec8815d20f7496026dc['nodes:page'] = $vb3b32a2d422265cd25c3323ed0157f81;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataObjects($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$v69ae498121c2d8e63f20c7144a0246d7 = umiObjectsCollection::getInstance();$v5891da2d64975cae48d175d1e001f5da = array();$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($ve62e4d22f2d8630f6e44e2b7c3f70ddc);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$va8cfde6331bd59eb2ac96f8911c4b666 = $ve62e4d22f2d8630f6e44e2b7c3f70ddc[$v865c0c0b4ab0e063e5caa3387c1a8741];if(is_numeric($va8cfde6331bd59eb2ac96f8911c4b666)) {$va8cfde6331bd59eb2ac96f8911c4b666 = $v69ae498121c2d8e63f20c7144a0246d7->getObject($va8cfde6331bd59eb2ac96f8911c4b666);}if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) {if(getRequest('viewMode') == 'full') {$v5891da2d64975cae48d175d1e001f5da[] = array('full:' => $va8cfde6331bd59eb2ac96f8911c4b666);}else {$v5891da2d64975cae48d175d1e001f5da[] = $va8cfde6331bd59eb2ac96f8911c4b666;$v69ae498121c2d8e63f20c7144a0246d7->unloadObject($va8cfde6331bd59eb2ac96f8911c4b666->getId());}}}$v8d777f385d3dfec8815d20f7496026dc['nodes:object'] = $v5891da2d64975cae48d175d1e001f5da;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataObject($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$v89e96bd1c461a4b70d8aaaba636b0f85 = cmsController::getInstance()->getModule("data");if($this->checkAllowedElementType($ve62e4d22f2d8630f6e44e2b7c3f70ddc, true) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}$va8cfde6331bd59eb2ac96f8911c4b666 = array();if($this->actionType == "create") {$v5f694956811487225d15e973ca38fbab = false;$v22884db148f0ffb0d830ba431102b0b5 = get_class($this);$vea9f6aca279138c58f705c8d4cb4b8ce = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'type');if($v22884db148f0ffb0d830ba431102b0b5 && $vea9f6aca279138c58f705c8d4cb4b8ce) {$v5f694956811487225d15e973ca38fbab = umiObjectTypesCollection::getInstance()->getBaseType($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);}if(isset($ve62e4d22f2d8630f6e44e2b7c3f70ddc['type-id'])) {$v5f694956811487225d15e973ca38fbab = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['type-id'];}if($v5f694956811487225d15e973ca38fbab == false) {throw new publicAdminException("Object type id is required to create new object");}$va8cfde6331bd59eb2ac96f8911c4b666['attribute:type-id'] = $v5f694956811487225d15e973ca38fbab;$va8cfde6331bd59eb2ac96f8911c4b666['properties'] = $v89e96bd1c461a4b70d8aaaba636b0f85->getCreateForm($v5f694956811487225d15e973ca38fbab, false, false, true);}else {if($ve62e4d22f2d8630f6e44e2b7c3f70ddc instanceof umiObject == false) {if(is_object($ve62e4d22f2d8630f6e44e2b7c3f70ddc = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'object')) === false) {throw new publicAdminException(getLabel("error-expect-object"));}}$v70e8822b2e035fa3777d666207aeafa8 = new umiEventPoint("sysytemBeginObjectEdit");$v70e8822b2e035fa3777d666207aeafa8->setMode("before");$v70e8822b2e035fa3777d666207aeafa8->addRef("object", $ve62e4d22f2d8630f6e44e2b7c3f70ddc);$v70e8822b2e035fa3777d666207aeafa8->call();$va8cfde6331bd59eb2ac96f8911c4b666['attribute:id'] = $ve62e4d22f2d8630f6e44e2b7c3f70ddc->getId();$va8cfde6331bd59eb2ac96f8911c4b666['attribute:name'] = $ve62e4d22f2d8630f6e44e2b7c3f70ddc->getName();$va8cfde6331bd59eb2ac96f8911c4b666['attribute:guid'] = $ve62e4d22f2d8630f6e44e2b7c3f70ddc->getGUID();$va8cfde6331bd59eb2ac96f8911c4b666['attribute:type-id'] = $ve62e4d22f2d8630f6e44e2b7c3f70ddc->getTypeId();$va8cfde6331bd59eb2ac96f8911c4b666['attribute:type-guid'] = $ve62e4d22f2d8630f6e44e2b7c3f70ddc->getTypeGUID();$va8cfde6331bd59eb2ac96f8911c4b666['attribute:owner-id'] = $ve62e4d22f2d8630f6e44e2b7c3f70ddc->getOwnerId();$va8cfde6331bd59eb2ac96f8911c4b666['properties'] = $v89e96bd1c461a4b70d8aaaba636b0f85->getEditFormWithIgnorePermissions($ve62e4d22f2d8630f6e44e2b7c3f70ddc->getId(), false, false, true, true);}$v8d777f385d3dfec8815d20f7496026dc['object'] = $va8cfde6331bd59eb2ac96f8911c4b666;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataType($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$v8d777f385d3dfec8815d20f7496026dc['full:type'] = $ve62e4d22f2d8630f6e44e2b7c3f70ddc;xmlTranslator::$showHiddenFieldGroups = true;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataField($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();if($this->actionType == "create") {$v06e3d36fa30cea095545139854ad1fb9 = array();$v06e3d36fa30cea095545139854ad1fb9['attribute:visible'] = 'visible';$v8d777f385d3dfec8815d20f7496026dc['field'] = $v06e3d36fa30cea095545139854ad1fb9;}else {$v8d777f385d3dfec8815d20f7496026dc['full:field'] = $ve62e4d22f2d8630f6e44e2b7c3f70ddc;}return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataGroup($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();if($this->actionType == "create") {$vca16dceccba97b5f16060a7c1f62f5c7 = array();$vca16dceccba97b5f16060a7c1f62f5c7['attribute:visible'] = true;$v8d777f385d3dfec8815d20f7496026dc['group'] = $vca16dceccba97b5f16060a7c1f62f5c7;}else {if($ve62e4d22f2d8630f6e44e2b7c3f70ddc instanceof umiFieldsGroup) {$v8d777f385d3dfec8815d20f7496026dc['group'] = $ve62e4d22f2d8630f6e44e2b7c3f70ddc;}else {throw new coreException("Expected instance of umiFieldsGroup");}}return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataTypes($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$vb3827f7111095f5ba1a9f49988fe9382 = umiObjectTypesCollection::getInstance();$vd14a8022b085f9ef19d479cbdd581127 = array();$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($ve62e4d22f2d8630f6e44e2b7c3f70ddc);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v94757cae63fd3e398c0811a976dd6bbe = $ve62e4d22f2d8630f6e44e2b7c3f70ddc[$v865c0c0b4ab0e063e5caa3387c1a8741];$v599dcce2998a6b40b1e38e8c6006cb0a = $vb3827f7111095f5ba1a9f49988fe9382->getType($v94757cae63fd3e398c0811a976dd6bbe);if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {$vd14a8022b085f9ef19d479cbdd581127[] = $v599dcce2998a6b40b1e38e8c6006cb0a;}}$v8d777f385d3dfec8815d20f7496026dc['nodes:type'] = $vd14a8022b085f9ef19d479cbdd581127;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataHierarchyTypes($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$vb3827f7111095f5ba1a9f49988fe9382 = umiHierarchyTypesCollection::getInstance();$vd14a8022b085f9ef19d479cbdd581127 = array();foreach($ve62e4d22f2d8630f6e44e2b7c3f70ddc as $v447b7147e84be512208dcc0995d67ebc) {if($v447b7147e84be512208dcc0995d67ebc instanceof iUmiHierarchyType) {$vd14a8022b085f9ef19d479cbdd581127[] = $v447b7147e84be512208dcc0995d67ebc;}else {$v94757cae63fd3e398c0811a976dd6bbe = $v447b7147e84be512208dcc0995d67ebc;$v599dcce2998a6b40b1e38e8c6006cb0a = $vb3827f7111095f5ba1a9f49988fe9382->getType($v94757cae63fd3e398c0811a976dd6bbe);if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof iUmiHierarchyType) {$vd14a8022b085f9ef19d479cbdd581127[] = $v599dcce2998a6b40b1e38e8c6006cb0a;}}}$v8d777f385d3dfec8815d20f7496026dc['nodes:basetype'] = $vd14a8022b085f9ef19d479cbdd581127;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataDomains($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$ve4e46deb7f9cc58c7abfb32e5570b6f3 = array();foreach($ve62e4d22f2d8630f6e44e2b7c3f70ddc as $v447b7147e84be512208dcc0995d67ebc) {$ve4e46deb7f9cc58c7abfb32e5570b6f3[] = $v447b7147e84be512208dcc0995d67ebc;}$v8d777f385d3dfec8815d20f7496026dc['nodes:domain'] = $ve4e46deb7f9cc58c7abfb32e5570b6f3;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataDomainMirrows($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$ve4e46deb7f9cc58c7abfb32e5570b6f3 = array();foreach($ve62e4d22f2d8630f6e44e2b7c3f70ddc as $v447b7147e84be512208dcc0995d67ebc) {$ve4e46deb7f9cc58c7abfb32e5570b6f3[] = $v447b7147e84be512208dcc0995d67ebc;}$v8d777f385d3dfec8815d20f7496026dc['nodes:domainMirrow'] = $ve4e46deb7f9cc58c7abfb32e5570b6f3;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataTemplates($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$v14a0ffee308315f250f040d5b4d48560 = domainsCollection::getInstance();$ve4e46deb7f9cc58c7abfb32e5570b6f3 = array();foreach($ve62e4d22f2d8630f6e44e2b7c3f70ddc as $v67b3dba8bc6778101892eb77249db32e => $vfed36e93a0509e20f2dc96cbbd85b678) {$vad5f82e879a9c5d6b5b442eb37e50551 = array();$vad5f82e879a9c5d6b5b442eb37e50551['attribute:id'] = $v14a0ffee308315f250f040d5b4d48560->getDomainId($v67b3dba8bc6778101892eb77249db32e);$vad5f82e879a9c5d6b5b442eb37e50551['attribute:host'] = $v67b3dba8bc6778101892eb77249db32e;$vad5f82e879a9c5d6b5b442eb37e50551['nodes:template'] = $vfed36e93a0509e20f2dc96cbbd85b678;$ve4e46deb7f9cc58c7abfb32e5570b6f3[] = $vad5f82e879a9c5d6b5b442eb37e50551;}$v8d777f385d3dfec8815d20f7496026dc['nodes:domain'] = $ve4e46deb7f9cc58c7abfb32e5570b6f3;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataTemplate(iTemplate $v66f6181bcb4cff4cd38fbc804a036db6) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v8d777f385d3dfec8815d20f7496026dc = array();$vcaf9b6b99962bf5c2264824231d7a40c = array();$vcaf9b6b99962bf5c2264824231d7a40c['attribute:id'] = $v66f6181bcb4cff4cd38fbc804a036db6->getId();$vcaf9b6b99962bf5c2264824231d7a40c['attribute:name'] = $v66f6181bcb4cff4cd38fbc804a036db6->getName();$vcaf9b6b99962bf5c2264824231d7a40c['attribute:title'] = $v66f6181bcb4cff4cd38fbc804a036db6->getTitle();$vcaf9b6b99962bf5c2264824231d7a40c['attribute:filename'] = $v66f6181bcb4cff4cd38fbc804a036db6->getFileName();$vcaf9b6b99962bf5c2264824231d7a40c['attribute:type'] = $v66f6181bcb4cff4cd38fbc804a036db6->getType();$vcaf9b6b99962bf5c2264824231d7a40c['attribute:lang-id'] = $v66f6181bcb4cff4cd38fbc804a036db6->getLangId();$vcaf9b6b99962bf5c2264824231d7a40c['attribute:domain-id'] = $v66f6181bcb4cff4cd38fbc804a036db6->getDomainId();$v557f12a93c5bf0febb3b293feeb085be = $v66f6181bcb4cff4cd38fbc804a036db6->getUsedPages();$vb3b32a2d422265cd25c3323ed0157f81 = array();$v6942e8fa62b3cc9d93881a58210e2fd7 = array();foreach($v557f12a93c5bf0febb3b293feeb085be as $vfc07ae6b81515e9c73cb36ac08488ca1) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($vfc07ae6b81515e9c73cb36ac08488ca1[0]);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$v7057e8409c7c531a1a6e9ac3df4ed549 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();$vb53e8255f052e2d8f7574bfac8663930['attribute:id'] = $v7057e8409c7c531a1a6e9ac3df4ed549;$vb53e8255f052e2d8f7574bfac8663930['xlink:href'] = "upage://" . $v7057e8409c7c531a1a6e9ac3df4ed549;$v94efb9bd8805ffa2a3d248cbe836b6ef = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId();if ( !isset($v6942e8fa62b3cc9d93881a58210e2fd7[$v94efb9bd8805ffa2a3d248cbe836b6ef]) ) {$v6942e8fa62b3cc9d93881a58210e2fd7[$v94efb9bd8805ffa2a3d248cbe836b6ef] = selector::get('hierarchy-type')->id($v94efb9bd8805ffa2a3d248cbe836b6ef);}$vb53e8255f052e2d8f7574bfac8663930['basetype'] = $v6942e8fa62b3cc9d93881a58210e2fd7[$v94efb9bd8805ffa2a3d248cbe836b6ef];$vb53e8255f052e2d8f7574bfac8663930['name'] = str_replace("\"", "\\\"", $v8e2dcfd7e7e24b1ca76c1193f645902b->getName());$vb3b32a2d422265cd25c3323ed0157f81[] = $vb53e8255f052e2d8f7574bfac8663930;}$vb81ca7c0ccaa77e7aa91936ab0070695->unloadElement($vfc07ae6b81515e9c73cb36ac08488ca1[0]);}$vcaf9b6b99962bf5c2264824231d7a40c['used-pages']['nodes:page'] = $vb3b32a2d422265cd25c3323ed0157f81;$v8d777f385d3dfec8815d20f7496026dc['template'] = $vcaf9b6b99962bf5c2264824231d7a40c;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataSettings($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$v8d777f385d3dfec8815d20f7496026dc['nodes:group'] = array();foreach($ve62e4d22f2d8630f6e44e2b7c3f70ddc as $veeeb23fbd23e52a6a6ff78b9f18cbc4e => $v21ffce5b8a6cc8cc6a41448dd69623c9) {if(!is_array($v21ffce5b8a6cc8cc6a41448dd69623c9)) {continue;}$vdb0f6f37ebeb6ea09489124345af2a45 = array();$vdb0f6f37ebeb6ea09489124345af2a45['attribute:name'] = $veeeb23fbd23e52a6a6ff78b9f18cbc4e;$vdb0f6f37ebeb6ea09489124345af2a45['attribute:label'] = getLabel("group-" . $veeeb23fbd23e52a6a6ff78b9f18cbc4e);$v93da65a9fd0004d9477aeac024e08e15 = array();foreach($v21ffce5b8a6cc8cc6a41448dd69623c9 as $v26521b6206cf44c2307504f57a37bcb7 => $v6dcb021c803bcc0f8eb29ea77e28c233) {$v57289251b219b7784ca956e1cc149ea0 = def_module::getRealKey($v26521b6206cf44c2307504f57a37bcb7);$v63235cb515d30fdbbe1cd6beef1e210f = def_module::getRealKey($v26521b6206cf44c2307504f57a37bcb7, true);$vef3e30e070f70244fd6578d88a6b77ac = array();$vef3e30e070f70244fd6578d88a6b77ac['attribute:name'] = $v57289251b219b7784ca956e1cc149ea0;$vef3e30e070f70244fd6578d88a6b77ac['attribute:type'] = $v63235cb515d30fdbbe1cd6beef1e210f;$vef3e30e070f70244fd6578d88a6b77ac['attribute:label'] = getLabel("option-" . $v57289251b219b7784ca956e1cc149ea0);switch($v63235cb515d30fdbbe1cd6beef1e210f) {case "select": {$v691d502cfd0e0626cd3b058e5682ad1c = array();$v2063c1608d6e0baf80249c42e2be5804 = isset($v6dcb021c803bcc0f8eb29ea77e28c233['value']) ? $v6dcb021c803bcc0f8eb29ea77e28c233['value'] : false;foreach($v6dcb021c803bcc0f8eb29ea77e28c233 as $v82bfda7962fd12f51163ae45886c4c62 => $v9d0307ba8eb290ff0e158fc1bca7fae7) {if($v82bfda7962fd12f51163ae45886c4c62 === "value") continue;$ve253bed1357afcefc5fadfbc92f9eb97 = array();$ve253bed1357afcefc5fadfbc92f9eb97['attribute:id'] = $v82bfda7962fd12f51163ae45886c4c62;$ve253bed1357afcefc5fadfbc92f9eb97['node:name'] = $v9d0307ba8eb290ff0e158fc1bca7fae7;$v691d502cfd0e0626cd3b058e5682ad1c[] = $ve253bed1357afcefc5fadfbc92f9eb97;}$vef3e30e070f70244fd6578d88a6b77ac['value'] = array("nodes:item" => $v691d502cfd0e0626cd3b058e5682ad1c);if($v2063c1608d6e0baf80249c42e2be5804 !== false) {$vef3e30e070f70244fd6578d88a6b77ac['value']['attribute:id'] = $v2063c1608d6e0baf80249c42e2be5804;}break;}case "password": {if($v6dcb021c803bcc0f8eb29ea77e28c233) {$v6dcb021c803bcc0f8eb29ea77e28c233 = "********";}else {$v6dcb021c803bcc0f8eb29ea77e28c233 = "";}break;}case "symlink": {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v6dcb021c803bcc0f8eb29ea77e28c233 = @unserialize($v6dcb021c803bcc0f8eb29ea77e28c233);if(!is_array($v6dcb021c803bcc0f8eb29ea77e28c233)) {$v6dcb021c803bcc0f8eb29ea77e28c233 = array();}$v691d502cfd0e0626cd3b058e5682ad1c = array();foreach($v6dcb021c803bcc0f8eb29ea77e28c233 as $v82bfda7962fd12f51163ae45886c4c62) {$v447b7147e84be512208dcc0995d67ebc = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v82bfda7962fd12f51163ae45886c4c62);if($v447b7147e84be512208dcc0995d67ebc instanceof umiHierarchyElement == false) {continue;}$ve253bed1357afcefc5fadfbc92f9eb97 = array();$ve253bed1357afcefc5fadfbc92f9eb97['attribute:id'] = $v82bfda7962fd12f51163ae45886c4c62;$ve253bed1357afcefc5fadfbc92f9eb97['node:name'] = $v447b7147e84be512208dcc0995d67ebc->getName();$v691d502cfd0e0626cd3b058e5682ad1c[] = $ve253bed1357afcefc5fadfbc92f9eb97;}$vef3e30e070f70244fd6578d88a6b77ac['value'] = array('nodes:item' => $v691d502cfd0e0626cd3b058e5682ad1c);break;}default: {$vef3e30e070f70244fd6578d88a6b77ac['value'] = $v6dcb021c803bcc0f8eb29ea77e28c233;break;}}$v93da65a9fd0004d9477aeac024e08e15[] = $vef3e30e070f70244fd6578d88a6b77ac;}$vdb0f6f37ebeb6ea09489124345af2a45['nodes:option'] = $v93da65a9fd0004d9477aeac024e08e15;$v8d777f385d3dfec8815d20f7496026dc['nodes:group'][] = $vdb0f6f37ebeb6ea09489124345af2a45;}return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataModules($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$v0eb9b3af2e4a00837a1b1a854c9ea18c = array_values($ve62e4d22f2d8630f6e44e2b7c3f70ddc);$v691d502cfd0e0626cd3b058e5682ad1c = array();foreach($v0eb9b3af2e4a00837a1b1a854c9ea18c as $v854203cccade0bbe21be239a208aea49) {$ve253bed1357afcefc5fadfbc92f9eb97 = array();$ve253bed1357afcefc5fadfbc92f9eb97['attribute:label'] = getLabel('module-' . $v854203cccade0bbe21be239a208aea49);$ve253bed1357afcefc5fadfbc92f9eb97['node:module'] = $v854203cccade0bbe21be239a208aea49;$v691d502cfd0e0626cd3b058e5682ad1c[] = $ve253bed1357afcefc5fadfbc92f9eb97;}$v8d777f385d3dfec8815d20f7496026dc['nodes:module'] = $v691d502cfd0e0626cd3b058e5682ad1c;return $v8d777f385d3dfec8815d20f7496026dc;}public function prepareDataLangs($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8d777f385d3dfec8815d20f7496026dc = array();$v5a05866850c28651fe234659f6c92ada = array();foreach($ve62e4d22f2d8630f6e44e2b7c3f70ddc as $v7572559ca86e781ba8fe8073a0b725c6) {$vfbdd276e365b935bbc9e5d282201665e = array();$vfbdd276e365b935bbc9e5d282201665e['attribute:id'] = $v7572559ca86e781ba8fe8073a0b725c6->getId();$vfbdd276e365b935bbc9e5d282201665e['attribute:title'] = $v7572559ca86e781ba8fe8073a0b725c6->getTitle();$vfbdd276e365b935bbc9e5d282201665e['attribute:prefix'] = $v7572559ca86e781ba8fe8073a0b725c6->getPrefix();$v5a05866850c28651fe234659f6c92ada[] = $vfbdd276e365b935bbc9e5d282201665e;}$v8d777f385d3dfec8815d20f7496026dc['nodes:lang'] = $v5a05866850c28651fe234659f6c92ada;return $v8d777f385d3dfec8815d20f7496026dc;}public function expectParams($v21ffce5b8a6cc8cc6a41448dd69623c9) {foreach($v21ffce5b8a6cc8cc6a41448dd69623c9 as $v6fb519cd0e7b78b19a008aae9a704da9 => $vdb0f6f37ebeb6ea09489124345af2a45) {foreach($vdb0f6f37ebeb6ea09489124345af2a45 as $v26521b6206cf44c2307504f57a37bcb7 => $veca07335a33c5aeb5e1bc7c98b4b9d80) {$v57289251b219b7784ca956e1cc149ea0 = def_module::getRealKey($v26521b6206cf44c2307504f57a37bcb7);$v63235cb515d30fdbbe1cd6beef1e210f = def_module::getRealKey($v26521b6206cf44c2307504f57a37bcb7, true);$v21ffce5b8a6cc8cc6a41448dd69623c9[$v6fb519cd0e7b78b19a008aae9a704da9][$v26521b6206cf44c2307504f57a37bcb7] = $this->getExpectedParam($v57289251b219b7784ca956e1cc149ea0, $v63235cb515d30fdbbe1cd6beef1e210f, $veca07335a33c5aeb5e1bc7c98b4b9d80);}}return $v21ffce5b8a6cc8cc6a41448dd69623c9;}public function getExpectedParam($v57289251b219b7784ca956e1cc149ea0, $v63235cb515d30fdbbe1cd6beef1e210f, $veca07335a33c5aeb5e1bc7c98b4b9d80 = NULL) {global $_FILES;$v2063c1608d6e0baf80249c42e2be5804 = getRequest($v57289251b219b7784ca956e1cc149ea0);if($v63235cb515d30fdbbe1cd6beef1e210f == "status") {return NULL;}if(is_null($v2063c1608d6e0baf80249c42e2be5804) && !in_array($v63235cb515d30fdbbe1cd6beef1e210f, array('file', 'weak_guide'))) {throw new requireAdminParamException("I expect value in request for param \"" . $v57289251b219b7784ca956e1cc149ea0 . "\"");}switch($v63235cb515d30fdbbe1cd6beef1e210f) {case "float": {return (float) $v2063c1608d6e0baf80249c42e2be5804;}case "bool":    case "boolean":    case "templates":    case "guide":    case "weak_guide":    case "int": {return (int) $v2063c1608d6e0baf80249c42e2be5804;}case "password": {$v2063c1608d6e0baf80249c42e2be5804 = ($v2063c1608d6e0baf80249c42e2be5804 == "********") ? NULL : (string) $v2063c1608d6e0baf80249c42e2be5804;if($v2063c1608d6e0baf80249c42e2be5804) {try {$vc1070685cc705de2c6ef676e1b41d257 = new umiOpenSSL();$v52fcb0450476610e7d8a870e84e3ea54 = $vc1070685cc705de2c6ef676e1b41d257->supplyDefaultKeyFiles();if ($v52fcb0450476610e7d8a870e84e3ea54) {$v2063c1608d6e0baf80249c42e2be5804 = 'umipwd_b64::' . base64_encode($vc1070685cc705de2c6ef676e1b41d257->encrypt($v2063c1608d6e0baf80249c42e2be5804));}else {$v2063c1608d6e0baf80249c42e2be5804 = NULL;}}catch(publicException $ve1671797c52e15f763380b45e841ec32) {$v2063c1608d6e0baf80249c42e2be5804 = NULL;}}return $v2063c1608d6e0baf80249c42e2be5804;}case "email":    case "status":    case "string": {return (string) $v2063c1608d6e0baf80249c42e2be5804;}case "symlink": {return serialize($v2063c1608d6e0baf80249c42e2be5804);}case "file": {$v5b396db1931f24274e64fafd2e60f961 = $veca07335a33c5aeb5e1bc7c98b4b9d80['destination-folder'];$vdb0f6f37ebeb6ea09489124345af2a45 = isset($veca07335a33c5aeb5e1bc7c98b4b9d80['group']) ? $veca07335a33c5aeb5e1bc7c98b4b9d80['group'] : "pics";if($v2063c1608d6e0baf80249c42e2be5804 = umiFile::upload($vdb0f6f37ebeb6ea09489124345af2a45, $v57289251b219b7784ca956e1cc149ea0, $v5b396db1931f24274e64fafd2e60f961)) {return $v2063c1608d6e0baf80249c42e2be5804;}else {$vd6fe1d0be6347b8ef2427fa629c04485 = $v5b396db1931f24274e64fafd2e60f961 . getRequest('select_' . $v57289251b219b7784ca956e1cc149ea0);return new umiFile($vd6fe1d0be6347b8ef2427fa629c04485);}break;}case "select": {return $v2063c1608d6e0baf80249c42e2be5804;break;}default: {throw new wrongParamException("I don't expect param \"" . $v63235cb515d30fdbbe1cd6beef1e210f . "\"");}}}public function expectElement($vb2145aac704ce76dbe1ac7adac535b23, $v2133fd717402a7966ee88d06f9e0b792 = false, $vde8649b95160445760560c5e4e418ef3 = false, $vbeaf7e25161be5ef9784e550ab4fc891 = false) {$v7057e8409c7c531a1a6e9ac3df4ed549 = ($vde8649b95160445760560c5e4e418ef3) ? $vb2145aac704ce76dbe1ac7adac535b23 : (int) getRequest($vb2145aac704ce76dbe1ac7adac535b23);$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement((int) $v7057e8409c7c531a1a6e9ac3df4ed549, false, $vbeaf7e25161be5ef9784e550ab4fc891);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {return $v8e2dcfd7e7e24b1ca76c1193f645902b;}else {if($v2133fd717402a7966ee88d06f9e0b792) {throw new expectElementException(getLabel("error-expect-element"));}else {return false;}}}public function expectObject($vb2145aac704ce76dbe1ac7adac535b23, $v2133fd717402a7966ee88d06f9e0b792 = false, $vde8649b95160445760560c5e4e418ef3 = false) {$vaf31437ce61345f416579830a98c91e5 = ($vde8649b95160445760560c5e4e418ef3) ? $vb2145aac704ce76dbe1ac7adac535b23 : (int) getRequest($vb2145aac704ce76dbe1ac7adac535b23);$va8cfde6331bd59eb2ac96f8911c4b666 = umiObjectsCollection::getInstance()->getObject((int) $vaf31437ce61345f416579830a98c91e5);if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) {return $va8cfde6331bd59eb2ac96f8911c4b666;}else {if($v2133fd717402a7966ee88d06f9e0b792) {throw new expectObjectException(getLabel("error-expect-object"));}else {return false;}}}public function expectElementId($vb2145aac704ce76dbe1ac7adac535b23, $v2133fd717402a7966ee88d06f9e0b792 = false) {$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) getRequest($vb2145aac704ce76dbe1ac7adac535b23);if($v7057e8409c7c531a1a6e9ac3df4ed549 === 0 || umiHierarchy::getInstance()->isExists($v7057e8409c7c531a1a6e9ac3df4ed549)) {return $v7057e8409c7c531a1a6e9ac3df4ed549;}else {if($v2133fd717402a7966ee88d06f9e0b792) {throw new expectElementException(getLabel("error-expect-element"));}else {return false;}}}public function expectObjectId($vb2145aac704ce76dbe1ac7adac535b23, $v2133fd717402a7966ee88d06f9e0b792 = false) {$vaf31437ce61345f416579830a98c91e5 = (int) getRequest($vb2145aac704ce76dbe1ac7adac535b23);if($vaf31437ce61345f416579830a98c91e5 === 0 || umiObjectsCollection::getInstance()->isExists($vaf31437ce61345f416579830a98c91e5)) {return $vaf31437ce61345f416579830a98c91e5;}else {if($v2133fd717402a7966ee88d06f9e0b792) {throw new expectObjectException(getLabel("error-expect-object"));}else {return false;}}}public function expectObjectType($vb2145aac704ce76dbe1ac7adac535b23, $v2133fd717402a7966ee88d06f9e0b792 = false) {$v87306dd4235ed712ebc07fe169b76f83 = (int) getRequest($vb2145aac704ce76dbe1ac7adac535b23);if($v87306dd4235ed712ebc07fe169b76f83 === 0 || umiObjectTypesCollection::getInstance()->isExists($v87306dd4235ed712ebc07fe169b76f83)) {return umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);}else {if($v2133fd717402a7966ee88d06f9e0b792) {throw new expectObjectTypeException(getLabel("error-expect-object-type"));}else {return false;}}}public function expectObjectTypeId($vb2145aac704ce76dbe1ac7adac535b23, $v2133fd717402a7966ee88d06f9e0b792 = false, $vde8649b95160445760560c5e4e418ef3 = false) {$v87306dd4235ed712ebc07fe169b76f83 = (int) getRequest($vb2145aac704ce76dbe1ac7adac535b23);if($vde8649b95160445760560c5e4e418ef3) {$v87306dd4235ed712ebc07fe169b76f83 = $vb2145aac704ce76dbe1ac7adac535b23;}$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();if($v87306dd4235ed712ebc07fe169b76f83 === 0 || $v0e8133eb006c0f85ed9444ae07a60842->getType($v87306dd4235ed712ebc07fe169b76f83)) {return $v87306dd4235ed712ebc07fe169b76f83;}else {if($v2133fd717402a7966ee88d06f9e0b792) {throw new expectObjectTypeException(getLabel("error-expect-object-type"));}else {return false;}}}public function saveEditedElementData($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {if($this->checkAllowedElementType($ve62e4d22f2d8630f6e44e2b7c3f70ddc) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}$v8e2dcfd7e7e24b1ca76c1193f645902b = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, "element");$v186ba0d5990f6e43e7ad46f0dbaa47fb = cmsController::getInstance()->getModule("users");$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemModifyElement");$v4119639092e62c55ea8be348e4d9260d->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v4119639092e62c55ea8be348e4d9260d->addRef("inputData", $ve62e4d22f2d8630f6e44e2b7c3f70ddc);$v4119639092e62c55ea8be348e4d9260d->setParam("user_id", $v186ba0d5990f6e43e7ad46f0dbaa47fb->user_id);$v4119639092e62c55ea8be348e4d9260d->setMode("before");$v4119639092e62c55ea8be348e4d9260d->call();if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement === false) {throw new expectElementException(getLabel("error-expect-element"));}$this->checkDomainPermissions($v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId());$this->checkElementPermissions($v8e2dcfd7e7e24b1ca76c1193f645902b->getId());$v854203cccade0bbe21be239a208aea49 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getModule();$v2fa70149e2a7e75da2b0303d0a36a944 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getMethod();if(!is_null(getRequest('alt-name'))) {$vd84ff935144e00c3e1d395c2379aca47 = strlen(getRequest('alt-name')) ? getRequest('alt-name') : getRequest('name');$v8e2dcfd7e7e24b1ca76c1193f645902b->setAltName($vd84ff935144e00c3e1d395c2379aca47);}if(!is_null($v4264c638e0098acb172519b0436db099 = getRequest('active'))) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$ve8701ad48ba05a91604e480dd60899a3 = $v41275a535677f79ff347e01bc530c176->getUserId();if($v41275a535677f79ff347e01bc530c176->isAllowedMethod($ve8701ad48ba05a91604e480dd60899a3, $v854203cccade0bbe21be239a208aea49, "publish") != false) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsActive($v4264c638e0098acb172519b0436db099);}}if(!is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = getRequest('is-visible'))) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4);}if(!is_null($vf62baf4c4ead98d50d516eca0ac5a746 = getRequest('is-default'))) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746);}if(!is_null($vd02e12eb6d6c3f6ebd763197df01e211 = getRequest('template-id'))) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setTplId($vd02e12eb6d6c3f6ebd763197df01e211);}$v9bc65c2abec141778ffaa729489f3e87 = cmsController::getInstance()->getModule('users');if($v9bc65c2abec141778ffaa729489f3e87 instanceof users) {$v9bc65c2abec141778ffaa729489f3e87->setPerms($v8e2dcfd7e7e24b1ca76c1193f645902b->getId());}backupModel::getInstance()->save($v8e2dcfd7e7e24b1ca76c1193f645902b->getId());$va8cfde6331bd59eb2ac96f8911c4b666 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) {$this->saveEditedObjectData($va8cfde6331bd59eb2ac96f8911c4b666);}$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$this->currentEditedElementId = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();return $v8e2dcfd7e7e24b1ca76c1193f645902b;}public function saveAddedElementData($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$vfed36e93a0509e20f2dc96cbbd85b678 = templatesCollection::getInstance();$v22884db148f0ffb0d830ba431102b0b5 = get_class($this);if(isset($ve62e4d22f2d8630f6e44e2b7c3f70ddc['module'])) $v22884db148f0ffb0d830ba431102b0b5 = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['module'];$vea9f6aca279138c58f705c8d4cb4b8ce = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['type'];$vd0e45878043844ffc41aac437e86b602 = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['parent'];if($this->checkAllowedElementType($ve62e4d22f2d8630f6e44e2b7c3f70ddc) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}if($v22884db148f0ffb0d830ba431102b0b5 == "content" && $vea9f6aca279138c58f705c8d4cb4b8ce == "page") {$vea9f6aca279138c58f705c8d4cb4b8ce = "";}if($vd0e45878043844ffc41aac437e86b602) {$this->checkElementPermissions($vd0e45878043844ffc41aac437e86b602->getId(), permissionsCollection::E_CREATE_ALLOWED);}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemCreateElement");$v4119639092e62c55ea8be348e4d9260d->addRef("inputData", $ve62e4d22f2d8630f6e44e2b7c3f70ddc);$v4119639092e62c55ea8be348e4d9260d->setMode("before");$v4119639092e62c55ea8be348e4d9260d->call();$vcfb14cbbb0da97c5d6fc00de2231984b = $vfed36e93a0509e20f2dc96cbbd85b678->getHierarchyTypeTemplate($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);if($vd0e45878043844ffc41aac437e86b602 instanceof iUmiHierarchyElement) {$v6be379826b20cc58475f636e33f4606b = $vd0e45878043844ffc41aac437e86b602->getId();$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $vd0e45878043844ffc41aac437e86b602->getLangId();$v662cbf1253ac7d8750ed9190c52163e5 = $vd0e45878043844ffc41aac437e86b602->getDomainId();if($vcfb14cbbb0da97c5d6fc00de2231984b !== false) {$vd02e12eb6d6c3f6ebd763197df01e211 = $vcfb14cbbb0da97c5d6fc00de2231984b;}else {$vb6aaa85825f7ae803766f43e00873d06 = umiHierarchy::getInstance()->getDominantTplId($v6be379826b20cc58475f636e33f4606b);if($vb6aaa85825f7ae803766f43e00873d06) {$vd02e12eb6d6c3f6ebd763197df01e211 = $vb6aaa85825f7ae803766f43e00873d06;}else {throw new coreException(getLabel('error-dominant-template-not-found'));}}}else {$v6be379826b20cc58475f636e33f4606b = 0;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getId();$v662cbf1253ac7d8750ed9190c52163e5 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();if($v84ad1b49a83349491077e094ad5c5d1b = $this->getFloatedDomain()) {$v662cbf1253ac7d8750ed9190c52163e5 = $v84ad1b49a83349491077e094ad5c5d1b;}if($vcfb14cbbb0da97c5d6fc00de2231984b !== false) {$vd02e12eb6d6c3f6ebd763197df01e211 = $vcfb14cbbb0da97c5d6fc00de2231984b;}else {$vd02e12eb6d6c3f6ebd763197df01e211 = $vfed36e93a0509e20f2dc96cbbd85b678->getDefaultTemplate()->getId();}}$this->checkDomainPermissions($v662cbf1253ac7d8750ed9190c52163e5);if(getRequest('template-id')) {$vd02e12eb6d6c3f6ebd763197df01e211 = getRequest('template-id');}$vb946c44d711ade3b061653732977d043 = $v6942e8fa62b3cc9d93881a58210e2fd7->getTypeByName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);if($vb946c44d711ade3b061653732977d043 instanceof iUmiHierarchyType) {$v0715f6d9497f93911417c9c324265771 = $vb946c44d711ade3b061653732977d043->getId();}else {throw new coreException(getLabel('error-element-type-detect-failed'));}if(is_null($vb068931cc450442b63f5b3d276ea4297 = getRequest('name'))) {throw new coreException(getLabel('error-require-name-param'));}if(is_null($vd84ff935144e00c3e1d395c2379aca47 = getRequest('alt-name'))) {$vd84ff935144e00c3e1d395c2379aca47 = $vb068931cc450442b63f5b3d276ea4297;}$v94757cae63fd3e398c0811a976dd6bbe = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'type-id');if(!$v94757cae63fd3e398c0811a976dd6bbe && !($v94757cae63fd3e398c0811a976dd6bbe = getRequest("type-id"))) {$v94757cae63fd3e398c0811a976dd6bbe = $v0e8133eb006c0f85ed9444ae07a60842->getBaseType($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);if($vd0e45878043844ffc41aac437e86b602 instanceof iUmiHierarchyElement) {$v5a509ca3ce95bc71bf833077b7d5a178 = $vb81ca7c0ccaa77e7aa91936ab0070695->getDominantTypeId($vd0e45878043844ffc41aac437e86b602->getId(), 1, $v0715f6d9497f93911417c9c324265771);if($v5a509ca3ce95bc71bf833077b7d5a178) {$v94757cae63fd3e398c0811a976dd6bbe = $v5a509ca3ce95bc71bf833077b7d5a178;}}}if(!$v94757cae63fd3e398c0811a976dd6bbe) {throw new coreException("Base type for {$v22884db148f0ffb0d830ba431102b0b5}::{$vea9f6aca279138c58f705c8d4cb4b8ce} doesn't exists");}$v7057e8409c7c531a1a6e9ac3df4ed549 = $vb81ca7c0ccaa77e7aa91936ab0070695->addElement($v6be379826b20cc58475f636e33f4606b, $v0715f6d9497f93911417c9c324265771, $vb068931cc450442b63f5b3d276ea4297, $vd84ff935144e00c3e1d395c2379aca47, $v94757cae63fd3e398c0811a976dd6bbe, $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86, $vd02e12eb6d6c3f6ebd763197df01e211);$v9bc65c2abec141778ffaa729489f3e87 = $v8b1dc169bf460ee884fceef66c6607d6->getModule('users');if($v9bc65c2abec141778ffaa729489f3e87 instanceof users) {backupModel::getInstance()->save($v7057e8409c7c531a1a6e9ac3df4ed549);$v9bc65c2abec141778ffaa729489f3e87->setPerms($v7057e8409c7c531a1a6e9ac3df4ed549);}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {$v854203cccade0bbe21be239a208aea49 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getModule();$v2fa70149e2a7e75da2b0303d0a36a944 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getMethod();if(!is_null($v4264c638e0098acb172519b0436db099 = getRequest('active'))) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$ve8701ad48ba05a91604e480dd60899a3 = $v41275a535677f79ff347e01bc530c176->getUserId();if($v41275a535677f79ff347e01bc530c176->isAllowedMethod($ve8701ad48ba05a91604e480dd60899a3, $v8b1dc169bf460ee884fceef66c6607d6->getCurrentModule(), "publish") == false) {$v4264c638e0098acb172519b0436db099 = false;}$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsActive($v4264c638e0098acb172519b0436db099);}if(!is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = getRequest('is-visible'))) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4);}if(!is_null($vd02e12eb6d6c3f6ebd763197df01e211 = getRequest('template-id'))) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setTplId($vd02e12eb6d6c3f6ebd763197df01e211);}if(!is_null($vf62baf4c4ead98d50d516eca0ac5a746 = getRequest('is-default'))) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746);}if(!is_null($vb068931cc450442b63f5b3d276ea4297 = getRequest('name'))) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setValue('h1', $vb068931cc450442b63f5b3d276ea4297);}$va8cfde6331bd59eb2ac96f8911c4b666 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();$this->saveAddedObject($va8cfde6331bd59eb2ac96f8911c4b666);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$v0c7f28926c50104e917a6cd58527573e = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();if (!$v0c7f28926c50104e917a6cd58527573e->getValue("publish_status")){$v0c7f28926c50104e917a6cd58527573e->setValue("publish_status", $this->getPageStatusIdByStatusSid());$v0c7f28926c50104e917a6cd58527573e->commit();}$vad255fe3eb36ab4782f3e471966df353 = new umiEventPoint("systemCreateElement");$vad255fe3eb36ab4782f3e471966df353->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$vad255fe3eb36ab4782f3e471966df353->setMode("after");$vad255fe3eb36ab4782f3e471966df353->call();$this->currentEditedElementId = $v7057e8409c7c531a1a6e9ac3df4ed549;return $v7057e8409c7c531a1a6e9ac3df4ed549;}else {throw new coreException("Can't get created element instance");}}public function saveEditedObjectData($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {if(is_array($ve62e4d22f2d8630f6e44e2b7c3f70ddc)) {$va8cfde6331bd59eb2ac96f8911c4b666 = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'object');}else {$va8cfde6331bd59eb2ac96f8911c4b666 = $ve62e4d22f2d8630f6e44e2b7c3f70ddc;}if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject === false) {throw new coreException("Expected instance of umiObject in param");}if(is_array($ve62e4d22f2d8630f6e44e2b7c3f70ddc)) {$this->setRequestDataAliases(getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'aliases'), $va8cfde6331bd59eb2ac96f8911c4b666->getId());}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemModifyObject");$v4119639092e62c55ea8be348e4d9260d->addRef("object", $va8cfde6331bd59eb2ac96f8911c4b666);$v4119639092e62c55ea8be348e4d9260d->setMode("before");$v4119639092e62c55ea8be348e4d9260d->call();if(!is_null($vb068931cc450442b63f5b3d276ea4297 = getRequest('name'))) {$va8cfde6331bd59eb2ac96f8911c4b666->setName($vb068931cc450442b63f5b3d276ea4297);$va8cfde6331bd59eb2ac96f8911c4b666->setValue('nazvanie', $vb068931cc450442b63f5b3d276ea4297);}if(!is_null($v94757cae63fd3e398c0811a976dd6bbe = getRequest('type-id'))) {$va8cfde6331bd59eb2ac96f8911c4b666->setTypeId($v94757cae63fd3e398c0811a976dd6bbe);}$v89e96bd1c461a4b70d8aaaba636b0f85 = cmsController::getInstance()->getModule("data");$v89e96bd1c461a4b70d8aaaba636b0f85->saveEditedObjectWithIgnorePermissions($va8cfde6331bd59eb2ac96f8911c4b666->getId(), false, true, true);$va8cfde6331bd59eb2ac96f8911c4b666->commit();$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();return $va8cfde6331bd59eb2ac96f8911c4b666;}public function saveAddedObject(umiObject $va8cfde6331bd59eb2ac96f8911c4b666) {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemCreateObject");$v4119639092e62c55ea8be348e4d9260d->addRef("object", $va8cfde6331bd59eb2ac96f8911c4b666);$v4119639092e62c55ea8be348e4d9260d->setMode("before");$v4119639092e62c55ea8be348e4d9260d->call();$v89e96bd1c461a4b70d8aaaba636b0f85 = cmsController::getInstance()->getModule("data");$v89e96bd1c461a4b70d8aaaba636b0f85->saveEditedObjectWithIgnorePermissions($va8cfde6331bd59eb2ac96f8911c4b666->getId(), true, true, true);if(!is_null($vb068931cc450442b63f5b3d276ea4297 = getRequest('name'))) {$va8cfde6331bd59eb2ac96f8911c4b666->setValue('nazvanie', $va8cfde6331bd59eb2ac96f8911c4b666->getName());}$va8cfde6331bd59eb2ac96f8911c4b666->commit();$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();return $va8cfde6331bd59eb2ac96f8911c4b666->getId();}public function saveAddedObjectData($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v69ae498121c2d8e63f20c7144a0246d7 = umiObjectsCollection::getInstance();$vb3827f7111095f5ba1a9f49988fe9382 = umiObjectTypesCollection::getInstance();if($this->checkAllowedElementType($ve62e4d22f2d8630f6e44e2b7c3f70ddc, true) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}$this->setRequestDataAliases(getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'aliases'));if(is_null($vb068931cc450442b63f5b3d276ea4297 = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'name'))) {$vb068931cc450442b63f5b3d276ea4297 = getRequest('name');}if(is_null($vb068931cc450442b63f5b3d276ea4297)) {throw new publicAdminException("Require 'name' param in _REQUEST array.");}$v22884db148f0ffb0d830ba431102b0b5 = get_class($this);$vea9f6aca279138c58f705c8d4cb4b8ce = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'type');$v5f694956811487225d15e973ca38fbab = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'type-id');if(!$v5f694956811487225d15e973ca38fbab) {$v5f694956811487225d15e973ca38fbab = $vb3827f7111095f5ba1a9f49988fe9382->getBaseType($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);}$v16b2b26000987faccb260b9d39df1269 = $v69ae498121c2d8e63f20c7144a0246d7->addObject($vb068931cc450442b63f5b3d276ea4297, $v5f694956811487225d15e973ca38fbab);$va8cfde6331bd59eb2ac96f8911c4b666 = $v69ae498121c2d8e63f20c7144a0246d7->getObject($v16b2b26000987faccb260b9d39df1269);if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) {$this->saveAddedObject($va8cfde6331bd59eb2ac96f8911c4b666);return $va8cfde6331bd59eb2ac96f8911c4b666;}else {throw new coreException("Can't create object #{$v16b2b26000987faccb260b9d39df1269} \"{$vb068931cc450442b63f5b3d276ea4297}\" of type #{$v5f694956811487225d15e973ca38fbab}");}}public function saveEditedList($v599dcce2998a6b40b1e38e8c6006cb0a, $v21ffce5b8a6cc8cc6a41448dd69623c9 = false) {$v8d777f385d3dfec8815d20f7496026dc = getRequest("data");$vcc86ffa55f0ab6b9ddbf32c1a3d24d67 = getRequest("dels");switch($v599dcce2998a6b40b1e38e8c6006cb0a) {case "objects": {return $this->saveEditedObjectsList($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67, $v21ffce5b8a6cc8cc6a41448dd69623c9);}case "basetypes": {return $this->saveEditedBaseTypesList($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67);}case "domains": {return $this->saveEditedDomains($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67);}case "domain_mirrows": {return $this->saveEditedDomainMirrows($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67);}case "langs": {return $this->saveEditedLangs($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67);}case "templates": {return $this->saveEditedTemplatesList($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67, $v21ffce5b8a6cc8cc6a41448dd69623c9);}default: {throw new coreException("Can't save edited list of type \"{$v599dcce2998a6b40b1e38e8c6006cb0a}\"");}}}public function saveEditedObjectsList($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67, $v21ffce5b8a6cc8cc6a41448dd69623c9) {$vdb6d9b451b818ccc9a449383f2f0c450 = umiObjectsCollection::getInstance();$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$v642318310ea1d693ed91345deb5921da = false;if(is_array($v8d777f385d3dfec8815d20f7496026dc)) {foreach($v8d777f385d3dfec8815d20f7496026dc as $vb80bb7740288fda1f201890375a60c8f => $vcaf9b6b99962bf5c2264824231d7a40c) {$vb068931cc450442b63f5b3d276ea4297 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'name');$v94757cae63fd3e398c0811a976dd6bbe = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'type_id');$vea9f6aca279138c58f705c8d4cb4b8ce = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'type');if(!$v94757cae63fd3e398c0811a976dd6bbe && $vea9f6aca279138c58f705c8d4cb4b8ce) {$v94757cae63fd3e398c0811a976dd6bbe = $v0e8133eb006c0f85ed9444ae07a60842->getBaseType(get_class($this), $vea9f6aca279138c58f705c8d4cb4b8ce);}if($vb80bb7740288fda1f201890375a60c8f == "new") {if($vb068931cc450442b63f5b3d276ea4297 && $v94757cae63fd3e398c0811a976dd6bbe) {$vb80bb7740288fda1f201890375a60c8f = $vdb6d9b451b818ccc9a449383f2f0c450->addObject($vb068931cc450442b63f5b3d276ea4297, $v94757cae63fd3e398c0811a976dd6bbe);$v447b7147e84be512208dcc0995d67ebc = $vdb6d9b451b818ccc9a449383f2f0c450->getObject($vb80bb7740288fda1f201890375a60c8f);if($v447b7147e84be512208dcc0995d67ebc instanceof umiObject) {$v642318310ea1d693ed91345deb5921da = $this->saveAddedObject($v447b7147e84be512208dcc0995d67ebc);$v447b7147e84be512208dcc0995d67ebc->commit();}}}else {$v447b7147e84be512208dcc0995d67ebc = $vdb6d9b451b818ccc9a449383f2f0c450->getObject($vb80bb7740288fda1f201890375a60c8f);if($v447b7147e84be512208dcc0995d67ebc instanceof umiObject) {$v447b7147e84be512208dcc0995d67ebc->setName($vb068931cc450442b63f5b3d276ea4297);$this->saveEditedObjectData($v447b7147e84be512208dcc0995d67ebc);$v447b7147e84be512208dcc0995d67ebc->commit();}else {throw new coreException("Object #{$vb80bb7740288fda1f201890375a60c8f} doesn't exists");}}}}if(is_array($vcc86ffa55f0ab6b9ddbf32c1a3d24d67)) {foreach($vcc86ffa55f0ab6b9ddbf32c1a3d24d67 as $vb80bb7740288fda1f201890375a60c8f) {$vdb6d9b451b818ccc9a449383f2f0c450->delObject($vb80bb7740288fda1f201890375a60c8f);}}return $v642318310ea1d693ed91345deb5921da;}public function saveEditedBaseTypesList($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67) {$vdb6d9b451b818ccc9a449383f2f0c450 = umiHierarchyTypesCollection::getInstance();if(is_array($v8d777f385d3dfec8815d20f7496026dc)) {foreach($v8d777f385d3dfec8815d20f7496026dc as $vb80bb7740288fda1f201890375a60c8f => $vcaf9b6b99962bf5c2264824231d7a40c) {$vd5d3db1765287eef77d7927cc956f50a = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'title');$v22884db148f0ffb0d830ba431102b0b5 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'module');$vea9f6aca279138c58f705c8d4cb4b8ce = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'method');if($vb80bb7740288fda1f201890375a60c8f == "new") {if($v22884db148f0ffb0d830ba431102b0b5 && $vd5d3db1765287eef77d7927cc956f50a) {$vdb6d9b451b818ccc9a449383f2f0c450->addType($v22884db148f0ffb0d830ba431102b0b5, $vd5d3db1765287eef77d7927cc956f50a, $vea9f6aca279138c58f705c8d4cb4b8ce);}}else {$v447b7147e84be512208dcc0995d67ebc = $vdb6d9b451b818ccc9a449383f2f0c450->getType($vb80bb7740288fda1f201890375a60c8f);if($v447b7147e84be512208dcc0995d67ebc instanceof iUmiHierarchyType) {$v447b7147e84be512208dcc0995d67ebc->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v447b7147e84be512208dcc0995d67ebc->setName($v22884db148f0ffb0d830ba431102b0b5);$v447b7147e84be512208dcc0995d67ebc->setExt($vea9f6aca279138c58f705c8d4cb4b8ce);$v447b7147e84be512208dcc0995d67ebc->commit();}else {throw new coreException("Hierarchy type #{$vb80bb7740288fda1f201890375a60c8f} doesn't exists");}}}}if(is_array($vcc86ffa55f0ab6b9ddbf32c1a3d24d67)) {foreach($vcc86ffa55f0ab6b9ddbf32c1a3d24d67 as $vb80bb7740288fda1f201890375a60c8f) {$vdb6d9b451b818ccc9a449383f2f0c450->delType($vb80bb7740288fda1f201890375a60c8f);}}}public function saveEditedTemplatesList($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67, $v21ffce5b8a6cc8cc6a41448dd69623c9) {$vdb6d9b451b818ccc9a449383f2f0c450 = templatesCollection::getInstance();$vc21f969b5f03d33d43e04f8f136e7682 = getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'default');foreach($v21ffce5b8a6cc8cc6a41448dd69623c9 as $v67b3dba8bc6778101892eb77249db32e => $vfed36e93a0509e20f2dc96cbbd85b678) {$v662cbf1253ac7d8750ed9190c52163e5 = domainsCollection::getInstance()->getDomainId($v67b3dba8bc6778101892eb77249db32e);$v4b28f331523f732cd51b3314d5a3c88f = getArrayKey($v8d777f385d3dfec8815d20f7496026dc, $v67b3dba8bc6778101892eb77249db32e);$v3822e54d799ece2cf6bec7120d8a3a9f = getArrayKey($vc21f969b5f03d33d43e04f8f136e7682, $v662cbf1253ac7d8750ed9190c52163e5);foreach($vfed36e93a0509e20f2dc96cbbd85b678 as $v66f6181bcb4cff4cd38fbc804a036db6) {$veae16ae723825858a85927d1ac28ad51 = getArrayKey($v4b28f331523f732cd51b3314d5a3c88f, $v66f6181bcb4cff4cd38fbc804a036db6->getId());$vd5d3db1765287eef77d7927cc956f50a = getArrayKey($veae16ae723825858a85927d1ac28ad51, 'title');$v435ed7e9f07f740abf511a62c00eef6e = getArrayKey($veae16ae723825858a85927d1ac28ad51, 'filename');if(!$vd5d3db1765287eef77d7927cc956f50a || !$v435ed7e9f07f740abf511a62c00eef6e) {continue;}$v66f6181bcb4cff4cd38fbc804a036db6->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v66f6181bcb4cff4cd38fbc804a036db6->setFileName($v435ed7e9f07f740abf511a62c00eef6e);if(is_numeric($v3822e54d799ece2cf6bec7120d8a3a9f)) {if($v66f6181bcb4cff4cd38fbc804a036db6->getId() == $v3822e54d799ece2cf6bec7120d8a3a9f) {$v66f6181bcb4cff4cd38fbc804a036db6->setIsDefault(true);}else {$v66f6181bcb4cff4cd38fbc804a036db6->setIsDefault(false);}}$v66f6181bcb4cff4cd38fbc804a036db6->commit();}if(!is_null($veae16ae723825858a85927d1ac28ad51 = getArrayKey($v4b28f331523f732cd51b3314d5a3c88f, 'new'))) {$vd5d3db1765287eef77d7927cc956f50a = getArrayKey($veae16ae723825858a85927d1ac28ad51, 'title');$v435ed7e9f07f740abf511a62c00eef6e = getArrayKey($veae16ae723825858a85927d1ac28ad51, 'filename');if($vd5d3db1765287eef77d7927cc956f50a && $v435ed7e9f07f740abf511a62c00eef6e) {$v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$vf62baf4c4ead98d50d516eca0ac5a746 = ($v3822e54d799ece2cf6bec7120d8a3a9f == "new") ? true : false;$vdb6d9b451b818ccc9a449383f2f0c450->addTemplate($v435ed7e9f07f740abf511a62c00eef6e, $vd5d3db1765287eef77d7927cc956f50a, $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86, $vf62baf4c4ead98d50d516eca0ac5a746);}}}if(is_array($vcc86ffa55f0ab6b9ddbf32c1a3d24d67)) {foreach($vcc86ffa55f0ab6b9ddbf32c1a3d24d67 as $vb80bb7740288fda1f201890375a60c8f) {$v66f6181bcb4cff4cd38fbc804a036db6 = $vdb6d9b451b818ccc9a449383f2f0c450->getTemplate($vb80bb7740288fda1f201890375a60c8f);if($v66f6181bcb4cff4cd38fbc804a036db6->getIsDefault() == false) {unset($v66f6181bcb4cff4cd38fbc804a036db6);$vdb6d9b451b818ccc9a449383f2f0c450->delTemplate($vb80bb7740288fda1f201890375a60c8f);}}}}public function saveEditedTemplateData(iTemplate $v66f6181bcb4cff4cd38fbc804a036db6) {$vb068931cc450442b63f5b3d276ea4297 = getRequest('name');$vd5d3db1765287eef77d7927cc956f50a = getRequest('title');$v435ed7e9f07f740abf511a62c00eef6e = getRequest('filename');$v599dcce2998a6b40b1e38e8c6006cb0a = getRequest('type');$v557f12a93c5bf0febb3b293feeb085be = getRequest('used_pages');$v66f6181bcb4cff4cd38fbc804a036db6->setName($vb068931cc450442b63f5b3d276ea4297);$v66f6181bcb4cff4cd38fbc804a036db6->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v66f6181bcb4cff4cd38fbc804a036db6->setFilename($v435ed7e9f07f740abf511a62c00eef6e);$v66f6181bcb4cff4cd38fbc804a036db6->setType($v599dcce2998a6b40b1e38e8c6006cb0a);$v66f6181bcb4cff4cd38fbc804a036db6->setUsedPages($v557f12a93c5bf0febb3b293feeb085be);$v66f6181bcb4cff4cd38fbc804a036db6->commit();}public function saveEditedDomains($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67) {$vdb6d9b451b818ccc9a449383f2f0c450 = domainsCollection::getInstance();if(is_array($v8d777f385d3dfec8815d20f7496026dc)) {foreach($v8d777f385d3dfec8815d20f7496026dc as $vb80bb7740288fda1f201890375a60c8f => $vcaf9b6b99962bf5c2264824231d7a40c) {$v67b3dba8bc6778101892eb77249db32e = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'host');$v78e6dd7a49f5b0cb2106a3a434dd5c86 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'lang_id');if($vb80bb7740288fda1f201890375a60c8f == "new") {$v67b3dba8bc6778101892eb77249db32e = domain::filterHostName($v67b3dba8bc6778101892eb77249db32e);if($v67b3dba8bc6778101892eb77249db32e && $v78e6dd7a49f5b0cb2106a3a434dd5c86) {$v97e32a574aa9ef24f76a81fc43aba6ce = regedit::getInstance()->getVal("//modules/autoupdate/system_edition");if ($v97e32a574aa9ef24f76a81fc43aba6ce=='gov' && count($vdb6d9b451b818ccc9a449383f2f0c450->getList())>0) {throw new publicAdminException(getLabel('error-disabled-in-demo'));}if(defined("CURRENT_VERSION_LINE") &&       in_array(CURRENT_VERSION_LINE, array('start', 'lite', 'shop'))) {throw new publicAdminException(getLabel('error-disabled-in-demo'));}if($vdb6d9b451b818ccc9a449383f2f0c450->getDomainId($v67b3dba8bc6778101892eb77249db32e)) {throw new publicAdminException(getLabel('error-domain-already-exists'));}$vdb6d9b451b818ccc9a449383f2f0c450->addDomain($v67b3dba8bc6778101892eb77249db32e, $v78e6dd7a49f5b0cb2106a3a434dd5c86);}}else {if(!$v67b3dba8bc6778101892eb77249db32e) {$v447b7147e84be512208dcc0995d67ebc = $vdb6d9b451b818ccc9a449383f2f0c450->getDomain($vb80bb7740288fda1f201890375a60c8f);$v447b7147e84be512208dcc0995d67ebc->setDefaultLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86);$v447b7147e84be512208dcc0995d67ebc->commit();continue;}$v447b7147e84be512208dcc0995d67ebc = $vdb6d9b451b818ccc9a449383f2f0c450->getDomain($vb80bb7740288fda1f201890375a60c8f);if($v447b7147e84be512208dcc0995d67ebc instanceof iDomain) {if($v447b7147e84be512208dcc0995d67ebc->getIsDefault() == false) {$v447b7147e84be512208dcc0995d67ebc->setHost($v67b3dba8bc6778101892eb77249db32e);}$v447b7147e84be512208dcc0995d67ebc->setDefaultLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86);$v447b7147e84be512208dcc0995d67ebc->commit();}else {throw new coreException("Domain #{$vb80bb7740288fda1f201890375a60c8f} doesn't exists");}}}}if(is_array($vcc86ffa55f0ab6b9ddbf32c1a3d24d67)) {foreach($vcc86ffa55f0ab6b9ddbf32c1a3d24d67 as $vb80bb7740288fda1f201890375a60c8f) {$vdb6d9b451b818ccc9a449383f2f0c450->delDomain($vb80bb7740288fda1f201890375a60c8f);}}}public function saveEditedDomainMirrows($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67) {$vdb6d9b451b818ccc9a449383f2f0c450 = domainsCollection::getInstance();$vad5f82e879a9c5d6b5b442eb37e50551 = $vdb6d9b451b818ccc9a449383f2f0c450->getDomain(getRequest('param0'));if(is_array($v8d777f385d3dfec8815d20f7496026dc)) {foreach($v8d777f385d3dfec8815d20f7496026dc as $vb80bb7740288fda1f201890375a60c8f => $vcaf9b6b99962bf5c2264824231d7a40c) {$v67b3dba8bc6778101892eb77249db32e = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'host');if($vb80bb7740288fda1f201890375a60c8f == "new") {$v67b3dba8bc6778101892eb77249db32e = domain::filterHostName($v67b3dba8bc6778101892eb77249db32e);if($v67b3dba8bc6778101892eb77249db32e) {if($vdb6d9b451b818ccc9a449383f2f0c450->getDomainId($v67b3dba8bc6778101892eb77249db32e)) {throw new publicAdminException(getLabel('error-domain-already-exists'));}$vad5f82e879a9c5d6b5b442eb37e50551->addMirrow($v67b3dba8bc6778101892eb77249db32e);}}else {if(!$v67b3dba8bc6778101892eb77249db32e) {continue;}$v447b7147e84be512208dcc0995d67ebc = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrow($vb80bb7740288fda1f201890375a60c8f);if($v447b7147e84be512208dcc0995d67ebc instanceof iDomainMirrow) {$v447b7147e84be512208dcc0995d67ebc->setHost($v67b3dba8bc6778101892eb77249db32e);$v447b7147e84be512208dcc0995d67ebc->commit();}else {throw new coreException("Domain #{$vb80bb7740288fda1f201890375a60c8f} doesn't exists");}}}}if(is_array($vcc86ffa55f0ab6b9ddbf32c1a3d24d67)) {foreach($vcc86ffa55f0ab6b9ddbf32c1a3d24d67 as $vb80bb7740288fda1f201890375a60c8f) {$vad5f82e879a9c5d6b5b442eb37e50551->delMirrow($vb80bb7740288fda1f201890375a60c8f);}}$vad5f82e879a9c5d6b5b442eb37e50551->setIsUpdated();$vad5f82e879a9c5d6b5b442eb37e50551->commit();}public function saveEditedLangs($v8d777f385d3dfec8815d20f7496026dc, $vcc86ffa55f0ab6b9ddbf32c1a3d24d67) {$vdb6d9b451b818ccc9a449383f2f0c450 = langsCollection::getInstance();if(is_array($v8d777f385d3dfec8815d20f7496026dc)) {foreach($v8d777f385d3dfec8815d20f7496026dc as $vb80bb7740288fda1f201890375a60c8f => $vcaf9b6b99962bf5c2264824231d7a40c) {$vd5d3db1765287eef77d7927cc956f50a  = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'title');$v851f5ac9941d720844d143ed9cfcf60a = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'prefix');if(!strlen($vd5d3db1765287eef77d7927cc956f50a) || !strlen($v851f5ac9941d720844d143ed9cfcf60a)) continue;$vd5d3db1765287eef77d7927cc956f50a  = trim($vd5d3db1765287eef77d7927cc956f50a);$v851f5ac9941d720844d143ed9cfcf60a = preg_replace("/[^A-z0-9]*/", "", $v851f5ac9941d720844d143ed9cfcf60a);if(!strlen($vd5d3db1765287eef77d7927cc956f50a) || !strlen($v851f5ac9941d720844d143ed9cfcf60a)) continue;if($vb80bb7740288fda1f201890375a60c8f == "new") {$vb80bb7740288fda1f201890375a60c8f = $vdb6d9b451b818ccc9a449383f2f0c450->addLang($v851f5ac9941d720844d143ed9cfcf60a, $vd5d3db1765287eef77d7927cc956f50a);}$v447b7147e84be512208dcc0995d67ebc = $vdb6d9b451b818ccc9a449383f2f0c450->getLang($vb80bb7740288fda1f201890375a60c8f);if($v447b7147e84be512208dcc0995d67ebc instanceof iLang) {$v447b7147e84be512208dcc0995d67ebc->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v447b7147e84be512208dcc0995d67ebc->setPrefix($v851f5ac9941d720844d143ed9cfcf60a);$v447b7147e84be512208dcc0995d67ebc->commit();}else {throw new coreException("Lang #{$vb80bb7740288fda1f201890375a60c8f} doesn't exists");}}}}public function saveEditedTypeData($v8d777f385d3dfec8815d20f7496026dc) {$vcaf9b6b99962bf5c2264824231d7a40c = getRequest('data');$vb068931cc450442b63f5b3d276ea4297 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'name');$v7617e8d03bb811f5c37135234006b114 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'is_guidable');$v117256556af3bd1a0c9710a593d93814 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'is_public');$v0715f6d9497f93911417c9c324265771 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'hierarchy_type_id');$v599dcce2998a6b40b1e38e8c6006cb0a = $v8d777f385d3dfec8815d20f7496026dc;if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {if (is_null($vb068931cc450442b63f5b3d276ea4297) || $vb068931cc450442b63f5b3d276ea4297 == '') throw new coreException("Expected to get type name");if ($v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId() && !$v0715f6d9497f93911417c9c324265771 && !$v599dcce2998a6b40b1e38e8c6006cb0a->getIsGuidable()) throw new coreException("Expected to get hierarchy type id");$v599dcce2998a6b40b1e38e8c6006cb0a->setName($vb068931cc450442b63f5b3d276ea4297);$v599dcce2998a6b40b1e38e8c6006cb0a->setIsGuidable($v7617e8d03bb811f5c37135234006b114);$v599dcce2998a6b40b1e38e8c6006cb0a->setIsPublic($v117256556af3bd1a0c9710a593d93814);$v599dcce2998a6b40b1e38e8c6006cb0a->setHierarchyTypeId($v0715f6d9497f93911417c9c324265771);$v599dcce2998a6b40b1e38e8c6006cb0a->commit();}else {throw new coreException("Expected instance of type umiObjectType");}}public function saveEditedGroupData($vdb0f6f37ebeb6ea09489124345af2a45) {$vcaf9b6b99962bf5c2264824231d7a40c = getRequest('data');$vd5d3db1765287eef77d7927cc956f50a = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'title');$vb068931cc450442b63f5b3d276ea4297 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'name');$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'is_visible');if($vdb0f6f37ebeb6ea09489124345af2a45 instanceof iUmiFieldsGroup) {$vdb0f6f37ebeb6ea09489124345af2a45->setName($vb068931cc450442b63f5b3d276ea4297);$vdb0f6f37ebeb6ea09489124345af2a45->setTitle($vd5d3db1765287eef77d7927cc956f50a);$vdb0f6f37ebeb6ea09489124345af2a45->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4);$vdb0f6f37ebeb6ea09489124345af2a45->setIsActive(true);$vdb0f6f37ebeb6ea09489124345af2a45->commit();}else {throw new coreException("Expected instance of type umiFieldsGroup");}}public function saveEditedFieldData($v06e3d36fa30cea095545139854ad1fb9) {$vcaf9b6b99962bf5c2264824231d7a40c = getRequest('data');$vd5d3db1765287eef77d7927cc956f50a = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'title');$vb068931cc450442b63f5b3d276ea4297 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'name');$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'is_visible');$v1e3f04102267eaf5e8d0ca424fd5c561 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'field_type_id');$v051369818a8073bba5feeb0e957eb308 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'guide_id');$v5fa2ecd1dc485ead330e65903d19650a = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'in_search');$ve4a2ed2dde6e8354ae6f321744843084 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'in_filter');$v6a2139364f96787c8ce1bbb0070b898c = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'tip');$v2a9d32d17ad47ac15c87d2e7c96d0e69 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'is_required');$v6b1a57fa235477758817df3c91158006 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'restriction_id');if($v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {$v06e3d36fa30cea095545139854ad1fb9->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v06e3d36fa30cea095545139854ad1fb9->setName($vb068931cc450442b63f5b3d276ea4297);$v06e3d36fa30cea095545139854ad1fb9->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4);$v06e3d36fa30cea095545139854ad1fb9->setFieldTypeId($v1e3f04102267eaf5e8d0ca424fd5c561);$v06e3d36fa30cea095545139854ad1fb9->setIsInSearch($v5fa2ecd1dc485ead330e65903d19650a);$v06e3d36fa30cea095545139854ad1fb9->setIsInFilter($ve4a2ed2dde6e8354ae6f321744843084);$v06e3d36fa30cea095545139854ad1fb9->setTip($v6a2139364f96787c8ce1bbb0070b898c);$v06e3d36fa30cea095545139854ad1fb9->setIsRequired($v2a9d32d17ad47ac15c87d2e7c96d0e69);$v06e3d36fa30cea095545139854ad1fb9->setRestrictionId($v6b1a57fa235477758817df3c91158006);$v19dad066c23a79c33b2975590e364a5a = umiFieldTypesCollection::getInstance()->getFieldType($v1e3f04102267eaf5e8d0ca424fd5c561);$v983560f49ede87197144b22c810a5087 = $v19dad066c23a79c33b2975590e364a5a->getDataType();if($v983560f49ede87197144b22c810a5087 == "relation" && $v051369818a8073bba5feeb0e957eb308 == 0) {$v051369818a8073bba5feeb0e957eb308 = self::getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a);}if($v983560f49ede87197144b22c810a5087 == "optioned" && $v051369818a8073bba5feeb0e957eb308 == 0) {$va98d7ac1b7459c54b19858e934794517 = umiObjectTypesCollection::getInstance()->getTypeIdByGUID('emarket-itemoption');$v051369818a8073bba5feeb0e957eb308 = self::getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a, $va98d7ac1b7459c54b19858e934794517);}$v06e3d36fa30cea095545139854ad1fb9->setGuideId($v051369818a8073bba5feeb0e957eb308);$v06e3d36fa30cea095545139854ad1fb9->commit();}else {throw new coreException("Expected instance of type umiField");}}public function saveAddedGroupData($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$vcaf9b6b99962bf5c2264824231d7a40c = getRequest('data');$vb068931cc450442b63f5b3d276ea4297 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'name');$vd5d3db1765287eef77d7927cc956f50a = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'title');$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'is_visible');$v94757cae63fd3e398c0811a976dd6bbe = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'type-id');$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {$v6790ebc6beba7eb1ae08a825c28e1600 = $v599dcce2998a6b40b1e38e8c6006cb0a->addFieldsGroup($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, true, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4);$v599dcce2998a6b40b1e38e8c6006cb0a->commit();return $v6790ebc6beba7eb1ae08a825c28e1600;}else {throw new coreException("Expected instance of type umiObjectType");}}public function saveAddedFieldData($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$v0e939a4ffd3aacd724dd3b50147b4353 = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['group-id'];$v94757cae63fd3e398c0811a976dd6bbe = $ve62e4d22f2d8630f6e44e2b7c3f70ddc['type-id'];$vcaf9b6b99962bf5c2264824231d7a40c = getRequest('data');$vd5d3db1765287eef77d7927cc956f50a = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'title');$vb068931cc450442b63f5b3d276ea4297 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'name');$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'is_visible');$v1e3f04102267eaf5e8d0ca424fd5c561 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'field_type_id');$v051369818a8073bba5feeb0e957eb308 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'guide_id');$v5fa2ecd1dc485ead330e65903d19650a = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'in_search');$ve4a2ed2dde6e8354ae6f321744843084 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'in_filter');$v6a2139364f96787c8ce1bbb0070b898c = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'tip');$v2a9d32d17ad47ac15c87d2e7c96d0e69 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'is_required');$v6b1a57fa235477758817df3c91158006 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'restriction_id');$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$vd05b6ed7d2345020440df396d6da7f73 = umiFieldsCollection::getInstance();$v69552af3a03df9391f70eb1851f817c5 = umiFieldTypesCollection::getInstance();$v599dcce2998a6b40b1e38e8c6006cb0a = $v0e8133eb006c0f85ed9444ae07a60842->getType($v94757cae63fd3e398c0811a976dd6bbe);if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {if($v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($vb068931cc450442b63f5b3d276ea4297)) {throw new publicAdminException(getLabel('error-non-unique-field-name'));}}$v19dad066c23a79c33b2975590e364a5a = $v69552af3a03df9391f70eb1851f817c5->getFieldType($v1e3f04102267eaf5e8d0ca424fd5c561);$v983560f49ede87197144b22c810a5087 = $v19dad066c23a79c33b2975590e364a5a->getDataType();if($v983560f49ede87197144b22c810a5087 == "relation" && $v051369818a8073bba5feeb0e957eb308 == 0) {$v051369818a8073bba5feeb0e957eb308 = self::getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a);}if($v983560f49ede87197144b22c810a5087 == "optioned" && $v051369818a8073bba5feeb0e957eb308 == 0) {$va98d7ac1b7459c54b19858e934794517 = $v0e8133eb006c0f85ed9444ae07a60842->getTypeIdByGUID('emarket-itemoption');$v051369818a8073bba5feeb0e957eb308 = self::getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a, $va98d7ac1b7459c54b19858e934794517);}$v3aabf39f2d943fa886d86dcbbee4d910 = false;$va08f2aee9de301619776deb6fee83e50 = $v599dcce2998a6b40b1e38e8c6006cb0a->getParentId();$v3f5af10cbb47cb1b6fcf196befc17b95 = $v0e8133eb006c0f85ed9444ae07a60842->getSubTypesList($va08f2aee9de301619776deb6fee83e50);foreach($v3f5af10cbb47cb1b6fcf196befc17b95 as $veb2c84964aa55a68255b7466cd21b62c) {if($veb2c84964aa55a68255b7466cd21b62c == $v94757cae63fd3e398c0811a976dd6bbe) continue;$v4ae5fdeb89c7a5a5daf33112bda3f82b = $v0e8133eb006c0f85ed9444ae07a60842->getType($veb2c84964aa55a68255b7466cd21b62c);if($v4ae5fdeb89c7a5a5daf33112bda3f82b instanceof umiObjectType == false) continue;if($v6270c3e00735121953b8585fd836af43 = $v4ae5fdeb89c7a5a5daf33112bda3f82b->getFieldId($vb068931cc450442b63f5b3d276ea4297)) {$vd3b250b73d77cb502490809548ef475e = $vd05b6ed7d2345020440df396d6da7f73->getField($v6270c3e00735121953b8585fd836af43);if($vd3b250b73d77cb502490809548ef475e instanceof umiField == false) continue;if(($vd3b250b73d77cb502490809548ef475e->getFieldTypeId() == $v1e3f04102267eaf5e8d0ca424fd5c561) && ($vd3b250b73d77cb502490809548ef475e->getTitle() == $vd5d3db1765287eef77d7927cc956f50a)) {$v3aabf39f2d943fa886d86dcbbee4d910 = $v6270c3e00735121953b8585fd836af43;break;}}}$v6a8e34c52627084d431e3b4c6edebc2d = $v0e8133eb006c0f85ed9444ae07a60842->getSubTypesList($v94757cae63fd3e398c0811a976dd6bbe);foreach($v6a8e34c52627084d431e3b4c6edebc2d as $vdff2729c2ea51cc1722c9df2117032bd) {$va0100f1c342300cc8f1c583d2b4ad9ee = $v0e8133eb006c0f85ed9444ae07a60842->getType($vdff2729c2ea51cc1722c9df2117032bd);if($va0100f1c342300cc8f1c583d2b4ad9ee instanceof umiObjectType == false) continue;if($ve6b31d5d6cb774ba4498162622b2575a = $va0100f1c342300cc8f1c583d2b4ad9ee->getFieldId($vb068931cc450442b63f5b3d276ea4297)) {$v9efe917b2c0f25687fa4b5e2a36edd5c = $vd05b6ed7d2345020440df396d6da7f73->getField($ve6b31d5d6cb774ba4498162622b2575a);if($v9efe917b2c0f25687fa4b5e2a36edd5c instanceof umiField == false) continue;if(($v9efe917b2c0f25687fa4b5e2a36edd5c->getFieldTypeId() == $v1e3f04102267eaf5e8d0ca424fd5c561) && ($v9efe917b2c0f25687fa4b5e2a36edd5c->getTitle() == $vd5d3db1765287eef77d7927cc956f50a)) {$v3aabf39f2d943fa886d86dcbbee4d910 = $ve6b31d5d6cb774ba4498162622b2575a;break;}}}if($v3aabf39f2d943fa886d86dcbbee4d910 === false) {$v3aabf39f2d943fa886d86dcbbee4d910 = $vd05b6ed7d2345020440df396d6da7f73->addField($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v1e3f04102267eaf5e8d0ca424fd5c561, $ve1c6c9ef2fcbe75f26f815c4ef2e60b4, false, false);$v06e3d36fa30cea095545139854ad1fb9 = $vd05b6ed7d2345020440df396d6da7f73->getField($v3aabf39f2d943fa886d86dcbbee4d910);$v06e3d36fa30cea095545139854ad1fb9->setGuideId($v051369818a8073bba5feeb0e957eb308);$v06e3d36fa30cea095545139854ad1fb9->setIsInSearch($v5fa2ecd1dc485ead330e65903d19650a);$v06e3d36fa30cea095545139854ad1fb9->setIsInFilter($ve4a2ed2dde6e8354ae6f321744843084);$v06e3d36fa30cea095545139854ad1fb9->setTip($v6a2139364f96787c8ce1bbb0070b898c);$v06e3d36fa30cea095545139854ad1fb9->setIsRequired($v2a9d32d17ad47ac15c87d2e7c96d0e69);$v06e3d36fa30cea095545139854ad1fb9->setRestrictionId($v6b1a57fa235477758817df3c91158006);$v06e3d36fa30cea095545139854ad1fb9->commit();}if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {$vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroup($v0e939a4ffd3aacd724dd3b50147b4353);if($vdb0f6f37ebeb6ea09489124345af2a45 instanceof umiFieldsGroup) {$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v3aabf39f2d943fa886d86dcbbee4d910);$veeeb23fbd23e52a6a6ff78b9f18cbc4e = $vdb0f6f37ebeb6ea09489124345af2a45->getName();$vadce578d04ed03c31f6ac59451fcf8e4 = $v0e8133eb006c0f85ed9444ae07a60842->getChildClasses($v94757cae63fd3e398c0811a976dd6bbe);$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($vadce578d04ed03c31f6ac59451fcf8e4);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vd4fd255f51559df00de5424b64292413 = $vadce578d04ed03c31f6ac59451fcf8e4[$v865c0c0b4ab0e063e5caa3387c1a8741];$v793536b8480511c5e2975eba32738d1d = $v0e8133eb006c0f85ed9444ae07a60842->getType($vd4fd255f51559df00de5424b64292413);if($v793536b8480511c5e2975eba32738d1d instanceof umiObjectType) {if($v793536b8480511c5e2975eba32738d1d->getFieldId($vb068931cc450442b63f5b3d276ea4297) == $v3aabf39f2d943fa886d86dcbbee4d910) continue;$vb19a4f118986f0631ceac2d003e1f4a3 = $v793536b8480511c5e2975eba32738d1d->getFieldsGroupByName($veeeb23fbd23e52a6a6ff78b9f18cbc4e);if($vb19a4f118986f0631ceac2d003e1f4a3 instanceof umiFieldsGroup) {$vb19a4f118986f0631ceac2d003e1f4a3->attachField($v3aabf39f2d943fa886d86dcbbee4d910, true);}else {throw new publicAdminException(getLabel("error-no-child-group", false, $veeeb23fbd23e52a6a6ff78b9f18cbc4e, $v793536b8480511c5e2975eba32738d1d->getName()));}}else {throw new publicAdminException(getLabel("error-no-object-type", false, $vd4fd255f51559df00de5424b64292413));}}return $v3aabf39f2d943fa886d86dcbbee4d910;}else {throw new coreException(getLabel("error-no-fieldgroup", false, $v0e939a4ffd3aacd724dd3b50147b4353));}}else {throw new coreException(getLabel("error-no-object-type", false, $v94757cae63fd3e398c0811a976dd6bbe));}}public function chooseRedirect($v28a25256d6223f571b1064a1c4e0b55e = false) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v2b118a2cbbb1d8af749254e5e61b7df0 = $v8b1dc169bf460ee884fceef66c6607d6->getCalculatedRefererUri();$v7bd5b748aa45cab130113ed77f5a159b = getRequest('save-mode');switch($v7bd5b748aa45cab130113ed77f5a159b) {case getLabel('label-save-exit'):    case getLabel('label-save-add-exit'): {$vff88f15e8cd17d762348242a0de7cd1c = 1;break;}case getLabel('label-save-view'):    case getLabel('label-save-add-view'): {$vff88f15e8cd17d762348242a0de7cd1c = 2;break;}case getLabel('label-save'):    case getLabel('label-save-add'): {$vff88f15e8cd17d762348242a0de7cd1c = 3;break;}default: {$vff88f15e8cd17d762348242a0de7cd1c = false;}}if($v5159f957a71513e2a2cc8daba995986f = getArrayKey($_GET, 'force-redirect')) {$this->redirect($v5159f957a71513e2a2cc8daba995986f);}if($vff88f15e8cd17d762348242a0de7cd1c == 1) {$this->redirect($v2b118a2cbbb1d8af749254e5e61b7df0);}if($vff88f15e8cd17d762348242a0de7cd1c == 2) {$v7057e8409c7c531a1a6e9ac3df4ed549 = $this->currentEditedElementId;if($v7057e8409c7c531a1a6e9ac3df4ed549) {$v84d8c2148d233e7430fceb3f20ae3314 = $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById($v7057e8409c7c531a1a6e9ac3df4ed549);$this->redirect($v84d8c2148d233e7430fceb3f20ae3314);}}if($v28a25256d6223f571b1064a1c4e0b55e !== false) {$this->redirect($v28a25256d6223f571b1064a1c4e0b55e);}if($vff88f15e8cd17d762348242a0de7cd1c && $v7057e8409c7c531a1a6e9ac3df4ed549 = $this->currentEditedElementId) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$vf8fd0c88f22095d75867e82d488e7f15 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getHierarchyType()->getName();$vbf2cd78bc903c712c023186d09be671d = $v8e2dcfd7e7e24b1ca76c1193f645902b->getHierarchyType()->getExt();$v22884db148f0ffb0d830ba431102b0b5 = cmsController::getInstance()->getModule($vf8fd0c88f22095d75867e82d488e7f15);if($v22884db148f0ffb0d830ba431102b0b5 instanceof def_module) {$v807765384d9d5527da8848df14a4f02f = $v22884db148f0ffb0d830ba431102b0b5->getEditLink($v7057e8409c7c531a1a6e9ac3df4ed549, $vbf2cd78bc903c712c023186d09be671d);$v6e8e7b349ee8e52e4f20489290e3ac27 = isset($v807765384d9d5527da8848df14a4f02f[1]) ? $v807765384d9d5527da8848df14a4f02f[1] : false;if($v6e8e7b349ee8e52e4f20489290e3ac27) {$this->redirect($v6e8e7b349ee8e52e4f20489290e3ac27);}}}}$v156577e912dd9b1be50a671edc17c4a0 = $this->removeErrorParam(getServer('HTTP_REFERER'));outputBuffer::current()->redirect($v156577e912dd9b1be50a671edc17c4a0);}public function checkAllowedElementType($ve62e4d22f2d8630f6e44e2b7c3f70ddc, $vb728bdb559aaf487a1e95ceaea9d0815 = true) {$v8e2dcfd7e7e24b1ca76c1193f645902b = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'element');$va8cfde6331bd59eb2ac96f8911c4b666 = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'object');$v599dcce2998a6b40b1e38e8c6006cb0a = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'type');$vb49eaf5d3952b8f9b7b1a09ab661c63b = getArrayKey($ve62e4d22f2d8630f6e44e2b7c3f70ddc, 'allowed-element-types');$v4ed1934b53e02cba7b361c00bf660ba7 = umiHierarchyTypesCollection::getInstance()->getTypeByName("comments", "comment");if($v4ed1934b53e02cba7b361c00bf660ba7) {$v0e9292c29834c503f695817879e138be = $v4ed1934b53e02cba7b361c00bf660ba7->getId();}else {$v0e9292c29834c503f695817879e138be = false;}if(is_array($vb49eaf5d3952b8f9b7b1a09ab661c63b) === false) {if($vb728bdb559aaf487a1e95ceaea9d0815 === false) {throw new coreException("Allowed types expected to be array");}else {return true;}}if($v599dcce2998a6b40b1e38e8c6006cb0a) {if(in_array($v599dcce2998a6b40b1e38e8c6006cb0a, $vb49eaf5d3952b8f9b7b1a09ab661c63b)) {return true;}else {return false;}}if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement === true) {$v0715f6d9497f93911417c9c324265771 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId();}else if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject === true) {$v87306dd4235ed712ebc07fe169b76f83 = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();$v7ae7003da59ae71dcc9f8638ef50593d = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);$v0715f6d9497f93911417c9c324265771 = $v7ae7003da59ae71dcc9f8638ef50593d->getHierarchyTypeId();}else {throw new coreException("If you are doing 'add' method, you should pass me 'type' key in 'inputData' array. If you have 'edit' method, pass me 'element' key in 'inputData' array.");}$vb946c44d711ade3b061653732977d043 = umiHierarchyTypesCollection::getInstance()->getType($v0715f6d9497f93911417c9c324265771);if($vb946c44d711ade3b061653732977d043 instanceof iUmiHierarchyType) {$vea9f6aca279138c58f705c8d4cb4b8ce = $vb946c44d711ade3b061653732977d043->getExt();if(in_array($vea9f6aca279138c58f705c8d4cb4b8ce, $vb49eaf5d3952b8f9b7b1a09ab661c63b) || $vb946c44d711ade3b061653732977d043->getId() == $v0e9292c29834c503f695817879e138be) {return true;}else {return false;}}else {throw new coreException("This should never happen");}}public function checkElementPermissions($v7057e8409c7c531a1a6e9ac3df4ed549, $v323d784d081622bc3fa291439a7dc9f7 = permissionsCollection::E_EDIT_ALLOWED) {static $v41275a535677f79ff347e01bc530c176 = NULL, $ve8701ad48ba05a91604e480dd60899a3 = NULL;if(is_null($v41275a535677f79ff347e01bc530c176)) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$ve8701ad48ba05a91604e480dd60899a3 = $v41275a535677f79ff347e01bc530c176->getUserId();}$vb394126a0e52e75f1e3d535d0fb0d33c = $v41275a535677f79ff347e01bc530c176->isAllowedObject($ve8701ad48ba05a91604e480dd60899a3, $v7057e8409c7c531a1a6e9ac3df4ed549);if(!isset($vb394126a0e52e75f1e3d535d0fb0d33c[$v323d784d081622bc3fa291439a7dc9f7]) || $vb394126a0e52e75f1e3d535d0fb0d33c[$v323d784d081622bc3fa291439a7dc9f7] == false) {throw new requreMoreAdminPermissionsException(getLabel("error-require-more-permissions"));}else {return true;}}public function switchActivity($v21ffce5b8a6cc8cc6a41448dd69623c9) {if($this->checkAllowedElementType($v21ffce5b8a6cc8cc6a41448dd69623c9) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}$v8e2dcfd7e7e24b1ca76c1193f645902b = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'element');$v69a256025f66e4ce5d15c9dd7225d357 = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'activity');if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement === false) {throw new expectElementException(getLabel('error-expect-element'));}$this->checkElementPermissions($v8e2dcfd7e7e24b1ca76c1193f645902b->getId());if(is_null($v69a256025f66e4ce5d15c9dd7225d357)) {$v69a256025f66e4ce5d15c9dd7225d357 = !$v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive();}$v854203cccade0bbe21be239a208aea49 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getModule();$v2fa70149e2a7e75da2b0303d0a36a944 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getMethod();$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$ve8701ad48ba05a91604e480dd60899a3 = $v41275a535677f79ff347e01bc530c176->getUserId();if($v41275a535677f79ff347e01bc530c176->isAllowedMethod($ve8701ad48ba05a91604e480dd60899a3, $v854203cccade0bbe21be239a208aea49, "publish") == false) {throw new requreMoreAdminPermissionsException(getLabel('error-no-publication-permissions'));}if($v69a256025f66e4ce5d15c9dd7225d357 == $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive()) {return $v69a256025f66e4ce5d15c9dd7225d357;}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemSwitchElementActivity");$v4119639092e62c55ea8be348e4d9260d->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v4119639092e62c55ea8be348e4d9260d->setParam("activity", $v69a256025f66e4ce5d15c9dd7225d357);$v4119639092e62c55ea8be348e4d9260d->setMode("before");try {$v4119639092e62c55ea8be348e4d9260d->call();}catch (coreBreakEventsException $ve1671797c52e15f763380b45e841ec32) {return $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive();}$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsActive($v69a256025f66e4ce5d15c9dd7225d357);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$v4119639092e62c55ea8be348e4d9260d->setMode("after");try {$v4119639092e62c55ea8be348e4d9260d->call();}catch (coreBreakEventsException $ve1671797c52e15f763380b45e841ec32) {return $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive();}return $v8e2dcfd7e7e24b1ca76c1193f645902b->getIsActive();}public function moveElement($v21ffce5b8a6cc8cc6a41448dd69623c9) {if($this->checkAllowedElementType($v21ffce5b8a6cc8cc6a41448dd69623c9) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$ve4e46deb7f9cc58c7abfb32e5570b6f3 = domainsCollection::getInstance();$v8e2dcfd7e7e24b1ca76c1193f645902b = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'element');$vbfa030fe63bacd523dd70a76cfaed98a = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'parent-id');$v72ee76c5c29383b7c9f9225c1fa4d10b = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'domain');$v6f7271d2b14630f80718ba10635b034e = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'as-sibling');$v2862c7667bfa3eb6b4c6fa1de2bd8826 = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'before-id');$this->checkElementPermissions($v8e2dcfd7e7e24b1ca76c1193f645902b->getId(), permissionsCollection::E_MOVE_ALLOWED);$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemMoveElement");$v4119639092e62c55ea8be348e4d9260d->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v4119639092e62c55ea8be348e4d9260d->setParam("parent-id", $vbfa030fe63bacd523dd70a76cfaed98a);$v4119639092e62c55ea8be348e4d9260d->setParam("domain-host", $v72ee76c5c29383b7c9f9225c1fa4d10b);$v4119639092e62c55ea8be348e4d9260d->setParam("as-sibling", $v6f7271d2b14630f80718ba10635b034e);$v4119639092e62c55ea8be348e4d9260d->setParam("before-id", $v2862c7667bfa3eb6b4c6fa1de2bd8826);$v4119639092e62c55ea8be348e4d9260d->setMode("before");try {$v4119639092e62c55ea8be348e4d9260d->call();}catch (coreBreakEventsException $ve1671797c52e15f763380b45e841ec32) {return false;}if(is_numeric($v72ee76c5c29383b7c9f9225c1fa4d10b) == false)    $v72ee76c5c29383b7c9f9225c1fa4d10b = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomainId($v72ee76c5c29383b7c9f9225c1fa4d10b);$vc02811e4c4fdd0b3549131ca8a2c74d1 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();if ($v72ee76c5c29383b7c9f9225c1fa4d10b) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setDomainId($v72ee76c5c29383b7c9f9225c1fa4d10b);}$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();if ($v6f7271d2b14630f80718ba10635b034e) {$vb81ca7c0ccaa77e7aa91936ab0070695->moveBefore($v8e2dcfd7e7e24b1ca76c1193f645902b->getId(), $vbfa030fe63bacd523dd70a76cfaed98a, (($v2862c7667bfa3eb6b4c6fa1de2bd8826) ? $v2862c7667bfa3eb6b4c6fa1de2bd8826 : false));}else {$vb81ca7c0ccaa77e7aa91936ab0070695->moveFirst($v8e2dcfd7e7e24b1ca76c1193f645902b->getId(), $vbfa030fe63bacd523dd70a76cfaed98a);}$v8e2dcfd7e7e24b1ca76c1193f645902b->update();$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsUpdated();$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$v4119639092e62c55ea8be348e4d9260d->setMode("after");try {$v4119639092e62c55ea8be348e4d9260d->call();return true;}catch (coreBreakEventsException $ve1671797c52e15f763380b45e841ec32) {return false;}}public function deleteElement($v21ffce5b8a6cc8cc6a41448dd69623c9) {if (! cmsController::isCSRFTokenValid()) {throw new coreException('CSRF Protection');}$v8e2dcfd7e7e24b1ca76c1193f645902b = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'element');if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement === false) {throw new expectElementException(getLabel('error-expect-element'));}if($this->checkAllowedElementType($v21ffce5b8a6cc8cc6a41448dd69623c9) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}$this->checkElementPermissions($v8e2dcfd7e7e24b1ca76c1193f645902b->getId(), permissionsCollection::E_DELETE_ALLOWED);$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemDeleteElement");$v4119639092e62c55ea8be348e4d9260d->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v4119639092e62c55ea8be348e4d9260d->setMode("before");$v4119639092e62c55ea8be348e4d9260d->call();umiHierarchy::getInstance()->delElement($v8e2dcfd7e7e24b1ca76c1193f645902b->getId());$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();}public function deleteObject($v21ffce5b8a6cc8cc6a41448dd69623c9) {if (! cmsController::isCSRFTokenValid()) {throw new coreException('CSRF Protection');}$v69ae498121c2d8e63f20c7144a0246d7 = umiObjectsCollection::getInstance();$v9b81909fd0da3add2602a8d0ede0e4e7 = umiObjectTypesCollection::getInstance();$v1723bdd4ee51910267a625cae41ced8a = umiHierarchyTypesCollection::getInstance();$va8cfde6331bd59eb2ac96f8911c4b666 = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'object');if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject == false) {throw new coreException("You should pass \"object\" key containing umiObject instance.");}$vaf31437ce61345f416579830a98c91e5 = $va8cfde6331bd59eb2ac96f8911c4b666->getId();$v87306dd4235ed712ebc07fe169b76f83 = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();$v7ae7003da59ae71dcc9f8638ef50593d = $v9b81909fd0da3add2602a8d0ede0e4e7->getType($v87306dd4235ed712ebc07fe169b76f83);if($v7ae7003da59ae71dcc9f8638ef50593d instanceof umiObjectType == false) {throw new coreException("Object #{$vaf31437ce61345f416579830a98c91e5} hasn't type #{$v87306dd4235ed712ebc07fe169b76f83}. This should not happen.");}if(!is_null(getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'type'))) {$v0715f6d9497f93911417c9c324265771 = $v7ae7003da59ae71dcc9f8638ef50593d->getHierarchyTypeId();$vb946c44d711ade3b061653732977d043 = $v1723bdd4ee51910267a625cae41ced8a->getType($v0715f6d9497f93911417c9c324265771);if($vb946c44d711ade3b061653732977d043 instanceof iUmiHierarchyType == false) {throw new coreException("Object type #{$v87306dd4235ed712ebc07fe169b76f83} doesn't have hierarchy type #{$v0715f6d9497f93911417c9c324265771}. This should not happen.");}$v21ffce5b8a6cc8cc6a41448dd69623c9['type'] = $vb946c44d711ade3b061653732977d043->getExt();if($this->checkAllowedElementType($v21ffce5b8a6cc8cc6a41448dd69623c9) == false) {throw new wrongElementTypeAdminException(getLabel("error-unexpected-element-type"));}}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemDeleteObject");$v4119639092e62c55ea8be348e4d9260d->addRef("object", $va8cfde6331bd59eb2ac96f8911c4b666);$v4119639092e62c55ea8be348e4d9260d->setMode("before");$v4119639092e62c55ea8be348e4d9260d->call();$result = $v69ae498121c2d8e63f20c7144a0246d7->delObject($vaf31437ce61345f416579830a98c91e5);$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();return $result;}public function getFloatedDomain() {if(!is_null($va6b64ba4d9e3e0b93a64bb6af8c320cc = getRequest('domain'))) {$vbf8851a393c0ed83c36c4c997e68fd00 = domainsCollection::getInstance()->getDomainId($va6b64ba4d9e3e0b93a64bb6af8c320cc);if($vbf8851a393c0ed83c36c4c997e68fd00) {return $vbf8851a393c0ed83c36c4c997e68fd00;}}return false;}public static function getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a, $v764668ee396165dd0f0559c7585b7699 = false) {$v9b81909fd0da3add2602a8d0ede0e4e7 = umiObjectTypesCollection::getInstance();if(!$v764668ee396165dd0f0559c7585b7699) $v764668ee396165dd0f0559c7585b7699 = $v9b81909fd0da3add2602a8d0ede0e4e7->getTypeIdByGUID('root-guides-type');$vcf4313ee98665bb3d4b717b344ba6999 = getLabel('autoguide-for-field') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\"";$v2af1d1812273df0bd0f720da7068f8a6 = $v9b81909fd0da3add2602a8d0ede0e4e7->getChildClasses($v764668ee396165dd0f0559c7585b7699);foreach($v2af1d1812273df0bd0f720da7068f8a6 as $vd4fd255f51559df00de5424b64292413) {$v793536b8480511c5e2975eba32738d1d = $v9b81909fd0da3add2602a8d0ede0e4e7->getType($vd4fd255f51559df00de5424b64292413);$vfd297f4a9a622aec6f6fb2589b9cda82 = $v793536b8480511c5e2975eba32738d1d->getName();if($vfd297f4a9a622aec6f6fb2589b9cda82 == $vcf4313ee98665bb3d4b717b344ba6999) {$v793536b8480511c5e2975eba32738d1d->setIsGuidable(true);return $vd4fd255f51559df00de5424b64292413;}}$v051369818a8073bba5feeb0e957eb308 = $v9b81909fd0da3add2602a8d0ede0e4e7->addType($v764668ee396165dd0f0559c7585b7699, $vcf4313ee98665bb3d4b717b344ba6999);$va0c391dc49c440fc9962168353cedde3 = $v9b81909fd0da3add2602a8d0ede0e4e7->getType($v051369818a8073bba5feeb0e957eb308);$va0c391dc49c440fc9962168353cedde3->setIsGuidable(true);$va0c391dc49c440fc9962168353cedde3->setIsPublic(true);$va0c391dc49c440fc9962168353cedde3->commit();return $v051369818a8073bba5feeb0e957eb308;}public function checkDomainPermissions($v662cbf1253ac7d8750ed9190c52163e5 = false) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$ve4e46deb7f9cc58c7abfb32e5570b6f3 = domainsCollection::getInstance();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if($v662cbf1253ac7d8750ed9190c52163e5 == false) {if(!is_null($vf9b9218cbe221f8b9f1292474aa6f3e4 = getRequest('domain'))) {$v662cbf1253ac7d8750ed9190c52163e5 = $ve4e46deb7f9cc58c7abfb32e5570b6f3->getDomainId($vf9b9218cbe221f8b9f1292474aa6f3e4);}else {$v662cbf1253ac7d8750ed9190c52163e5 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getId();}}if(!$v662cbf1253ac7d8750ed9190c52163e5) {throw new coreException("Require domain id to check domain permissions");}$ve8701ad48ba05a91604e480dd60899a3 = $v41275a535677f79ff347e01bc530c176->getUserId();$vbab394571d9305ff0c667ed256c19a70 = $v41275a535677f79ff347e01bc530c176->isAllowedDomain($ve8701ad48ba05a91604e480dd60899a3, $v662cbf1253ac7d8750ed9190c52163e5);if($vbab394571d9305ff0c667ed256c19a70 == 0) {throw new requreMoreAdminPermissionsException(getLabel('error-no-domain-permissions'));}else {return NULL;}}public function setRequestDataAlias($vc2add694bf942dc77b376592d9c862cd, $v78f825aaa0103319aaa1a30bf4fe3ada) {if(isset($_REQUEST[$v78f825aaa0103319aaa1a30bf4fe3ada])) {$_REQUEST[$vc2add694bf942dc77b376592d9c862cd] = &$_REQUEST[$v78f825aaa0103319aaa1a30bf4fe3ada];return true;}else {return false;}}public function setRequestDataAliases($v9299da2529c98fccce0e32b476ba3266, $vb80bb7740288fda1f201890375a60c8f = "new") {if(!is_array($v9299da2529c98fccce0e32b476ba3266)) {return false;}foreach($v9299da2529c98fccce0e32b476ba3266 as $vc2add694bf942dc77b376592d9c862cd => $v78f825aaa0103319aaa1a30bf4fe3ada) {if(isset($_REQUEST['data'][$vb80bb7740288fda1f201890375a60c8f][$v78f825aaa0103319aaa1a30bf4fe3ada])) {$_REQUEST[$vc2add694bf942dc77b376592d9c862cd] = &$_REQUEST['data'][$vb80bb7740288fda1f201890375a60c8f][$v78f825aaa0103319aaa1a30bf4fe3ada];}}}public function compareObjectTypeByHierarchy($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $v94757cae63fd3e398c0811a976dd6bbe) {$vb3827f7111095f5ba1a9f49988fe9382 = umiObjectTypesCollection::getInstance();$v1723bdd4ee51910267a625cae41ced8a = umiHierarchyTypesCollection::getInstance();$v599dcce2998a6b40b1e38e8c6006cb0a = $vb3827f7111095f5ba1a9f49988fe9382->getType($v94757cae63fd3e398c0811a976dd6bbe);$vb946c44d711ade3b061653732977d043 = $v1723bdd4ee51910267a625cae41ced8a->getTypeByName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType && $vb946c44d711ade3b061653732977d043 instanceof umiHierarchyType) {return $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId() == $vb946c44d711ade3b061653732977d043->getId();}else {return false;}}public function systemIsLocked($v8e2dcfd7e7e24b1ca76c1193f645902b, $ve8701ad48ba05a91604e480dd60899a3){if ($v8e2dcfd7e7e24b1ca76c1193f645902b){$v8a2c76c90da3802fc2f3d7b0b1f2a77a = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();$v31e6b624e5c05c45b0f1e8a7f59801ba = $v8a2c76c90da3802fc2f3d7b0b1f2a77a->getValue("locktime");$vfd394e0fa409a6f15ee8c54a0f069f5e = $v8a2c76c90da3802fc2f3d7b0b1f2a77a->getValue("lockuser");if ($v31e6b624e5c05c45b0f1e8a7f59801ba == null || $vfd394e0fa409a6f15ee8c54a0f069f5e == null){return false;}$vd5034fb9092631c8a2869ebb11b5c591 = regedit::getInstance()->getVal("//settings/lock_duration");if (($v31e6b624e5c05c45b0f1e8a7f59801ba->timestamp + $vd5034fb9092631c8a2869ebb11b5c591) > time() && $vfd394e0fa409a6f15ee8c54a0f069f5e!=$ve8701ad48ba05a91604e480dd60899a3){return true;}else{$v8a2c76c90da3802fc2f3d7b0b1f2a77a->setValue("lockuser", null);$v8a2c76c90da3802fc2f3d7b0b1f2a77a->setValue("locktime", null);$v8a2c76c90da3802fc2f3d7b0b1f2a77a->commit();$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();return false;}}}public function autoDetectAllFilters(umiSelection $v8be74552df93e31bbdd6b36ed74bdb6a, $v38bceec7c944e9431e65bb5bb50cc5fa = false) {$v6a8e3fc043747ec4b0e60aed6b7023ed = getRequest('rel');$vf99eaf9123d0eb944e4a40f8c8b73404 = (int) getRequest('depth');$v8ef57923ab3049b18fb75541ff476ff7 = getRequest('domain_id');$v99deeeb03d58e86bd63af257b5b74888 = getRequest('lang_id');if(!$vf99eaf9123d0eb944e4a40f8c8b73404) {$vf99eaf9123d0eb944e4a40f8c8b73404 = 0;}$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v9b81909fd0da3add2602a8d0ede0e4e7 = umiObjectTypesCollection::getInstance();$v1723bdd4ee51910267a625cae41ced8a = umiHierarchyTypesCollection::getInstance();if(is_null(getRequest('or-mode')) == false) {$v8be74552df93e31bbdd6b36ed74bdb6a->setConditionModeOr();}if (isset($v8ef57923ab3049b18fb75541ff476ff7[0])) {$v8be74552df93e31bbdd6b36ed74bdb6a->setDomainId($v8ef57923ab3049b18fb75541ff476ff7[0]);}if (isset($v99deeeb03d58e86bd63af257b5b74888[0])) {$v8be74552df93e31bbdd6b36ed74bdb6a->setLangId($v99deeeb03d58e86bd63af257b5b74888[0]);}if (is_array($v6a8e3fc043747ec4b0e60aed6b7023ed) && count($v6a8e3fc043747ec4b0e60aed6b7023ed)) {foreach ($v6a8e3fc043747ec4b0e60aed6b7023ed as $vc600dd3e8efd757e388daedf1a383638) {$v558363dde110ad2b3af09518966e0197 = intval($vc600dd3e8efd757e388daedf1a383638);if (is_numeric($v558363dde110ad2b3af09518966e0197)) {$v8be74552df93e31bbdd6b36ed74bdb6a->addHierarchyFilter(intval($vc600dd3e8efd757e388daedf1a383638), $vf99eaf9123d0eb944e4a40f8c8b73404, true);}}}$v0e8133eb006c0f85ed9444ae07a60842 = array_extract_values($v8be74552df93e31bbdd6b36ed74bdb6a->getObjectTypeConds());$vdad8db09124c43be9156ca0e7596fc04 = array_extract_values($v8be74552df93e31bbdd6b36ed74bdb6a->getElementTypeConds());$vc4feb6f9b5b1aa42ea49f74ecab346f9 = array_extract_values($v8be74552df93e31bbdd6b36ed74bdb6a->getHierarchyConds(), $vacbd18db4cc2f85cedef654fccc4a4d8, true);$v0132bb0bf9821bce1103f4db6ced0a5f = getRequest('search-all-text');$v0132bb0bf9821bce1103f4db6ced0a5f = array_extract_values($v0132bb0bf9821bce1103f4db6ced0a5f);$v00ef6e359e66ade0706b8305550f7ea2 = getRequest('fields_filter');$v00ef6e359e66ade0706b8305550f7ea2 = array_extract_values($v00ef6e359e66ade0706b8305550f7ea2, $vacbd18db4cc2f85cedef654fccc4a4d8, true);if(sizeof($vdad8db09124c43be9156ca0e7596fc04)) {$vd663178671639336ce153c008ff6acef = $vdad8db09124c43be9156ca0e7596fc04[sizeof($vdad8db09124c43be9156ca0e7596fc04) - 1];}else {$vd663178671639336ce153c008ff6acef = false;}if(sizeof($v0e8133eb006c0f85ed9444ae07a60842)) {reset($v0e8133eb006c0f85ed9444ae07a60842);$v5f694956811487225d15e973ca38fbab = current($v0e8133eb006c0f85ed9444ae07a60842);}else if(sizeof($vc4feb6f9b5b1aa42ea49f74ecab346f9)) {reset($vc4feb6f9b5b1aa42ea49f74ecab346f9);$v5f694956811487225d15e973ca38fbab = $vb81ca7c0ccaa77e7aa91936ab0070695->getDominantTypeId(current($vc4feb6f9b5b1aa42ea49f74ecab346f9));}else if(sizeof($vdad8db09124c43be9156ca0e7596fc04) && (!empty($v0132bb0bf9821bce1103f4db6ced0a5f) || sizeof($vdad8db09124c43be9156ca0e7596fc04) == 1)) {reset($vdad8db09124c43be9156ca0e7596fc04);$v5f694956811487225d15e973ca38fbab = $v9b81909fd0da3add2602a8d0ede0e4e7->getTypeByHierarchyTypeId(array_pop($vdad8db09124c43be9156ca0e7596fc04));}else {$v5f694956811487225d15e973ca38fbab = $v9b81909fd0da3add2602a8d0ede0e4e7->getTypeIdByGUID('root-pages-type');}if(empty($vc4feb6f9b5b1aa42ea49f74ecab346f9) && !empty($vdad8db09124c43be9156ca0e7596fc04) && empty($v0132bb0bf9821bce1103f4db6ced0a5f) && empty($v00ef6e359e66ade0706b8305550f7ea2)) {$v8be74552df93e31bbdd6b36ed74bdb6a->optimize_root_search_query = true;}else {if(!empty($v00ef6e359e66ade0706b8305550f7ea2)) {if($vd663178671639336ce153c008ff6acef) {$v5f694956811487225d15e973ca38fbab = $v9b81909fd0da3add2602a8d0ede0e4e7->getTypeByHierarchyTypeId($vd663178671639336ce153c008ff6acef);}}}if($v5f694956811487225d15e973ca38fbab) {$this->autoDetectFilters($v8be74552df93e31bbdd6b36ed74bdb6a, $v5f694956811487225d15e973ca38fbab);$this->autoDetectOrders($v8be74552df93e31bbdd6b36ed74bdb6a, $v5f694956811487225d15e973ca38fbab);}if(!$v38bceec7c944e9431e65bb5bb50cc5fa) {$v8be74552df93e31bbdd6b36ed74bdb6a->excludeNestedPages = true;}if(sizeof($vc4feb6f9b5b1aa42ea49f74ecab346f9) && sizeof($vdad8db09124c43be9156ca0e7596fc04)) {$v0715f6d9497f93911417c9c324265771 = $v1723bdd4ee51910267a625cae41ced8a->getTypeByName("comments", "comment")->getId();$v8be74552df93e31bbdd6b36ed74bdb6a->addElementType($v0715f6d9497f93911417c9c324265771);}if(getRequest('import')) {quickCsvImporter::autoImport($v8be74552df93e31bbdd6b36ed74bdb6a, $v38bceec7c944e9431e65bb5bb50cc5fa, (bool) getRequest('force-hierarchy'));}if(getRequest('export')) {quickCsvExporter::autoExport($v8be74552df93e31bbdd6b36ed74bdb6a, (bool) getRequest('force-hierarchy'));}return true;}public function getPageStatusIdByStatusSid($v03c07d5bea3270c79066ec0a8b6b5d28 = 'page_status_publish') {$v8be74552df93e31bbdd6b36ed74bdb6a = new umiSelection;$v8be74552df93e31bbdd6b36ed74bdb6a->setObjectTypeFilter();$v6301cee35ea764a1e241978f93f01069 = $this->getGuideIdByFieldName('publish_status');if(!$v6301cee35ea764a1e241978f93f01069) {return false;}$v8be74552df93e31bbdd6b36ed74bdb6a->addObjectType($v6301cee35ea764a1e241978f93f01069);$result = umiSelectionsParser::runSelection($v8be74552df93e31bbdd6b36ed74bdb6a);foreach ($result as $v16b2b26000987faccb260b9d39df1269) {$vb2b5820c9d36fad67c5a4aa95ddbd8f9 = umiObjectsCollection::getInstance()->getObject($v16b2b26000987faccb260b9d39df1269)->getValue("publish_status_id");if ($vb2b5820c9d36fad67c5a4aa95ddbd8f9 == $v03c07d5bea3270c79066ec0a8b6b5d28) {return $v16b2b26000987faccb260b9d39df1269;}}return false;}public function getGuideIdByFieldName($v972bf3f05d14ffbdb817bef60638ff00) {$vd05b6ed7d2345020440df396d6da7f73 = umiObjectTypesCollection::getInstance()->getTypeByGUID('root-pages-type');foreach ($vd05b6ed7d2345020440df396d6da7f73->getAllFields() as $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getName() == $v972bf3f05d14ffbdb817bef60638ff00) {return $v06e3d36fa30cea095545139854ad1fb9->getGuideId();}}return false;}public function setHeaderLabel($vd304ba20e96d87411588eeabac850e34) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v8b1dc169bf460ee884fceef66c6607d6->headerLabel = $vd304ba20e96d87411588eeabac850e34;}public function getObjectTypeMethod($va8cfde6331bd59eb2ac96f8911c4b666) {if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject == false) {throw new coreException("Expected instance of umiObject as param.");}$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$v6301cee35ea764a1e241978f93f01069 = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();$v726e8e4809d4c1b28a6549d86436a124 = $v0e8133eb006c0f85ed9444ae07a60842->getType($v6301cee35ea764a1e241978f93f01069);if($v726e8e4809d4c1b28a6549d86436a124 instanceof umiObjectType) {$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v726e8e4809d4c1b28a6549d86436a124->getHierarchyTypeId();$v89b0b9deff65f8b9cd1f71bc74ce36ba = $v6942e8fa62b3cc9d93881a58210e2fd7->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {return $v89b0b9deff65f8b9cd1f71bc74ce36ba->getExt();}else {throw new coreException("Can't get hierarchy type #{$vacf567c9c3d6cf7c6e2cc0ce108e0631}");}}else {throw new coreException("Can't get object type #{$v6301cee35ea764a1e241978f93f01069}");}}public function getDatasetConfiguration($veca07335a33c5aeb5e1bc7c98b4b9d80 = '') {return array(     'methods' => array(      array('title'=>getLabel('smc-load'), 'forload'=>true,     'module'=>'content', '#__name'=>'load_tree_node'),      array('title'=>getLabel('smc-delete'),           'module'=>'content', '#__name'=>'tree_delete_element'),      array('title'=>getLabel('smc-activity'),    'module'=>'content', '#__name'=>'tree_set_activity'),      array('title'=>getLabel('smc-copy'), 'module'=>'content', '#__name'=>'tree_copy_element'),      array('title'=>getLabel('smc-move'),       'module'=>'content', '#__name'=>'tree_move_element'),      array('title'=>getLabel('smc-change-template'),        'module'=>'content', '#__name'=>'change_template'),      array('title'=>getLabel('smc-change-lang'),       'module'=>'content', '#__name'=>'copy_to_lang_old'),      array('title'=>getLabel('smc-change-lang'),       'module'=>'content', '#__name'=>'move_to_lang'),     )    );}final public function dataset_config() {$veca07335a33c5aeb5e1bc7c98b4b9d80 = getRequest('param');$v2f4adddaca8e63aeb6aa99e64bd89572 = array('methods'=>'method', 'types'=>'type', 'stoplist'=>'exclude', 'default'=>'column');$v9bf73c8994aad280e5160d0030c48f28 = $this->getDatasetConfiguration($veca07335a33c5aeb5e1bc7c98b4b9d80);$vfdc3bdefb79cec8eb8211d2499e04704 = new DOMDocument();$vfdc3bdefb79cec8eb8211d2499e04704->encoding = "utf-8";$v63a9f0ea7bb98050796b649e85481845   = $vfdc3bdefb79cec8eb8211d2499e04704->createElement('dataset');$vfdc3bdefb79cec8eb8211d2499e04704->appendChild($v63a9f0ea7bb98050796b649e85481845);if(is_array($v9bf73c8994aad280e5160d0030c48f28)) {$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();foreach($v9bf73c8994aad280e5160d0030c48f28 as $vb71772ba2ee2cdb2ebb175d0cb465bd5 => $ve7f1e731d719bc9e6b96840ac4bf5260) {$v73d5342eba070f636ac3246f319bf77f = $vfdc3bdefb79cec8eb8211d2499e04704->createElement($vb71772ba2ee2cdb2ebb175d0cb465bd5);$v63a9f0ea7bb98050796b649e85481845->appendChild($v73d5342eba070f636ac3246f319bf77f);if(is_array($ve7f1e731d719bc9e6b96840ac4bf5260)) {foreach($ve7f1e731d719bc9e6b96840ac4bf5260 as $vde17f0f24b49f8364187891f8550ffbb) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vfdc3bdefb79cec8eb8211d2499e04704->createElement($v2f4adddaca8e63aeb6aa99e64bd89572[$vb71772ba2ee2cdb2ebb175d0cb465bd5]);if(is_array($vde17f0f24b49f8364187891f8550ffbb)) {foreach($vde17f0f24b49f8364187891f8550ffbb as $v9190e95d1c478aceb70ac5c82692a74c => $v9602b952913db0444a013e59553f377e) {if($v9190e95d1c478aceb70ac5c82692a74c === "#__name") {$v8e2dcfd7e7e24b1ca76c1193f645902b->appendChild( $vfdc3bdefb79cec8eb8211d2499e04704->createTextNode($v9602b952913db0444a013e59553f377e) );continue;}if($v9190e95d1c478aceb70ac5c82692a74c == "id" && !is_numeric($v9602b952913db0444a013e59553f377e)) {$v9602b952913db0444a013e59553f377e = $v0e8133eb006c0f85ed9444ae07a60842->getBaseType(get_class($this), $v9602b952913db0444a013e59553f377e);}$v8e2dcfd7e7e24b1ca76c1193f645902b->setAttribute($v9190e95d1c478aceb70ac5c82692a74c, is_bool($v9602b952913db0444a013e59553f377e) ? ($v9602b952913db0444a013e59553f377e ? "true" : "false") : $v9602b952913db0444a013e59553f377e );}}else {$v8e2dcfd7e7e24b1ca76c1193f645902b->appendChild( $vfdc3bdefb79cec8eb8211d2499e04704->createTextNode($vde17f0f24b49f8364187891f8550ffbb) );}$v73d5342eba070f636ac3246f319bf77f->appendChild($v8e2dcfd7e7e24b1ca76c1193f645902b);}}else {$v73d5342eba070f636ac3246f319bf77f->appendChild( $vfdc3bdefb79cec8eb8211d2499e04704->createTextNode($ve7f1e731d719bc9e6b96840ac4bf5260) );}}}$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v7f2db423a49b305459147332fb01cf87->contentType('text/xml');$v7f2db423a49b305459147332fb01cf87->charset('utf-8');$v7f2db423a49b305459147332fb01cf87->push($vfdc3bdefb79cec8eb8211d2499e04704->saveXML());$v7f2db423a49b305459147332fb01cf87->end();}public function change_template() {$v6a7f245843454cf4f28ad7c5e2572aa2 = getRequest('element');if(!is_array($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6a7f245843454cf4f28ad7c5e2572aa2 = array($v6a7f245843454cf4f28ad7c5e2572aa2);}$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement("element");$v3200a31fc05da4e9d5a0465c36822e2f = getRequest('template-id');if (!is_null($v3200a31fc05da4e9d5a0465c36822e2f)) {foreach($v6a7f245843454cf4f28ad7c5e2572aa2 as $v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement($v7552cd149af7495ee7d8225974e50f80, false, true);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setTplId($v3200a31fc05da4e9d5a0465c36822e2f);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();}else {throw new publicAdminException(getLabel('error-expect-element'));}}$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v6a7f245843454cf4f28ad7c5e2572aa2, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}else {throw new publicAdminException(getLabel('error-expect-action'));}}public function switchGroupsActivity($va2b861d0e7719d9108522aacfd4181bc, $v69a256025f66e4ce5d15c9dd7225d357) {$v1471e4e05a4db95d353cc867fe317314 = umiFieldsGroup::getAllGroupsByName($va2b861d0e7719d9108522aacfd4181bc);foreach($v1471e4e05a4db95d353cc867fe317314 as $vdb0f6f37ebeb6ea09489124345af2a45) {if($vdb0f6f37ebeb6ea09489124345af2a45 instanceof umiFieldsGroup) {$vdb0f6f37ebeb6ea09489124345af2a45->setIsActive($v69a256025f66e4ce5d15c9dd7225d357);$vdb0f6f37ebeb6ea09489124345af2a45->commit();}}}}interface iBaseSerialize {public static function serializeDocument($v599dcce2998a6b40b1e38e8c6006cb0a, $v58309fbfe87fa90ec9f4b9d78ead9d77, $v21ffce5b8a6cc8cc6a41448dd69623c9);};abstract class baseSerialize implements iBaseSerialize {static $called = Array();final public static function serializeDocument($v599dcce2998a6b40b1e38e8c6006cb0a, $v7f2db423a49b305459147332fb01cf87, $v21ffce5b8a6cc8cc6a41448dd69623c9) {$v84f6fb7cd5cd53b5679489a29396448f = self::loadSerializer($v599dcce2998a6b40b1e38e8c6006cb0a);return $v84f6fb7cd5cd53b5679489a29396448f->execute($v7f2db423a49b305459147332fb01cf87, $v21ffce5b8a6cc8cc6a41448dd69623c9);}abstract public function execute($v58309fbfe87fa90ec9f4b9d78ead9d77, $v21ffce5b8a6cc8cc6a41448dd69623c9);protected static function loadSerializer($v599dcce2998a6b40b1e38e8c6006cb0a) {$v435ed7e9f07f740abf511a62c00eef6e = SYS_KERNEL_PATH . "subsystems/matches/serializes/{$v599dcce2998a6b40b1e38e8c6006cb0a}/{$v599dcce2998a6b40b1e38e8c6006cb0a}.php";if(is_file($v435ed7e9f07f740abf511a62c00eef6e)) {require $v435ed7e9f07f740abf511a62c00eef6e;$v59a92a319c1a57b505bacd5f2e591363 = strtolower($v599dcce2998a6b40b1e38e8c6006cb0a) . "Serialize";if(class_exists($v59a92a319c1a57b505bacd5f2e591363)) {return new $v59a92a319c1a57b505bacd5f2e591363();}else {throw new coreException("Class {$v59a92a319c1a57b505bacd5f2e591363} doesn't exsits");}}else {throw new coreException("Can't load serializer of type \"{$v599dcce2998a6b40b1e38e8c6006cb0a}\"");}}protected function sendHTTPHeaders($v21ffce5b8a6cc8cc6a41448dd69623c9) {if(is_array($v21ffce5b8a6cc8cc6a41448dd69623c9)) {$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v4340fd73e75df7a9d9e45902a59ba3a4 = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'headers');if(is_array($v4340fd73e75df7a9d9e45902a59ba3a4)) {foreach($v4340fd73e75df7a9d9e45902a59ba3a4 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if(strtolower($v865c0c0b4ab0e063e5caa3387c1a8741) == 'content-type') {$v7f2db423a49b305459147332fb01cf87->contentType($v9e3669d19b675bd57058fd4664205d2a);continue;}$v7f2db423a49b305459147332fb01cf87->header($v865c0c0b4ab0e063e5caa3387c1a8741, $v9e3669d19b675bd57058fd4664205d2a);}}}else {throw new coreException("First argument must be ad array in sendHTTPHeaders()");}}};interface iUmiLogger {public function __construct($vd3326835044515b68dab0a9dc8eec976 = "./logs/");public function pushGlobalEnviroment();public function push($vf664237e19ad7e814700e688b6016d6c, $v7474e980a35c8d389fd3a8f1991c0352 = true);public function log();public function save();public function get();};class umiLogger implements iUmiLogger {protected $logDir = "./logs/",     $log = "",     $is_saved = false,     $is_global_env_pushed = false,     $start_time = false;public function __construct($vd3326835044515b68dab0a9dc8eec976 = "./logs/") {$this->runTimer();$this->logDir = $vd3326835044515b68dab0a9dc8eec976;$this->checkDirectory();}public function pushGlobalEnviroment() {if ($this->is_global_env_pushed == false) {$this->collectGlobalEnviroment();$this->is_global_env_pushed = true;return true;}else {return false;}}public function push($vf664237e19ad7e814700e688b6016d6c, $v7474e980a35c8d389fd3a8f1991c0352 = true) {if ($v7474e980a35c8d389fd3a8f1991c0352 == true) {$vf664237e19ad7e814700e688b6016d6c = "[" . sprintf("%1.7f", $this->getTimer()) . "]\t" . $vf664237e19ad7e814700e688b6016d6c;}$this->log .= $vf664237e19ad7e814700e688b6016d6c . "\n";}public function log() {$this->pushGlobalEnviroment();}public function __destruct() {if($this->is_saved == false) {$this->save();}}public function save() {$v0325035afbe5ded2250a31010977cedf = $this->prepareStoreDir();$v435ed7e9f07f740abf511a62c00eef6e = date("Y-m-d_H_i_s");$v6a2a431fe8b621037ea949531c28551d = $v0325035afbe5ded2250a31010977cedf . "/" . $v435ed7e9f07f740abf511a62c00eef6e . ".log";if (file_put_contents($v6a2a431fe8b621037ea949531c28551d, $this->get())) {return $v6a2a431fe8b621037ea949531c28551d;}else {throw new Exception("Can't save log in \"{$v6a2a431fe8b621037ea949531c28551d}\"");}$this->is_saved = true;}public function get() {return $this->log;}protected function checkDirectory() {$v183f3fe79292a8d428a6160d1d44bd90 = $this->logDir;if (is_dir($v183f3fe79292a8d428a6160d1d44bd90)) {if (is_writable($v183f3fe79292a8d428a6160d1d44bd90)) {return true;}else {throw new Exception("Directory \"{$v183f3fe79292a8d428a6160d1d44bd90}\" must be writable");}}else {throw new Exception("Directory \"{$v183f3fe79292a8d428a6160d1d44bd90}\" doesn't exists");}}protected function prepareStoreDir() {$v183f3fe79292a8d428a6160d1d44bd90 = $this->logDir;$v89d2e9db6cf76746b7bebdc7f21d1646 = getServer('REMOTE_ADDR');$vd30057347e577d1ac6f943b16c967047 = $v183f3fe79292a8d428a6160d1d44bd90 . $v89d2e9db6cf76746b7bebdc7f21d1646;if (file_exists($vd30057347e577d1ac6f943b16c967047)) {if (is_writable($vd30057347e577d1ac6f943b16c967047)) {return $vd30057347e577d1ac6f943b16c967047;}else {throw new Exception("Directory \"{$vd30057347e577d1ac6f943b16c967047}\" must be writable");}}if (mkdir($vd30057347e577d1ac6f943b16c967047)) {return $vd30057347e577d1ac6f943b16c967047 . '/';}else {throw new Exception("Can't create directory \"{$vd30057347e577d1ac6f943b16c967047}\"");}}protected function collectGlobalEnviroment() {$this->collectGlobalArray('_COOKIE');$this->collectGlobalArray('_SESSION');$this->collectGlobalArray('_POST');$this->collectGlobalArray('_GET');$this->collectGlobalArray('_FILES');if (function_exists('apache_request_headers')) {$this->collectArray("Request headers", apache_request_headers());}if (function_exists('apache_response_headers')) {$this->collectArray("Response headers", apache_response_headers());}}protected function collectGlobalArray($v2b359ce0e32ccc218965d608c087eabc) {global $$v2b359ce0e32ccc218965d608c087eabc;if (isset($$v2b359ce0e32ccc218965d608c087eabc)) {$this->collectArray($v2b359ce0e32ccc218965d608c087eabc, $$v2b359ce0e32ccc218965d608c087eabc);}}protected function collectArray($vb068931cc450442b63f5b3d276ea4297, $v47c80780ab608cc046f2a6e6f071feb6) {if (!is_array($v47c80780ab608cc046f2a6e6f071feb6)) {return false;}if (sizeof($v47c80780ab608cc046f2a6e6f071feb6) == 0) {return true;}$v6e2baaf3b97dbeef01c0043275f9a0e7 = "[{$vb068931cc450442b63f5b3d276ea4297}]\n";foreach ($v47c80780ab608cc046f2a6e6f071feb6 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {$v6e2baaf3b97dbeef01c0043275f9a0e7 .= "\t[" . $v865c0c0b4ab0e063e5caa3387c1a8741 . "]\n\t" . "(" . gettype($v9e3669d19b675bd57058fd4664205d2a) . ") ";if (is_array($v9e3669d19b675bd57058fd4664205d2a)) {$v9e3669d19b675bd57058fd4664205d2a = $this->serializeArray($v9e3669d19b675bd57058fd4664205d2a);}$v6e2baaf3b97dbeef01c0043275f9a0e7 .= $v9e3669d19b675bd57058fd4664205d2a . "\n\n";}$this->push($v6e2baaf3b97dbeef01c0043275f9a0e7, false);return true;}protected function serializeArray($v47c80780ab608cc046f2a6e6f071feb6) {$v9b207167e5381c47682c6b4f58a623fb = "[";$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v47c80780ab608cc046f2a6e6f071feb6);$v4a8a08f09d37b73795649038408b5f33 = 0;foreach ($v47c80780ab608cc046f2a6e6f071feb6 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if (is_array($v9e3669d19b675bd57058fd4664205d2a)) {$v9e3669d19b675bd57058fd4664205d2a = $this->serializeArray($v9e3669d19b675bd57058fd4664205d2a);}$v9b207167e5381c47682c6b4f58a623fb .= "'" . $v9e3669d19b675bd57058fd4664205d2a . "'";if(++$v4a8a08f09d37b73795649038408b5f33 < $v7dabf5c198b0bab2eaa42bb03a113e55) {$v9b207167e5381c47682c6b4f58a623fb .= ", ";}}$v9b207167e5381c47682c6b4f58a623fb .= "]";return $v9b207167e5381c47682c6b4f58a623fb;}protected function runTimer() {$this->start_time = microtime(true);}protected function getTimer() {$v07cc694b9b3fc636710fa08b6922c42b = microtime(true) - $this->start_time;return round($v07cc694b9b3fc636710fa08b6922c42b, 7);}};abstract class baseRestriction {protected $errorMessage = 'restriction-error-common',     $id, $title, $classPrefix, $fieldTypeId;final public static function get($v6b1a57fa235477758817df3c91158006) {$v6b1a57fa235477758817df3c91158006 = (int) $v6b1a57fa235477758817df3c91158006;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `class_prefix`, `title`, `field_type_id` FROM `cms3_object_fields_restrictions` WHERE `id` = '{$v6b1a57fa235477758817df3c91158006}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(list($v6f65638723a69dfa99474478b83b7b17, $vd5d3db1765287eef77d7927cc956f50a, $ve2aeb4e882d60b1eb4b7c8cd97986a28) = mysql_fetch_row($result)) {$v47826cacc65c665212b821e6ff80b9b0 = CURRENT_WORKING_DIR . '/classes/system/subsystems/models/data/restrictions/' . $v6f65638723a69dfa99474478b83b7b17 . '.php';$v6f66e878c62db60568a3487869695820 = $v6f65638723a69dfa99474478b83b7b17 . 'Restriction';if(is_file($v47826cacc65c665212b821e6ff80b9b0) == false) {return false;}if(!class_exists($v6f66e878c62db60568a3487869695820)) {require $v47826cacc65c665212b821e6ff80b9b0;}if(class_exists($v6f66e878c62db60568a3487869695820)) {$v3dadfaeb46ec74762b37de11fea7605c = new $v6f66e878c62db60568a3487869695820($v6b1a57fa235477758817df3c91158006, $v6f65638723a69dfa99474478b83b7b17, $vd5d3db1765287eef77d7927cc956f50a, $ve2aeb4e882d60b1eb4b7c8cd97986a28);if($v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) {return $v3dadfaeb46ec74762b37de11fea7605c;}else {return false;}}else {return false;}}else {return false;}}final public static function getList() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `id` FROM `cms3_object_fields_restrictions`";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v81e12dac658cfd4c590486dd6f7523cf = array();while(list($vb80bb7740288fda1f201890375a60c8f) = mysql_fetch_row($result)) {$v3dadfaeb46ec74762b37de11fea7605c= self::get($vb80bb7740288fda1f201890375a60c8f);if($v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) {$v81e12dac658cfd4c590486dd6f7523cf[] = $v3dadfaeb46ec74762b37de11fea7605c;}}return $v81e12dac658cfd4c590486dd6f7523cf;}final public static function add($v6f65638723a69dfa99474478b83b7b17, $vd5d3db1765287eef77d7927cc956f50a, $ve2aeb4e882d60b1eb4b7c8cd97986a28) {$v6f65638723a69dfa99474478b83b7b17 = l_mysql_real_escape_string($v6f65638723a69dfa99474478b83b7b17);$vd5d3db1765287eef77d7927cc956f50a = l_mysql_real_escape_string($vd5d3db1765287eef77d7927cc956f50a);$ve2aeb4e882d60b1eb4b7c8cd97986a28 = (int) $ve2aeb4e882d60b1eb4b7c8cd97986a28;$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO `cms3_object_fields_restrictions`
	(`class_prefix`, `title`, `field_type_id`)
	VALUES ('{$v6f65638723a69dfa99474478b83b7b17}', '{$vd5d3db1765287eef77d7927cc956f50a}', '{$ve2aeb4e882d60b1eb4b7c8cd97986a28}')
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return l_mysql_insert_id();}abstract public function validate($v2063c1608d6e0baf80249c42e2be5804, $v16b2b26000987faccb260b9d39df1269 = false);public function getErrorMessage() {return getLabel($this->errorMessage);}public function getTitle() {return getLabel($this->title);}public function getClassName() {return $this->classPrefix;}public function getId() {return $this->id;}public function getFieldTypeId() {return $this->fieldTypeId;}public static function find($v6f65638723a69dfa99474478b83b7b17, $ve2aeb4e882d60b1eb4b7c8cd97986a28) {$v81e12dac658cfd4c590486dd6f7523cf = self::getList();foreach($v81e12dac658cfd4c590486dd6f7523cf as $v3dadfaeb46ec74762b37de11fea7605c) {if($v3dadfaeb46ec74762b37de11fea7605c->getClassName() == $v6f65638723a69dfa99474478b83b7b17 && $v3dadfaeb46ec74762b37de11fea7605c->getFieldTypeId() == $ve2aeb4e882d60b1eb4b7c8cd97986a28) {return $v3dadfaeb46ec74762b37de11fea7605c;}}}protected function __construct($vb80bb7740288fda1f201890375a60c8f, $v6f65638723a69dfa99474478b83b7b17, $vd5d3db1765287eef77d7927cc956f50a, $ve2aeb4e882d60b1eb4b7c8cd97986a28) {$this->id = (int) $vb80bb7740288fda1f201890375a60c8f;$this->classPrefix = $v6f65638723a69dfa99474478b83b7b17;$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->fieldTypeId = (int) $ve2aeb4e882d60b1eb4b7c8cd97986a28;}};interface iNormalizeInRestriction {public function normalizeIn($v2063c1608d6e0baf80249c42e2be5804, $v16b2b26000987faccb260b9d39df1269 = false);};interface iNormalizeOutRestriction {public function normalizeOut($v2063c1608d6e0baf80249c42e2be5804, $v16b2b26000987faccb260b9d39df1269 = false);};interface iRedirects {public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL);public function add($v36cd38f49b9afa08222c0dc9ebfe35eb, $v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258 = 301);public function getRedirectsIdBySource($v36cd38f49b9afa08222c0dc9ebfe35eb);public function getRedirectIdByTarget($v42aefbae01d2dfd981f7da7d823d689e);public function del($vb80bb7740288fda1f201890375a60c8f);public function redirectIfRequired($vf0183130c6c478a364b95e4325786eb9);public function init();};class redirects implements iRedirects {public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {static $v7123a699d77db6479a1d8ece2c4f1c16;if(is_null($v7123a699d77db6479a1d8ece2c4f1c16)) {$v7123a699d77db6479a1d8ece2c4f1c16 = new redirects;}return $v7123a699d77db6479a1d8ece2c4f1c16;}public function add($v36cd38f49b9afa08222c0dc9ebfe35eb, $v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258 = 301) {if($v36cd38f49b9afa08222c0dc9ebfe35eb == $v42aefbae01d2dfd981f7da7d823d689e) return;$v36cd38f49b9afa08222c0dc9ebfe35eb = l_mysql_real_escape_string($this->parseUri($v36cd38f49b9afa08222c0dc9ebfe35eb));$v42aefbae01d2dfd981f7da7d823d689e = l_mysql_real_escape_string($this->parseUri($v42aefbae01d2dfd981f7da7d823d689e));$v9acb44549b41563697bb490144ec6258 = (int) $v9acb44549b41563697bb490144ec6258;l_mysql_query("START TRANSACTION /* Adding new redirect records */");$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO `cms3_redirects`
	(`source`, `target`, `status`)
	SELECT `source`, '{$v42aefbae01d2dfd981f7da7d823d689e}', '{$v9acb44549b41563697bb490144ec6258}' FROM `cms3_redirects`	
		WHERE `target` = '{$v36cd38f49b9afa08222c0dc9ebfe35eb}'
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
DELETE FROM `cms3_redirects` WHERE `target` = '{$v36cd38f49b9afa08222c0dc9ebfe35eb}'
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$result = l_mysql_query("SELECT * FROM `cms3_redirects` WHERE `source` = '{$v36cd38f49b9afa08222c0dc9ebfe35eb}' AND `target` = '{$v42aefbae01d2dfd981f7da7d823d689e}'", true);if(mysql_num_rows($result)) {return;}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO `cms3_redirects`
	(`source`, `target`, `status`)
	VALUES
	('{$v36cd38f49b9afa08222c0dc9ebfe35eb}', '{$v42aefbae01d2dfd981f7da7d823d689e}', '{$v9acb44549b41563697bb490144ec6258}')
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);l_mysql_query("COMMIT");}public function getRedirectsIdBySource($v36cd38f49b9afa08222c0dc9ebfe35eb) {$vc08b1ffecd5ba75362b821842b4f4505 = l_mysql_real_escape_string($this->parseUri($v36cd38f49b9afa08222c0dc9ebfe35eb));$v2d8413ae32cda5259e93d4f3666f1235 = array();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `id`, `target`, `status` FROM `cms3_redirects` WHERE `source` = '{$vc08b1ffecd5ba75362b821842b4f4505}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($vb80bb7740288fda1f201890375a60c8f, $v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258) = mysql_fetch_row($result)) {$v2d8413ae32cda5259e93d4f3666f1235[$vb80bb7740288fda1f201890375a60c8f] = Array($v36cd38f49b9afa08222c0dc9ebfe35eb, $v42aefbae01d2dfd981f7da7d823d689e, (int) $v9acb44549b41563697bb490144ec6258);}return $v2d8413ae32cda5259e93d4f3666f1235;}public function getRedirectIdByTarget($v42aefbae01d2dfd981f7da7d823d689e) {$vf70cd12b2475f48430f5afb914d43f9c = l_mysql_real_escape_string($this->parseUri($v42aefbae01d2dfd981f7da7d823d689e));$v2d8413ae32cda5259e93d4f3666f1235 = array();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `id`, `source`, `status` FROM `cms3_redirects` WHERE `target` = '{$vf70cd12b2475f48430f5afb914d43f9c}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(list($vb80bb7740288fda1f201890375a60c8f, $v36cd38f49b9afa08222c0dc9ebfe35eb, $v9acb44549b41563697bb490144ec6258) = mysql_fetch_row($result)) {return Array($v36cd38f49b9afa08222c0dc9ebfe35eb, $v42aefbae01d2dfd981f7da7d823d689e, (int) $v9acb44549b41563697bb490144ec6258);}else {return false;}}public function del($vb80bb7740288fda1f201890375a60c8f) {$vb80bb7740288fda1f201890375a60c8f = (int) $vb80bb7740288fda1f201890375a60c8f;$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
DELETE FROM `cms3_redirects` WHERE `id` = '{$vb80bb7740288fda1f201890375a60c8f}'
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}public function redirectIfRequired($vf0183130c6c478a364b95e4325786eb9) {$vf0183130c6c478a364b95e4325786eb9 = l_mysql_real_escape_string($this->parseUri($vf0183130c6c478a364b95e4325786eb9));$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT `target`, `status` FROM `cms3_redirects`
	WHERE `source` = '{$vf0183130c6c478a364b95e4325786eb9}'
	ORDER BY `id` DESC LIMIT 1
SQL;   $result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(mysql_num_rows($result)) {list($v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258) = mysql_fetch_row($result);if (strpos($v42aefbae01d2dfd981f7da7d823d689e, 'http') !== 0) {$v42aefbae01d2dfd981f7da7d823d689e = '/' . $v42aefbae01d2dfd981f7da7d823d689e;}return $this->redirect($v42aefbae01d2dfd981f7da7d823d689e, (int) $v9acb44549b41563697bb490144ec6258);}$v8401668c4e8a4292331d5d46ddd1f649 = explode("/", trim($vf0183130c6c478a364b95e4325786eb9, "/"));do {array_pop($v8401668c4e8a4292331d5d46ddd1f649);$vf93632f2f958d47116bf0ad6ae7e6509 = implode("/", $v8401668c4e8a4292331d5d46ddd1f649) . "/";$v059db73d368bc8964f075448480bb487 = l_mysql_real_escape_string($this->parseUri($vf93632f2f958d47116bf0ad6ae7e6509));if(!strlen($v059db73d368bc8964f075448480bb487)) {if(count($v8401668c4e8a4292331d5d46ddd1f649)) continue;else break;}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT `source`, `target`, `status` FROM `cms3_redirects`
	WHERE `source` = '{$v059db73d368bc8964f075448480bb487}'
	ORDER BY `id` DESC LIMIT 1
SQL;    $result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(mysql_num_rows($result)) {list($v36cd38f49b9afa08222c0dc9ebfe35eb, $v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258) = mysql_fetch_row($result);$v4cb75ae8da8b4b486d9a2eb6220d78f2 = substr($vf0183130c6c478a364b95e4325786eb9, strlen($v36cd38f49b9afa08222c0dc9ebfe35eb));$v42aefbae01d2dfd981f7da7d823d689e .= $v4cb75ae8da8b4b486d9a2eb6220d78f2;if (strpos($v42aefbae01d2dfd981f7da7d823d689e, 'http') !== 0) {$v42aefbae01d2dfd981f7da7d823d689e = '/' . $v42aefbae01d2dfd981f7da7d823d689e;}$this->redirect($v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258);}}while (sizeof($v8401668c4e8a4292331d5d46ddd1f649) > 1);}public function init() {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if($v2245023265ae4cf87d02c8b6ba991139->get('seo', 'watch-redirects-history')) {$vd0b62cf0cd270bb58374f321620931ff = new umiEventListener("systemModifyElement", "content", "onModifyPageWatchRedirects");$vd0b62cf0cd270bb58374f321620931ff = new umiEventListener("systemMoveElement", "content", "onModifyPageWatchRedirects");}}protected function redirect($v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258) {$vcccb484e3a7978e609c6d8725c8c8c09 = array(    300 => 'Multiple Choices',    'Moved Permanently', 'Found', 'See Other',    'Not Modified', 'Use Proxy', 'Switch Proxy', 'Temporary Redirect'   );if(!isset($vcccb484e3a7978e609c6d8725c8c8c09[$v9acb44549b41563697bb490144ec6258])) return false;$va153823cb904cdc2433606062b6aea0f = $vcccb484e3a7978e609c6d8725c8c8c09[$v9acb44549b41563697bb490144ec6258];$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();if($vc66c00ae9f18fc0c67d8973bd07dc4cd = getServer('HTTP_REFERER')) {$v7f2db423a49b305459147332fb01cf87->header('Referrer', $vc66c00ae9f18fc0c67d8973bd07dc4cd);}$v7f2db423a49b305459147332fb01cf87->status($v9acb44549b41563697bb490144ec6258 . ' ' . $va153823cb904cdc2433606062b6aea0f);$v7f2db423a49b305459147332fb01cf87->redirect($v42aefbae01d2dfd981f7da7d823d689e);$v7f2db423a49b305459147332fb01cf87->end();}protected function parseUri($v9305b73d359bd06734fee0b3638079e1) {return trim($v9305b73d359bd06734fee0b3638079e1, '/');}};interface iUmiBaseStream {public function stream_open($vd6fe1d0be6347b8ef2427fa629c04485, $v15d61712450a686a7f365adf4fef581f, $v93da65a9fd0004d9477aeac024e08e15, $v6385a5865e0b96f09e4142ab2d9e3736);public function stream_read($ve2942a04780e223b215eb8b663cf5353);public function stream_write($v8d777f385d3dfec8815d20f7496026dc);public function stream_tell();public function stream_eof();public function stream_seek($v7a86c157ee9713c34fbd7a1ee40f0c5a, $v02c86cc535151887678873a6d0a3c347);public function stream_flush();public function stream_close();public function url_stat();public function getProtocol();public static function getCalledStreams();};abstract class umiBaseStream implements iUmiBaseStream {public static $allowTimeMark = true;public static $allowExtendedOptions = true;protected    $position = 0,    $length = 0,    $data = "",    $expire = 0,    $transform = "",    $path, $params = array(),    $isJson = false;protected $scheme;protected static $callLog = array();private  $start_time = false;public function __construct() {$this->start_time = microtime(true);}public function stream_flush() {return true;}public function stream_tell() {return $this->position;}public function stream_eof() {return $this->position >= $this->length;}public function stream_seek($v7a86c157ee9713c34fbd7a1ee40f0c5a, $v02c86cc535151887678873a6d0a3c347) {switch($v02c86cc535151887678873a6d0a3c347) {case SEEK_SET: {if($this->isValidOffset($v7a86c157ee9713c34fbd7a1ee40f0c5a)) {$this->position = $v7a86c157ee9713c34fbd7a1ee40f0c5a;return true;}else {return false;}}case SEEK_CUR: {if($v7a86c157ee9713c34fbd7a1ee40f0c5a >= 0) {$this->position += $v7a86c157ee9713c34fbd7a1ee40f0c5a;return true;}else {return false;}}case SEEK_END: {if($this->isValidOffset($this->position + $v7a86c157ee9713c34fbd7a1ee40f0c5a)) {$this->position = $this->length + $v7a86c157ee9713c34fbd7a1ee40f0c5a;return true;}else {return false;}}default: {return false;}}}public function url_stat() {return Array();}public function stream_stat() {return Array();}public function stream_close() {return true;}public function stream_read($ve2942a04780e223b215eb8b663cf5353) {$result = bytes_substr($this->data, $this->position, $ve2942a04780e223b215eb8b663cf5353);$this->position += $ve2942a04780e223b215eb8b663cf5353;return $result;}public function stream_write($ve62e4d22f2d8630f6e44e2b7c3f70ddc) {$vfa2a5780ee71a3c906f941f11804346a = bytes_strlen($ve62e4d22f2d8630f6e44e2b7c3f70ddc);$v5db949cee806af8b6998a0b53bc78489 = bytes_substr($this->data, 0, $this->position);$ve2ad64473fdb1836ebaa0dc70299e9a8 = bytes_substr($this->data, $this->position + $vfa2a5780ee71a3c906f941f11804346a);$this->data = $v5db949cee806af8b6998a0b53bc78489 . $ve62e4d22f2d8630f6e44e2b7c3f70ddc . $ve2ad64473fdb1836ebaa0dc70299e9a8;$this->position += $ve62e4d22f2d8630f6e44e2b7c3f70ddc;return $vfa2a5780ee71a3c906f941f11804346a;}public function getProtocol() {return $this->scheme . "://";}static public function registerStream($v41323917ef8089432959a3c33269debf) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$v6a2a431fe8b621037ea949531c28551d = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.kernel.streams') . "{$v41323917ef8089432959a3c33269debf}/{$v41323917ef8089432959a3c33269debf}Stream.php";if(file_exists($v6a2a431fe8b621037ea949531c28551d)) {require $v6a2a431fe8b621037ea949531c28551d;if(!stream_wrapper_register($v41323917ef8089432959a3c33269debf, "{$v41323917ef8089432959a3c33269debf}Stream")) {throw new coreException("Failed to register stream \"{$v41323917ef8089432959a3c33269debf}\"");}}else {throw new coreException("Can't locate file \"{$v6a2a431fe8b621037ea949531c28551d}\"");}}public static function protectParams($veca07335a33c5aeb5e1bc7c98b4b9d80) {return str_replace("/", "&#2F;", $veca07335a33c5aeb5e1bc7c98b4b9d80);}public static function unprotectParams($veca07335a33c5aeb5e1bc7c98b4b9d80) {return str_replace("&#2F;", "/", $veca07335a33c5aeb5e1bc7c98b4b9d80);}public static function getCalledStreams() {$v058ea00715de566bfe7b13f8e17aaf15 = Array();$v843b9f46c0bf720976d53057a3b40877 = 0;foreach(self::$callLog as $v3cde413efdb2e8ce17b094592df0334e) {list($v572d4e421e5e6b9bc11d815e8a027112, $v07cc694b9b3fc636710fa08b6922c42b) = $v3cde413efdb2e8ce17b094592df0334e;$v843b9f46c0bf720976d53057a3b40877 += $v07cc694b9b3fc636710fa08b6922c42b;$v058ea00715de566bfe7b13f8e17aaf15[] = array(     'attribute:generation-time' => $v07cc694b9b3fc636710fa08b6922c42b,     'node:url'     => $v572d4e421e5e6b9bc11d815e8a027112    );}$vfca1bff8ad8b3a8585abfb0ad523ba42 = array('nodes:call' => $v058ea00715de566bfe7b13f8e17aaf15);$vdd988cfd769c9f7fbd795a0f5da8e751 = new DOMDocument('1.0', 'utf-8');$vdd988cfd769c9f7fbd795a0f5da8e751->formatOutput = XML_FORMAT_OUTPUT;$v173a1756d2d82394cb803161f70f9a38 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement("streams-call");$v173a1756d2d82394cb803161f70f9a38->setAttribute('total-time', $v843b9f46c0bf720976d53057a3b40877);$vdd988cfd769c9f7fbd795a0f5da8e751->appendChild($v173a1756d2d82394cb803161f70f9a38);$vea392050444b5a06a86b8ec9c02d2437 = new xmlTranslator($vdd988cfd769c9f7fbd795a0f5da8e751);$vea392050444b5a06a86b8ec9c02d2437->translateToXml($v173a1756d2d82394cb803161f70f9a38, $vfca1bff8ad8b3a8585abfb0ad523ba42);return $vdd988cfd769c9f7fbd795a0f5da8e751->saveXml();}public static function reportCallTime($vd6fe1d0be6347b8ef2427fa629c04485, $v07cc694b9b3fc636710fa08b6922c42b) {foreach(self::$callLog as &$v3cde413efdb2e8ce17b094592df0334e) {$v63aaa382d493096040036f07fdbd9d22 = explode("?", $v3cde413efdb2e8ce17b094592df0334e[0]);if($v63aaa382d493096040036f07fdbd9d22[0] == $vd6fe1d0be6347b8ef2427fa629c04485) {$v3cde413efdb2e8ce17b094592df0334e[1] = $v07cc694b9b3fc636710fa08b6922c42b;}}}protected function isValidOffset($v7a86c157ee9713c34fbd7a1ee40f0c5a) {return ($v7a86c157ee9713c34fbd7a1ee40f0c5a >= 0) && ($v7a86c157ee9713c34fbd7a1ee40f0c5a < $this->length);}protected function translateToXml() {$args = func_get_args();$v9b207167e5381c47682c6b4f58a623fb = $args[0];if($this->isJson) {return $this->translateToJSON($v9b207167e5381c47682c6b4f58a623fb);}if(isset($v9b207167e5381c47682c6b4f58a623fb['plain:result'])) {return $v9b207167e5381c47682c6b4f58a623fb['plain:result'];}$vdd988cfd769c9f7fbd795a0f5da8e751 = new DOMDocument("1.0", "utf-8");$vdd988cfd769c9f7fbd795a0f5da8e751->formatOutput = XML_FORMAT_OUTPUT;$v173a1756d2d82394cb803161f70f9a38 = $vdd988cfd769c9f7fbd795a0f5da8e751->createElement("udata");$vdd988cfd769c9f7fbd795a0f5da8e751->appendChild($v173a1756d2d82394cb803161f70f9a38);$v173a1756d2d82394cb803161f70f9a38->setAttribute('xmlns:xlink', 'http://www.w3.org/TR/xlink');$va9af713c2b2cfe00ff6c77a6a07127ed = new xmlTranslator($vdd988cfd769c9f7fbd795a0f5da8e751);$va9af713c2b2cfe00ff6c77a6a07127ed->translateToXml($v173a1756d2d82394cb803161f70f9a38, $v9b207167e5381c47682c6b4f58a623fb);$vf9d06f6bf4fdf64ee0d73708c1a94ee1 = number_format(microtime(true) - $this->start_time, 6);$v173a1756d2d82394cb803161f70f9a38->setAttribute('generation-time', $vf9d06f6bf4fdf64ee0d73708c1a94ee1);self::reportCallTime($this->getProtocol() . $this->path, $vf9d06f6bf4fdf64ee0d73708c1a94ee1);if($this->transform) {return $this->applyXslTransformation($vdd988cfd769c9f7fbd795a0f5da8e751, $this->transform);}return $vdd988cfd769c9f7fbd795a0f5da8e751->saveXml();}protected function applyXslTransformation(DOMDocument $vdd988cfd769c9f7fbd795a0f5da8e751, $v6a559eac8ab38b0b76a6fca32dcb9749) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if ($v6829cdfdefd69b947abedd8fa2c4bcc7 = cmsController::getInstance()->getResourcesDirectory()) {$vf2ce473b36fb79a44028293890c685be = $v6829cdfdefd69b947abedd8fa2c4bcc7 . "/xslt/";}else {$vf2ce473b36fb79a44028293890c685be = $v2245023265ae4cf87d02c8b6ba991139->includeParam('templates.xsl');}$v47826cacc65c665212b821e6ff80b9b0 = $vf2ce473b36fb79a44028293890c685be . $v6a559eac8ab38b0b76a6fca32dcb9749;if(is_file($v47826cacc65c665212b821e6ff80b9b0) == false) {throw new publicException("Udata trasform xsl-template was not found \"{$v47826cacc65c665212b821e6ff80b9b0}\"");}$vc3aaa7dd2c4cf0305f95e82438b46e82 = DomDocument::load($v47826cacc65c665212b821e6ff80b9b0, DOM_LOAD_OPTIONS);if ( $vc3aaa7dd2c4cf0305f95e82438b46e82 === false && !defined("DEBUG") && function_exists("libxml_get_last_error") ) {throw new libXMLErrorException(libxml_get_last_error());}$v801f7201346b43f8ee8390a1ef20ddcd = new xsltProcessor;$v801f7201346b43f8ee8390a1ef20ddcd->registerPHPFunctions();$v801f7201346b43f8ee8390a1ef20ddcd->importStyleSheet($vc3aaa7dd2c4cf0305f95e82438b46e82);return $v801f7201346b43f8ee8390a1ef20ddcd->transformToXML($vdd988cfd769c9f7fbd795a0f5da8e751);}protected function parsePath($vd6fe1d0be6347b8ef2427fa629c04485) {$v81788ba0d7d02d81c063dbca621ba11b = $this->getProtocol();$vd6fe1d0be6347b8ef2427fa629c04485 = substr($vd6fe1d0be6347b8ef2427fa629c04485, strlen($v81788ba0d7d02d81c063dbca621ba11b));$v6d530125c7b0bc91b8b49c9d98795759 = parse_url($vd6fe1d0be6347b8ef2427fa629c04485);$v6d92ba33a14649f2a6f698b128302ad7 = $v6d530125c7b0bc91b8b49c9d98795759['path'];if(substr($v6d92ba33a14649f2a6f698b128302ad7, -5) == '.json') {$v6d92ba33a14649f2a6f698b128302ad7 = substr($v6d92ba33a14649f2a6f698b128302ad7, 0, strlen($v6d92ba33a14649f2a6f698b128302ad7) - 5);$this->isJson = true;}else $this->isJson = false;$this->path = $v6d92ba33a14649f2a6f698b128302ad7;self::$callLog[] = array($v81788ba0d7d02d81c063dbca621ba11b . $vd6fe1d0be6347b8ef2427fa629c04485, false);if($v21ffce5b8a6cc8cc6a41448dd69623c9 = getArrayKey($v6d530125c7b0bc91b8b49c9d98795759, 'query')) {parse_str($v21ffce5b8a6cc8cc6a41448dd69623c9, $vd5330079a488b3cac29a84f13a458629);$this->params = $vd5330079a488b3cac29a84f13a458629;$_REQUEST = array_merge($_REQUEST, $vd5330079a488b3cac29a84f13a458629);if(isset($vd5330079a488b3cac29a84f13a458629['expire'])) {$this->expire = getArrayKey($vd5330079a488b3cac29a84f13a458629, 'expire');}if(isset($vd5330079a488b3cac29a84f13a458629['transform'])) {$this->transform = getArrayKey($vd5330079a488b3cac29a84f13a458629, 'transform');}}if(!$this->expire) {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if ($v2245023265ae4cf87d02c8b6ba991139->get('cache', 'streams.cache-enabled')) {$vcd91e7679d575a2c548bd2c889c23b9e = (int) $v2245023265ae4cf87d02c8b6ba991139->get('cache', 'streams.cache-lifetime');if ($vcd91e7679d575a2c548bd2c889c23b9e > 0) {$this->expire = $vcd91e7679d575a2c548bd2c889c23b9e;}}}if (self::$allowExtendedOptions) {$vc24ba01bcba954c5250c44586665f9fa = array();if (isset($this->params['extGroups']) && !empty($this->params['extGroups'])) {$vc24ba01bcba954c5250c44586665f9fa = explode(',', $this->params['extGroups']);$vc24ba01bcba954c5250c44586665f9fa = array_unique(array_map('trim', $vc24ba01bcba954c5250c44586665f9fa));}$vf85c5ff1aa094b72bf2da8b62ba521c6 = array();if (isset($this->params['extProps']) && !empty($this->params['extProps'])) {$vf85c5ff1aa094b72bf2da8b62ba521c6 = explode(',', $this->params['extProps']);$vf85c5ff1aa094b72bf2da8b62ba521c6 = array_unique(array_map('trim', $vf85c5ff1aa094b72bf2da8b62ba521c6));}def_module::setMacrosExtendedResult($vf85c5ff1aa094b72bf2da8b62ba521c6, $vc24ba01bcba954c5250c44586665f9fa);}return $this->path;}protected function normalizeString($v341be97d9aff90c9978347f66f945b77) {$v341be97d9aff90c9978347f66f945b77 = urldecode($v341be97d9aff90c9978347f66f945b77);if(!preg_match("/[\x{0000}-\x{FFFF}]+/u", $v341be97d9aff90c9978347f66f945b77)) {$v341be97d9aff90c9978347f66f945b77 = iconv("CP1251", "UTF-8//IGNORE", $v341be97d9aff90c9978347f66f945b77);}return $v341be97d9aff90c9978347f66f945b77;}protected function setData($v8d777f385d3dfec8815d20f7496026dc) {if(!$v8d777f385d3dfec8815d20f7496026dc) {return false;}$this->data = $v8d777f385d3dfec8815d20f7496026dc;$this->length = bytes_strlen($v8d777f385d3dfec8815d20f7496026dc);return true;}protected function setDataError($v0279985cdca9ad2836b5dc949af215c8) {$v8d777f385d3dfec8815d20f7496026dc = Array(    'error' => Array(     'attribute:code' => $v0279985cdca9ad2836b5dc949af215c8,     'node:message' => getLabel('error-' . $v0279985cdca9ad2836b5dc949af215c8)    )   );$v8d777f385d3dfec8815d20f7496026dc = self::translateToXml($v8d777f385d3dfec8815d20f7496026dc);$this->setData($v8d777f385d3dfec8815d20f7496026dc);return true;}protected function translateToJSON($v8d777f385d3dfec8815d20f7496026dc) {$v607f2f3099f2a347b327caa70e0be4b2 = new jsonTranslator;return $v607f2f3099f2a347b327caa70e0be4b2->translateToJson($v8d777f385d3dfec8815d20f7496026dc);}};$i18n = Array( "header-data-config"   => "Настройки модуля", "header-data-guides"   => "Справочники", "header-data-guide_items"  => "Содержание справочника", "header-data-guide_item_edit" => "Редактирование элемента справочника", "header-data-guide_item_add" => "Добавление элемента справочника", "header-data-trash"    => "Корзина удаленных страниц", "header-data-types"    => "Типы данных", "header-data-type_edit"   => "Редактирование типа данных", "header-data-type_group_add" => "Добавление группы полей", "header-data-type_group_edit" => "Редактирование группы полей", "header-data-type_field_add" => "Добавление поля", "header-data-type_field_edit" => "Редактирование поля", "label-add-fields-group"  => "Добавить группу полей", 'label-delete-time'    => 'Время удаления', "label-edit-type-common"  => "Свойства типа", "label-empty-all"    => "Очистить корзину", 'label-field-anons'    => 'Анонс', 'label-field-content'   => 'Контент', "label-field-default-guide"  => "Использовать справочник", "label-field-in-filter"   => "Использовать в фильтрах", "label-field-in-search"   => "Индексировать", "label-field-is-required"  => "Обязательное", "label-field-is-visible"  => "Видимое", "label-field-name"    => "Идентификатор", 'label-field-restriction-id' => 'Проверка значений', "label-field-tip"    => "Подсказка", "label-field-title"    => "Название поля", "label-field-type"    => "Тип поля", "label-group-is-visible"  => "Видимое", "label-group-name"    => "Идентификатор", "label-group-title"    => "Название группы", "label-guide-add"    => "Добавить справочник", "label-guide-item-add"   => "Добавить наименование справочника", "label-hierarchy-type"   => "Назначение типа", "label-is-guide"    => "Можно использовать как справочник", "label-is-public"    => "Общедоступный", "label-method"     => "Метод", "label-module"     => "Модуль", 'label-section-description'  => 'Описание раздела', "label-type-add"    => "Добавить тип данных", "label-type-name"    => "Название типа", 'object-type-filemanagers'  => 'Файловые менеджеры', 'object-type-blogs-blog_message' => 'Cообщение блога', 'object-type-rss-lenta'   => 'RSS-лента', 'object-type-users-author'  => 'Автор', 'object-type-eshop-address'  => 'Адрес доставки', 'object-type-banners-banner'  => 'Баннер', 'object-type-banners-banner-image'  => 'Баннер с картинкой', 'object-type-banners-banner-swf'  => 'Баннер с флешкой', 'object-type-banners-banner-html'  => 'Баннер с HTML', 'object-type-blogs-blog'  => 'Блог', 'object-type-valyuta'   => 'Валюта', 'object-type-vote-poll_item'  => 'Вариант ответа на опрос', 'object-type-vid_homyachka'  => 'Вид хомячка', 'object-type-faq-question'  => 'Вопрос в FAQ', 'object-type-catalog-question'  => 'Вопрос в матрице подбора', 'object-type-dispatches-release' => 'Выпуск рассылки', 'object-type-users-users'  => 'Группы пользователей', 'object-type-eshop-discount_card' => 'Дисконтная карта', 'object-type-druzhelyubnost_homyachka' => 'Дружелюбность хомячка', 'object-type-eshop-order'  => 'Заказ в интернет-магазине', 'object-type-content-ticket'  => 'Заметка', 'object-type-integriruemost_homyachka_v_koleso'   => 'Интегрируемость хомячка в колесо', 'object-type-faq-category'  => 'Категория в FAQ', 'object-type-kachestvo_fleshki'  => 'Качество флешки', 'object-type-catalog-object'  => 'Объект каталога', 'object-type-catalog-object-good'  => 'Товар в магазине', 'object-type-catalog-object-good-hamster'  => 'Хомячок', 'object-type-catalog-object-good-kolesa'  => 'Колеса для хомячков', 'object-type-catalog-object-good-povodki'  => 'Поводки', 'object-type-comments-comment'  => 'Комментарий', 'object-type-blogs-blog_comment' => 'Комментарий к сообщению блога', 'object-type-forum-conf'  => 'Конференция форума', 'object-type-kulinarnye_predpochteniya_homyachka'   => 'Кулинарные предпочтения хомячка', 'object-type-news-rubric'  => 'Лента новостей', 'object-type-updatesrv-license'  => 'Лицензия UMI.CMS', 'object-type-catalog-matrix'  => 'Матрица подбора', 'object-type-banners-place'  => 'Места показов баннеров', 'object-type-eshop-order_item'  => 'Наименование в заказе', 'object-type-news-item'   => 'Новость', 'object-type-okras_homyachka'  => 'Окрас хомячка', 'object-type-catalog-answer'  => 'Ответ на вопрос в матрице подбора', 'object-type-eshop-payment_transaction' => 'Платежная транзакция', 'object-type-dispatches-subscriber' => 'Подписчик на рассылку', 'object-type-pol'   => 'Пол', 'object-type-pol_homyachka'  => 'Пол хомячка', 'object-type-users-user'  => 'Пользователь', 'object-type-faq-project'  => 'Проект в FAQ', 'object-type-proizvoditeli'  => 'Производители', 'object-type-catalog-category'  => 'Раздел каталога', 'object-type-razdel_sajta'  => 'Раздел сайта', 'object-type-dispatches-dispatch' => 'Рассылка', 'object-type-filemanager-shared_file' => 'Скачиваемый файл', 'object-type-eshop-discount'  => 'Скидка в интернет-магазине', 'object-type-eshop-store'  => 'Склад интернет-магазина', 'object-type-forum-message'  => 'Сообщение в форуме', 'object-type-dispatches-message' => 'Сообщение рассылки', 'object-type-webforms-address'  => 'Список адресов', 'object-type-spisok_gorodov_dlya_geo' => 'Список городов', 'object-type-spravochnik_dlya_polya_gorod' => 'Справочник для поля "Город"', 'object-type-spravochnik_dlya_polya_zhanr' => 'Справочник для поля "Жанр"', 'object-type-spravochnik_dlya_polya_nalichiya_na_skladah' => 'Справочник для поля "Наличия на складах"', 'object-type-spravochnik_dlya_polya_ukazatel_na_sklad'  => 'Справочник для поля "Указатель на склад"', 'object-type-spravochnik_dlya_polya_format_nositelya'  => 'Справочник для поля "Формат носителя"', 'object-type-spravochniki'  => 'Справочники', 'object-type-vote-poll'   => 'Стандартный опрос', 'object-type-eshop-order_status' => 'Статус заказа', 'object-type-eshop-payment_transaction_status' => 'Статус платежной транзакции', 'object-type-blogs-blog_privacy' => 'Степень приватности (блоги)', 'object-type-content-'   => 'Страница контента', 'object-type-strany'   => 'Страны', 'object-type-news-subject'  => 'Сюжет публикации', 'object-type-tip_rss'   => 'Тип RSS', 'object-type-updatesrv-license_type' => 'Тип лицензии UMI.CMS', 'object-type-tip_povodka'  => 'Тип поводка', 'object-type-tip_shersti_homyachka' => 'Тип шерсти хомячка', 'object-type-eshop-store_relation' => 'Товар на складе интернет-магазина', 'object-type-forum-topic'  => 'Топик в форуме', 'object-type-webforms-form'  => 'Форма обратной связи', 'object-type-photoalbum-album'  => 'Фотоальбом', 'object-type-photoalbum-photo'  => 'Фотография', 'object-type-harakter_homyachka' => 'Характер хомячка', 'object-type-cvet'   => 'Цвет', 'object-type-webforms-template'  => 'Шаблон письма', 'object-type-new-data-type'   =>  'Новый тип данных', 'object-type-new-guide'    =>  'Новый справочник',  'object-type-decoration' => 'Отделка', 'object-type-mahogany' => 'Красное дерево', 'object-type-ivory' => 'Слоновая кость', 'object-type-strass' => 'Стразы', 'object-type-velour' => 'Велюр', 'object-type-color-field-guide' => 'Справочник для поля "Цвет"', 'object-type-silver' => 'Серебристый', 'object-type-black' => 'Черный', 'object-type-red' => 'Красный', 'object-type-brown' => 'Коричневый', 'object-type-vinous' => 'Бордовый', 'object-type-blue' => 'Синий', 'object-type-completely_transparent' => 'Очень прозрачный', 'object-type-medium_transparent' => 'Не особо прозрачный', 'object-type-green' => 'Зеленый', 'object-type-grey' => 'Серый', 'object-type-transparent' => 'Прозрачный',  'object-type-sound-field-guide' => 'Справочник для поля "Звук"', 'object-type-mono' => 'Моно', 'object-type-stereo' => 'Стерео', 'object-type-surround' => 'Объемный',  'object-type-drives-field-guide' => 'Справочник для поля "Носители"', 'object-type-drives_dvd' => 'DVD', 'object-type-drives_vinyl' => 'Винил', 'object-type-drives_cd' => 'CD',  'object-type-diagonal-field-guide' => 'Справочник для поля "Диагональ"',  'object-type-screen-field-guide' => 'Справочник для поля "Экран"', 'object-type-screen_glossy' => 'Глянцевый', 'object-type-screen_mini' => 'Мини', 'object-type-screen_matte' => 'Матовый', 'object-type-screen_saturated' => 'Насыщенный', 'object-type-screen_big' => 'Большой',  'object-type-brightness-field-guide' => 'Справочник для поля "Яркость"', 'object-type-very_bright' => 'Очень ярко', 'object-type-not_very_bright' => 'Не очень ярко',  'object-type-wall_mounting-field-guide' => 'Справочник для поля "Настенное крепление"', 'object-type-wall_mounting_fixed' => 'Фиксированное',  'object-type-os-field-guide' => 'Справочник для поля "Операционная система"',  'object-type-template_theme-field-guide' => 'Справочник для поля "Тема шаблона"', 'object-type-winter' => 'Зима', 'object-type-technics' => 'Техника', 'object-type-summer' => 'Лето', 'object-type-autumn' => 'Осень',  'object-type-price-modifier-field-guide' => 'Справочник для поля "Модификатор цены"', 'object-type-price-validation-rules-guide' => 'Справочник для поля "Правила валидации"',  'object-type-without_design' => 'Без рисунка', 'object-type-basic_design' => 'Стандартный рисунок', 'object-type-personal_design' => 'Свой рисунок',  'object-type-audio_equipment' => 'Аудиотехника', 'object-type-dvd_equipment' => 'DVD техника', 'object-type-tv-sets' => 'Телевизоры', 'object-type-mobile-telephony' => 'Мобильная связь', 'object-type-dvd_disks' => 'DVD диски', 'object-type-contact_info' => 'Контактные данные', 'field-best-offers' => 'Лучшие предложения', 'field-similar-items' => 'Похожие товары', 'field-width' => 'Ширина, мм', 'field-height' => 'Высота, мм', 'field-depth' => 'Глубина, мм', 'field-sound' => 'Звук', 'field-decoration' => 'Отделка', 'fields-group-item-properties' => 'Характеристики', 'fields-group-management-options' => 'Опции управления', 'field-tip-number-reserved-items' => 'Количество зарезервированных товаров',  'field-drives' => 'Носители', 'field-tv-connections-count' => 'Количество подключений к ТВ', 'field-record-option' => 'Возможность записи', 'field-diameter' => 'Диаметр, см', 'field-disk-area' => 'Площадь круга', 'field-diagonal' => 'Диагональ', 'field-screen' => 'Экран', 'field-brightness' => 'Яркость', 'field-child-proof' => 'Защита от детей', 'field-wall-mounting' => 'Настенное крепление', 'field-os' => 'Операционная система', 'field-battery-life' => 'Время работы от АКБ, час', 'fields-group-service-properties' => 'Служебные свойства',  'fields-group-store-info' => 'Информация о магазине', 'field-payment-info' => 'Информация об оплате', 'field-site-logo' => 'Логотип сайта', 'field-template-theme' => 'Тема шаблона', 'field-orders-hours' => 'Доступное время заказа', 'field-orders-reseption-info' => 'Полезная информация по приему заказов', 'field-info-page' => 'Информационная страница', 'field-store-phone' => 'Номер телефона', 'object-type-commerce_ml_data_format' => 'Данные в формате Commerce ML 2.0', 'field-tin' => 'ИНН', 'field-account-number' => 'Номер счета', 'object-type-test-delivery' => 'Тестовая доставка', 'field-legal-body' => 'Юридическое лицо',  'object-filemanager-elfinder' => 'Файловый менеджер elFinder', 'object-filemanager-flash'  => 'Классический файловый менеджер', 'object-samka'    => 'Самка', 'object-samec'    => 'Самец', 'object-v_korzine'   => 'В корзине', 'object-ozhidaet_proverki'  => 'Ожидает проверки', 'object-prinyat'   => 'Принят', 'object-otklonen'   => 'Отклонен', 'object-otmenen'   => 'Отменен', 'object-oplachivaetsya'  => 'Оплачивается', 'object-dostavlyaetsya'  => 'Доставляется', 'object-gotov'    => 'Готов', 'object-ojidaet_otgruzki' => 'Ожидает отгрузки', 'object-ojidaet_dostavki' => 'Доставляется', 'object-dostavlen'   => 'Доставлен', 'object-inicialisirovana' => 'Инициализирована', 'object-podtverjdena'  => 'Подтверждена', 'object-otklonena'   => 'Отклонена', 'object-prinyata'   => 'Принята', 'object-v_processe_oplaty'  => 'В процессе оплаты', 'object-oplachen_uspeshno'  => 'Оплачен успешно', 'object-oshibki_v_oplate'  => 'Ошибки в оплате', 'object-proveren_mozhno_oplachivat' => 'Проверен, можно оплачивать', 'object-proverka_oplaty'  => 'Проверка оплаты', 'object-1_inicializirovana'  => '1. Инициализирована', 'object-2_dostavlena'   => '2. Доставлена', 'object-3_ne_dostavlena'  => '3. Не доставлена', 'object-4_predvaritel_no_prinyata_ozhidaetsya_podtverzhdenie'   => '4. Предварительно принята (ожидается подтверждение)', 'object-5_predvaritel_no_prinyata_podtverzhdenie_ne_trebuetsya'   => '5. Предварительно принята (подтверждение не требуется)', 'object-6_predvaritel_no_otklonena_ozhidaetsya_podtverzhdenie'   => '6. Предварительно отклонена (ожидается подтверждение)', 'object-7_predvaritel_no_otklonena_podtverzhdenie_ne_trebuetsya'  => '7. Предварительно отклонена (подтверждение не требуется)', 'object-8_prinyata_s_podtverzhdeniem' => '8. Принята с подтверждением', 'object-9_otklonena_s_podtverzhdeniem' => '9. Отклонена с подтверждением', 'object-moya_zhzh-lenta'  => 'Моя ЖЖ-лента', 'object-rss'    => 'RSS', 'object-atom'    => 'ATOM', 'object-dlya_vseh'   => 'Для всех', 'object-dlya_vladel_ca_i_druzej' => 'Для владельца и друзей', 'object-tol_ko_dlya_vladel_ca_bloga' => 'Только для владельца блога', 'object-male'   => 'Мужской', 'object-female' => 'Женский', 'object-height'    => 'Высокое', 'object-low'    => 'Низкое', 'object-medium'    => 'Среднее',  'object-guest' => 'Гость', 'object-usa' => 'США', 'object-russia' => 'Россия', 'object-catalog_item_discount' => 'На товары каталога', 'object-order_discount' => 'На заказ', 'object-test_percent_modifier' => 'Тестовый процентный модификатор', 'object-summ_percent' => 'Процент от суммы', 'object-main_store' => 'Основной склад', 'object-specify_items' => 'На определенные товары', 'object-digital' => 'Цифровой', 'object-complex' => 'Составной', 'object-rur' => 'Российский рубль', 'object-usd' => 'Американский доллар', 'object-euro' => 'Евро', 'object-pickup' => 'Самовывоз', 'object-courier_delivery' => 'Курьерская доставка', 'object-sales_draft' => 'Платежная квитанция', 'object-yandex_money' => 'Яндекс.Деньги', 'object-acquiropay' => 'AcquiroPay', 'object-paymenttype-yandex30' => 'Яндекс.Деньги 3.0', 'object-paymenttype-paypal' => 'PayPal', 'object-utf_8' => 'utf-8', 'object-windows_1251' => 'windows-1251', 'object-ios' => 'ios', 'object-android' => 'android', 'object-catalog_export' => 'Перенос каталога в 1С (CommerceML)', 'object-money_online' => 'Деньги Online', 'object-payanyway' => 'PayAnyWay', 'object-umi_export_umiDump' => 'Перенос UMI.CMS (umiDump 2.0)', 'object-csv_dataformat' => 'Данные в формате CSV', 'object-legal_bodies_account' => 'Счет для юридических лиц', 'object-monday' => 'Понедельник', 'object-tuesday' => 'Вторник', 'object-wednesday' => 'Среда', 'object-thursday' => 'Четверг', 'object-friday' => 'Пятница', 'object-saturday' => 'Суббота', 'object-sunday' => 'Воскресенье', 'object-rbk_money' => 'RBK Money', 'object-robokassa' => 'Robokassa', 'object-russian_post' => 'Почта России', 'object-accelerated' => 'Ускоренный', 'object-composite' => 'Комбинированный', 'object-air' => 'Авиа', 'object-surface' => 'Наземный', 'object-value_parcel' => 'Ценная посылка', 'object-value_wrapper_1_cl' => 'Ценная бандероль 1 кл.', 'object-value_wrapper' => 'Ценная бандероль', 'object-registered_wrapper_1_cl' => 'Заказная бандероль 1 кл.', 'object-registered_wrapper' => 'Заказная бандероль', 'object-ems_declared_value' => 'EMS с объявленной ценностью', 'object-ems_standart' => 'EMS обыкновенный', 'object-umiDump_data_format' => 'Данные в формате umiDump 2.0', 'object-yml_catalog' => 'Каталог в формате Яндекс-маркет (yml)', 'object-commerceml_order_list' => 'Список заказов в формате CommerceML 2.0', 'object-commerceml_offer_list' => 'Список предложений в формате CommerceML 2.0', 'object-commerceml_catalog' => 'Каталог товаров в формате СommerceML 2.0', 'object-commerceml_data_format' => 'Данные в формате CommerceML 2.0', 'object-to_courier' => 'Курьеру при получении', 'object-payonline_system' => 'PayOnline System', 'object-fixed_modifier' => 'Фиксированный размер', 'object-users' => 'users', 'object-related_items_discount' => 'На связанные товары', 'object-users_discount' => 'На пользователей', 'object-user_group_discount' => 'На группу пользователей', 'object-user_summ_discount' => 'На сумму покупок пользователя', 'object-order_summ_discount' => 'На сумму заказа', 'object-time_interval_discount' => 'На временной промежуток', 'object-social_categories_other' => 'Другое', 'object-social_categories_electronics' => 'Электроника', 'object-social_categories_mobile_phones' => 'Мобильные телефоны', 'object-social_categories_cameras' => 'Фото- и видеокамеры', 'object-social_categories_computers' => 'Компьютеры', 'object-social_categories_books' => 'Книги', 'object-social_categories_furniture' => 'Мебель', 'object-social_categories_clothes_shoes' => 'Одежда и обувь', 'object-social_categories_sports_equipment' => 'Спортивный инвентарь', 'object-social_categories_instruments' => 'Музыкальные инструменты', 'object-social_categories_flowers' => 'Цветы', 'object-social_categories_cosmetics' => 'Косметика', 'object-social_categories_souvenirs_toys' => 'Игрушки и сувениры', 'object-social_categories_food' => 'Продукты питания', 'object-social_categories_audio' => 'Аудио', 'object-social_categories_video' => 'Видео', 'object-social_categories_software_games' => 'Программы и игры', 'object-social_categories_office_goods' => 'Канцелярские товары', 'object-social_categories_sewing_goods' => 'Швейные принадлежности', 'object-social_categories_baby_goods' => 'Товары для детей', 'object-social_categories_optics_goods' => 'Оптика', 'object-social_categories_perfumery' => 'Парфюмерия', 'object-social_categories_bags_accessories'  => 'Сумки и аксессуары', 'object-social_categories_household_goods' => 'Посуда и товары для дома', 'object-lyxsus' => 'lyxsus', 'object-status-preunpublish' => 'Готовится к снятию с публикации', 'object-status-publish'  => 'Опубликован', 'object-status-unpublish' => 'Снят с публикации', 'object-type-users-avatar'   => 'Аватара', 'object-type-blogs20-blog'   => 'Блог', 'object-type-eshop-currency'   => 'Валюта в интернет магазине', 'object-type-blogs20-comment'   => 'Комментарий блога', 'object-type-blogs20-post'   => 'Пост блога', 'object-type-status_stranicy'   => 'Статус страницы', 'object-type-webforms-page'   => 'Страница с формой обратной связи', 'object-supervajzery'   => 'Супервайзеры', 'object-zaregistrirovannye_pol_zovateli'   => 'Зарегистрированные пользователи', 'object-currency-australia-dollars' => 'Австралийский доллар', 'object-currency-uk-pound' => 'Фунт стерлингов Соединенного королевства', 'object-currency-belarus-rubles' => 'Белорусский рубль', 'object-currency-us-dollar' => 'Доллар США', 'object-currency-euro' => 'Евро', 'object-currency-tenge' => 'Казахский тенге', 'object-currency-can-dollar' => 'Канадский доллар', 'object-currency-ukr-grivna' => 'Украинская гривна', 'object-currency-rus-rubles' => 'Российский рубль', 'object-type-mobile-platform' => 'Платформа мобильного устройства', 'object-type-mobile-devices' => 'Зарегистрированные мобильные устройства', 'object-type-news-rss-source-charset' => 'Кодировка источника RSS', 'object-type-emarket-payment-acquiropay' => 'AcquiroPay', 'object-type-emarket-payment-yandex30' => 'Яндекс.Деньги 3.0', 'object-type-emarket-payment-paypal' => 'PayPal', 'object-type-orderdeliverystatus' => 'Статус доставки', 'object-type-orderpaymentstatus' => 'Статус оплаты', 'object-type-store' => 'Склад', 'object-type-order' => 'Заказ', 'object-type-itemoption' => 'Опции товара', 'object-type-customer' => 'Незарегистрированный покупатель', 'object-type-discounttype' => 'Тип скидки', 'object-type-discount' => 'Скидка', 'object-type-discount_price_modifier' => 'Модификаторы цены скидок', 'object-type-order_summ_percent' => 'Процент от суммы заказа', 'object-type-discountmodificatortype' => 'Типы модификаторов скидок', 'object-type-discountruletype' => 'Типы правил для скидок', 'object-type-discountrules' => 'Правила скидок', 'object-type-special_items_discount' => 'На определенные товары', 'object-type-itemtype' => 'Тип товара', 'object-type-delivery' => 'Способ доставки', 'object-type-deliverytype' => 'Типы доставки', 'object-type-pickup' => 'Самовывоз', 'object-type-paymenttype' => 'Типы способов оплаты', 'object-type-payment' => 'Способ оплаты', 'object-type-export' => 'Экспорт данных', 'object-type-import' => 'Импорт данных', 'object-type-import_format' => 'Форматы импорта', 'object-type-export_format' => 'Форматы экспорта', 'object-type-courier' => 'Курьеру при получении', 'object-type-pay_online' => 'PayOnline System', 'object-type-dengionline' => 'Деньги Online', 'object-type-payanyway' => 'PayAnyWay', 'object-type-vkontakte' => 'Vkontakte', 'object-type-network' => 'Социальные сети', 'object-type-social_categories_vkontakte' => 'Категории товаров Вконтакте', 'object-type-ip_blacklist' => 'Список IP-адресов, которым недоступен сайт', 'object-type-blacklist' => 'Черный список слов', 'object-type-legalperson' => 'Юридическое лицо', 'object-type-legal_person_account' => 'Счет для юридических лиц', 'object-type-days' => 'Дни недели', 'object-type-hours' => 'Часы в сутках', 'object-type-rbk_money' => 'RBK Money', 'object-type-robokassa' => 'Robokassa', 'object-type-carriage_type' => 'Способ пересылки (почта России)', 'object-type-dispatch_type' => 'Вид отправления (почта России)', 'object-type-mail' => 'Почта России', 'object-type-fixed_discount' => 'Фиксированный размер скидки', 'object-type-related_items_discount' => 'На связанные товары', 'object-type-users_discount' => 'На пользователей', 'object-type-users_group_discount' => 'На группу пользователей', 'object-type-customer_summ' => 'На сумму покупок пользователя', 'object-type-order_summ' => 'На сумму заказа', 'object-type-time_interval' => 'На временной промежуток', 'object-type-validation_rule' => 'Справочник для поля \"Правила валидации\"', 'object-type-price_modifier' => 'Справочник для поля \"Модификатор цены\"', 'object-type-sales_draft' => 'Платежная квитанция', 'object-type-yandex_money' => 'Яндекс.Деньги', 'object-type-courier_deliver_spb' => 'Курьерская доставка по Санкт-Петербургу',    'hierarchy-type-content-page'  => 'Страницы контента', 'hierarchy-type-users-user'  => 'Пользователи', 'hierarchy-type-catalog-category' => 'Разделы каталога', 'hierarchy-type-catalog-object'  => 'Объекты каталога', 'hierarchy-type-users-users'  => 'Группы пользователей', 'hierarchy-type-news-rubric'  => 'Ленты новостей', 'hierarchy-type-news-item'  => 'Новости', 'hierarchy-type-news-subject'  => 'Сюжет публикации', 'hierarchy-type-vote-poll'  => 'Опрос', 'hierarchy-type-vote-poll_item'  => 'Ответ в опросе', 'hierarchy-type-eshop-order'  => 'Заказ в интернет-магазине', 'hierarchy-type-eshop-order_item' => 'Наименование заказа в интернет-магазине', 'hierarchy-type-eshop-order_status' => 'Статус заказа в интернет-магазине', 'hierarchy-type-eshop-address'  => 'Адрес доставки', 'hierarchy-type-forum-conf'  => 'Конференция форума', 'hierarchy-type-forum-topic'  => 'Топик в форуме', 'hierarchy-type-forum-message'  => 'Сообщение в форуме', 'hierarchy-type-comments-comment' => 'Комментарий', 'hierarchy-type-updatesrv-license' => 'Лицензия UMI.CMS', 'hierarchy-type-updatesrv-license_type' => 'Тип лицензии UMI.CMS', 'hierarchy-type-banners-banner'  => 'Баннер', 'hierarchy-type-banners-place'  => 'Место показа баннера', 'hierarchy-type-dispatches-dispatch' => 'Рассылка', 'hierarchy-type-dispatches-release' => 'Выпуск рассылки', 'hierarchy-type-dispatches-message' => 'Сообщение рассылки', 'hierarchy-type-dispatches-subscriber' => 'Подписчик на рассылку', 'hierarchy-type-catalog-matrix'  => 'Матрица подбора', 'hierarchy-type-catalog-question' => 'Вопрос в матрице подбора', 'hierarchy-type-catalog-answer'  => 'Ответ на вопрос в матрице подбора', 'hierarchy-type-users-author'  => 'Автор', 'hierarchy-type-content-ticket'  => 'Заметка на сайте', 'hierarchy-type-photoalbum-album' => 'Фотоальбом', 'hierarchy-type-photoalbum-photo' => 'Фотография', 'hierarchy-type-faq-project'  => 'Проекты в FAQ', 'hierarchy-type-faq-category'  => 'Категории в FAQ', 'hierarchy-type-faq-question'  => 'Вопросы в FAQ', 'hierarchy-type-filemanager-shared_file' => 'Скачиваемый файл', 'hierarchy-type-eshop-store'  => 'Склад в интернет-магазине', 'hierarchy-type-eshop-store_relation' => 'Товар на складе интернет-магазина', 'hierarchy-type-eshop-discount_card' => 'Дисконтная карта', 'hierarchy-type-eshop-discount'  => 'Скидка в интернет-магазине', 'hierarchy-type-blogs-blog'  => 'Блог', 'hierarchy-type-blogs-blog_privacy' => 'Степень приватности блога', 'hierarchy-type-blogs-blog_comment' => 'Комментарий к сообщению блога', 'hierarchy-type-blogs-blog_message' => 'Сообщение блога', 'hierarchy-type-eshop-payment_transaction' => 'Платежная транзакция', 'hierarchy-type-eshop-payment_transaction_status' => 'Статус платежной транзакции', 'hierarchy-type-webforms-form'  => 'Форма обратной связи', 'hierarchy-type-webforms-template' => 'Шаблон письма', 'hierarchy-type-webforms-address' => 'Список адресов', "hierarchy-type-eshop-global-discount" => "Глобальная скидка в интернет магазине", 'hierarchy-type-blogs20-blog' => 'Блог', 'hierarchy-type-blogs20-comment' => 'Комментарий блога', 'hierarchy-type-users-avatar'   => 'Аватар пользователя', 'hierarchy-type-blogs20-post'   => 'Пост блога', 'hierarchy-type-eshop-currency'   => 'Валюта в интернет магазине', 'hierarchy-type-webforms-page'   => 'Страница с формой обратной связи', 'hierarchy-type-emarket-order'   => 'Заказ в магазине', 'hierarchy-type-emarket-order_status' => 'Статус заказа', 'hierarchy-type-emarket-store'   => 'Склад', 'hierarchy-type-emarket-payment_status' => 'Статус оплаты', 'hierarchy-type-emarket-delivery_status' => 'Статус доставки', 'hierarchy-type-emarket-order_item'  => 'Наименование в заказе', 'hierarchy-type-emarket-item_option' => 'Опция товара', 'hierarchy-type-emarket-unregistered_customer' => 'Незарегистрированный покупатель', 'hierarchy-type-emarket-discount'  => 'Скидка', 'hierarchy-type-emarket-discount_modificator' =>'Модификатор цены скидки', 'hierarchy-type-emarket-discount_rule' => 'Правило скидки',  'hierarchy-type-emarket-discount_type' => 'Тип скидки',   'hierarchy-type-emarket-discount_modificator_type' =>'Тип модификатора скидки', 'hierarchy-type-emarket-discount_rule_type' => 'Тип правила скидки', 'hierarchy-type-emarket-currency'  => 'Валюта', 'hierarchy-type-emarket-delivery'  => 'Способ доставки', 'hierarchy-type-emarket-delivery_type' => 'Тип доставки', 'hierarchy-type-emarket-payment' => 'Способ оплаты', 'hierarchy-type-emarket-item_type' => 'Тип товара', 'hierarchy-type-emarket-legal_person' => 'Юридическое лицо', 'hierarchy-type-exchange-data_exchange_export' => 'Обмен данными: Экспорт', 'hierarchy-type-exchange-data_exchange_import' => 'Обмен данными: Импорт', 'hierarchy-type-social_networks-networks' => 'Социальные сети', 'hierarchy-type-social_networks-vkontakte' => 'Вконтакте',  'field-rss-source-charset'   => 'Идентификатор кодировки', 'field-rss-source-charset-relation' => 'Кодировка источника', "field-project-id"  => "Идентификатор проекта", "field-secret-key"  => "Секретный ключ", "field-owner-id"  => "Идентификатор владельца", "field-filemanager"  => "Файловый менеджер", "field-filemanager-directory" => "Доступные директории (для файлового менеджера elFinder)", "field-appended-file-extensions" => "Дополнительные разрешенные типы файлов", "field-prefix"   => "Префикс", "field-is_active"  => "Активность", "field-name"   => "Название", 'field-min_discount_order_total' => 'Минимальный размер заказа', 'field-max_discount_order_total' => 'Максимальный размер заказа', 'field-preffered_currency'   => 'Предпочитаемая валюта', 'field-age'    => 'Возраст', 'field-gender'    => 'Пол', 'field-geo_targeting_is_active'  => 'Гео-таргетинг включен', 'field-avatar'    => 'Аватарка', 'field-url'    => 'Url страницы', 'field-rss_type'   => 'Тип', 'field-news_rubric'   => 'Раздел публикаций', 'field-anons_pic'   => 'Картинка для анонса', 'field-publish_pic'   => 'Картинка для публикации', 'field-customer_comments'  => 'Пометки покупателя', 'field-default_type_id'   => 'default_type_id', 'field-seo_prefix'   => 'seo_prefix', 'field-trans'    => 'Транзитный Id', 'field-proizvoditel'   => 'Производитель', 'field-predyduwaya_cena'  => 'Предыдущая цена', 'field-specialnaya_cena'  => 'Специальная цена', 'field-fiksirovannaya_cena'  => 'Фиксированная цена', 'field-opisanie'   => 'Описание товара', 'field-soputstvuyuwie_tovary'  => 'Сопутствующие товары', 'field-polosa_tehnologij'  => 'Полоса технологий', 'field-izobrazhenie'   => 'Изображение', 'field-bolshoe_izobrazhenie'  => 'Большое изображение', 'field-id_name'    => 'ID статуса', 'field-tip_igrovoj_pristavki'  => 'Тип игровой приставки', 'field-komplekt_postavki'  => 'Комплект поставки', 'field-tip_karty_pamyati'  => 'Тип карты памяти', 'field-razemy_tip'   => 'Разъемы (тип)', 'field-cvet_korpusa'   => 'Цвет корпуса', 'field-garantiya'   => 'Гарантия', 'field-tranzitnyj_id'   => 'Транзитный ID', 'field-special_naya_cena'  => 'Специальная цена', 'field-bol_shoe_izobrazhenie'  => 'Большое изображение', 'field-yes_or_no'   => 'Да или нет?', 'field-country'    => 'Страна', 'field-city'    => 'Город', 'field-post_index'   => 'Почтовый индекс', 'field-address'    => 'Адрес', 'field-phone'    => 'Номер телефона для контрольного звонка', 'field-codename'   => 'Идентификатор версии', 'field-ot_baldi'   => 'Какое-то поле', 'field-my_house'   => 'Фотка моего дома', 'field-site_link'   => 'Ссылка на сайт', 'field-company_logo'   => 'Логoтип фирмы', 'field-elements_links'   => 'Ссылки на элементы', 'field-kartinochka'   => 'Картиночка', 'field-objektiki'   => 'Объектики', 'field-currency_id'   => 'Код валюты', 'field-currency'   => 'Валюта', 'field-rate'    => 'Курс', 'field-model'    => 'Модель товара', 'field-isbn'    => 'ISBN', 'field-author'    => 'Автор', 'field-publisher'   => 'Издатель', 'field-year'    => 'Год', 'field-series'    => 'Серия', 'field-nazvanie'   => 'Название', 'field-media'    => 'Носитель', 'field-starring'   => 'Актеры', 'field-director'   => 'Режиссер', 'field-original_name'   => 'Оригинальное название', 'field-store'    => 'Количество на складе', 'field-quality_value'   => 'Значение', 'field-to_order'   => 'на заказ (при отсутствии на складе)', 'field-typePrefiks'   => 'префикс', 'field-place'    => 'Место показа', 'field-hall'    => 'Зал', 'field-date'    => 'Дата выпуска', 'field-premier'    => 'Премьера', 'field-for-kids'   => 'для детей', 'field-hall_plan'   => 'План зала', 'field-hall_part'   => 'Места', 'field-worldRegion'   => 'Часть света', 'field-region'    => 'Курорт или город', 'field-days'    => 'Количество дней', 'field-dataTour'   => 'Даты заездов', 'field-hotel_stars'   => 'Звезды', 'field-room'    => 'Тип комнаты', 'field-meal'    => 'Тип питания', 'field-included'   => 'Что включено в стоимость тура', 'field-transport'   => 'Транспорт', 'field-plus'    => 'Процент (+)', 'field-is_cbrf'    => 'Использовать CBRF', 'field-deliveryIncluded'  => 'Доставка', 'field-price_min'   => 'Минимальная цена', 'field-price_max'   => 'Максимальная цена', 'field-sales_notes'   => 'Особенности товара', 'field-color'    => 'Цвет', 'field-weight'    => 'Вес', 'field-power'    => 'мощность', 'field-description'   => 'Описание', 'field-'    => 'Продолжительность', 'field-descr'    => 'Описание', 'field-order_price'   => 'Сумма счета', 'field-elements'   => 'Разделы каталога', 'field-hex'    => 'Цветовой код', 'field-zhanr'    => 'Жанр', 'field-kratkoe_opisanie'  => 'Краткое описание', 'field-format_nositelya'  => 'Формат носителя', 'field-god_vypuska'   => 'Год выпуска', 'field-vozrastnoe_ogranichenie_na_prosmotr' => 'Возрастное ограничение на просмотр', 'field-vid'    => 'Вид', 'field-okras'    => 'Окрас', 'field-tip_shersti'   => 'Тип шерсти', 'field-ves'    => 'Вес', 'field-pol'    => 'Пол', 'field-kolichestvo_lap'   => 'Количество лап', 'field-dlina_usov'   => 'Длина усов', 'field-maksimalnaya_skorost'  => 'Максимальная скорость', 'field-obem_legkih'   => 'Объем легких', 'field-razmah_lap_v_bege'  => 'Размах лап в беге', 'field-harakter'   => 'Характер', 'field-druzhelyubnost'   => 'Дружелюбность', 'field-kulinarnye_predpochteniya' => 'Кулинарные предпочтения', 'field-integriruemost_v_koleso'  => 'Интегрируемость в колесо', 'field-photo'    => 'Фотография', 'field-diametr_kolesa'   => 'Диаметр колеса', 'field-type'    => 'Тип', 'field-s_shipami'   => 'С шипами', 'field-recommend'   => 'Рекомендуем', 'field-lock_cancel'   => 'Статус блокирует отмену заказа', 'field-lock_payment'   => 'Статус блокирует оплату заказа', 'field-destination_address'  => 'Адрес доставки', 'field-sender_ip'   => 'IP-адрес отправителя', 'field-from_email_template'  => 'Адрес от', 'field-from_template'   => 'Имя от', 'field-subject_template'  => 'Тема письма', 'field-master_template'   => 'Шаблон тела письма', 'field-autoreply_from_email_template' => 'Адрес отправителя', 'field-autoreply_from_template'  => 'Имя отправителя', 'field-autoreply_subject_template' => 'Тема', 'field-autoreply_template'  => 'Тело', 'field-form_id'    => 'Идентификатор формы', 'field-address_description'  => 'Описание', 'field-address_list'   => 'Адреса', 'field-fname'    => 'Имя', 'field-father_name'   => 'Отчество', 'field-lname'    => 'Фамилия', 'field-e-mail'    => 'E-mail', 'field-time_targeting_is_active' => 'Time-таргетинг включен', 'field-time_targeting_by_month_days' => 'По числам месяца', 'field-time_targeting_by_month'  => 'По месяцам', 'field-time_targeting_by_week_days' => 'По дням недели', 'field-time_targeting_by_hours'  => 'По времени суток', 'field-title'    => 'Поле TITLE', 'field-h1'    => 'Поле H1', 'field-meta_keywords'   => 'Поле meta KEYWORDS', 'field-meta_descriptions'  => 'Поле meta DESCRIPTIONS', 'field-content'    => 'Контент', 'field-menu_pic_ua'   => 'Изображение неактивного раздела', 'field-menu_pic_a'   => 'Изображение активного раздела', 'field-header_pic'   => 'Изображение для заголовка', 'field-robots_deny'   => 'Запретить индексацию поисковиками', 'field-social_categories_vkontakte'   => 'Категория ВКонтакте', 'field-show_submenu'   => 'Показывать подменю', 'field-is_expanded'   => 'Меню всегда развернуто', 'field-is_unindexed'   => "Исключить из поиска", 'field-login'    => 'Логин', 'field-password'   => 'Пароль', 'field-groups'    => 'Группы пользователей', 'field-readme'    => 'Описание', 'field-anons'    => 'Анонс', 'field-source'    => 'Источник', 'field-source_url'   => 'URL источника', 'field-publish_time'   => 'Дата публикации', 'field-begin_time'   => 'Дата начала активности', 'field-finish_time'   => 'Дата завершения активности', 'field-end_time'   => 'Дата завершения скидки', 'field-subjects'   => 'Входит в сюжеты', 'field-price_item'   => 'Цена за единицу товара', 'field-price_total'   => 'Цена итоговая', 'field-count'    => 'Количество ответов', 'field-discount_size'   => 'Размер скидки', 'field-catalog_relation'  => 'Ссылка на товар', 'field-items'    => 'Наименования', 'field-status'    => 'Состояние', 'field-order_time'   => 'Дата заказа', 'field-admin_comments'   => 'Пометки администратора', 'field-is_closed'   => 'Голосование закрыто', 'field-question'   => 'Вопрос', 'field-answers'    => 'Ответы', 'field-total_count'      => 'Всего проголосовало', 'field-cena'       => 'Цена', 'field-orders_refs'      => 'Заказы', 'field-delivery_address'    => 'Адрес доставки', 'field-delivery_addresses'    => 'Адреса доставки', 'field-message'       => 'Сообщение', 'field-activate_code'     => 'Код активации', 'field-is_activated'     => 'Активирован', 'field-domain_name'      => 'Домен', 'field-ip'        => 'ip', 'field-license_type'     => 'Тип лицензии', 'field-owner_lname'      => 'Фамилия', 'field-owner_fname'      => 'Имя', 'field-owner_mname'      => 'Отчество', 'field-owner_email'      => 'E-mail', 'field-keycode'       => 'Лицензионный ключ', 'field-gen_time'      => 'Дата создания', 'field-id'        => 'ID', 'field-views_count'      => 'Количество показов', 'field-clicks_count'     => 'Количество переходов', 'field-max_views'      => 'Максимальное количество показов', 'field-tags'       => 'Теги', 'field-is_active'      => 'Активен', 'field-view_pages'      => 'Страницы, на которых показывать баннер', 'field-not_view_pages'     => 'Страницы, на которых не показывать баннер', 'field-image'       => 'Изображение', 'field-open_in_new_window'    => 'Открывать в новом окне', 'field-width'       => 'Ширина', 'field-height'       => 'Высота', 'field-alt'        => 'Альтернативный текст', 'field-swf'        => 'Флеш-ролик', 'field-swf_quality'      => 'Качество ролика', 'field-html_content'     => 'HTML-содержание', 'field-show_till_date'     => 'Дата окончания показа', 'field-poll_rel'      => 'Указатель на опрос', 'field-is_show_rand_banner'    => 'Показ случайного баннера', 'field-show_start_date'     => 'Дата начала показа', 'field-disp_last_release'    => 'Дата последнего выпуска', 'field-disp_description'    => 'Описание', 'field-disp_reference'     => 'Ссылка на рассылку', 'field-header'       => 'Заголовок', 'field-body'       => 'Тело сообщения', 'field-attach_file'      => 'Прикрепленный файл', 'field-release_reference'    => 'Ссылка на выпуск', 'field-uid'        => 'Пользователь', 'field-subscriber_dispatches'   => 'Подписан на рассылки', 'field-subscribe_date'     => 'Дата подписки', 'field-related_items'     => 'Подходящие товары', 'field-question_txt'     => 'Текст вопроса', 'field-answers_rel'      => 'Список ответов', 'field-per_page'      => 'Количество выводимых результатов', 'field-goods'       => 'Товары', 'field-questions_rel'     => 'Список вопросов', 'field-is_registrated'     => 'Зарегистрирован', 'field-user_id'       => 'Владелец', 'field-nickname'      => 'Ник', 'field-email'       => 'E-mail', 'field-author_id'      => 'Автор', 'field-x'        => 'X', 'field-y'        => 'Y', 'field-create_time'      => 'Дата создания', 'field-answer'       => 'Ответ на вопрос', 'field-fs_file'       => 'Скачиваемый файл', 'field-downloads_counter'    => 'Количество загрузок', 'field-user_dock'      => 'Пользовательская панель',    'field-page_tags'      => 'Показывать на страницах с тэгами', 'field-user_tags'      => 'Показывать пользователям с тэгами', 'field-rate_voters'      => 'Количество проголосовавших', 'field-rate_sum'      => 'Сумма баллов', 'field-amount'       => 'Количество на складе', 'field-store_id'      => 'Указатель на склад', 'field-store_amounts'     => 'Наличия на складах', 'field-proc'       => 'Процент скидки', 'field-start_time'      => 'Дата начала действия скидки', 'field-code'       => 'Код', 'field-price'       => 'Цена', 'field-ignore_discounts'    => 'Игнорировать скидки', 'field-subscribed_pages'    => 'Подписки на изменения', 'field-is_online'      => 'Пользователь on-line', 'field-privacy'       => 'Приватность', 'field-sid'        => 'Идентификатор', 'field-prvlist_friends'     => 'Мои друзья', 'field-lmessage_time'     => 'Дата добавления последнего сообщения', 'field-lcomment_time'     => 'Дата добавления последнего комментария', 'field-privacy_forpostonly'    => 'Приватность действует только на комментирование (не на просмотр)', 'field-topics_count'     => 'Количество топиков', 'field-messages_count'     => 'Количество сообщений', 'field-last_post_time'     => 'Дата последнего добавления', 'field-last_request_time'    => 'Время последнего обращения', 'field-rated_pages'      => 'Рейтингованные страницы', 'field-sid_transaction'     => 'Строковый идентификатор', 'field-sid_eshoporder_status'   => 'Соотнесенный статус заказа', 'field-rel_transactionstatus'   => 'Статус транзакции', 'field-date_created'     => 'Дата создания', 'field-inited_whom'      => 'Инициализатор транзакции', 'field-rel_eshoporder'     => 'Оплачиваемый заказ', 'field-initprice'      => 'Сумма заказа', 'field-text_request'     => 'Подробности запроса', 'field-method_engine'     => 'Transaction engine', 'field-date_answered'     => 'Дата получения результата', 'field-text_answer'      => 'Подробности получения результата', 'field-date_validated'     => 'Дата проверки результата', 'field-text_validated'     => 'Подробности проверки результата', 'field-date_conseq'      => 'Дата проверки', 'field-text_conseq'      => 'Подробности проверки', 'field-city_targeting_city'    => 'Город', 'field-city_targeting_is_active'  => 'Геотаргетинг включен', 'field-news_relation'     => 'Связано с лентой новостей', 'field-ignore-banner-subpages'   => 'Игнорировать подстраницы', 'field-publish-status'     => 'Статус публикации', 'field-type-int'      => 'Число', 'field-type-string'      => 'Строка', 'field-type-text'      => 'Простой текст', 'field-type-relation'     => 'Выпадающий список', 'field-type-relation-multiple'   => 'Выпадающий список с множественным выбором', 'field-type-file'      => 'Файл', 'field-type-img_file'     => 'Изображение', 'field-type-swf_file'     => 'Флеш-ролик', 'field-type-date'      => 'Дата', 'field-type-boolean'     => 'Кнопка-флажок', 'field-type-wysiwyg'     => 'HTML-текст', 'field-type-password'     => 'Пароль', 'field-type-tags-multiple'    => 'Теги', 'field-type-symlink-multiple'   => 'Ссылка на дерево', 'field-type-price'      => 'Цена', 'field-type-float'      => 'Число с точкой', 'field-type-optioned'     => 'Составное', 'field-type-counter'     => 'Счетчик', 'field-type-video'      => 'Видео', 'field-expiration-date'     => 'Дата окончания актуальности', 'field-notification-date'    => 'Дата предупреждения об окончании актуальности', 'field-publish_comments'    => 'Комментарий к публикации', 'field-date-empty'      => 'Никогда', 'field-form_sending_time'    => 'Время отправки', 'field-auto_reply'      => 'Автоответ', 'field-body'       => 'Текст сообщения', 'field-userpic'       => 'Загрузить свой', 'field-picture'       => 'Картинка', 'field-is_hidden'      => 'Скрытая', 'field-forced_subscribers'    => 'Принудительно подписанные пользователи:', 'field-msg_date'      => 'Дата сообщения', 'field-short_body'      => 'Краткий текст сообщения', 'field-new_relation'     => 'Ссылка на новость', 'field-publish_status_id'    => 'id статуса', 'field-locktime'      => 'Время блокировки', 'field-lockuser'      => 'Блокирующий пользователь', 'field-last_message'     => 'Последнее сообщение', 'field-friendlist'      => 'Список друзей', 'field-only_for_friends'    => 'Видимо только друзьям', 'field-user_settings_data'    => 'Настройки пользователя', 'field-opinion'       => 'Как вам сайт?', 'field-expiration_date'     => 'Дата снятия с публикации', 'field-notification_date'    => 'Дата уведомления', 'field-publish_status'     => 'Статус публикации', 'field-faq_publish_time'    => 'Дата публикации', 'field-global-discount-size'   => 'Сумма глобальной скидки', 'field-eshop_order_currency'   => 'Валюта в интернет магазине', 'field-currency_exchange_rate'   => 'Курс обмена', 'field-eshop_order_currency_total'  => 'Сумма в валюте заказа', 'field-sending_time'     => 'Дата отправки', 'field-use_in_eshop'     => 'Использовать в интернет-магазине', 'field-eshop_currency_letter_code'  => 'Код валюты', 'field-eshop_currency_exchange_rate' => 'Курс обмена', 'field-eshop-currency-symbol'   => 'Сокращенное название валюты', 'field-photo-s'       => 'Фото', 'field-strana_prozhivaniya'    => 'Страна проживания', 'field-gorod_prozhivaniya'    => 'Город проживания', 'field-adres_prozhivaniya'    => 'Адрес проживания', 'field-restriction-email'    => 'E-mail', 'field-restriction-http-url'   => 'Web-адрес', 'field-restriction-system-domain'  => 'Домен системы', 'field-restriction-discount'   => 'Размер скидки', 'field-restriction-object-type'   => 'Тип данных', 'field-loginza'       => 'Провайдер регистрации (через Loginza)', 'field-common-quantity'     => 'Общее количество на складах', 'field-referer'       => 'Адрес, с которого пришел пользователь', 'field-target'       => 'Адрес, на который пришел пользователь', 'field-register_date'     => 'Дата регистрации', 'field-last_order'      => 'Последний заказ', 'field-bonus'       => 'Зачисленные бонусы', 'field-spent_bonus'      => 'Потраченные бонусы', 'field-departure_city'     => 'Город отправления', 'field-order_items'      => 'Наименования заказа', 'field-order_status'     => 'Статус заказа', 'field-payment_status'     => 'Статус оплаты', 'field-delivery_status'     => 'Статус доставки', 'field-item_options' => 'Опции товара', 'field-item_price' => 'Стоимость единицы товара', 'field-item_amount' => 'Количество единиц товара', 'field-customer' => 'Покупатель', 'field-string_id' => 'Строковой id', 'field-discount_type' => 'Тип скидки', 'field-price_modificator' => 'Модификатор цены', 'field-validation_rules' => 'Правила валидации', 'field-identifier' => 'Идентификатор', 'field-modificator_type_id' => 'Тип данных (id)', 'field-modificator_discount_types' => 'Допустимые типы скидки', 'field-modificator_type' => 'Тип модификатора', 'field-rule_id' => 'Идентификатор', 'field-rule_type_id' => 'Тип данных (id)', 'field-rule_type' => 'Тип правила', 'field-stores_state' => 'Состояние на складе', 'field-item_type_id' => 'Идентификатор типа товара', 'field-item_type' => 'Тип товара', 'field-item_link' => 'Товар в магазине', 'field-catalog_object_discount' => 'Скидка на наименование', 'field-total_price' => 'Стоимость заказа', 'field-total_amount' => 'Количество товаров', 'field-order_original_price' => 'Стоимость заказа без скидки', 'field-item_original_price' => 'Стоимость наименования без скидки', 'field-order_discount' => 'Скидка на заказ', 'field-secret_word' => 'Секретное слово', 'field-product_id' => 'ID продукта магазина', 'field-emarket-id' => 'ID магазина', 'field-excluded_elements' => 'Разделы сайта, которые не будут экспортированы', 'field-domain_id' => 'Идентификатор домена', 'field-template_id' => 'Идентификатор шаблона', 'field-message_sent' => 'Сообщение об отправке', 'field-test_mode' => 'Тестовый режим', 'field-data_integrity_code' => 'Код проверки целостности данных', 'field-failed_pay_url' => 'Url неудачной оплаты',  'field-successful_pay_url' => 'Url удачной оплаты', 'field-mnt_id' => 'Идентификатор магазина', 'field-mnt_system_url' => 'Url платежной системы', 'field-site_name' => 'Название сайта', 'field-social_network_id' => 'Идентификатор социальной сети', 'field-is_iframe_enabled' => 'Включить отображение', 'field-iframe_pages' => 'Разделы сайта', 'field-social_id' => 'ID категории в Вконтакте', 'field-social_order_id' => 'Номер заказа в социальной сети', 'field-country_code' => 'Код страны', 'field-legal_persons' => 'Юридические лица', 'field-legal_person' => 'Юридическое лицо', 'field-bank' => 'Наименование банка', 'field-account' => 'Расчетный счет', 'field-post_address' => 'Почтовый адрес', 'field-defacto_address' => 'Фактический адрес', 'field-legal_address' => 'Юридический адрес', 'field-organisation_name' => 'Наименование организации', 'field-fax' => 'Факс', 'field-phone_number' => 'Контактный телефон', 'field-status_code' => 'Код статуса', 'field-nominal' => 'Номинал', 'field-prefix_n' => 'Префикс', 'field-suffix' => 'Суффикс', 'field-delivery_description' => 'Описание доставки', 'field-delivery_type_id' => 'Идентификатор типа доставки',  'field-order_min_price' => 'Стоимость заказа, после которой доставка бесплатна', 'field-delivery_type' => 'Тип доставки', 'field-delivery_datatype_id' => 'Тип данных (id)', 'field-delivery_price' => 'Стоимость доставки', 'field-delivery_id' => 'Способ доставки', 'field-payment_id' => 'Способ оплаты', 'field-payment_type_id' => 'Идентификатор типа оплаты', 'field-payment_datatype_id' => 'Тип данных (id)', 'field-payment_type' => 'Тип оплаты', 'field-order_number' => 'Номер заказа', 'field-phone_n' => 'Телефон', 'field-ip_address' => 'IP-адрес', 'field-discount_start' => 'Начало действия скидки', 'field-discount_end' => 'Окончание действия скидки', 'field-users' => 'Пользователи', 'field-minimal_summ' => 'Минимальная сумма', 'field-maximal_summ' => 'Максимальная сумма', 'field-minimal_order_price' => 'Минимальная стоимость заказа', 'field-maximal_order_price' => 'Максимальная стоимость заказа', 'field-connected_items' => 'Связанные товары', 'field-private_key' => 'Секретный ключ', 'field-product_code' => 'Код продукта', 'field-secret' => 'Секретный ключ', 'field-geographic_area' => 'Регион', 'field-street' => 'Улица', 'field-house' => 'Дом', 'field-appartment' => 'Квартира', 'field-status_change_date' => 'Дата последнего изменения статуса заказа', 'field-export_1C' => 'Выгружать заказ в 1С при следующем сеансе связи', 'field-export_format' => 'Формат экспорта', 'field-included_site_sections' => 'Разделы сайта, которые будут экспортированы', 'field-cache_time' => 'Время кеширования результатов экспорта (в минутах)', 'field-data_format' => 'Формат данных', 'field-data_file' => 'Файл данных', 'field-site_section_export' => 'Раздел сайта, в который будут импортированы данные', 'field-order_date' => 'Дата оформления заказа', 'field-reciever_account' => 'Номер счета получателя платежа', 'field-reciever_bank' => 'Наименование банка получателя платежа', 'field-reciever' => 'Наименование получателя платежа', 'field-payment_date' => 'Дата оплаты', 'field-payment_document_number' => 'Номер платежного документа', 'field-is_reserved' => 'Товары зарезервированы', 'field-reserved' => 'Зарезервировано', 'field-del_price' => 'Стоимость доставки', 'field-demo_mode' => 'Демо-режим', 'field-test_mode_n' => 'Тестовый режим', 'field-reciever_inn' => 'ИНН получателя платежа', 'field-bik' => 'БИК', 'field-viewpost' => 'Вид отправления', 'field-typepost' => 'Способ пересылки', 'field-setpostvalue' => 'С объявленной ценностью', 'field-idcode' => 'Идентификатор', 'field-delivery_allow_date' => 'Дата разрешения доставки', 'field-primary_store' => 'Основной', 'field-password1' => 'Пароль #1', 'field-password2' => 'Пароль #2', 'field-eshopid' => 'Номер сайта продавца', 'field-secretkey' => 'Секретный ключ', 'field-source_name' => 'Идентификатор ресурса', 'field-is_spam' => 'Спам', 'field-index_number' => 'Порядковый номер', 'field-days' => 'Дни недели', 'field-reciever_bank_account' => 'Номер кор./сч. банка получателя платежа', 'field-hours' => 'Часы', 'field-delivery_type_guid' => 'Тип данных (GUID)', 'field-payment_type_guid' => 'Тип данных (GUID)', 'field-modificator_type_guid' => 'Тип данных (GUID)', 'field-rule_type_guid' => 'Тип данных (GUID)', 'field-name' => 'Наименование', 'field-RRC' => 'КПП', 'field-receiver_bank' => 'Банк получателя', 'field-bank_account_number' => 'Номер кор. счета банка', 'field-sign_image' => 'Изображение с подписями', 'field-contact_person' => 'Контактное лицо', 'field-bank_account' => 'Кор. счет банка', 'field-shop_password' => 'shopPassword', 'field-bank_id' => 'BankId', 'field-merchant_id' => 'Merchant ID', 'field-shop_id' => 'ShopId', 'field-scid' => 'scid', 'field-rule_discount_types' => 'Допустимые типы скидки', 'field-manager'    => 'Ответственный менеджер', 'field-source_domain'  => 'Источник перехода', 'field-utm_medium'   => 'Тип трафика', 'field-utm_term'   => 'Ключевые слова', 'field-utm_campaign'  => 'Рекламная кампания', 'field-utm_content'   => 'Тип рекламной кампании', 'field-order_create_date' => 'Дата создания заказа', 'field-date_create_object' => 'Дата создания объекта',   'fields-group-short_info'  => 'Персональная информация', 'fields-group-more_info'  => 'Дополнительная информация', 'fields-group-common'   => 'Основные параметры', 'fields-group-view_params'  => 'Параметры показа', 'fields-group-time_targeting'  => 'Time-таргетинг', 'fields-group-menu_view'  => 'Отображение в меню', 'fields-group-more_params'  => 'Дополнительные параметры', 'fields-group-idetntify_data'  => 'Идентификационные данные', 'fields-group-item_props'  => 'Свойства публикации', 'fields-group-subjects_block'  => 'Сюжеты', 'fields-group-order_item_props'  => 'Свойства наименования', 'fields-group-order_props'  => 'Свойства заказа', 'fields-group-comments'   => 'Пометки', 'fields-group-common_props'  => 'Общие свойства', 'fields-group-poll_props'  => 'Свойства опроса', 'fields-group-status_props'  => 'Свойства статусы', 'fields-group-delivery_address'  => 'Адрес для доставки', 'fields-group-topic_props'  => 'Свойства топика',    'fields-group-message_props'        =>    'Свойства сообщения', 'fields-group-comment_props'  => 'Свойства комментария', 'fields-group-license_info'  => 'Свойства лицензии', 'fields-group-owner_info'  => 'Информация о клиенте', 'fields-group-currency_props'  => 'Свойства валюты', 'fields-group-view_pages'  => 'Разделы отображения', 'fields-group-banner_custom_props' => 'Индивидуальные параметры баннера', 'fields-group-redirect_props'  => 'Параметры перехода', 'fields-group-props'   => 'Свойства', 'fields-group-grp_disp_props'  => 'Свойства рассылки', 'fields-group-grp_disp_release_props' => 'Свойства выпуска рассылки', 'fields-group-grp_disp_msg_props' => 'Свойства сообщения рассылки', 'fields-group-grp_sbs_props'  => 'Информация о подписчике', 'fields-group-grp_disp_msg_extended' => 'Дополнительные свойства', 'fields-group-grp_sbs_extended'  => 'Параметры подписки', 'fields-group-matrix_props'  => 'Свойства матрицы', 'fields-group-photo_props'  => 'Свойства фотографии', 'fields-group-album_props'  => 'Свойства фотоальбома', 'fields-group-svojstva_gruppy_polzovatelej'  => 'Свойства группы пользователей', 'fields-group-fs_file_props'  => 'Свойства файла', 'fields-group-news_images'  => 'Изображения новости', 'fields-group-dopolnitelno'  => 'Дополнительно', 'fields-group-rate_props'  => 'Свойства рейтинга', 'fields-group-rate_voters'  => 'Количество проголосовавших', 'fields-group-store_props'  => 'Свойства склада', 'fields-group-cenovye_svojstva'  => 'Ценовые свойства', 'fields-group-other_proerties'  => 'Характеристики хомячка', 'fields-group-pictures'   => 'Изображения', 'fields-group-descr_grp'  => 'Описание товара', 'fields-group-parametry_aksessuara' => 'Параметры аксессуара', 'fields-group-recommend'  => 'Рекомендуем', 'fields-group-common_group'  => 'Общие параметры', 'fields-group-privatnost'  => 'Приватность', 'fields-group-identity'   => 'identity', 'fields-group-transaction_status_props' => 'Свойства', 'fields-group-transaction_props' => 'Свойства транзакции', 'fields-group-trans_init'  => 'Инициализация', 'fields-group-trans_deliver'  => 'Доставка', 'fields-group-prelim'   => 'Результат', 'fields-group-final'   => 'Подтверждение', 'fields-group-consequences'  => 'Послесловие', 'fields-group-city_targeting'  => 'Геотаргетинг', 'fields-group-SendingData'  => 'Данные для отправки', 'fields-group-Templates'  => 'Письмо', 'fields-group-Binding'   => 'Привязка', 'fields-group-list'   => 'Список', 'fields-group-short_user_info'  => 'Краткая информация', 'fields-group-advanced'   => 'Дополнительные', 'fields-group-userpic'   => 'Юзерпик', 'fields-group-auto_reply'   => 'Автоответ', 'fields-group-svojstva_statusa_stranicy'   => 'Свойства статуса страницы', 'fields-group-locks'   => 'Блокировка', 'fields-group-privacy'   => 'Настройки отображения', 'fields-group-osnovnoe'   => 'Основное', 'fields-group-currency-props'  => 'Свойства валюты', 'fields-group-svojstva_publikacii' => 'Актуальность публикации', 'fields-group-svojstva'   => 'Свойства', 'fields-group-news-rss-source-charset-common' => 'Основные свойства', 'fields-group-order_payment_props' => 'Свойства оплаты заказа', 'fields-group-order_delivery_props' => 'Свойства доставки заказа', 'fields-group-order_discount_props' => 'Свойства скидки на заказ', 'fields-group-item_optioned_props' => 'Опции товара', 'fields-group-discount_type_props' => 'Свойства типа скидки', 'fields-group-discount_props' => 'Свойства скидки', 'fields-group-discount_modificator_props' => 'Свойства модификатора скидки', 'fields-group-discount_modificator_type_props' => 'Свойства типа модификатора скидки', 'fields-group-discount_rule_type_props' => 'Свойства типа правила скидки', 'fields-group-discount_rule_props' => 'Свойства правила скидки', 'fields-group-option_props'  => 'Опционные свойства', 'fields-group-stores' => 'Склады', 'fields-group-item_type_props' => 'Свойства типа товара', 'fields-group-order_status_props' => 'Свойства статуса заказа', 'fields-group-delivery_description' => 'Описание способа доставки', 'fields-group-delivery_type_props' => 'Свойства типа доставки', 'fields-group-delivery_courier_props' => 'Свойства курьерской доставки', 'fields-group-payment_type_props' => 'Свойства типа оплаты', 'fields-group-payment_props' => 'Свойства способа оплаты', 'fields-group-personal_info' => 'Персональные данные', 'fields-group-contacts' => 'Контакты', 'fields-group-parameters' => 'Параметры', 'fields-group-delivery_status_props' => 'Свойства статуса доставки', 'fields-group-payment_status_props' => 'Свойства статуса оплаты', 'fields-group-intergation_props' => 'Свойства для интеграции с 1С', 'fields-group-settings' => 'Настройки', 'fields-group-common' => 'Общее', 'fields-group-organization_data' => 'Данные организации', 'fields-group-addresses' => 'Адреса', 'fields-group-payment_info' => 'Информация для оплаты', 'fields-group-yuridicheskie_dannye' => 'Юридические данные', 'fields-group-site_parts' => 'Разделы сайта', 'fields-group-service_props' => 'Служебные свойства', 'fields-group-messages' => 'Сообщения', 'fields-group-statistic_data' => 'Статистическая информация',  'perms-data-main' => 'Просмотр объектов',    'perms-data-guides' => 'Управление справочниками', 'perms-data-files' => 'Управление файлами', 'perms-data-trash' => 'Мусорная корзина', 'perms-data-types' => 'Управление шаблонами данных', 'group-currency-props'  => 'Свойства валюты', 'min-discount-order-total' => 'Минимальная сумма заказа', 'max-discount-order-total' => 'Максимальная сумма заказа', 'global-discount-order-size' => 'Сумма глобальной скидки', 'global-discount-end'  => 'Дата окончания действия', 'global-discount-start'  => 'Дата начала действия', 'global-discount-active-time' => 'Время действия скидки', 'order-total-range'  =>  'Диапазон суммы заказа', 'eshop-order-currency' => 'Валюта в интернет магазине', 'eshop-global-discount-proc'  => 'Процент глобальной скидки', 'eshop-currency' => 'Валюта в интернет магазине', 'eshop-currency-letter-code' => 'Буквенный код', 'eshop-currency-digit-code'  => 'Цифровой код', 'eshop-currency-exchange-rate' => 'Курс обмена', 'eshop-order-currency-id'  => 'Идентификатор валюты', "eshop-order-currency-exchange_rate" => "Курс обмена", "eshop-order-currency-total"  => "Сумма в валюте заказа", 'locktime'      => 'Время начала блокировки', 'lockuser'      => 'Пользователь заблокировавший страницу', "date-empty-field"    => "Никогда", 'js-trash-empty' => 'Очистка корзины', 'js-trash-empty-done' => 'Очистка корзины выполнена', 'js-trash-empty-help' => 'Подождите, выполняется очистка...', 'js-trash-toggle-log' => 'cкрыть/показать лог', 'js-trash-ajaxerror' => 'Ошибка разбора данных', 'js-trash-empty_stop' => 'Остановить', 'js-trash-empty_ok' => 'Готово', 'js-trash-empty_repeat' => 'Снова', 'js-trash-deleted' => 'Удалено: ', 'js-trash-confirm-title'   => 'Очистка корзины', 'js-trash-confirm-text'    => 'Вы собираетесь очистить корзину. Это означает, что все страницы в корзине будут безвозвратно удалены.', 'js-trash-confirm-cancel'   => 'Отменить', 'js-trash-confirm-ok'    => 'Очистить', 'js-trash-restore'     => 'Восстановить', 'js-data-add-field'     => 'Добавить поле', 'js-data-edit-field'    => 'Сохранить', 'js-view-guide-items'    => 'Содержимое справочника', 'js-type-edit-edit'     => 'изменить', 'js-type-edit-remove'    => 'удалить', 'js-type-edit-add_group'   => 'Добавить группу', 'js-type-edit-add_field'   => 'Добавить поле', 'js-type-edit-title'    => 'Название', 'js-type-edit-name'     => 'Идентификатор', 'js-type-edit-tip'     => 'Подсказка', 'js-type-edit-type'     => 'Тип', 'js-type-edit-restriction'   => 'Формат значения', 'js-type-edit-guide'    => 'Справочник', 'js-type-edit-visible'    => 'Видимое', 'js-type-edit-required'    => 'Обязательное', 'js-type-edit-indexable'   => 'Индексируемое', 'js-type-edit-filterable'   => 'Фильтруемое', 'js-type-edit-saving'    => 'Сохранение', 'js-type-edit-new_group'   => 'Новая группа', 'js-type-edit-new_field'   => 'Новое поле', 'js-type-edit-confirm_title'  => 'Подтверждение удаления', 'js-type-edit-confirm_text'   => 'Если вы уверены, нажмите "Удалить" (действие необратимо).', 'restriction-error-common'   => 'Неверное значение', 'restriction-error-discount-size' => 'Размер скидки должен находиться в диапозоне от 0 до 100%', 'restriction-error-domain-id'  => 'Домена с таким id нет в системе', 'restriction-error-email'   => 'Неверный e-mail', 'restriction-error-object-type'  => 'Должен быть передан существующий тип данных', 'error-value-required'    => 'Поле "%s" обязательно должно быть заполнено', 'error-max_filesize'    => 'Файл превышает максимально допустимый размер', 'error-max_img_filesize'   => 'Изображение превышает максимально допустимый размер', 'error-files_quota_exceeded'  => 'Вы превысили максимально допустимый объем дискового пространства', 'field-kvk-ContractSigningDeadline' => "Крайний срок подписания оферты", 'field-kvk-ContractDeliveryDeadline' => "Срок доставки оригиналов документов", 'field-kvk-BankSigningAppointmentTime' => "Встреча с представителем банка", 'field-kvk-IsConfirmed' => "Подтверждение", 'field-kvk-SigningType' => "Способ подписания оферты", 'field-kvk-BeingProcessed' => "В обработке", 'field-kvk-CreditStatus' => "Статус кредита", 'object-type-signingtypes' => 'Способы подписания оферты', 'object-signingtype-bank' => 'Силами банка', 'object-signingtype-partner' => 'Силами магазина', 'object-type-creditstatuses' => 'Статусы кредита', 'object-credit-status-new' => 'На рассмотрении', 'object-credit-status-rej' => 'Отказано', 'object-credit-status-hol' => 'На удержании', 'object-credit-status-ver' => 'Предварительно одобрено', 'object-credit-status-agr' => 'Одобрено', 'object-credit-status-can' => 'Отменено', 'object-credit-status-app' => 'Ожидание оригиналов', 'object-credit-status-pvr' => 'Проверка оригиналов', 'object-credit-status-fap' => 'Оригиналы ОК', 'object-credit-status-prr' => 'Оригиналы на доработке', 'object-credit-status-ovr' => 'Просрочено', 'field-kvk-partnerId' => "Идентификатор магазина", 'field-kvk-apiKey' => "Ключ API", 'field-kvk-secretKey' => "Секретный ключ", 'header-emarket-order_payment' => "Система оплаты", 'field-payment-error' => 'Ошибка системы оплаты', 'error-payment-system' => 'Сервер системы оплаты вернул ошибку: %s.', 'fields-group-credit-status-props' => 'Свойства статуса кредита', 'fields-group-credit' => 'Свойства кредита',  'field-order-status-priority' => 'Приоритет', 'field-emarket-mobile-device-token' => 'Токен', 'field-emarket-mobile-platform' => 'Платформа', 'field-emarket-mobile-device-active' => 'Активно', 'field-emarket-mobile-platform_identificator' => 'Идентификатор платформы', 'fields-group-emarket-mobile-devices-common' => 'Основные', 'fields-group-emarket-mobile-platform-common' => 'Основные', 'field-order-payment-priority' => 'Приоритет', 'object-order-payment-status-default' => 'Не установлен',  'field-order-delivery-priority' => 'Приоритет', 'object-order-delivery-status-default' => 'Не установлен', 'field-yandex_order_id' => 'Номер заказа в Яндекс.Маркет', 'fields-group-yandex_payment_types' => 'Доступные в магазине способы оплаты', 'field-yandex_pc' => 'Оплата Яндекс.Деньгами', 'field-yandex_gp_svzny' => 'Оплата через терминалы сети салонов "Связной"', 'field-yandex_ac' => 'Оплата банковской картой', 'field-yandex_gp_eurst' => 'Оплата через терминалы сети салонов "Евросеть"', 'field-yandex_mc' => 'Оплата со счета мобильного телефона', 'field-yandex_gp_other' => 'Оплата через другие терминалы', 'hierarchy-type-seo-yandex_island' => 'SEO: Яндекс.Остров', 'object-type-seo-yandex-island'  => 'Яндекс.Остров', 'fields-group-seo-island-common' => 'Основные настройки', 'field-island_metrika_id'   => 'Идентификатор счетчика Яндекс.Метрики', 'field-island_title'    => 'Название острова в Яндексе', 'field-island_domain_id'   => 'Домен системы', 'field-island_description'   => 'Описание острова в Яндексе', 'field-island_type'     => 'Тип острова', 'field-island_tree_link'   => 'Адрес страницы', 'field-island_user_fields'   => 'Настройки полей острова', 'field-island_url_link'    => 'Адрес страницы', 'object-type-seo-yandex-island-types' => 'Типы Яндекс.Островов', 'fields-group-seo-island-types-common' => 'Основные настройки', 'field-island_island_type'    => 'Строковый идентификатор типа', 'object-seo-yandex-island-relation'  => 'Ссылка на существующую страницу', 'object-seo-yandex-island-system'  => 'Ссылка на несуществующую или системную страницу', 'object-type-emarket-purchase-oneclick' => 'Данные из формы "Заказ в 1 клик"', 'fields-group-purchase_one_click' => 'Заказ в 1 клик', 'field-paypalemail'  => 'E-mail продавца', 'field-return_success' => 'Url удачной оплаты', 'field-cancel_return' => 'Url неудачной оплаты', 'hierarchy-type-menu-item_element' => 'Меню', 'object-type-menu'     => 'Меню', 'fields-group-menu_common'   => 'Основные', 'field-menu-menu_id'    => 'Идентификатор', 'field-menuhierarchy'    => 'Структура меню', 'field-fname_oneclick'    => 'Имя', 'field-father_name_oneclick'  => 'Отчество', 'field-lname_oneclick'    => 'Фамилия', 'field-email_oneclick'    => 'E-mail', 'field-phone_number_oneclick'  => 'Телефон',);class ulangStream extends umiBaseStream {protected $scheme = "ulang", $prop_name = NULL;protected static $i18nCache = Array();public function stream_open($vd6fe1d0be6347b8ef2427fa629c04485, $v15d61712450a686a7f365adf4fef581f, $v93da65a9fd0004d9477aeac024e08e15, $v6385a5865e0b96f09e4142ab2d9e3736) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();$vcaf9b6b99962bf5c2264824231d7a40c = parse_url($vd6fe1d0be6347b8ef2427fa629c04485);$vd6fe1d0be6347b8ef2427fa629c04485 = trim(getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'host') . getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'path'), "/");if(substr($vd6fe1d0be6347b8ef2427fa629c04485, -5, 5) == ':file') {$vbc45423e1780f4dbda64608a76f2e05b = $this->getExternalDTD(substr($vd6fe1d0be6347b8ef2427fa629c04485, 0, strlen($vd6fe1d0be6347b8ef2427fa629c04485) - 5));return $this->setData($vbc45423e1780f4dbda64608a76f2e05b);}if(strpos(getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'query'), 'js') !== false) {$v15d61712450a686a7f365adf4fef581f = 'js';}else if(strpos($vd6fe1d0be6347b8ef2427fa629c04485, 'js') !== false) {$v15d61712450a686a7f365adf4fef581f = 'js';$vd6fe1d0be6347b8ef2427fa629c04485 = substr($vd6fe1d0be6347b8ef2427fa629c04485, 0, strlen($vd6fe1d0be6347b8ef2427fa629c04485) - 3);}else $v15d61712450a686a7f365adf4fef581f = 'dtd';if($v15d61712450a686a7f365adf4fef581f == 'js') {$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v7f2db423a49b305459147332fb01cf87->contentType('text/javascript');$v8d777f385d3dfec8815d20f7496026dc = $this->generateJavaScriptLabels($vd6fe1d0be6347b8ef2427fa629c04485);return $this->setData($v8d777f385d3dfec8815d20f7496026dc);}if(isset($v0fea6a13c52b4d4725368f24b045ca84[$vd6fe1d0be6347b8ef2427fa629c04485])) {$v8d777f385d3dfec8815d20f7496026dc = $v0fea6a13c52b4d4725368f24b045ca84[$vd6fe1d0be6347b8ef2427fa629c04485];}else {$v11cc313f766c5d93e6b73ba8439ade0f = self::loadI18NFiles($vd6fe1d0be6347b8ef2427fa629c04485);$v8d777f385d3dfec8815d20f7496026dc = $v0fea6a13c52b4d4725368f24b045ca84[$vd6fe1d0be6347b8ef2427fa629c04485] = $this->translateToDTD($v11cc313f766c5d93e6b73ba8439ade0f);}return $this->setData($v8d777f385d3dfec8815d20f7496026dc);}protected function translateToDTD($v5a1969515ab7b523d913732d256e644a) {$v6a87284914054e1ba5d1d288c1b09f43 = "<!ENTITY quote '&#34;'>\n";$v6a87284914054e1ba5d1d288c1b09f43 .= "<!ENTITY nbsp '&#160;'>\n";$v6a87284914054e1ba5d1d288c1b09f43 .= "<!ENTITY middot '&#183;'>\n";$v6a87284914054e1ba5d1d288c1b09f43 .= "<!ENTITY reg '&#174;'>\n";$v6a87284914054e1ba5d1d288c1b09f43 .= "<!ENTITY copy '&#169;'>\n";$v6a87284914054e1ba5d1d288c1b09f43 .= "<!ENTITY raquo '&#187;'>\n";$v6a87284914054e1ba5d1d288c1b09f43 .= "<!ENTITY laquo '&#171;'>\n";$v156577e912dd9b1be50a671edc17c4a0 = getServer('REQUEST_URI');$v156577e912dd9b1be50a671edc17c4a0 = htmlspecialchars($v156577e912dd9b1be50a671edc17c4a0);foreach($v5a1969515ab7b523d913732d256e644a as $v18389a4a9ad5795744699cff0ba66c15 => $v385aa5385e83efc5d83c7588ee5fb7e8) {$v385aa5385e83efc5d83c7588ee5fb7e8 = $this->protectEntityValue($v385aa5385e83efc5d83c7588ee5fb7e8);$v6a87284914054e1ba5d1d288c1b09f43 .= "<!ENTITY {$v18389a4a9ad5795744699cff0ba66c15} \"{$v385aa5385e83efc5d83c7588ee5fb7e8}\">\n";}return $v6a87284914054e1ba5d1d288c1b09f43;}protected function isRestrictedRef($v18389a4a9ad5795744699cff0ba66c15) {$v47c80780ab608cc046f2a6e6f071feb6 = Array('field-', 'object-type-', 'hierarchy-type-', 'fields-group-', 'field-type-');for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < sizeof($v47c80780ab608cc046f2a6e6f071feb6);$v865c0c0b4ab0e063e5caa3387c1a8741++) {if(substr($v18389a4a9ad5795744699cff0ba66c15, 0, strlen($v47c80780ab608cc046f2a6e6f071feb6[$v865c0c0b4ab0e063e5caa3387c1a8741])) == $v47c80780ab608cc046f2a6e6f071feb6[$v865c0c0b4ab0e063e5caa3387c1a8741]) {return true;}}return false;}protected function protectEntityValue($v3a6d0284e743dc4a9b86f97d6dd1a3bf) {$vd98a07f84921b24ee30f86fd8cd85c3c = array('&', '"', '%');$v01b6e20344b68835c5ed1ddedf20d531 = array('&amp;', '&quote;', '&#037;');$v3a6d0284e743dc4a9b86f97d6dd1a3bf = str_replace($vd98a07f84921b24ee30f86fd8cd85c3c, $v01b6e20344b68835c5ed1ddedf20d531, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);return $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}protected static function parseLangsPath($vd6fe1d0be6347b8ef2427fa629c04485) {$v81788ba0d7d02d81c063dbca621ba11b = "ulang://";if(substr($vd6fe1d0be6347b8ef2427fa629c04485, 0, strlen($v81788ba0d7d02d81c063dbca621ba11b)) == $v81788ba0d7d02d81c063dbca621ba11b) {$vd6fe1d0be6347b8ef2427fa629c04485 = substr($vd6fe1d0be6347b8ef2427fa629c04485, strlen($v81788ba0d7d02d81c063dbca621ba11b));}$vd6fe1d0be6347b8ef2427fa629c04485 = trim($vd6fe1d0be6347b8ef2427fa629c04485, "/");return explode("/", $vd6fe1d0be6347b8ef2427fa629c04485);}protected static function loadI18NFiles($vd6fe1d0be6347b8ef2427fa629c04485) {global $i18n;static $v7abdda3251de25a51bf5fb15d7c3391d = "content", $v4a8a08f09d37b73795649038408b5f33 = 0;if(!$v7abdda3251de25a51bf5fb15d7c3391d) {$v594c103f2c6e04c3d8ab059f031e0c1a = cmsController::getInstance();$v7abdda3251de25a51bf5fb15d7c3391d = $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentModule();}$ve6451b27d4123951dfd29d32a18b3919 = self::$i18nCache;$ve8723cd5a634e83ba1d810e6584f3e59 = self::parseLangsPath($vd6fe1d0be6347b8ef2427fa629c04485);$v753527be46567ad90a4203cf4b40d70e = self::getLangPrefix();$v11cc313f766c5d93e6b73ba8439ade0f = Array();if(!in_array($v7abdda3251de25a51bf5fb15d7c3391d, $ve8723cd5a634e83ba1d810e6584f3e59)) {$ve8723cd5a634e83ba1d810e6584f3e59[] = $v7abdda3251de25a51bf5fb15d7c3391d;}$vfa1c731ead93e333a9180e16f968c01e = Array();$vfa1c731ead93e333a9180e16f968c01e[10] = array(    'dir'  => CURRENT_WORKING_DIR . '/classes/modules/',    'file' => 'i18n.php'   );$vfa1c731ead93e333a9180e16f968c01e[20] = array(    'dir'  => CURRENT_WORKING_DIR . '/classes/modules/',    'file' => 'i18n.' . $v753527be46567ad90a4203cf4b40d70e . '.php'   );$vfbfa50b2e3ef554f9ac216be37adaaa0 = NULL;if (!is_null($vfbfa50b2e3ef554f9ac216be37adaaa0)) {$vfa1c731ead93e333a9180e16f968c01e[30] = array(     'dir'  => $vfbfa50b2e3ef554f9ac216be37adaaa0 . '/classes/modules/',     'file' => 'i18n.php'    );$vfa1c731ead93e333a9180e16f968c01e[40] = array(     'dir'  => $vfbfa50b2e3ef554f9ac216be37adaaa0 . '/classes/modules/',     'file' => 'i18n.' . $v753527be46567ad90a4203cf4b40d70e . '.php'    );}$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($ve8723cd5a634e83ba1d810e6584f3e59);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vdff9a6fde59e8dfc96361ffa7b52426a = $ve8723cd5a634e83ba1d810e6584f3e59[$v865c0c0b4ab0e063e5caa3387c1a8741];if($vdff9a6fde59e8dfc96361ffa7b52426a == false) continue;$v851148b4fd8fd7ae74bd9100c5c0c898 = ($vdff9a6fde59e8dfc96361ffa7b52426a == "common") ? '' : $vdff9a6fde59e8dfc96361ffa7b52426a . '/';if(array_key_exists($vdff9a6fde59e8dfc96361ffa7b52426a, $ve6451b27d4123951dfd29d32a18b3919)) {$v381aac9ee2f1346c0d06e1b015036d15 = $ve6451b27d4123951dfd29d32a18b3919[$vdff9a6fde59e8dfc96361ffa7b52426a];}else {$v381aac9ee2f1346c0d06e1b015036d15 = array();foreach($vfa1c731ead93e333a9180e16f968c01e as $v36cd38f49b9afa08222c0dc9ebfe35eb) {$v435ed7e9f07f740abf511a62c00eef6e = $v36cd38f49b9afa08222c0dc9ebfe35eb['dir'] . $v851148b4fd8fd7ae74bd9100c5c0c898 . $v36cd38f49b9afa08222c0dc9ebfe35eb['file'];if (file_exists($v435ed7e9f07f740abf511a62c00eef6e)) {include $v435ed7e9f07f740abf511a62c00eef6e;$v381aac9ee2f1346c0d06e1b015036d15 = $i18n + $v381aac9ee2f1346c0d06e1b015036d15;}}}if(isset($v381aac9ee2f1346c0d06e1b015036d15) && is_array($v381aac9ee2f1346c0d06e1b015036d15)) {$ve6451b27d4123951dfd29d32a18b3919[$vdff9a6fde59e8dfc96361ffa7b52426a] = $v381aac9ee2f1346c0d06e1b015036d15;$v11cc313f766c5d93e6b73ba8439ade0f = $v381aac9ee2f1346c0d06e1b015036d15 + $v11cc313f766c5d93e6b73ba8439ade0f;unset($v381aac9ee2f1346c0d06e1b015036d15);}}self::$i18nCache = $ve6451b27d4123951dfd29d32a18b3919;return $v11cc313f766c5d93e6b73ba8439ade0f;}public static function getLabelSimple($vd304ba20e96d87411588eeabac850e34, array $v21ffce5b8a6cc8cc6a41448dd69623c9 = array()) {return self::getLabel($vd304ba20e96d87411588eeabac850e34, false, array_merge(array($vd304ba20e96d87411588eeabac850e34, false) , $v21ffce5b8a6cc8cc6a41448dd69623c9));}public static function getLabel($vd304ba20e96d87411588eeabac850e34, $vd6fe1d0be6347b8ef2427fa629c04485 = false, $args = null) {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();static $v535d02e594853266d2db02ff178dd7f7 = false;if($v535d02e594853266d2db02ff178dd7f7 === false) {$v535d02e594853266d2db02ff178dd7f7 = self::getLangPrefix();}$v9a4a6f6ee974a928a90c9152a674b141 = ($vd6fe1d0be6347b8ef2427fa629c04485 == false) ? "common/data" : $vd6fe1d0be6347b8ef2427fa629c04485;if(isset($v0fea6a13c52b4d4725368f24b045ca84[$v9a4a6f6ee974a928a90c9152a674b141])) {$v11cc313f766c5d93e6b73ba8439ade0f = $v0fea6a13c52b4d4725368f24b045ca84[$v9a4a6f6ee974a928a90c9152a674b141];}else {$v11cc313f766c5d93e6b73ba8439ade0f = self::loadI18NFiles($v9a4a6f6ee974a928a90c9152a674b141);$v0fea6a13c52b4d4725368f24b045ca84[$v9a4a6f6ee974a928a90c9152a674b141] = &$v11cc313f766c5d93e6b73ba8439ade0f;}if(isset($v11cc313f766c5d93e6b73ba8439ade0f[$vd304ba20e96d87411588eeabac850e34])) {$v9b207167e5381c47682c6b4f58a623fb = $v11cc313f766c5d93e6b73ba8439ade0f[$vd304ba20e96d87411588eeabac850e34];}elseif(!$vd6fe1d0be6347b8ef2427fa629c04485 && strpos($vd304ba20e96d87411588eeabac850e34, 'module-') === 0) {$v52a43e48ec4649dee819dadabcab1bde = str_replace('module-', '', $vd304ba20e96d87411588eeabac850e34);$v9b207167e5381c47682c6b4f58a623fb = self::getLabel($vd304ba20e96d87411588eeabac850e34, $v52a43e48ec4649dee819dadabcab1bde, $args);}else {$v9b207167e5381c47682c6b4f58a623fb = "{$vd304ba20e96d87411588eeabac850e34}";}if(is_array($args) && sizeof($args) > 2) {$v9b207167e5381c47682c6b4f58a623fb = vsprintf($v9b207167e5381c47682c6b4f58a623fb, array_slice($args, 2));}return $v9b207167e5381c47682c6b4f58a623fb;}public static function getI18n($v3c6e0b8a9c15224a8228b9a98ca1531d, $v240bf022e685b0ee30ad9fe9e1fb5d5b = "") {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();if(!$v3c6e0b8a9c15224a8228b9a98ca1531d) {return $v3c6e0b8a9c15224a8228b9a98ca1531d;}$v9a4a6f6ee974a928a90c9152a674b141 = "common/data";$v851f5ac9941d720844d143ed9cfcf60a = "i18n::";if(isset($v0fea6a13c52b4d4725368f24b045ca84[$v9a4a6f6ee974a928a90c9152a674b141])) {$v11cc313f766c5d93e6b73ba8439ade0f = $v0fea6a13c52b4d4725368f24b045ca84[$v9a4a6f6ee974a928a90c9152a674b141];}else {$v11cc313f766c5d93e6b73ba8439ade0f = self::loadI18NFiles($v9a4a6f6ee974a928a90c9152a674b141);$v0fea6a13c52b4d4725368f24b045ca84[$v9a4a6f6ee974a928a90c9152a674b141] = $v11cc313f766c5d93e6b73ba8439ade0f;}$result = NULL;foreach($v11cc313f766c5d93e6b73ba8439ade0f as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if($v9e3669d19b675bd57058fd4664205d2a == $v3c6e0b8a9c15224a8228b9a98ca1531d) {if($v240bf022e685b0ee30ad9fe9e1fb5d5b) {if(substr($v865c0c0b4ab0e063e5caa3387c1a8741, 0, strlen($v240bf022e685b0ee30ad9fe9e1fb5d5b)) == $v240bf022e685b0ee30ad9fe9e1fb5d5b) {$result = $v851f5ac9941d720844d143ed9cfcf60a . $v865c0c0b4ab0e063e5caa3387c1a8741;break;}}else {$result = $v851f5ac9941d720844d143ed9cfcf60a . $v865c0c0b4ab0e063e5caa3387c1a8741;break;}}}if(!is_null($result)) {$v61aa67e6eaba94628806fae66b03cc2c = Array(     'object-type-',     'hierarchy-type-',     'field-',     'fields-group-',     'field-type-',     'object-'    );$v22ee71e9dcc9ca12fc313c6e1ce3f806 = false;$vf663bcefae644ae5f8a16deb6b2fd115 = str_replace("i18n::", "", $v240bf022e685b0ee30ad9fe9e1fb5d5b);foreach($v61aa67e6eaba94628806fae66b03cc2c as $v240bf022e685b0ee30ad9fe9e1fb5d5b) {$v240bf022e685b0ee30ad9fe9e1fb5d5b = $v240bf022e685b0ee30ad9fe9e1fb5d5b;if(substr($vf663bcefae644ae5f8a16deb6b2fd115, 0, strlen($v240bf022e685b0ee30ad9fe9e1fb5d5b)) == $vf663bcefae644ae5f8a16deb6b2fd115) {$v22ee71e9dcc9ca12fc313c6e1ce3f806 = true;}}if($v22ee71e9dcc9ca12fc313c6e1ce3f806 == false) {return NULL;}}return $result;}public static function getLangPrefix() {return "ru";static $vc105c08af1d0d83b729e22ecb887f52a;if(!is_null($vc105c08af1d0d83b729e22ecb887f52a)) {return $vc105c08af1d0d83b729e22ecb887f52a;}$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v851f5ac9941d720844d143ed9cfcf60a = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getPrefix();if($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() != "admin" && !defined('VIA_HTTP_SCHEME')) {return $vc105c08af1d0d83b729e22ecb887f52a = checkInterfaceLang($v851f5ac9941d720844d143ed9cfcf60a);}if (defined('VIA_HTTP_SCHEME')) {$v7552cd149af7495ee7d8225974e50f80 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentElementId();$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7552cd149af7495ee7d8225974e50f80);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceOf umiHierarchyElement) {return $vc105c08af1d0d83b729e22ecb887f52a = langsCollection::getInstance()->getLang($v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId())->getPrefix();}else {return $vc105c08af1d0d83b729e22ecb887f52a = checkInterfaceLang($v851f5ac9941d720844d143ed9cfcf60a);}}if(!is_null($vc105c08af1d0d83b729e22ecb887f52a = getArrayKey($_POST, 'ilang'))) {$vc105c08af1d0d83b729e22ecb887f52a = checkInterfaceLang($vc105c08af1d0d83b729e22ecb887f52a);setcookie('ilang', $vc105c08af1d0d83b729e22ecb887f52a, time() + 3600*24*31, '/');return $vc105c08af1d0d83b729e22ecb887f52a;}if(!is_null($vc105c08af1d0d83b729e22ecb887f52a = getArrayKey($_GET, 'ilang'))) {$vc105c08af1d0d83b729e22ecb887f52a = checkInterfaceLang($vc105c08af1d0d83b729e22ecb887f52a);setcookie('ilang', $vc105c08af1d0d83b729e22ecb887f52a, time() + 3600*24*31, '/');return $vc105c08af1d0d83b729e22ecb887f52a;}if(!is_null($vc105c08af1d0d83b729e22ecb887f52a = getCookie('ilang'))) {$vc105c08af1d0d83b729e22ecb887f52a = checkInterfaceLang($vc105c08af1d0d83b729e22ecb887f52a);setcookie('ilang', $vc105c08af1d0d83b729e22ecb887f52a, time() + 3600*24*31, '/');return $vc105c08af1d0d83b729e22ecb887f52a;}return $vc105c08af1d0d83b729e22ecb887f52a = checkInterfaceLang($v851f5ac9941d720844d143ed9cfcf60a);}public function __construct() {parent::__construct();}public function __destruct() {}protected function generateJavaScriptLabels($vd6fe1d0be6347b8ef2427fa629c04485) {$i18n = self::loadI18NFiles($vd6fe1d0be6347b8ef2427fa629c04485);$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v0ffc9ad8303afce4216f05d62289e63c = $vb1444fb0c07653567ad325aa25d4e37a->getList('//modules');foreach($v0ffc9ad8303afce4216f05d62289e63c as $v52a43e48ec4649dee819dadabcab1bde) {list($v52a43e48ec4649dee819dadabcab1bde) = $v52a43e48ec4649dee819dadabcab1bde;if (!isset($i18n['module-' . $v52a43e48ec4649dee819dadabcab1bde])) $i18n['module-' . $v52a43e48ec4649dee819dadabcab1bde] = self::getLabel('module-' . $v52a43e48ec4649dee819dadabcab1bde, $v52a43e48ec4649dee819dadabcab1bde);}$result = <<<INITJS
function getLabel(key, str) {if(setLabel.langLabels[key]) {var res = setLabel.langLabels[key];if(str) {res = res.replace(/\%s/g, str);}return res;} else {return "[" + key + "]";}}
function setLabel(key, label) {setLabel.langLabels[key] = label;}setLabel.langLabels = new Array();


INITJS;   foreach($i18n as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if(substr($v865c0c0b4ab0e063e5caa3387c1a8741, 0, 3) == "js-" || strpos($v865c0c0b4ab0e063e5caa3387c1a8741, "module-") === 0 || strpos($v865c0c0b4ab0e063e5caa3387c1a8741, "error-") === 0) {$v865c0c0b4ab0e063e5caa3387c1a8741 = self::filterOutputString($v865c0c0b4ab0e063e5caa3387c1a8741);$v9e3669d19b675bd57058fd4664205d2a = self::filterOutputString($v9e3669d19b675bd57058fd4664205d2a);$result .= "setLabel('{$v865c0c0b4ab0e063e5caa3387c1a8741}', '{$v9e3669d19b675bd57058fd4664205d2a}');\n";}}umiBaseStream::$allowTimeMark = false;return $result;}protected function filterOutputString($vb45cffe084dd3d20d928bee85e7b0f21) {$vd98a07f84921b24ee30f86fd8cd85c3c = array("\r\n", "\n", "'");$v01b6e20344b68835c5ed1ddedf20d531 = array("\\r\\n", "\\n", "\\'");$vb45cffe084dd3d20d928bee85e7b0f21 = str_replace($vd98a07f84921b24ee30f86fd8cd85c3c, $v01b6e20344b68835c5ed1ddedf20d531, $vb45cffe084dd3d20d928bee85e7b0f21);return $vb45cffe084dd3d20d928bee85e7b0f21;}protected function getExternalDTD($vd6fe1d0be6347b8ef2427fa629c04485) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v851f5ac9941d720844d143ed9cfcf60a = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getPrefix();$vcaf9b6b99962bf5c2264824231d7a40c = getPathInfo($v8b1dc169bf460ee884fceef66c6607d6->getTemplatesDirectory() . $vd6fe1d0be6347b8ef2427fa629c04485);$v811882fecd5c7618d7099ebbd39ea254 = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'dirname') . '/' . getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'filename');$v7c4f29407893c334a6cb7a87bf045c0d = getArrayKey($vcaf9b6b99962bf5c2264824231d7a40c, 'extension');$v867391a2d5bc1e52a2b08ddf5e7fb4ae = $v811882fecd5c7618d7099ebbd39ea254 . '.' . $v851f5ac9941d720844d143ed9cfcf60a . '.' . $v7c4f29407893c334a6cb7a87bf045c0d;$vf61b46d4bf30fc38e029dee2db5aa417 = $v811882fecd5c7618d7099ebbd39ea254 . '.' . $v7c4f29407893c334a6cb7a87bf045c0d;if(is_file($v867391a2d5bc1e52a2b08ddf5e7fb4ae)) {return file_get_contents($v867391a2d5bc1e52a2b08ddf5e7fb4ae);}if(is_file($vf61b46d4bf30fc38e029dee2db5aa417)) {return file_get_contents($vf61b46d4bf30fc38e029dee2db5aa417);}return '';}};class umiObjectProxy {protected $object;protected function __construct(umiObject $va8cfde6331bd59eb2ac96f8911c4b666) {$this->object = $va8cfde6331bd59eb2ac96f8911c4b666;}public function getId() {return $this->object->getId();}public function setName($vb068931cc450442b63f5b3d276ea4297) {$this->object->setName($vb068931cc450442b63f5b3d276ea4297);}public function getName() {return $this->object->getName();}public function setValue($v46b9e6004c49d9cc040029c197cab278, $v2063c1608d6e0baf80249c42e2be5804) {return $this->object->setValue($v46b9e6004c49d9cc040029c197cab278, $v2063c1608d6e0baf80249c42e2be5804);}public function getValue($v46b9e6004c49d9cc040029c197cab278) {return $this->object->getValue($v46b9e6004c49d9cc040029c197cab278);}public function isFilled() {return $this->object->isFilled();}public function getObject() {return $this->object;}public function commit() {return $this->object->commit();}public function delete() {$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();return $v5891da2d64975cae48d175d1e001f5da->delObject($this->getId());}public function __get($v23a5b8ab834cb5140fa6665622eb6417) {switch($v23a5b8ab834cb5140fa6665622eb6417) {case 'id':  return $this->getId();case 'name': return $this->getName();default:  return $this->getValue($v23a5b8ab834cb5140fa6665622eb6417);}}public function __set($v23a5b8ab834cb5140fa6665622eb6417, $v2063c1608d6e0baf80249c42e2be5804) {switch($v23a5b8ab834cb5140fa6665622eb6417) {case 'name': return $this->setName($v2063c1608d6e0baf80249c42e2be5804);default:  return $this->setValue($v23a5b8ab834cb5140fa6665622eb6417, $v2063c1608d6e0baf80249c42e2be5804);}}public function __destruct() {$this->object->commit();}};interface iUmiObjectsExpiration {public function run();public function add($v16b2b26000987faccb260b9d39df1269, $v018e77635d40709feb0c09c6fb84ee00 = false);public function update($v16b2b26000987faccb260b9d39df1269, $v018e77635d40709feb0c09c6fb84ee00 = false);public function clear($v16b2b26000987faccb260b9d39df1269);};class umiObjectsExpiration extends singleton implements iSingleton, iUmiObjectsExpiration {protected $defaultExpires = 86400;protected function __construct() {}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {return parent::getInstance(__CLASS__);}public function isExpirationExists($v16b2b26000987faccb260b9d39df1269) {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
			SELECT
				`obj_id`
			FROM
				`cms3_objects_expiration`
			WHERE
				`obj_id` = {$v16b2b26000987faccb260b9d39df1269}
			LIMIT 1
SQL;   $v9b207167e5381c47682c6b4f58a623fb = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return mysql_num_rows($v9b207167e5381c47682c6b4f58a623fb) > 0;}public function getExpiredObjectsByTypeId($v5f694956811487225d15e973ca38fbab, $vaa9f73eea60a006820d0f8768bc8a3fc = 50) {$v07cc694b9b3fc636710fa08b6922c42b = time();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
			SELECT
				`obj_id`
			FROM
				`cms3_objects_expiration`
			WHERE
				`obj_id`  IN (
					SELECT
						`id`
					FROM
						`cms3_objects`
					WHERE
						`type_id`='{$v5f694956811487225d15e973ca38fbab}'
					)
				AND (`entrytime` +  `expire`) <= {$v07cc694b9b3fc636710fa08b6922c42b}
			ORDER BY (`entrytime` +  `expire`)
			LIMIT {$vaa9f73eea60a006820d0f8768bc8a3fc}
SQL;   $result = array();$v9b207167e5381c47682c6b4f58a623fb = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if (mysql_numrows($v9b207167e5381c47682c6b4f58a623fb) > 0) {while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_assoc($v9b207167e5381c47682c6b4f58a623fb)) {$result[] = $vf1965a857bc285d26fe22023aa5ab50d['obj_id'];}}return $result;}public function run() {return;$v07cc694b9b3fc636710fa08b6922c42b = time();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
DELETE FROM `cms3_objects`
	WHERE `id` IN (
		SELECT `obj_id`
			FROM `cms3_objects_expiration`
				WHERE (`entrytime` + `expire`) >= '{$v07cc694b9b3fc636710fa08b6922c42b}'
	)
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}public function update($v16b2b26000987faccb260b9d39df1269, $v09bcb72d61c0d6d1eff5336da6881557 = false) {if($v09bcb72d61c0d6d1eff5336da6881557 == false) {$v09bcb72d61c0d6d1eff5336da6881557 = $this->defaultExpires;}$v16b2b26000987faccb260b9d39df1269 = (int) $v16b2b26000987faccb260b9d39df1269;$v09bcb72d61c0d6d1eff5336da6881557 = (int) $v09bcb72d61c0d6d1eff5336da6881557;$v07cc694b9b3fc636710fa08b6922c42b = time();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
			UPDATE
				`cms3_objects_expiration`
			SET
				`entrytime`='{$v07cc694b9b3fc636710fa08b6922c42b}',
				`expire`='{$v09bcb72d61c0d6d1eff5336da6881557}'
			WHERE
				`obj_id` = '{$v16b2b26000987faccb260b9d39df1269}'
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}public function add($v16b2b26000987faccb260b9d39df1269, $v09bcb72d61c0d6d1eff5336da6881557 = false) {if($v09bcb72d61c0d6d1eff5336da6881557 == false) {$v09bcb72d61c0d6d1eff5336da6881557 = $this->defaultExpires;}$v16b2b26000987faccb260b9d39df1269 = (int) $v16b2b26000987faccb260b9d39df1269;$v09bcb72d61c0d6d1eff5336da6881557 = (int) $v09bcb72d61c0d6d1eff5336da6881557;$v07cc694b9b3fc636710fa08b6922c42b = time();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO `cms3_objects_expiration`
	(`obj_id`, `entrytime`, `expire`)
		VALUES ('{$v16b2b26000987faccb260b9d39df1269}', '{$v07cc694b9b3fc636710fa08b6922c42b}', '{$v09bcb72d61c0d6d1eff5336da6881557}')
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}public function clear($v16b2b26000987faccb260b9d39df1269) {$v16b2b26000987faccb260b9d39df1269 = (int) $v16b2b26000987faccb260b9d39df1269;$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
DELETE FROM `cms3_objects_expiration`
	WHERE `obj_id` = '{$v16b2b26000987faccb260b9d39df1269}'
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}};class HTTPOutputBuffer extends outputBuffer {protected   $cleanEipAttributes = false,   $charset  = 'utf-8',   $contentType = 'text/html',   $headers  = array(),   $headersSended = false,   $status   = '200 Ok',   $options  = array(    'compression' => true,    'quick-edit' => true,    'generation-time' => true,    'send-stat-id' => true   );public function __construct() {showWorkTime("buffer construct start",2);parent::__construct();showWorkTime("buffer before session start",2);$v21d6f40cfb511982e4424e0e250a9557 = session::getInstance();$v42fa7968ffb6a9c6b86b77657ff2d176 = $v21d6f40cfb511982e4424e0e250a9557->get("user_is_sv");if ($v42fa7968ffb6a9c6b86b77657ff2d176 && $v21d6f40cfb511982e4424e0e250a9557->isValid()) {$v21d6f40cfb511982e4424e0e250a9557->setValid();}elseif($v42fa7968ffb6a9c6b86b77657ff2d176) {session::recreateInstance(true);}showWorkTime("buffer after session start",2);$this->checkHTTPAuth();showWorkTime("buffer construct end",2);}public function send() {$this->sendHeaders();echo $this->buffer;$this->clear();}public function status($v9acb44549b41563697bb490144ec6258 = false) {if($v9acb44549b41563697bb490144ec6258) $this->status = $v9acb44549b41563697bb490144ec6258;return $this->status;}public function charset($vdbd153490a1c3720a970a611afc4371c = false) {if($vdbd153490a1c3720a970a611afc4371c) $this->charset = $vdbd153490a1c3720a970a611afc4371c;return $this->charset;}public function contentType($vdf5feafab86601ea0e1e6fe6e20df6c5 = false) {if($vdf5feafab86601ea0e1e6fe6e20df6c5) $this->contentType = $vdf5feafab86601ea0e1e6fe6e20df6c5;return $this->contentType;}public function getHTTPRequestBody() {$v7397e0741c9ce2781444c8afea22005c = fopen("php://input", "r");$v8d777f385d3dfec8815d20f7496026dc = "";while (!feof($v7397e0741c9ce2781444c8afea22005c)) {$v8d777f385d3dfec8815d20f7496026dc .= fread($v7397e0741c9ce2781444c8afea22005c, 1024);}fclose($v7397e0741c9ce2781444c8afea22005c);return $v8d777f385d3dfec8815d20f7496026dc;}public function sendHeaders() {if($this->headersSended) {return true;}else if (headers_sent()) {return false;}if($this->status != '404 Not Found' and CALC_LAST_MODIFIED) $this->sendLastModified();$this->sendStatusHeader();$this->sendDefaultHeaders();foreach($this->headers as $v099fb995346f31c749f6e40db0f395e3 => $v2063c1608d6e0baf80249c42e2be5804) {$this->sendHeader($v099fb995346f31c749f6e40db0f395e3, $v2063c1608d6e0baf80249c42e2be5804);}$this->headersSended = true;}public function end() {if(!DEBUG) @ob_clean();if(getArrayKey($this->options, 'quick-edit')) {umiTemplater::prepareQuickEdit();}if(CALC_E_TAG) $this->sendETag();$this->push($this->getCallTime());$this->send();session_write_close();exit;}public function option($v3c6e0b8a9c15224a8228b9a98ca1531d, $v2063c1608d6e0baf80249c42e2be5804 = null) {if(is_null($v2063c1608d6e0baf80249c42e2be5804)) {return isset($this->options[$v3c6e0b8a9c15224a8228b9a98ca1531d]) ? $this->options[$v3c6e0b8a9c15224a8228b9a98ca1531d] : null;}else $this->options[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v2063c1608d6e0baf80249c42e2be5804;}public static function checkUrlSecurity($v572d4e421e5e6b9bc11d815e8a027112) {return stripos($v572d4e421e5e6b9bc11d815e8a027112, "javascript:") === false && stripos($v572d4e421e5e6b9bc11d815e8a027112, "data:") === false && !preg_match('/^\/{2,}/i', $v572d4e421e5e6b9bc11d815e8a027112);}public function redirect($v572d4e421e5e6b9bc11d815e8a027112, $v15e03a651c4771934c90043c22e736ac = '301 Moved Permanently', $vafc83e97f17c79ad582675c662b8ee16 = 301) {$vba7d756f209f3da15d6fdf4de0b50c94 = 0;while (ob_get_level() && $vba7d756f209f3da15d6fdf4de0b50c94++ < 5) {@ob_end_clean();}$v572d4e421e5e6b9bc11d815e8a027112 = urldecode($v572d4e421e5e6b9bc11d815e8a027112);if (!self::checkUrlSecurity($v572d4e421e5e6b9bc11d815e8a027112)) {$this->status = "400 Bad Request";$this->sendStatusHeader();flush();exit('');}$this->status = $v15e03a651c4771934c90043c22e736ac;$this->sendStatusHeader();$vbef65933acbed511ed4f607e97852f2b = parse_url($v572d4e421e5e6b9bc11d815e8a027112);if (!isset($vbef65933acbed511ed4f607e97852f2b['scheme']) && !isset($vbef65933acbed511ed4f607e97852f2b['host'])) $v572d4e421e5e6b9bc11d815e8a027112 = "/" . ltrim($v572d4e421e5e6b9bc11d815e8a027112, "/");header('Location: ' . $v572d4e421e5e6b9bc11d815e8a027112, true, $vafc83e97f17c79ad582675c662b8ee16);flush();exit('');}public function header($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804 = false) {if($v2063c1608d6e0baf80249c42e2be5804 === false) {unset($this->headers[$vb068931cc450442b63f5b3d276ea4297]);return NULL;}else {return $this->headers[$vb068931cc450442b63f5b3d276ea4297] = $v2063c1608d6e0baf80249c42e2be5804;}}protected function checkHTTPAuth() {$vd56b699830e77ba53855679cb1d252da = getServer('PHP_AUTH_USER');$v5f4dcc3b5aa765d61d8327deb882cf99 = getServer('PHP_AUTH_PW');if (!$vd56b699830e77ba53855679cb1d252da && !$v5f4dcc3b5aa765d61d8327deb882cf99 && $va71c5565961982e6d4f22d940d7f9a1e = getRequest('umi_authorization')) {$va71c5565961982e6d4f22d940d7f9a1e = explode(':', base64_decode(substr($va71c5565961982e6d4f22d940d7f9a1e, 6)));if (count($va71c5565961982e6d4f22d940d7f9a1e) == 2) {list($vd56b699830e77ba53855679cb1d252da, $v5f4dcc3b5aa765d61d8327deb882cf99) = $va71c5565961982e6d4f22d940d7f9a1e;}}if($vd56b699830e77ba53855679cb1d252da && $v5f4dcc3b5aa765d61d8327deb882cf99) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();if($v41275a535677f79ff347e01bc530c176->isAuth() == false) {if($vee11cbb19052e40b07aac0ca060c23ee = $v41275a535677f79ff347e01bc530c176->checkLogin($vd56b699830e77ba53855679cb1d252da, $v5f4dcc3b5aa765d61d8327deb882cf99)) {$v41275a535677f79ff347e01bc530c176->loginAsUser($vee11cbb19052e40b07aac0ca060c23ee->getId());}else {$this->clear();$this->status('401 Unauthorized');$this->header('WWW-Authenticate: Basic realm="UMI.CMS"');$this->push('HTTP Authenticate failed');$this->end();}}}}protected function sendStatusHeader() {header("HTTP/1.1 " . $this->status);if((int)mainConfiguration::getInstance()->get("kernel", "send-additional-status-header")) {header("Status: " . $this->status, true);}}public function length() {ob_start();echo $this->buffer;$vf7bd60b75b29d79b660a2859395c1a24 = ob_get_length();ob_end_clean();return $vf7bd60b75b29d79b660a2859395c1a24;}protected function sendDefaultHeaders() {$this->sendHeader('Content-type', $this->contentType . '; charset=' . $this->charset);$v2fa47f7c65fec19cc163b195725e3844 = $this->length();if ($v2fa47f7c65fec19cc163b195725e3844) {$this->sendHeader('Content-length', $v2fa47f7c65fec19cc163b195725e3844);}$this->sendHeader('Date', (gmdate("D, d M Y H:i:s") . " GMT"));$this->sendHeader('X-Generated-By', 'UMI.CMS');if (strpos(getServer('HTTP_USER_AGENT'), 'MSIE')) {$this->sendHeader('X-UA-Compatible', 'IE=edge');}$v2af72f100c356273d46284f6fd1dfc08 = regedit::getInstance()->getVal("//modules/autoupdate/system_version");$this->sendHeader('X-CMS-Version', $v2af72f100c356273d46284f6fd1dfc08);if(stristr(getServer('HTTP_USER_AGENT'), 'msie')) {$this->sendHeader('Cache-Control', 'no-store, no-cache, must-revalidate');$this->sendHeader('Pragma', 'no-cache');$this->sendHeader('Expires', gmdate('D, d M Y H:i:s') . ' GMT');$this->sendHeader('X-XSS-Protection', '0');}else {$this->sendHeader('Cache-Control', 'max-age=3600, private, must-revalidate');}if($this->option('send-stat-id')) {if (!getCookie('stat_id')) {setcookie('stat_id', session_id(), strtotime('+10 years'), "/");}}}protected function sendHeader($v099fb995346f31c749f6e40db0f395e3, $v2063c1608d6e0baf80249c42e2be5804) {header("{$v099fb995346f31c749f6e40db0f395e3}: {$v2063c1608d6e0baf80249c42e2be5804}");}protected function sendETag() {$this->sendHeader('E-tag', sha1($this->content()));}protected function sendLastModified() {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v5fa40b2485d1096a170d2d7ecd0f7030 = $vb81ca7c0ccaa77e7aa91936ab0070695->getElementsLastUpdateTime();if($v5fa40b2485d1096a170d2d7ecd0f7030) {$this->sendHeader('Last-Modified', (gmdate('D, d M Y H:i:s', $v5fa40b2485d1096a170d2d7ecd0f7030) . ' GMT'));$this->sendHeader('Expires', (gmdate('D, d M Y H:i:s', time() + 24 * 3600) . ' GMT'));if(function_exists("apache_request_headers")) {$v10573b873d2fa5a365d558a45e328e47 = apache_request_headers();if(isset($v10573b873d2fa5a365d558a45e328e47['If-Modified-Since']) && (strtotime($v10573b873d2fa5a365d558a45e328e47['If-Modified-Since']) >= ($v5fa40b2485d1096a170d2d7ecd0f7030) )) {$this->status('304 Not Modified');$this->sendHeader('Connection',  'close');}}}}protected function getCallTime() {$v6b65583eced7f2bc21d80ba0fc82066a = round(microtime(true) - $this->invokeTime, 6);$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$v500926d0e2f1fd46a82272d2a9b11627 = (string) $v2245023265ae4cf87d02c8b6ba991139->get('kernel', 'show-generate-time');if (!$this->option('generation-time') || $v500926d0e2f1fd46a82272d2a9b11627 === "0") {return;}$v30fbafbb765afb6552e512877a217fc6 = '';$v36750de19bed237506726986ae09e0c9 = parent::contentGenerator();if (is_string($v36750de19bed237506726986ae09e0c9) && strlen($v36750de19bed237506726986ae09e0c9)) {$v30fbafbb765afb6552e512877a217fc6 = ' by ' . $v36750de19bed237506726986ae09e0c9;}switch($this->contentType) {case 'text/html':    case 'text/xml':     return "<!-- This page generated in {$v6b65583eced7f2bc21d80ba0fc82066a} secs{$v30fbafbb765afb6552e512877a217fc6} -->";case 'application/javascript':    case 'text/javascript':     return "/* This page generated in {$v6b65583eced7f2bc21d80ba0fc82066a} secs{$v30fbafbb765afb6552e512877a217fc6} */";default: "";}}}class CLIOutputBuffer extends outputBuffer {public function send() {echo $this->buffer;$this->clear();}};abstract class objectProxyHelper {public static function getClassPrefixByType($v16b2b26000987faccb260b9d39df1269) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();if(isset($v0fea6a13c52b4d4725368f24b045ca84[$v16b2b26000987faccb260b9d39df1269])) {return $v0fea6a13c52b4d4725368f24b045ca84[$v16b2b26000987faccb260b9d39df1269];}$v6f65638723a69dfa99474478b83b7b17 = '';$va8cfde6331bd59eb2ac96f8911c4b666 = selector::get('object')->id($v16b2b26000987faccb260b9d39df1269);if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof iUmiObject) {if($va8cfde6331bd59eb2ac96f8911c4b666->class_name) {$v6f65638723a69dfa99474478b83b7b17 = $va8cfde6331bd59eb2ac96f8911c4b666->class_name;}}else {throw new coreException("Can't get class name prefix from object #{$v16b2b26000987faccb260b9d39df1269}");}return $v0fea6a13c52b4d4725368f24b045ca84[$v16b2b26000987faccb260b9d39df1269] = $v6f65638723a69dfa99474478b83b7b17;}public static function includeClass($vcd3fff114c1e7ae001e9f0e995a21bc7, $v6f65638723a69dfa99474478b83b7b17) {static $v99f78c54130e752954404fff0707dcbd = array();if(in_array($vcd3fff114c1e7ae001e9f0e995a21bc7 . $v6f65638723a69dfa99474478b83b7b17, $v99f78c54130e752954404fff0707dcbd)) {return;}else {$v99f78c54130e752954404fff0707dcbd[] = $vcd3fff114c1e7ae001e9f0e995a21bc7 . $v6f65638723a69dfa99474478b83b7b17;}$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$v47826cacc65c665212b821e6ff80b9b0 = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.default-module') . $vcd3fff114c1e7ae001e9f0e995a21bc7 . $v6f65638723a69dfa99474478b83b7b17 . '.php';if(is_file($v47826cacc65c665212b821e6ff80b9b0) == false) {throw new coreException("Required source file {$v47826cacc65c665212b821e6ff80b9b0} is not found");}require $v47826cacc65c665212b821e6ff80b9b0;}};class selector implements IteratorAggregate {protected   $mode, $permissions = null, $limit, $offset,   $types = array(), $hierarchy = array(),   $whereFieldProps = array(), $whereSysProps = array(),   $orderSysProps = array(), $orderFieldProps = array(),   $groupSysProps = array(), $groupFieldProps = array(),   $executor, $result = null, $length = null,   $options = array();protected static   $modes = array('objects', 'pages'),   $sysPagesWhereFields = array('id', 'name', 'owner', 'domain', 'lang', 'is_deleted',    'is_active', 'is_visible', 'updatetime', 'is_default', 'template_id', '*'),   $sysObjectsWhereFields = array('id', 'name', 'owner', 'guid', '*'),   $sysPagesGroupFields = array('name', 'owner', 'domain', 'lang', 'is_deleted',    'is_active', 'is_visible', 'updatetime', 'is_default', 'template_id'),   $sysObjectsGroupFields = array('name', 'owner', 'guid'),   $sysOrderFields = array('name', 'ord', 'rand', 'updatetime', 'id');protected function checkExecuted() {if($this->executor && $this->executor->getSkipExecutedCheckState()) return;if(!is_null($this->result) || !is_null($this->length)) {throw new selectorException("Selector has been already executed. You should create new one or use selector::flush() method instead.");}}protected function executor() {if(!$this->executor) $this->executor = new selectorExecutor($this);return $this->executor;}protected function unloadExecutor() {if(!is_null($this->length) && !is_null($this->result)) {unset($this->executor);}}protected function setMode($v15d61712450a686a7f365adf4fef581f) {if(in_array($v15d61712450a686a7f365adf4fef581f, self::$modes)) {$this->mode = $v15d61712450a686a7f365adf4fef581f;if($v15d61712450a686a7f365adf4fef581f == 'pages') {$this->setDefaultPagesWhere();}}else {throw new selectorException(     "This mode \"{$v15d61712450a686a7f365adf4fef581f}\" is not supported, choose one of these: " . implode(', ', self::$modes)    );}}protected function setDefaultPagesWhere () {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$this->where('domain')->equals($v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain());$this->where('lang')->equals($v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang());$this->where('is_deleted')->equals(0);if($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() != 'admin') {$this->where('is_active')->equals(1);}}public static function get($v9c32b08fe4f1100357be3cefc37fb591) {return new selectorGetter($v9c32b08fe4f1100357be3cefc37fb591);}public function __construct($v15d61712450a686a7f365adf4fef581f) {$this->setMode($v15d61712450a686a7f365adf4fef581f);}public function types($v2dda916891cbd0bf046213df34800783 = false) {$this->checkExecuted();if($v2dda916891cbd0bf046213df34800783 === false)    return $this->types;else    return $this->types[] = new selectorType($v2dda916891cbd0bf046213df34800783, $this);}public function where($v972bf3f05d14ffbdb817bef60638ff00) {$this->checkExecuted();if($v972bf3f05d14ffbdb817bef60638ff00 == 'hierarchy') {if($this->mode == 'objects')     throw new selectorException("Hierarchy filter is not suitable for \"objects\" selector mode");return $this->hierarchy[] = new selectorWhereHierarchy;}if($v972bf3f05d14ffbdb817bef60638ff00 == 'permissions') {if($this->mode == 'objects')     throw new selectorException("Permissions filter is not suitable for \"objects\" selector mode");if(is_null($this->permissions)) $this->permissions = new selectorWherePermissions;return $this->permissions;}if(in_array($v972bf3f05d14ffbdb817bef60638ff00, ($this->mode == 'pages') ? self::$sysPagesWhereFields : self::$sysObjectsWhereFields)) {return $this->whereSysProps[$v972bf3f05d14ffbdb817bef60638ff00] = new selectorWhereSysProp($v972bf3f05d14ffbdb817bef60638ff00);}else {$v945100186b119048837b9859c2c46410 = $this->searchField($v972bf3f05d14ffbdb817bef60638ff00);if($v945100186b119048837b9859c2c46410) {return $this->whereFieldProps[] = new selectorWhereFieldProp($v945100186b119048837b9859c2c46410);}else {throw new selectorException("Field \"{$v972bf3f05d14ffbdb817bef60638ff00}\" is not presented in selected object types");}}}public function order($v972bf3f05d14ffbdb817bef60638ff00) {$this->checkExecuted();if(in_array($v972bf3f05d14ffbdb817bef60638ff00, self::$sysOrderFields)) {return $this->orderSysProps[] = new selectorOrderSysProp($v972bf3f05d14ffbdb817bef60638ff00);}else {$v945100186b119048837b9859c2c46410 = $this->searchField($v972bf3f05d14ffbdb817bef60638ff00);if($v945100186b119048837b9859c2c46410) {return $this->orderFieldProps[] = new selectorOrderFieldProp($v945100186b119048837b9859c2c46410);}else {throw new selectorException("Field \"{$v972bf3f05d14ffbdb817bef60638ff00}\" is not presented in selected object types");}}}public function group($v972bf3f05d14ffbdb817bef60638ff00) {$this->checkExecuted();if(in_array($v972bf3f05d14ffbdb817bef60638ff00, ($this->mode == 'pages') ? self::$sysPagesGroupFields : self::$sysObjectsGroupFields)) {return $this->groupSysProps[] = new selectorGroupSysProp($v972bf3f05d14ffbdb817bef60638ff00);}else {$v945100186b119048837b9859c2c46410 = $this->searchField($v972bf3f05d14ffbdb817bef60638ff00);if($v945100186b119048837b9859c2c46410) {return $this->groupFieldProps[] = new selectorGroupFieldProp($v945100186b119048837b9859c2c46410);}else {throw new selectorException("Field \"{$v972bf3f05d14ffbdb817bef60638ff00}\" is not presented in selected object types");}}}public function limit($v7a86c157ee9713c34fbd7a1ee40f0c5a, $vaa9f73eea60a006820d0f8768bc8a3fc) {$this->checkExecuted();$this->limit = (int) $vaa9f73eea60a006820d0f8768bc8a3fc;$this->offset = (int) $v7a86c157ee9713c34fbd7a1ee40f0c5a;}public function result() {if(is_null($this->result)) {if($this->mode == 'pages') {if(sizeof($this->orderSysProps) == 0) $this->order('ord')->asc();if(is_null($this->permissions)) $this->where('permissions');}$ve70c4df10ef0983b9c8c31bd06b2a2c3 = $this->option('return')->value;if (is_array($ve70c4df10ef0983b9c8c31bd06b2a2c3) && in_array('count', $ve70c4df10ef0983b9c8c31bd06b2a2c3)) {$this->result = $this->executor()->length();}else $this->result = $this->executor()->result();$this->length = $this->executor()->length();}$this->unloadExecutor();return $this->result;}public function length() {if(is_null($this->length)) {if($this->mode == 'pages' && is_null($this->permissions)) {$this->where('permissions');}$v2fa47f7c65fec19cc163b195725e3844 = $this->executor()->length();if (in_array('count', $this->option('return')->value)) {$this->result = $v2fa47f7c65fec19cc163b195725e3844;}else $this->result = $this->executor()->result();$this->length = $v2fa47f7c65fec19cc163b195725e3844;}$this->unloadExecutor();return $this->length;}public function option($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804 = null) {$this->checkExecuted();if (!isset($this->options[$vb068931cc450442b63f5b3d276ea4297])) {$ved94a6ed342e92fe771ebe903685f5c8 = new selectorOption($vb068931cc450442b63f5b3d276ea4297);$this->options[$vb068931cc450442b63f5b3d276ea4297] = $ved94a6ed342e92fe771ebe903685f5c8;}if (!is_null($v2063c1608d6e0baf80249c42e2be5804)) $this->options[$vb068931cc450442b63f5b3d276ea4297]->value($v2063c1608d6e0baf80249c42e2be5804);return $this->options[$vb068931cc450442b63f5b3d276ea4297];}public function flush() {$this->result = null;$this->length = null;}public function __get($v23a5b8ab834cb5140fa6665622eb6417) {switch($v23a5b8ab834cb5140fa6665622eb6417) {case 'length':    case 'total':     return $this->length();case 'result':     return $this->result();case 'first':     return (sizeof($this->result())) ? $this->result[0] : null;case 'last':     return (sizeof($this->result())) ? $this->result[sizeof($this->result) - 1] : null;}$v48f492cfc4344663d5a15ab0d2025226 = array('mode', 'offset', 'limit', 'whereFieldProps', 'orderFieldProps', 'groupFieldProps',    'whereSysProps', 'orderSysProps', 'groupSysProps', 'types', 'permissions', 'hierarchy', 'options');if(in_array($v23a5b8ab834cb5140fa6665622eb6417, $v48f492cfc4344663d5a15ab0d2025226)) {return $this->$v23a5b8ab834cb5140fa6665622eb6417;}}public function getIterator() {$this->result();return new ArrayIterator($this->result);}public function query() {if($this->mode == 'pages') {if(sizeof($this->orderSysProps) == 0) $this->order('ord')->asc();if(is_null($this->permissions)) $this->where('permissions');}return $this->executor()->query();}public function searchField($v972bf3f05d14ffbdb817bef60638ff00) {foreach($this->types as $v599dcce2998a6b40b1e38e8c6006cb0a) {$v945100186b119048837b9859c2c46410 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($v972bf3f05d14ffbdb817bef60638ff00);if($v945100186b119048837b9859c2c46410) return $v945100186b119048837b9859c2c46410;}if($this->mode == 'pages') {$vd14a8022b085f9ef19d479cbdd581127 = umiObjectTypesCollection::getInstance();$v599dcce2998a6b40b1e38e8c6006cb0a = $vd14a8022b085f9ef19d479cbdd581127->getTypeByGUID('root-pages-type');$v945100186b119048837b9859c2c46410 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($v972bf3f05d14ffbdb817bef60638ff00);if($v945100186b119048837b9859c2c46410) return $v945100186b119048837b9859c2c46410;}}};abstract class selectorWhereProp {protected $value, $mode,  $modes = array('equals', 'notequals', 'ilike', 'like', 'more', 'eqmore', 'less', 'eqless', 'between', 'isnull', 'isnotnull');public function __call($vea9f6aca279138c58f705c8d4cb4b8ce, $args) {$vea9f6aca279138c58f705c8d4cb4b8ce = strtolower($vea9f6aca279138c58f705c8d4cb4b8ce);if(in_array($vea9f6aca279138c58f705c8d4cb4b8ce, $this->modes)) {$v2063c1608d6e0baf80249c42e2be5804 = sizeof($args) ? $args[0] : null;if($v2063c1608d6e0baf80249c42e2be5804 instanceof iUmiEntinty) {$v2063c1608d6e0baf80249c42e2be5804 = $v2063c1608d6e0baf80249c42e2be5804->getId();}if(isset($this->fieldId)) {$v06e3d36fa30cea095545139854ad1fb9 = selector::get('field')->id($this->fieldId);if($v6b1a57fa235477758817df3c91158006 = $v06e3d36fa30cea095545139854ad1fb9->getRestrictionId()) {$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v6b1a57fa235477758817df3c91158006);if($v3dadfaeb46ec74762b37de11fea7605c instanceof iNormalizeInRestriction) {$v2063c1608d6e0baf80249c42e2be5804 = $v3dadfaeb46ec74762b37de11fea7605c->normalizeIn($v2063c1608d6e0baf80249c42e2be5804);}}if(is_numeric($v2063c1608d6e0baf80249c42e2be5804) && substr($v2063c1608d6e0baf80249c42e2be5804, 0, 1) !== "0") {$v2063c1608d6e0baf80249c42e2be5804 = (double) $v2063c1608d6e0baf80249c42e2be5804;}if($v06e3d36fa30cea095545139854ad1fb9->getDataType() == 'relation' && is_string($v2063c1608d6e0baf80249c42e2be5804)) {if($v52eb29c6d8ea0d3a5bb3654f49bbd7c7 = $v06e3d36fa30cea095545139854ad1fb9->getGuideId()) {$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('objects');$v8be74552df93e31bbdd6b36ed74bdb6a->types('object-type')->id($v52eb29c6d8ea0d3a5bb3654f49bbd7c7);$v8be74552df93e31bbdd6b36ed74bdb6a->where('*')->ilike($v2063c1608d6e0baf80249c42e2be5804);$v2fa47f7c65fec19cc163b195725e3844 = sizeof($v8be74552df93e31bbdd6b36ed74bdb6a->result);if($v2fa47f7c65fec19cc163b195725e3844 > 0 && $v2fa47f7c65fec19cc163b195725e3844 < 100) {$v2063c1608d6e0baf80249c42e2be5804 = $v8be74552df93e31bbdd6b36ed74bdb6a->result;}}}if($v06e3d36fa30cea095545139854ad1fb9->getDataType() == 'date' && is_string($v2063c1608d6e0baf80249c42e2be5804)) {$v5fc732311905cb27e82d67f4f6511f7f = new umiDate;$v5fc732311905cb27e82d67f4f6511f7f->setDateByString(trim($v2063c1608d6e0baf80249c42e2be5804, ' %'));$v2063c1608d6e0baf80249c42e2be5804 = $v5fc732311905cb27e82d67f4f6511f7f->getDateTimeStamp();}}$this->value = $v2063c1608d6e0baf80249c42e2be5804;$this->mode = $vea9f6aca279138c58f705c8d4cb4b8ce;}else {throw new selectorException("This property doesn't support \"{$vea9f6aca279138c58f705c8d4cb4b8ce}\" method");}}public function between($vea2b2676c28c0db26d39331a336c6b92, $v7f021a1415b86f2d013b2618fb31ae53) {return $this->__call('between', array(array($vea2b2676c28c0db26d39331a336c6b92, $v7f021a1415b86f2d013b2618fb31ae53)));}public function __get($v23a5b8ab834cb5140fa6665622eb6417) {return $this->$v23a5b8ab834cb5140fa6665622eb6417;}};class selectorWhereSysProp extends selectorWhereProp {protected $name;public function __construct($vb068931cc450442b63f5b3d276ea4297) {$this->name = $vb068931cc450442b63f5b3d276ea4297;}};class selectorWhereFieldProp extends selectorWhereProp {protected $fieldId;public function __construct($v945100186b119048837b9859c2c46410) {$this->fieldId = $v945100186b119048837b9859c2c46410;}};class selectorWhereHierarchy {protected $elementId, $level = 1, $selfLevel;public function page($v7552cd149af7495ee7d8225974e50f80)  {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();if(is_numeric($v7552cd149af7495ee7d8225974e50f80) == false) {$v7552cd149af7495ee7d8225974e50f80 = $vb81ca7c0ccaa77e7aa91936ab0070695->getIdByPath($v7552cd149af7495ee7d8225974e50f80);}if($v7552cd149af7495ee7d8225974e50f80 !== false) {$this->elementId = (int) $v7552cd149af7495ee7d8225974e50f80;}return $this;}public function childs($vc9e9a848920877e76685b2e4e76de38d = 1) {if(is_null($this->selfLevel)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT level FROM cms3_hierarchy_relations WHERE child_id = {$this->elementId}";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);list($this->selfLevel) = mysql_fetch_row($result);}$this->level = ($vc9e9a848920877e76685b2e4e76de38d == 0) ? 0 : (int) $vc9e9a848920877e76685b2e4e76de38d + (int) $this->selfLevel;}public function __get($v23a5b8ab834cb5140fa6665622eb6417) {return $this->$v23a5b8ab834cb5140fa6665622eb6417;}};class selectorWherePermissions {protected $level = 0x1, $owners = array(), $isSv;public function __construct() {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $v41275a535677f79ff347e01bc530c176->getUserId();$this->isSv = $v41275a535677f79ff347e01bc530c176->isSv();if(!$this->isSv) {$this->owners = array($v8e44f0089b076e18a718eb9ca3d94674);$vee11cbb19052e40b07aac0ca060c23ee = umiObjectsCollection::getInstance()->getObject($v8e44f0089b076e18a718eb9ca3d94674);if($vee11cbb19052e40b07aac0ca060c23ee) {$this->owners = array_merge($this->owners, $vee11cbb19052e40b07aac0ca060c23ee->groups);}}}public function level($vc9e9a848920877e76685b2e4e76de38d) {$this->level = (int) $vc9e9a848920877e76685b2e4e76de38d;}public function owners($vb132392a317588e56460e77a8fd74229) {if(is_array($vb132392a317588e56460e77a8fd74229)) {foreach($vb132392a317588e56460e77a8fd74229 as $v72122ce96bfec66e2396d2e25225d70a) $this->owners($v72122ce96bfec66e2396d2e25225d70a);}else {$this->addOwner($vb132392a317588e56460e77a8fd74229);}return $this;}public function __get($v23a5b8ab834cb5140fa6665622eb6417) {return $this->$v23a5b8ab834cb5140fa6665622eb6417;}protected function addOwner($vb0ab4f7791b60b1e8ea01057b77873b0) {if(in_array($vb0ab4f7791b60b1e8ea01057b77873b0, $this->owners)) return;$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$va8cfde6331bd59eb2ac96f8911c4b666 = $v5891da2d64975cae48d175d1e001f5da->getObject($vb0ab4f7791b60b1e8ea01057b77873b0);if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof iUmiObject) {if($v41275a535677f79ff347e01bc530c176->isSv($vb0ab4f7791b60b1e8ea01057b77873b0)) {$this->isSv = true;return;}$this->owners[] = $vb0ab4f7791b60b1e8ea01057b77873b0;if($va8cfde6331bd59eb2ac96f8911c4b666->groups) {$this->owners = array_merge($this->owners, $va8cfde6331bd59eb2ac96f8911c4b666->groups);}}}};class selectorType {protected $typeClass, $objectType, $hierarchyType, $selector;protected static $typeClasses = array('object-type', 'hierarchy-type');public function __construct($v2dda916891cbd0bf046213df34800783, $v5b3c32009797feb79096d52e56a56b82) {$this->setTypeClass($v2dda916891cbd0bf046213df34800783);$this->selector = $v5b3c32009797feb79096d52e56a56b82;}public function name($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce) {if(!$vea9f6aca279138c58f705c8d4cb4b8ce && $v22884db148f0ffb0d830ba431102b0b5 == 'content') $vea9f6aca279138c58f705c8d4cb4b8ce = 'page';switch($this->typeClass) {case 'object-type': {$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$v6301cee35ea764a1e241978f93f01069 = $v0e8133eb006c0f85ed9444ae07a60842->getBaseType($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);return $this->setObjectType($v0e8133eb006c0f85ed9444ae07a60842->getType($v6301cee35ea764a1e241978f93f01069));}case 'hierarchy-type': {$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();$v89b0b9deff65f8b9cd1f71bc74ce36ba = $v6942e8fa62b3cc9d93881a58210e2fd7->getTypeByName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);return $this->setHierarchyType($v89b0b9deff65f8b9cd1f71bc74ce36ba);}}}public function id($vb80bb7740288fda1f201890375a60c8f) {if(is_array($vb80bb7740288fda1f201890375a60c8f)) {$result = null;foreach($vb80bb7740288fda1f201890375a60c8f as $vb5210062221c584573e8e554dfcfd026) {$this->selector->types($this->typeClass)->id($vb5210062221c584573e8e554dfcfd026);}return $result;}switch($this->typeClass) {case 'object-type': {$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();return $this->setObjectType($v0e8133eb006c0f85ed9444ae07a60842->getType($vb80bb7740288fda1f201890375a60c8f));}case 'hierarchy-type': {$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();return $this->setHierarchyType($v6942e8fa62b3cc9d93881a58210e2fd7->getType($vb80bb7740288fda1f201890375a60c8f));}}}public function guid($v1e0ca5b1252f1f6b1e0ac91be7e7219e) {if($this->typeClass != 'object-type') {throw new selectorException("Select by guid is allowed only for object-type");}if(is_array($v1e0ca5b1252f1f6b1e0ac91be7e7219e)) {$v0d36323f5b053b8f3a0db27177660854[] = array();foreach($v1e0ca5b1252f1f6b1e0ac91be7e7219e as $v9e3669d19b675bd57058fd4664205d2a) {$v0d36323f5b053b8f3a0db27177660854[] = umiObjectTypesCollection::getInstance()->getTypeIdByGUID($v9e3669d19b675bd57058fd4664205d2a);}$v1e0ca5b1252f1f6b1e0ac91be7e7219e = $v0d36323f5b053b8f3a0db27177660854;}else {$v1e0ca5b1252f1f6b1e0ac91be7e7219e = umiObjectTypesCollection::getInstance()->getTypeIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);}return $this->id($v1e0ca5b1252f1f6b1e0ac91be7e7219e);}public function setTypeClass($v2dda916891cbd0bf046213df34800783) {if(in_array($v2dda916891cbd0bf046213df34800783, self::$typeClasses)) {$this->typeClass = $v2dda916891cbd0bf046213df34800783;}else {throw new selectorException(     "Unkown type class \"{$v2dda916891cbd0bf046213df34800783}\". These types are only supported: " . implode(", ", self::$typeClasses)    );}}public function getFieldId($v972bf3f05d14ffbdb817bef60638ff00) {if(is_null($this->objectType)) {if(is_null($this->hierarchyType)) {throw new selectorException("Object and hierarchy type prop can't be empty both");}$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$v6301cee35ea764a1e241978f93f01069 = $v0e8133eb006c0f85ed9444ae07a60842->getTypeByHierarchyTypeId($this->hierarchyType->getId());if($v726e8e4809d4c1b28a6549d86436a124 = $v0e8133eb006c0f85ed9444ae07a60842->getType($v6301cee35ea764a1e241978f93f01069)) {$this->setObjectType($v726e8e4809d4c1b28a6549d86436a124);}else {return false;}}return $this->objectType->getFieldId($v972bf3f05d14ffbdb817bef60638ff00);}public function __get($v23a5b8ab834cb5140fa6665622eb6417) {$v48f492cfc4344663d5a15ab0d2025226 = array('objectType', 'hierarchyType');if(in_array($v23a5b8ab834cb5140fa6665622eb6417, $v48f492cfc4344663d5a15ab0d2025226)) {return $this->$v23a5b8ab834cb5140fa6665622eb6417;}}protected function setObjectType($v726e8e4809d4c1b28a6549d86436a124) {if($v726e8e4809d4c1b28a6549d86436a124 instanceof iUmiObjectType) {$this->objectType = $v726e8e4809d4c1b28a6549d86436a124;}else {throw new selectorException("Wrong object type given");}}protected function setHierarchyType($v89b0b9deff65f8b9cd1f71bc74ce36ba) {if($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {$this->hierarchyType = $v89b0b9deff65f8b9cd1f71bc74ce36ba;}else {throw new selectorException("Wrong hierarchy type given");}}};abstract class selectorOrderField {protected $asc = true;public function asc() {$this->asc = true;}public function desc() {$this->asc = false;}public function rand() {$this->name = 'rand';}public function __get($v23a5b8ab834cb5140fa6665622eb6417) {return $this->$v23a5b8ab834cb5140fa6665622eb6417;}};class selectorOrderFieldProp extends selectorOrderField {protected $fieldId;public function __construct($v945100186b119048837b9859c2c46410) {$this->fieldId = $v945100186b119048837b9859c2c46410;}};class selectorOrderSysProp extends selectorOrderField {protected $name;public function __construct($vb068931cc450442b63f5b3d276ea4297) {$this->name = $vb068931cc450442b63f5b3d276ea4297;}}class selectorExecutor {protected   $selector,   $queryColumns = array(),   $queryTables = array(),   $queryJoinTables = array(),   $queryLimit = array(),   $queryFields = array(),   $queryOptions = array(),   $length = null,   $skipExecutedCheck = false;public function __construct(selector $v5b3c32009797feb79096d52e56a56b82) {$this->selector = $v5b3c32009797feb79096d52e56a56b82;$this->analyze();}public function query() {return $this->buildQuery('result');}public function result() {$vac5c74b64b4b8352ef2f181affb5ac2a = $this->buildQuery('result');if(defined('DEBUG_SQL_SELECTOR')) {$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v7f2db423a49b305459147332fb01cf87->push($vac5c74b64b4b8352ef2f181affb5ac2a . "\n\n\n");}$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$result = $v4717d53ebfdfea8477f780ec66151dcb->query($vac5c74b64b4b8352ef2f181affb5ac2a);$ve70c4df10ef0983b9c8c31bd06b2a2c3 = $this->selector->option('return')->value;if(!DISABLE_CALC_FOUND_ROWS) {$v770c639e20ac2f19c5ae0da373080e25 = l_mysql_query("SELECT FOUND_ROWS()", true);list($ve2942a04780e223b215eb8b663cf5353) = mysql_fetch_row($v770c639e20ac2f19c5ae0da373080e25);mysql_free_result($v770c639e20ac2f19c5ae0da373080e25);$this->length = (int) $ve2942a04780e223b215eb8b663cf5353;}if($this->selector->mode == 'objects') {$v10ae9fc7d453b0dd525d0edf2ede7961 = array();$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {list($v16b2b26000987faccb260b9d39df1269) = $vf1965a857bc285d26fe22023aa5ab50d;if (is_array($ve70c4df10ef0983b9c8c31bd06b2a2c3) && sizeof($ve70c4df10ef0983b9c8c31bd06b2a2c3)) {if (sizeof($ve70c4df10ef0983b9c8c31bd06b2a2c3) == 1 && $ve70c4df10ef0983b9c8c31bd06b2a2c3[0] == 'id') {$v10ae9fc7d453b0dd525d0edf2ede7961[] = array('id' => $v16b2b26000987faccb260b9d39df1269);}else {$va8cfde6331bd59eb2ac96f8911c4b666 = $v5891da2d64975cae48d175d1e001f5da->getObject($v16b2b26000987faccb260b9d39df1269, array_slice($vf1965a857bc285d26fe22023aa5ab50d, 1));$vae50a11a070db2b31891ed57c8a26a15 = array();foreach ($ve70c4df10ef0983b9c8c31bd06b2a2c3 as $v73f329f154a663bfda020aadcdd0b775) {switch ($v73f329f154a663bfda020aadcdd0b775) {case "id": $vae50a11a070db2b31891ed57c8a26a15[$v73f329f154a663bfda020aadcdd0b775] = $v16b2b26000987faccb260b9d39df1269;break;case "name": $vae50a11a070db2b31891ed57c8a26a15[$v73f329f154a663bfda020aadcdd0b775] = $va8cfde6331bd59eb2ac96f8911c4b666->getName();break;case "guid": $vae50a11a070db2b31891ed57c8a26a15[$v73f329f154a663bfda020aadcdd0b775] = $va8cfde6331bd59eb2ac96f8911c4b666->getGUID();break;default :          $v06e3d36fa30cea095545139854ad1fb9 = $va8cfde6331bd59eb2ac96f8911c4b666->getValue($v73f329f154a663bfda020aadcdd0b775);$vae50a11a070db2b31891ed57c8a26a15[$v73f329f154a663bfda020aadcdd0b775] = $v06e3d36fa30cea095545139854ad1fb9 ? $v06e3d36fa30cea095545139854ad1fb9 : false;}}$v10ae9fc7d453b0dd525d0edf2ede7961[] = $vae50a11a070db2b31891ed57c8a26a15;}}else {$va8cfde6331bd59eb2ac96f8911c4b666 = $v5891da2d64975cae48d175d1e001f5da->getObject($v16b2b26000987faccb260b9d39df1269, array_slice($vf1965a857bc285d26fe22023aa5ab50d, 1));if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof iUmiObject) {$v10ae9fc7d453b0dd525d0edf2ede7961[] = $va8cfde6331bd59eb2ac96f8911c4b666;}}}return $v10ae9fc7d453b0dd525d0edf2ede7961;}else {$vbf516925bb37a8544c8ee19a24e15c05 = array();while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_assoc($result)) {$vb80bb7740288fda1f201890375a60c8f = (int) $vf1965a857bc285d26fe22023aa5ab50d['id'];$v0db3209e1adc6d67be435a81baf9a66e = isset($vf1965a857bc285d26fe22023aa5ab50d['pid']) ? (int) $vf1965a857bc285d26fe22023aa5ab50d['pid'] : 0;$vbf516925bb37a8544c8ee19a24e15c05[$vb80bb7740288fda1f201890375a60c8f] = $v0db3209e1adc6d67be435a81baf9a66e;}if($this->selector->option('exclude-nested')->value) {$va7ef1586e4bce6064f74264fbbab9165 = $this->excludeNestedPages($vbf516925bb37a8544c8ee19a24e15c05);$this->length = sizeof($va7ef1586e4bce6064f74264fbbab9165);if($this->selector->limit || $this->selector->offset) {$va7ef1586e4bce6064f74264fbbab9165 = array_slice($va7ef1586e4bce6064f74264fbbab9165, $this->selector->offset, $this->selector->limit);}}else {$va7ef1586e4bce6064f74264fbbab9165 = array_keys($vbf516925bb37a8544c8ee19a24e15c05);}$v10ae9fc7d453b0dd525d0edf2ede7961 = array();if(count($va7ef1586e4bce6064f74264fbbab9165)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT h.id, h.rel, h.type_id, h.lang_id, h.domain_id, h.tpl_id, h.obj_id, h.ord, h.alt_name, h.is_active, h.is_visible, h.is_deleted, h.updatetime, h.is_default, o.name FROM cms3_hierarchy h, cms3_objects o WHERE h.id IN (" . implode(',', $va7ef1586e4bce6064f74264fbbab9165) . ") AND o.id = h.obj_id";$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v10ae9fc7d453b0dd525d0edf2ede7961 = array_flip($va7ef1586e4bce6064f74264fbbab9165);$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();foreach($result as $vf1965a857bc285d26fe22023aa5ab50d) {$v7552cd149af7495ee7d8225974e50f80 = array_shift($vf1965a857bc285d26fe22023aa5ab50d);if (sizeof($ve70c4df10ef0983b9c8c31bd06b2a2c3)) {if (sizeof($ve70c4df10ef0983b9c8c31bd06b2a2c3) == 1 && $ve70c4df10ef0983b9c8c31bd06b2a2c3[0] == 'id') {$v10ae9fc7d453b0dd525d0edf2ede7961[$v7552cd149af7495ee7d8225974e50f80] = array('id' => $v7552cd149af7495ee7d8225974e50f80);}else {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);$vae50a11a070db2b31891ed57c8a26a15 = array();foreach ($ve70c4df10ef0983b9c8c31bd06b2a2c3 as $v73f329f154a663bfda020aadcdd0b775) {switch ($v73f329f154a663bfda020aadcdd0b775) {case "id": $vae50a11a070db2b31891ed57c8a26a15[$v73f329f154a663bfda020aadcdd0b775] = $v7552cd149af7495ee7d8225974e50f80;break;case "name": $vae50a11a070db2b31891ed57c8a26a15[$v73f329f154a663bfda020aadcdd0b775] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();break;case "alt_name": $vae50a11a070db2b31891ed57c8a26a15[$v73f329f154a663bfda020aadcdd0b775] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getAltName();break;default :           $v06e3d36fa30cea095545139854ad1fb9 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue($v73f329f154a663bfda020aadcdd0b775);$vae50a11a070db2b31891ed57c8a26a15[$v73f329f154a663bfda020aadcdd0b775] = $v06e3d36fa30cea095545139854ad1fb9 ? $v06e3d36fa30cea095545139854ad1fb9 : false;}}$v10ae9fc7d453b0dd525d0edf2ede7961[$v7552cd149af7495ee7d8225974e50f80] = $vae50a11a070db2b31891ed57c8a26a15;}}else {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80, false, false, $vf1965a857bc285d26fe22023aa5ab50d);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {$v10ae9fc7d453b0dd525d0edf2ede7961[$v7552cd149af7495ee7d8225974e50f80] = $v8e2dcfd7e7e24b1ca76c1193f645902b;}}}$v10ae9fc7d453b0dd525d0edf2ede7961 = array_values($v10ae9fc7d453b0dd525d0edf2ede7961);}return $v10ae9fc7d453b0dd525d0edf2ede7961;}}public function length() {if(!is_null($this->length)) {return $this->length;}$this->skipExecutedCheck = true;if(count($this->selector->groupSysProps) || count($this->selector->groupFieldProps)) {$vac5c74b64b4b8352ef2f181affb5ac2a = $this->buildQuery('result');}else {$vac5c74b64b4b8352ef2f181affb5ac2a = $this->buildQuery('count');}$this->skipExecutedCheck = false;$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(count($this->selector->groupSysProps) || count($this->selector->groupFieldProps)) {$ve2942a04780e223b215eb8b663cf5353 = mysql_num_rows($result);}else {list($ve2942a04780e223b215eb8b663cf5353) = mysql_fetch_row($result);}return $this->length = (int) $ve2942a04780e223b215eb8b663cf5353;}public static function getContentTableName(selector $v5b3c32009797feb79096d52e56a56b82, $v945100186b119048837b9859c2c46410) {if(!is_null($v945100186b119048837b9859c2c46410) && self::getFieldColumn($v945100186b119048837b9859c2c46410) == 'cnt') {return 'cms3_object_content_cnt';}$v0e8133eb006c0f85ed9444ae07a60842 = array();$v6942e8fa62b3cc9d93881a58210e2fd7 = array();$vd14a8022b085f9ef19d479cbdd581127 = $v5b3c32009797feb79096d52e56a56b82->types;foreach($vd14a8022b085f9ef19d479cbdd581127 as $v599dcce2998a6b40b1e38e8c6006cb0a) {if(is_null($v599dcce2998a6b40b1e38e8c6006cb0a->objectType) == false) $v0e8133eb006c0f85ed9444ae07a60842[] = $v599dcce2998a6b40b1e38e8c6006cb0a->objectType->getId();if(is_null($v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyType) == false) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = $v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyType;if($v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule() == 'comments') continue;$v6942e8fa62b3cc9d93881a58210e2fd7[] = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getId();}}if(sizeof($v0e8133eb006c0f85ed9444ae07a60842)) {return umiBranch::getBranchedTableByTypeId(array_pop($v0e8133eb006c0f85ed9444ae07a60842));}if(sizeof($v6942e8fa62b3cc9d93881a58210e2fd7)) {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = array_pop($v6942e8fa62b3cc9d93881a58210e2fd7);if(umiBranch::checkIfBranchedByHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631)) {return 'cms3_object_content_' . $vacf567c9c3d6cf7c6e2cc0ce108e0631;}}return 'cms3_object_content';}public function getSkipExecutedCheckState() {return $this->skipExecutedCheck;}protected function analyze() {$v5b3c32009797feb79096d52e56a56b82 = $this->selector;switch($v5b3c32009797feb79096d52e56a56b82->mode) {case 'objects':     $this->requireTable('o', 'cms3_objects');$this->requireTable('t', 'cms3_object_types');break;case 'pages':     $this->requireTable('h', 'cms3_hierarchy');break;}$this->analyzeFields();$this->analyzeLimit();}protected function requireTable($v724874d1be77f450a09b305fc1534afb, $v80071f37861c360a27b7327e132c911a) {$this->queryTables[$v724874d1be77f450a09b305fc1534afb] = $v80071f37861c360a27b7327e132c911a;}protected function requireSysProp($v46b9e6004c49d9cc040029c197cab278) {$v90e46a37654bd99f32b7dce981c0d9a0 = array();$v90e46a37654bd99f32b7dce981c0d9a0['name'] = array('o.name', 'table' => array('o', 'cms3_objects'));$v90e46a37654bd99f32b7dce981c0d9a0['guid'] = array('o.guid', 'table' => array('o', 'cms3_objects'));$v90e46a37654bd99f32b7dce981c0d9a0['owner'] = array('o.owner_id', 'table' => array('o', 'cms3_objects'));$v90e46a37654bd99f32b7dce981c0d9a0['domain'] = array('h.domain_id');$v90e46a37654bd99f32b7dce981c0d9a0['lang'] = array('h.lang_id');$v90e46a37654bd99f32b7dce981c0d9a0['is_deleted'] = array('h.is_deleted');$v90e46a37654bd99f32b7dce981c0d9a0['is_default'] = array('h.is_default');$v90e46a37654bd99f32b7dce981c0d9a0['is_visible'] = array('h.is_visible');$v90e46a37654bd99f32b7dce981c0d9a0['is_active'] = array('h.is_active');$v90e46a37654bd99f32b7dce981c0d9a0['domain'] = array('h.domain_id');$v90e46a37654bd99f32b7dce981c0d9a0['updatetime'] = array('h.updatetime');$v90e46a37654bd99f32b7dce981c0d9a0['rand'] = array('RAND()');$v90e46a37654bd99f32b7dce981c0d9a0['template_id'] = array('h.tpl_id');if($this->selector->mode == 'pages') {$v90e46a37654bd99f32b7dce981c0d9a0['ord'] = array('h.ord', 'table' => array('h', 'cms3_hierarchy'));$v90e46a37654bd99f32b7dce981c0d9a0['id'] = array('h.id');}else {$v90e46a37654bd99f32b7dce981c0d9a0['id'] = array('o.id', 'table' => array('o', 'cms3_objects'));}if(isset($v90e46a37654bd99f32b7dce981c0d9a0[$v46b9e6004c49d9cc040029c197cab278])) {$vcaf9b6b99962bf5c2264824231d7a40c = $v90e46a37654bd99f32b7dce981c0d9a0[$v46b9e6004c49d9cc040029c197cab278];if(isset($vcaf9b6b99962bf5c2264824231d7a40c['table'])) {$this->requireTable($vcaf9b6b99962bf5c2264824231d7a40c['table'][0], $vcaf9b6b99962bf5c2264824231d7a40c['table'][1]);}return $vcaf9b6b99962bf5c2264824231d7a40c[0];}else {throw new selectorException("Not supported property \"{$v46b9e6004c49d9cc040029c197cab278}\"");}}protected function analyzeFields() {$v5b3c32009797feb79096d52e56a56b82 = $this->selector;$v4d15c1a5147ac6e7c61f1f05cc0339bc = $v5b3c32009797feb79096d52e56a56b82->whereFieldProps;$vd05b6ed7d2345020440df396d6da7f73 = array();foreach($v4d15c1a5147ac6e7c61f1f05cc0339bc as $v06e3d36fa30cea095545139854ad1fb9) {$vd05b6ed7d2345020440df396d6da7f73[] = $v06e3d36fa30cea095545139854ad1fb9->fieldId;}$vd05b6ed7d2345020440df396d6da7f73 = array_unique($vd05b6ed7d2345020440df396d6da7f73);foreach($vd05b6ed7d2345020440df396d6da7f73 as $v945100186b119048837b9859c2c46410) {$v80071f37861c360a27b7327e132c911a = self::getContentTableName($v5b3c32009797feb79096d52e56a56b82, $v945100186b119048837b9859c2c46410);$this->requireTable('oc_' . $v945100186b119048837b9859c2c46410, $v80071f37861c360a27b7327e132c911a);$this->queryFields[] = $v945100186b119048837b9859c2c46410;}}protected function analyzeLimit() {$v5b3c32009797feb79096d52e56a56b82 = $this->selector;if($v5b3c32009797feb79096d52e56a56b82->option('exclude-nested')->value) {return;}if($v5b3c32009797feb79096d52e56a56b82->limit || $v5b3c32009797feb79096d52e56a56b82->offset) {$this->queryLimit = array((int) $v5b3c32009797feb79096d52e56a56b82->offset, (int) $v5b3c32009797feb79096d52e56a56b82->limit);}}protected function buildQuery($v15d61712450a686a7f365adf4fef581f) {if($this->selector->option('root')->value) {return $this->buildRootQuery($v15d61712450a686a7f365adf4fef581f);}$vc6c12f4db6ba0426c8e023cb1ca31038 = $va85bfb9c6bcd889ceb433a1c9cd4b218 = '';if ($v15d61712450a686a7f365adf4fef581f != 'count') {$vc6c12f4db6ba0426c8e023cb1ca31038 = $this->buildLimit();$va85bfb9c6bcd889ceb433a1c9cd4b218 = $this->buildOrder();}$ve22c565b90e9a278849f2d61d78e8388 = $this->buildGroup();$vccc9e74cf27019ed02701010da900d6d = $this->buildWhere();$v0b63a75de116aadef5f4aed3dc3b7d87 = $this->buildLeftJoins();$v75a8be0fca0bc0497c40180b6d02d580 = $this->buildTables();$v39daa41bf389071ad9cd7a7a0ad2ff2c = $this->buildOptions($v15d61712450a686a7f365adf4fef581f);if($v15d61712450a686a7f365adf4fef581f == 'result') {if($this->selector->mode == 'objects') {$this->queryColumns = array('o.id as id', 'o.name as name', 'o.type_id as type_id', 'o.is_locked as is_locked', 'o.owner_id as owner_id', 'o.guid as guid', 't.guid as type_guid');}else {$this->queryColumns = array('h.id as id', 'h.rel as pid');}}else {$vee87bc8747ad849f76f9f6c9f6a6f6ed = in_array('DISTINCT', $this->queryOptions);if (($this->selector->mode == 'objects')) {$this->queryColumns = $vee87bc8747ad849f76f9f6c9f6a6f6ed ? array('COUNT(DISTINCT o.id)') : array('COUNT(o.id)');}else {$this->queryColumns = $vee87bc8747ad849f76f9f6c9f6a6f6ed ? array('COUNT(DISTINCT h.id)') : array('COUNT(h.id)');}}$v5a6f85b0e2c34b7c96af65b0f54b4dea = $this->buildColumns();return <<<SQL
SELECT {$v39daa41bf389071ad9cd7a7a0ad2ff2c} {$v5a6f85b0e2c34b7c96af65b0f54b4dea}
	FROM {$v75a8be0fca0bc0497c40180b6d02d580}
	{$v0b63a75de116aadef5f4aed3dc3b7d87}
	{$vccc9e74cf27019ed02701010da900d6d}
	{$ve22c565b90e9a278849f2d61d78e8388}
	{$va85bfb9c6bcd889ceb433a1c9cd4b218}
	{$vc6c12f4db6ba0426c8e023cb1ca31038}
SQL;  }protected function buildOptions($v15d61712450a686a7f365adf4fef581f) {$v56b07ca9227f50ef928ccc932038180f = $this->queryOptions;$v56b07ca9227f50ef928ccc932038180f = array_unique($v56b07ca9227f50ef928ccc932038180f);if(MAX_SELECTION_TABLE_JOINS > 0 && MAX_SELECTION_TABLE_JOINS < sizeof($this->queryJoinTables)) {$v56b07ca9227f50ef928ccc932038180f[] = 'STRAIGHT_JOIN';}if($v15d61712450a686a7f365adf4fef581f == 'result') {if(!DISABLE_CALC_FOUND_ROWS) {$v56b07ca9227f50ef928ccc932038180f[] = 'SQL_CALC_FOUND_ROWS';}}return implode(' ', $v56b07ca9227f50ef928ccc932038180f);}protected function buildLeftJoins() {$va12b4ea43cb390c701ca21b24717887a = array();$v0cc53116375bee4529f23b0f2f407df5 = array_merge($this->selector->orderFieldProps, $this->selector->whereFieldProps);$vbdf7216b52ab1c35e07a5ba2def35348 = array();foreach($v0cc53116375bee4529f23b0f2f407df5 as $v8040c3c227f813496fd957249478b6e3) {$v945100186b119048837b9859c2c46410 = $v8040c3c227f813496fd957249478b6e3->fieldId;if (!in_array($v945100186b119048837b9859c2c46410, $vbdf7216b52ab1c35e07a5ba2def35348)) {$this->requireTable('o', 'cms3_objects');$v80071f37861c360a27b7327e132c911a = self::getContentTableName($this->selector, $v945100186b119048837b9859c2c46410);$v731b886d80d2ea138da54d30f43b2005 = "LEFT JOIN {$v80071f37861c360a27b7327e132c911a} oc_{$v945100186b119048837b9859c2c46410}_lj ON oc_{$v945100186b119048837b9859c2c46410}_lj.obj_id=o.id AND oc_{$v945100186b119048837b9859c2c46410}_lj.field_id = '{$v945100186b119048837b9859c2c46410}'";$va12b4ea43cb390c701ca21b24717887a[] = $v731b886d80d2ea138da54d30f43b2005;$vbdf7216b52ab1c35e07a5ba2def35348[] = $v945100186b119048837b9859c2c46410;$this->queryJoinTables[] = $v80071f37861c360a27b7327e132c911a;}}return empty($va12b4ea43cb390c701ca21b24717887a) ? "" : implode(" ", $va12b4ea43cb390c701ca21b24717887a);}protected function buildColumns() {return implode(', ', $this->queryColumns);}protected function buildTables() {$v9ab2ec7ea4a2041306f7bdf150fcd453 = array();$v00a9a809ad34d904aba9c5b4875643e2 = false;foreach($this->queryTables as $v724874d1be77f450a09b305fc1534afb => $vb068931cc450442b63f5b3d276ea4297) {if ($vb068931cc450442b63f5b3d276ea4297 == 'cms3_objects' && $v00a9a809ad34d904aba9c5b4875643e2 === false) {$v00a9a809ad34d904aba9c5b4875643e2 = $v724874d1be77f450a09b305fc1534afb;continue;}if ( (strpos($vb068931cc450442b63f5b3d276ea4297, 'cms3_object_content') === 0) && ($v724874d1be77f450a09b305fc1534afb != 'o_asteriks') ) continue;$v9ab2ec7ea4a2041306f7bdf150fcd453[] = $vb068931cc450442b63f5b3d276ea4297 . ' ' . $v724874d1be77f450a09b305fc1534afb;}if($v00a9a809ad34d904aba9c5b4875643e2 !== false) {$v9ab2ec7ea4a2041306f7bdf150fcd453[] = $this->queryTables[$v00a9a809ad34d904aba9c5b4875643e2] . ' ' . $v00a9a809ad34d904aba9c5b4875643e2;}return implode(', ', $v9ab2ec7ea4a2041306f7bdf150fcd453);}protected function buildLimit() {if(sizeof($this->queryLimit)) {return " LIMIT {$this->queryLimit[0]}, {$this->queryLimit[1]}";}else {return "";}}protected function buildWhere() {$vac5c74b64b4b8352ef2f181affb5ac2a = "";$vb71a97a0f96cb8b238309d23a188ae98 = array();$v0e8133eb006c0f85ed9444ae07a60842 = array();$v6942e8fa62b3cc9d93881a58210e2fd7 = array();foreach($this->selector->types as $v599dcce2998a6b40b1e38e8c6006cb0a) {if(is_null($v599dcce2998a6b40b1e38e8c6006cb0a->objectType) == false) $v0e8133eb006c0f85ed9444ae07a60842[] = $v599dcce2998a6b40b1e38e8c6006cb0a->objectType->getId();if(is_null($v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyType) == false) $v6942e8fa62b3cc9d93881a58210e2fd7[] = $v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyType->getId();}if(sizeof($v0e8133eb006c0f85ed9444ae07a60842)) {$this->requireTable('o', 'cms3_objects');$this->requireTable('t', 'cms3_object_types');$vb3827f7111095f5ba1a9f49988fe9382 = umiObjectTypesCollection::getInstance();$veb52d3ec890b2d484d6630771e37554c = array();foreach($v0e8133eb006c0f85ed9444ae07a60842 as $v6301cee35ea764a1e241978f93f01069) {$veb52d3ec890b2d484d6630771e37554c = array_merge($veb52d3ec890b2d484d6630771e37554c, $vb3827f7111095f5ba1a9f49988fe9382->getChildClasses($v6301cee35ea764a1e241978f93f01069));}$v0e8133eb006c0f85ed9444ae07a60842 = array_unique(array_merge($v0e8133eb006c0f85ed9444ae07a60842, $veb52d3ec890b2d484d6630771e37554c));$vb71a97a0f96cb8b238309d23a188ae98[] = 'o.type_id IN (' . implode(', ', $v0e8133eb006c0f85ed9444ae07a60842) . ')';$vb71a97a0f96cb8b238309d23a188ae98[] = 't.id = o.type_id';}if(sizeof($v6942e8fa62b3cc9d93881a58210e2fd7)) {$v6942e8fa62b3cc9d93881a58210e2fd7 = array_unique($v6942e8fa62b3cc9d93881a58210e2fd7);$vb71a97a0f96cb8b238309d23a188ae98[] = 'h.type_id IN (' . implode(', ', $v6942e8fa62b3cc9d93881a58210e2fd7) . ')';}if(sizeof($this->queryFields)) {$this->requireTable('o', 'cms3_objects');}$v6d7c8db4f8b49f97b93014d8ff3a1d2d     = umiFieldsCollection::getInstance();$v9129be9157de7546ad9a50df5f46dda3        = $this->selector->option('or-mode');$vc2451bc29e93cf5592f4e9e0905fc76a    = array();$va0705b747cdc4dc7dbc5e6260e204157 = array();$vabf1da7c42b3413c5be3d8d906f3630d = '';foreach($this->queryFields as $v945100186b119048837b9859c2c46410) {if (isset($v9129be9157de7546ad9a50df5f46dda3->value['fields']) && in_array($v6d7c8db4f8b49f97b93014d8ff3a1d2d->getField($v945100186b119048837b9859c2c46410)->getName(), $v9129be9157de7546ad9a50df5f46dda3->value['fields'])) {$va0705b747cdc4dc7dbc5e6260e204157[] = $this->buildWhereValue($v945100186b119048837b9859c2c46410);}else $vc2451bc29e93cf5592f4e9e0905fc76a[] = $this->buildWhereValue($v945100186b119048837b9859c2c46410);}if(sizeof($vc2451bc29e93cf5592f4e9e0905fc76a) || sizeof($va0705b747cdc4dc7dbc5e6260e204157)) {if (isset($v9129be9157de7546ad9a50df5f46dda3->value['all'])) {$vc2451bc29e93cf5592f4e9e0905fc76a = array_merge($vc2451bc29e93cf5592f4e9e0905fc76a, $va0705b747cdc4dc7dbc5e6260e204157);$vabf1da7c42b3413c5be3d8d906f3630d = implode(' OR ', $vc2451bc29e93cf5592f4e9e0905fc76a);}else {if (sizeof($vc2451bc29e93cf5592f4e9e0905fc76a)) {$vabf1da7c42b3413c5be3d8d906f3630d .= implode(' AND ', $vc2451bc29e93cf5592f4e9e0905fc76a);if (sizeof($va0705b747cdc4dc7dbc5e6260e204157)) $vabf1da7c42b3413c5be3d8d906f3630d .= ' AND ';}if (sizeof($va0705b747cdc4dc7dbc5e6260e204157)) {$vabf1da7c42b3413c5be3d8d906f3630d .= (sizeof($va0705b747cdc4dc7dbc5e6260e204157) > 1) ? "(" . implode(' OR ', $va0705b747cdc4dc7dbc5e6260e204157) . ")" : $va0705b747cdc4dc7dbc5e6260e204157[0];}}$vb71a97a0f96cb8b238309d23a188ae98[] = '('. $vabf1da7c42b3413c5be3d8d906f3630d . ')';}$v620d6d4d09a18d4c5fdc7fa1abae6149 = $this->selector->whereSysProps;foreach($v620d6d4d09a18d4c5fdc7fa1abae6149 as $ve7b2acf954344b64ff7a1bdef7490812) {if($v26542fb18a8b14c9775aa475f23c909f = $this->buildSysProp($ve7b2acf954344b64ff7a1bdef7490812)) {$vb71a97a0f96cb8b238309d23a188ae98[] = $v26542fb18a8b14c9775aa475f23c909f;}}if($this->selector->mode == 'pages') {if($vc59a4dbfd0b091548a2f1d692a2a7c01 = $this->buildPermissions()) {$vb71a97a0f96cb8b238309d23a188ae98[] = $vc59a4dbfd0b091548a2f1d692a2a7c01;}if($v5b20cfc8862f370a9201f62df14c09c2 = $this->buildHierarchy()) {$vb71a97a0f96cb8b238309d23a188ae98[] = $v5b20cfc8862f370a9201f62df14c09c2;}if(isset($this->queryTables['o'])) {$vb71a97a0f96cb8b238309d23a188ae98[] = "h.obj_id = o.id";}}$vac5c74b64b4b8352ef2f181affb5ac2a .= implode(' AND ', $vb71a97a0f96cb8b238309d23a188ae98);if($vac5c74b64b4b8352ef2f181affb5ac2a) $vac5c74b64b4b8352ef2f181affb5ac2a = "WHERE " . $vac5c74b64b4b8352ef2f181affb5ac2a;return $vac5c74b64b4b8352ef2f181affb5ac2a;}protected function buildWhereValue($v945100186b119048837b9859c2c46410) {$v173936e059d215ede2e8b723a6165878 = $this->selector->whereFieldProps;$v43b5c9175984c071f30b873fdce0a000 = array();foreach($v173936e059d215ede2e8b723a6165878 as $v567904efe9e64d9faf3e41ef402cb568) {if($v567904efe9e64d9faf3e41ef402cb568->fieldId == $v945100186b119048837b9859c2c46410) $v43b5c9175984c071f30b873fdce0a000[] = $v567904efe9e64d9faf3e41ef402cb568;}$v1afd32818d1c9525f82aff4c09efd254 = self::getFieldColumn($v945100186b119048837b9859c2c46410);$vac5c74b64b4b8352ef2f181affb5ac2a = "";$vb71a97a0f96cb8b238309d23a188ae98 = array();foreach($v43b5c9175984c071f30b873fdce0a000 as $v567904efe9e64d9faf3e41ef402cb568) {if($v1afd32818d1c9525f82aff4c09efd254 === false) {if(sizeof($v567904efe9e64d9faf3e41ef402cb568->value) == 1) {$v14f802e1fba977727845e8872c1743a7 = array_keys($v567904efe9e64d9faf3e41ef402cb568->value);$v1afd32818d1c9525f82aff4c09efd254 = array_pop($v14f802e1fba977727845e8872c1743a7) . '_val';}else continue;}$v3f9178c25b78ed8bed19091bcb62e266 = $this->parseValue($v567904efe9e64d9faf3e41ef402cb568->mode, $v567904efe9e64d9faf3e41ef402cb568->value, "oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254}");$vb71a97a0f96cb8b238309d23a188ae98[] = ($v567904efe9e64d9faf3e41ef402cb568->mode == 'notequals') ? "(oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254}{$v3f9178c25b78ed8bed19091bcb62e266})" : "oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254}{$v3f9178c25b78ed8bed19091bcb62e266}";}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);$v9129be9157de7546ad9a50df5f46dda3 = $this->selector->option('or-mode');if (isset($v9129be9157de7546ad9a50df5f46dda3->value['all']) || (isset($v9129be9157de7546ad9a50df5f46dda3->value['field']) && in_array($v06e3d36fa30cea095545139854ad1fb9->getName(), $v9129be9157de7546ad9a50df5f46dda3->value['field']))) {$veaae0796859eed71de2b22d27b57296b = ' OR ';$this->queryOptions[] = 'DISTINCT';}else {$veaae0796859eed71de2b22d27b57296b = ' AND ';}$vac5c74b64b4b8352ef2f181affb5ac2a = implode($veaae0796859eed71de2b22d27b57296b, array_unique($vb71a97a0f96cb8b238309d23a188ae98));return $vac5c74b64b4b8352ef2f181affb5ac2a ? (sizeof($vb71a97a0f96cb8b238309d23a188ae98) > 1 ? "(" . $vac5c74b64b4b8352ef2f181affb5ac2a . ")" : $vac5c74b64b4b8352ef2f181affb5ac2a) : "";}protected function parseValue($v15d61712450a686a7f365adf4fef581f, $v2063c1608d6e0baf80249c42e2be5804, $v1afd32818d1c9525f82aff4c09efd254 = false) {switch($v15d61712450a686a7f365adf4fef581f) {case 'equals':     if(is_array($v2063c1608d6e0baf80249c42e2be5804) || is_object($v2063c1608d6e0baf80249c42e2be5804)) {$v2063c1608d6e0baf80249c42e2be5804 = $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);if(sizeof($v2063c1608d6e0baf80249c42e2be5804)) {return ' IN(' . implode(', ', $v2063c1608d6e0baf80249c42e2be5804) . ')';}else {return ' = 0 = 1';}}else      return ' = ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);break;case 'notequals':     if(is_array($v2063c1608d6e0baf80249c42e2be5804) || is_object($v2063c1608d6e0baf80249c42e2be5804)) {$v2063c1608d6e0baf80249c42e2be5804 = $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);if(sizeof($v2063c1608d6e0baf80249c42e2be5804)) {return ' NOT IN(' . implode(', ', $v2063c1608d6e0baf80249c42e2be5804) . ')' . ($v1afd32818d1c9525f82aff4c09efd254 ? " OR {$v1afd32818d1c9525f82aff4c09efd254} IS NULL" : "");}else {return ' = 0 = 1';}}else      return ' != ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804) . ($v1afd32818d1c9525f82aff4c09efd254 ? " OR {$v1afd32818d1c9525f82aff4c09efd254} IS NULL" : "");break;case 'like':     if(is_array($v2063c1608d6e0baf80249c42e2be5804)) throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");else return ' LIKE ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'ilike':     if(is_array($v2063c1608d6e0baf80249c42e2be5804)) throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");else return ' LIKE ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'more':     if(is_array($v2063c1608d6e0baf80249c42e2be5804)) throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");else return ' > ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'eqmore':     if(is_array($v2063c1608d6e0baf80249c42e2be5804)) throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");else return ' >= ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'less':     if(is_array($v2063c1608d6e0baf80249c42e2be5804)) throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");else return ' < ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'eqless':     if(is_array($v2063c1608d6e0baf80249c42e2be5804)) throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");else return ' <= ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'between':     return ' BETWEEN ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804[0]) . ' AND ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804[1]);case 'isnotnull':     $v2063c1608d6e0baf80249c42e2be5804 != $v2063c1608d6e0baf80249c42e2be5804;case 'isnull':     return ($v2063c1608d6e0baf80249c42e2be5804) ? ' IS NULL' : ' IS NOT NULL';default:     throw new selectorException("Unsupported field mode \"{$v15d61712450a686a7f365adf4fef581f}\"");}}protected function buildSysProp($v23a5b8ab834cb5140fa6665622eb6417) {if($v23a5b8ab834cb5140fa6665622eb6417->name == 'domain' || $v23a5b8ab834cb5140fa6665622eb6417->name == 'lang') {if($v23a5b8ab834cb5140fa6665622eb6417->value === false) return false;}if($v23a5b8ab834cb5140fa6665622eb6417->name == 'domain'){$vea7a5ff9e872aa9554d2d55b11036c30 = $this->selector->hierarchy;if(sizeof($vea7a5ff9e872aa9554d2d55b11036c30) && $vea7a5ff9e872aa9554d2d55b11036c30[0]->elementId) {return false;}}if($v23a5b8ab834cb5140fa6665622eb6417->name == '*') {$this->requireTable('o_asteriks', 'cms3_object_content');$this->requireTable('o', 'cms3_objects');$v724874d1be77f450a09b305fc1534afb = self::getContentTableName($this->selector, null);$v9ab2ec7ea4a2041306f7bdf150fcd453 = array('o_asteriks');if($v724874d1be77f450a09b305fc1534afb != 'cms3_object_content') {$this->requireTable('o_asteriks_branched', $v724874d1be77f450a09b305fc1534afb);$v9ab2ec7ea4a2041306f7bdf150fcd453[] = 'o_asteriks_branched';}$this->queryOptions[] = 'DISTINCT';$vb71a97a0f96cb8b238309d23a188ae98 = array();foreach($v9ab2ec7ea4a2041306f7bdf150fcd453 as $v80071f37861c360a27b7327e132c911a) {$vf09cc7ee3a9a93273f4b80601cafb00c = $v23a5b8ab834cb5140fa6665622eb6417->value;if(!is_array($vf09cc7ee3a9a93273f4b80601cafb00c)) $vf09cc7ee3a9a93273f4b80601cafb00c = array($vf09cc7ee3a9a93273f4b80601cafb00c);$v559cc56c655f21b6412d45a20dabd67d = array();foreach($vf09cc7ee3a9a93273f4b80601cafb00c as $v2063c1608d6e0baf80249c42e2be5804) {$vb29e62a6153f20d910bc9f0d25a57d83 = $this->escapeValue('%' . $v2063c1608d6e0baf80249c42e2be5804 . '%');$v559cc56c655f21b6412d45a20dabd67d[] = $v80071f37861c360a27b7327e132c911a . '.varchar_val LIKE ' . $vb29e62a6153f20d910bc9f0d25a57d83;$v559cc56c655f21b6412d45a20dabd67d[] = $v80071f37861c360a27b7327e132c911a . '.text_val LIKE ' . $vb29e62a6153f20d910bc9f0d25a57d83;$v559cc56c655f21b6412d45a20dabd67d[] = 'o.name LIKE ' . $vb29e62a6153f20d910bc9f0d25a57d83;if(is_numeric($v2063c1608d6e0baf80249c42e2be5804)) {$v559cc56c655f21b6412d45a20dabd67d[] = $v80071f37861c360a27b7327e132c911a . '.float_val = ' . $vb29e62a6153f20d910bc9f0d25a57d83;$v559cc56c655f21b6412d45a20dabd67d[] = $v80071f37861c360a27b7327e132c911a . '.int_val = ' . $vb29e62a6153f20d910bc9f0d25a57d83;}}$vb71a97a0f96cb8b238309d23a188ae98[] = '(' . $v80071f37861c360a27b7327e132c911a . '.obj_id = o.id AND (' . implode(' OR ', $v559cc56c655f21b6412d45a20dabd67d) . '))';}$vac5c74b64b4b8352ef2f181affb5ac2a = '(' . implode(' OR ', $vb71a97a0f96cb8b238309d23a188ae98) . ')';return $vac5c74b64b4b8352ef2f181affb5ac2a;}else {$vb068931cc450442b63f5b3d276ea4297 = $this->requireSysProp($v23a5b8ab834cb5140fa6665622eb6417->name);$vac5c74b64b4b8352ef2f181affb5ac2a = "{$vb068931cc450442b63f5b3d276ea4297}" . $this->parseValue($v23a5b8ab834cb5140fa6665622eb6417->mode, $v23a5b8ab834cb5140fa6665622eb6417->value, $vb068931cc450442b63f5b3d276ea4297);return ($v23a5b8ab834cb5140fa6665622eb6417->mode == 'notequals') ? '('.$vac5c74b64b4b8352ef2f181affb5ac2a.')' : $vac5c74b64b4b8352ef2f181affb5ac2a;}}protected function buildOrder() {$vac5c74b64b4b8352ef2f181affb5ac2a = "";$vb71a97a0f96cb8b238309d23a188ae98 = array();foreach($this->selector->orderFieldProps as $v70a17ffa722a3985b86d30b034ad06d7) {$v945100186b119048837b9859c2c46410 = $v70a17ffa722a3985b86d30b034ad06d7->fieldId;$v1afd32818d1c9525f82aff4c09efd254 = self::getFieldColumn($v945100186b119048837b9859c2c46410);$vb71a97a0f96cb8b238309d23a188ae98[] = "oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254} " . ($v70a17ffa722a3985b86d30b034ad06d7->asc ? 'ASC' : 'DESC');}foreach($this->selector->orderSysProps as $v70a17ffa722a3985b86d30b034ad06d7) {$vb068931cc450442b63f5b3d276ea4297 = $this->requireSysProp($v70a17ffa722a3985b86d30b034ad06d7->name);$vb71a97a0f96cb8b238309d23a188ae98[] = $vb068931cc450442b63f5b3d276ea4297 . ' ' . ($v70a17ffa722a3985b86d30b034ad06d7->asc ? 'ASC' : 'DESC');}$vac5c74b64b4b8352ef2f181affb5ac2a = implode(', ', $vb71a97a0f96cb8b238309d23a188ae98);return $vac5c74b64b4b8352ef2f181affb5ac2a ? "ORDER BY " . $vac5c74b64b4b8352ef2f181affb5ac2a : "";}protected function buildGroup() {$vac5c74b64b4b8352ef2f181affb5ac2a = "";$vb71a97a0f96cb8b238309d23a188ae98 = array();foreach($this->selector->groupFieldProps as $vdb0f6f37ebeb6ea09489124345af2a45) {$v945100186b119048837b9859c2c46410 = $vdb0f6f37ebeb6ea09489124345af2a45->fieldId;$v1afd32818d1c9525f82aff4c09efd254 = self::getFieldColumn($v945100186b119048837b9859c2c46410);$vb71a97a0f96cb8b238309d23a188ae98[] = "oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254}";}foreach($this->selector->groupSysProps as $vdb0f6f37ebeb6ea09489124345af2a45) {$vb068931cc450442b63f5b3d276ea4297 = $this->requireSysProp($vdb0f6f37ebeb6ea09489124345af2a45->name);$vb71a97a0f96cb8b238309d23a188ae98[] = $vb068931cc450442b63f5b3d276ea4297;}$vac5c74b64b4b8352ef2f181affb5ac2a = implode(', ', $vb71a97a0f96cb8b238309d23a188ae98);return $vac5c74b64b4b8352ef2f181affb5ac2a ? "GROUP BY " . $vac5c74b64b4b8352ef2f181affb5ac2a : "";}protected function buildPermissions() {$v41275a535677f79ff347e01bc530c176 = $this->selector->permissions;$vb132392a317588e56460e77a8fd74229 = $v41275a535677f79ff347e01bc530c176->owners;if($v41275a535677f79ff347e01bc530c176 && sizeof($vb132392a317588e56460e77a8fd74229)) {$this->requireTable('p', 'cms3_permissions');$this->queryOptions[] = 'DISTINCT';$v92ad7554e2e0d208f33729db6d54b59b = umiObjectsCollection::getInstance()->getObjectIdByGUID('system-guest');if (!in_array($v92ad7554e2e0d208f33729db6d54b59b, $vb132392a317588e56460e77a8fd74229)) $vb132392a317588e56460e77a8fd74229[] = $v92ad7554e2e0d208f33729db6d54b59b;$vb132392a317588e56460e77a8fd74229 = implode(', ', $vb132392a317588e56460e77a8fd74229);return "(p.rel_id = h.id AND p.level & {$v41275a535677f79ff347e01bc530c176->level} AND p.owner_id IN({$vb132392a317588e56460e77a8fd74229}))";}else return "";}protected function buildHierarchy() {$vb81ca7c0ccaa77e7aa91936ab0070695 = $this->selector->hierarchy;if(sizeof($vb81ca7c0ccaa77e7aa91936ab0070695) == 0) return "";$this->requireTable('hr', 'cms3_hierarchy_relations');$vac5c74b64b4b8352ef2f181affb5ac2a = "h.id = hr.child_id AND ";$v032f3ae7c8ab69e3b2d44917fa7b737a = array();foreach($vb81ca7c0ccaa77e7aa91936ab0070695 as $v3f9178c25b78ed8bed19091bcb62e266) {if($v3f9178c25b78ed8bed19091bcb62e266->elementId > 0)     $vdc45f409298a34f384ba3a7ee75a751c = "(hr.level <= {$v3f9178c25b78ed8bed19091bcb62e266->level} AND hr.rel_id";else     $vdc45f409298a34f384ba3a7ee75a751c = "(hr.level < {$v3f9178c25b78ed8bed19091bcb62e266->level} AND hr.rel_id";$vdc45f409298a34f384ba3a7ee75a751c .= ($v3f9178c25b78ed8bed19091bcb62e266->elementId > 0) ? " = '{$v3f9178c25b78ed8bed19091bcb62e266->elementId}'" : " IS NULL";$vdc45f409298a34f384ba3a7ee75a751c .= ")";$v032f3ae7c8ab69e3b2d44917fa7b737a[] = $vdc45f409298a34f384ba3a7ee75a751c;}if (sizeof($v032f3ae7c8ab69e3b2d44917fa7b737a) > 1) $vac5c74b64b4b8352ef2f181affb5ac2a .= "(";$vac5c74b64b4b8352ef2f181affb5ac2a .= implode(' OR ', $v032f3ae7c8ab69e3b2d44917fa7b737a);if (sizeof($v032f3ae7c8ab69e3b2d44917fa7b737a) > 1) $vac5c74b64b4b8352ef2f181affb5ac2a .= ")";return $vac5c74b64b4b8352ef2f181affb5ac2a;}protected static function getFieldColumn($v945100186b119048837b9859c2c46410) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();if(isset($v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410])) return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410];$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);switch($v06e3d36fa30cea095545139854ad1fb9->getDataType()) {case 'string':    case 'password':    case 'tags':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'varchar_val';case 'int':    case 'boolean':    case 'date':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'int_val';case 'counter':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'cnt';case 'price':    case 'float':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'float_val';case 'text':    case 'wysiwyg':    case 'file':    case 'img_file':    case 'swf_file':    case 'video_file':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'text_val';case 'relation':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'rel_val';case 'symlink':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'tree_val';case 'optioned': return false;default:     throw new selectorException("Unsupported field type \"{$v06e3d36fa30cea095545139854ad1fb9->getDataType()}\"");}}protected function escapeValue($v2063c1608d6e0baf80249c42e2be5804) {if(is_array($v2063c1608d6e0baf80249c42e2be5804)) {foreach($v2063c1608d6e0baf80249c42e2be5804 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v3a6d0284e743dc4a9b86f97d6dd1a3bf) $v2063c1608d6e0baf80249c42e2be5804[$v865c0c0b4ab0e063e5caa3387c1a8741] = $this->escapeValue($v3a6d0284e743dc4a9b86f97d6dd1a3bf);return $v2063c1608d6e0baf80249c42e2be5804;}if ($v2063c1608d6e0baf80249c42e2be5804 instanceof selector) {return $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804->result());}if ($v2063c1608d6e0baf80249c42e2be5804 instanceof iUmiObject || $v2063c1608d6e0baf80249c42e2be5804 instanceof iUmiHierarchyElement) {return $v2063c1608d6e0baf80249c42e2be5804->id;}else {return "'" . l_mysql_real_escape_string($v2063c1608d6e0baf80249c42e2be5804) . "'";}}protected function buildRootQuery($v15d61712450a686a7f365adf4fef581f) {$vc6c12f4db6ba0426c8e023cb1ca31038 = $this->buildLimit();$va85bfb9c6bcd889ceb433a1c9cd4b218 = $this->buildOrder();$vccc9e74cf27019ed02701010da900d6d = $this->buildWhere();$v75a8be0fca0bc0497c40180b6d02d580 = $this->buildTables();$v39daa41bf389071ad9cd7a7a0ad2ff2c = $this->buildOptions($v15d61712450a686a7f365adf4fef581f);$vd14a8022b085f9ef19d479cbdd581127 = array();foreach($this->selector->types as $v599dcce2998a6b40b1e38e8c6006cb0a) {if($v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyType) $vd14a8022b085f9ef19d479cbdd581127[] = $v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyType->getId();}$ve067058f1b6dfcee3ff9b6e52cbada57 = implode(', ', $vd14a8022b085f9ef19d479cbdd581127);$v5a6f85b0e2c34b7c96af65b0f54b4dea = ($v15d61712450a686a7f365adf4fef581f == 'result') ? 'DISTINCT h.id' : 'COUNT(DISTINCT h.id)';$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT $v5a6f85b0e2c34b7c96af65b0f54b4dea
	FROM cms3_hierarchy hp, {$v75a8be0fca0bc0497c40180b6d02d580}
	{$vccc9e74cf27019ed02701010da900d6d}
	AND (h.rel = 0 OR (h.rel = hp.id AND hp.type_id NOT IN ({$ve067058f1b6dfcee3ff9b6e52cbada57})))
		{$va85bfb9c6bcd889ceb433a1c9cd4b218}
		{$vc6c12f4db6ba0426c8e023cb1ca31038}
SQL;   return $vac5c74b64b4b8352ef2f181affb5ac2a;}protected function excludeNestedPages(&$vbf516925bb37a8544c8ee19a24e15c05) {$v47c80780ab608cc046f2a6e6f071feb6 = array();reset($vbf516925bb37a8544c8ee19a24e15c05);while (($v843b5cb83e973a0a72a5404f064518fd = each($vbf516925bb37a8544c8ee19a24e15c05)) !== false) {list ($vb80bb7740288fda1f201890375a60c8f, $v0db3209e1adc6d67be435a81baf9a66e) = $v843b5cb83e973a0a72a5404f064518fd;if (!isset($vbf516925bb37a8544c8ee19a24e15c05[$v0db3209e1adc6d67be435a81baf9a66e])) {$v47c80780ab608cc046f2a6e6f071feb6[] = $vb80bb7740288fda1f201890375a60c8f;}}return $v47c80780ab608cc046f2a6e6f071feb6;}};class selectorGetter {protected static $types = array('object', 'page', 'object-type', 'hierarchy-type', 'field', 'field-type', 'domain', 'lang');protected $requestedType;public function __construct($v9c32b08fe4f1100357be3cefc37fb591) {if(in_array($v9c32b08fe4f1100357be3cefc37fb591, self::$types) == false) {throw new selectorException("Wrong content type \"{$v9c32b08fe4f1100357be3cefc37fb591}\"");}$this->requestedType = $v9c32b08fe4f1100357be3cefc37fb591;}public function id($vb80bb7740288fda1f201890375a60c8f) {if(is_array($vb80bb7740288fda1f201890375a60c8f)) {$result = array();foreach($vb80bb7740288fda1f201890375a60c8f as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {$v447b7147e84be512208dcc0995d67ebc = $this->id($v9e3669d19b675bd57058fd4664205d2a);if(is_object($v447b7147e84be512208dcc0995d67ebc)) {$result[$v865c0c0b4ab0e063e5caa3387c1a8741] = $v447b7147e84be512208dcc0995d67ebc;}unset($v447b7147e84be512208dcc0995d67ebc);}return $result;}if(!$vb80bb7740288fda1f201890375a60c8f) return null;$vdb6d9b451b818ccc9a449383f2f0c450 = $this->collection();try {switch($this->requestedType) {case 'object':      return $vdb6d9b451b818ccc9a449383f2f0c450->getObject($vb80bb7740288fda1f201890375a60c8f);case 'page':      return $vdb6d9b451b818ccc9a449383f2f0c450->getElement($vb80bb7740288fda1f201890375a60c8f);case 'hierarchy-type':     case 'object-type':      return $vdb6d9b451b818ccc9a449383f2f0c450->getType($vb80bb7740288fda1f201890375a60c8f);case 'field':      return $vdb6d9b451b818ccc9a449383f2f0c450->getField($vb80bb7740288fda1f201890375a60c8f);case 'field-type':      return $vdb6d9b451b818ccc9a449383f2f0c450->getFieldType($vb80bb7740288fda1f201890375a60c8f);case 'domain':      return $vdb6d9b451b818ccc9a449383f2f0c450->getDomain($vb80bb7740288fda1f201890375a60c8f);case 'lang':      return $vdb6d9b451b818ccc9a449383f2f0c450->getLang($vb80bb7740288fda1f201890375a60c8f);}}catch (coreException $ve1671797c52e15f763380b45e841ec32) {return null;}}public function name($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce = '') {$vdb6d9b451b818ccc9a449383f2f0c450 = $this->collection();switch($this->requestedType) {case 'object-type': {$v6301cee35ea764a1e241978f93f01069 = $vdb6d9b451b818ccc9a449383f2f0c450->getBaseType($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);return $this->id($v6301cee35ea764a1e241978f93f01069);}case 'hierarchy-type': {$v89b0b9deff65f8b9cd1f71bc74ce36ba = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeByName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);return ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) ? $v89b0b9deff65f8b9cd1f71bc74ce36ba : null;}default: throw new selectorException("Unsupported \"name\" method for \"{$this->requestedType}\"");}}public function prefix($v851f5ac9941d720844d143ed9cfcf60a) {if($this->requestedType != 'lang') {throw new selectorException("Unsupported \"prefix\" method for \"{$this->requestedType}\"");}$vdb6d9b451b818ccc9a449383f2f0c450 = $this->collection();return $this->id($vdb6d9b451b818ccc9a449383f2f0c450->getLangId($v851f5ac9941d720844d143ed9cfcf60a));}public function host($v67b3dba8bc6778101892eb77249db32e) {if($this->requestedType != 'domain') {throw new selectorException("Unsupported \"host\" method for \"{$this->requestedType}\"");}$vdb6d9b451b818ccc9a449383f2f0c450 = $this->collection();return $this->id($vdb6d9b451b818ccc9a449383f2f0c450->getDomainId($v67b3dba8bc6778101892eb77249db32e));}protected function collection() {switch($this->requestedType) {case 'object':     return umiObjectsCollection::getInstance();case 'page':     return umiHierarchy::getInstance();case 'object-type':     return umiObjectTypesCollection::getInstance();case 'hierarchy-type':     return umiHierarchyTypesCollection::getInstance();case 'field':     return umiFieldsCollection::getInstance();case 'field-type':     return umiFieldTypesCollection::getInstance();case 'domain':     return domainsCollection::getInstance();case 'lang':     return langsCollection::getInstance();}}};class selectorOption {protected $name, $value = array();public function __construct($vb068931cc450442b63f5b3d276ea4297) {$v1558595e0197d7bbd53e1ee6cae810af = array('or-mode', 'root', 'exclude-nested', 'return');if (in_array($vb068931cc450442b63f5b3d276ea4297, $v1558595e0197d7bbd53e1ee6cae810af)) $this->name = $vb068931cc450442b63f5b3d276ea4297;else throw new selectorException("Unkown option \"{$vb068931cc450442b63f5b3d276ea4297}\"");}public function __call($vea9f6aca279138c58f705c8d4cb4b8ce, $args) {$v27c9c7a40184647e1c3f49d7c85f812b = array('all', 'field', 'fields');$vea9f6aca279138c58f705c8d4cb4b8ce = strtolower($vea9f6aca279138c58f705c8d4cb4b8ce);if (in_array($vea9f6aca279138c58f705c8d4cb4b8ce, $v27c9c7a40184647e1c3f49d7c85f812b)) {$v2063c1608d6e0baf80249c42e2be5804 = false;if ($vea9f6aca279138c58f705c8d4cb4b8ce == 'all') $v2063c1608d6e0baf80249c42e2be5804 = true;elseif (sizeof($args)) $v2063c1608d6e0baf80249c42e2be5804 = $args;if ($v2063c1608d6e0baf80249c42e2be5804 !== false) $this->value[$vea9f6aca279138c58f705c8d4cb4b8ce] = $v2063c1608d6e0baf80249c42e2be5804;}elseif ($vea9f6aca279138c58f705c8d4cb4b8ce == 'value') {if ($v200fc6e6fd8b0f9aa0f80a5cadfda522 = sizeof($args)) {if ($this->name == 'or-mode') $this->value['all'] = true;else {if ($v200fc6e6fd8b0f9aa0f80a5cadfda522 == 1 && (is_array($args[0]) || $args[0] === true || $args[0] === false)) {$this->value = $args[0];}else $this->value = $args;}}else $this->value = null;}else throw new selectorException("This property doesn't support \"{$vea9f6aca279138c58f705c8d4cb4b8ce}\" method");}public function __get($v23a5b8ab834cb5140fa6665622eb6417) {return $this->$v23a5b8ab834cb5140fa6665622eb6417;}};class selectorHelper {static function detectFilters(selector $v8be74552df93e31bbdd6b36ed74bdb6a) {if($v8be74552df93e31bbdd6b36ed74bdb6a->mode == 'pages') {$ve4e46deb7f9cc58c7abfb32e5570b6f3 = (array) getRequest('domain_id');foreach($ve4e46deb7f9cc58c7abfb32e5570b6f3 as $v72ee76c5c29383b7c9f9225c1fa4d10b) {$v8be74552df93e31bbdd6b36ed74bdb6a->where('domain')->equals($v72ee76c5c29383b7c9f9225c1fa4d10b);}$v5a05866850c28651fe234659f6c92ada = (array) getRequest('lang_id');foreach($v5a05866850c28651fe234659f6c92ada as $vf585b7f018bb4ced15a03683a733e50b) {$v8be74552df93e31bbdd6b36ed74bdb6a->where('lang')->equals($vf585b7f018bb4ced15a03683a733e50b);}}if ( $v8be74552df93e31bbdd6b36ed74bdb6a->mode == 'pages' && sizeof($v8be74552df93e31bbdd6b36ed74bdb6a->types) && is_array(getRequest('rel')) && regedit::getInstance()->getVal('//modules/comments') ) {$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('comments', 'comment');}if( isset($_REQUEST['hierarchy_types'] ) ) {$vc7fcb1af65c062d638abb298ceddb52b = (array) $_REQUEST['hierarchy_types'];foreach($vc7fcb1af65c062d638abb298ceddb52b as $v9e3669d19b675bd57058fd4664205d2a) {$v9e3669d19b675bd57058fd4664205d2a = explode('-',$v9e3669d19b675bd57058fd4664205d2a);if(sizeof($v9e3669d19b675bd57058fd4664205d2a)==2)       $v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name($v9e3669d19b675bd57058fd4664205d2a[0],$v9e3669d19b675bd57058fd4664205d2a[1]);}}self::detectHierarchyFilters($v8be74552df93e31bbdd6b36ed74bdb6a);self::detectWhereFilters($v8be74552df93e31bbdd6b36ed74bdb6a);self::detectOrderFilters($v8be74552df93e31bbdd6b36ed74bdb6a);self::checkSyncParams($v8be74552df93e31bbdd6b36ed74bdb6a);}static function checkSyncParams(selector $v8be74552df93e31bbdd6b36ed74bdb6a) {if(getRequest('export')) {quickCsvExporter::autoExport($v8be74552df93e31bbdd6b36ed74bdb6a, (bool) getRequest('force-hierarchy'));}if(getRequest('import')) {quickCsvImporter::autoImport($v8be74552df93e31bbdd6b36ed74bdb6a, (bool) getRequest('force-hierarchy'));}}static function detectHierarchyFilters(selector $v8be74552df93e31bbdd6b36ed74bdb6a) {$v48908871a0d20dd2e5bd0a3d634ac745 = (array) getRequest('rel');if(sizeof($v48908871a0d20dd2e5bd0a3d634ac745) == 0 && $v8be74552df93e31bbdd6b36ed74bdb6a->mode == 'pages') {$v8be74552df93e31bbdd6b36ed74bdb6a->option('exclude-nested', true);}foreach($v48908871a0d20dd2e5bd0a3d634ac745 as $vb80bb7740288fda1f201890375a60c8f) {try {if($vb80bb7740288fda1f201890375a60c8f || $vb80bb7740288fda1f201890375a60c8f === '0') $v8be74552df93e31bbdd6b36ed74bdb6a->where('hierarchy')->page($vb80bb7740288fda1f201890375a60c8f)->childs(1);if($vb80bb7740288fda1f201890375a60c8f === '0') $v8be74552df93e31bbdd6b36ed74bdb6a->option('exclude-nested', true);}catch (selectorException $ve1671797c52e15f763380b45e841ec32) {}}}static function detectWhereFilters(selector $v8be74552df93e31bbdd6b36ed74bdb6a) {static $v4b5bea44af9baf871f58e4ecb54526ff = array('eq' => 'equals', 'ne' => 'notequals', 'like' => 'like', 'gt' => 'more', 'lt' => 'less' );$va339e2404792d7f8add09a5013066a3e = (array) getRequest('search-all-text');if(sizeof($v8be74552df93e31bbdd6b36ed74bdb6a->types) == 1 && ($v8be74552df93e31bbdd6b36ed74bdb6a->types[0]->objectType instanceof iUmiObjectType) && sizeof($v8be74552df93e31bbdd6b36ed74bdb6a->types[0]->objectType->getAllFields()) == 0) {foreach($va339e2404792d7f8add09a5013066a3e as $v597a51f04d341eba4ca965899acc10b3) {$v8be74552df93e31bbdd6b36ed74bdb6a->where('name')->like('%' . $v597a51f04d341eba4ca965899acc10b3 . '%');}return;}else {foreach($va339e2404792d7f8add09a5013066a3e as $v597a51f04d341eba4ca965899acc10b3) {try {if($v597a51f04d341eba4ca965899acc10b3 !== "") $v8be74552df93e31bbdd6b36ed74bdb6a->where('*')->like('%' . $v597a51f04d341eba4ca965899acc10b3 . '%');}catch (selectorException $ve1671797c52e15f763380b45e841ec32) {}}}$v2c9885d2b0c7e26971f60a90f33cf718 = (array) getRequest('fields_filter');foreach($v2c9885d2b0c7e26971f60a90f33cf718 as $v972bf3f05d14ffbdb817bef60638ff00 => $vcaf9b6b99962bf5c2264824231d7a40c) {if(is_array($vcaf9b6b99962bf5c2264824231d7a40c)) {if(isset($vcaf9b6b99962bf5c2264824231d7a40c[0]) && isset($vcaf9b6b99962bf5c2264824231d7a40c[1])) {try {$v8be74552df93e31bbdd6b36ed74bdb6a->where($v972bf3f05d14ffbdb817bef60638ff00)->between($vcaf9b6b99962bf5c2264824231d7a40c[0], $vcaf9b6b99962bf5c2264824231d7a40c[1]);}catch (selectorException $ve1671797c52e15f763380b45e841ec32) {}}foreach($vcaf9b6b99962bf5c2264824231d7a40c as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if(isset($v4b5bea44af9baf871f58e4ecb54526ff[$v865c0c0b4ab0e063e5caa3387c1a8741])) {try {if($v4b5bea44af9baf871f58e4ecb54526ff[$v865c0c0b4ab0e063e5caa3387c1a8741] == 'like') {$v9e3669d19b675bd57058fd4664205d2a .= '%';}if($v9e3669d19b675bd57058fd4664205d2a !== "") $v8be74552df93e31bbdd6b36ed74bdb6a->where($v972bf3f05d14ffbdb817bef60638ff00)->$v4b5bea44af9baf871f58e4ecb54526ff[$v865c0c0b4ab0e063e5caa3387c1a8741]($v9e3669d19b675bd57058fd4664205d2a);}catch(selectorException $ve1671797c52e15f763380b45e841ec32) {self::tryException($ve1671797c52e15f763380b45e841ec32);}}}}else {try {if($vcaf9b6b99962bf5c2264824231d7a40c !== "") $v8be74552df93e31bbdd6b36ed74bdb6a->where($v972bf3f05d14ffbdb817bef60638ff00)->equals($vcaf9b6b99962bf5c2264824231d7a40c);}catch(selectorException $ve1671797c52e15f763380b45e841ec32) {}}}}static function detectOrderFilters(selector $v8be74552df93e31bbdd6b36ed74bdb6a) {$v12c500ed0b7879105fb46af0f246be87 = (array) getRequest('order_filter');foreach($v12c500ed0b7879105fb46af0f246be87 as $v972bf3f05d14ffbdb817bef60638ff00 => $vef72c37be9d1b9e6e5bbd6ef09448abe) {$v7df4935f4a5a2865191ef74f64df8754 = (strtolower($vef72c37be9d1b9e6e5bbd6ef09448abe) == 'desc') ? 'desc' : 'asc';try {$v8be74552df93e31bbdd6b36ed74bdb6a->order($v972bf3f05d14ffbdb817bef60638ff00)->$v7df4935f4a5a2865191ef74f64df8754();}catch (selectorException $ve1671797c52e15f763380b45e841ec32) {self::tryException($ve1671797c52e15f763380b45e841ec32);}}}static private function tryException(Exception $ve1671797c52e15f763380b45e841ec32) {}};abstract class def_module {public static  $templates_cache = array(), $noRedirectOnPanic = false, $defaultTemplateName = 'default', $xsltResultMode = null;protected static $macrosesXsltExtendedResult = array(array(), array());public $max_pages = 10, $isSelectionFiltered = false;public $pid, $FORMS_CACHE = array(), $FORMS = array(), $per_page = 20;public $dataType, $actionType, $currentEditedElementId = false;public $__classes = array(), $libsCalled = array();public $common_tabs = null, $config_tabs = null;protected $errors = array();protected $errorPage = '';protected function __implement($v38c9bd9e6690779c49b5cea2617fa07c) {$this->__classes[] = $v38c9bd9e6690779c49b5cea2617fa07c;$v820eb5b696ea2a657c0db1e258dc7d81 = get_class_methods($v38c9bd9e6690779c49b5cea2617fa07c);if(is_null($v820eb5b696ea2a657c0db1e258dc7d81)) return;$v4d9d6c17eeae2754c9b49171261b93bd = "onInit";if(in_array($v4d9d6c17eeae2754c9b49171261b93bd, $v820eb5b696ea2a657c0db1e258dc7d81)) $this->$v4d9d6c17eeae2754c9b49171261b93bd();$v4d9d6c17eeae2754c9b49171261b93bd = "onImplement";if (in_array($v4d9d6c17eeae2754c9b49171261b93bd, $v820eb5b696ea2a657c0db1e258dc7d81) && class_exists('ReflectionClass')  && class_exists('ReflectionMethod') && class_exists('ReflectionException')) {try {$v209979537b932c207f8179bb76c93890 = new ReflectionClass($v38c9bd9e6690779c49b5cea2617fa07c);$vc31f8bdacd6556cf4c183aae689075a1 = $v209979537b932c207f8179bb76c93890->getMethod($v4d9d6c17eeae2754c9b49171261b93bd);if ($vc31f8bdacd6556cf4c183aae689075a1 instanceof ReflectionMethod) {if ($vc31f8bdacd6556cf4c183aae689075a1->isPublic()) {eval('$res = ' . $v38c9bd9e6690779c49b5cea2617fa07c . '::' . $v4d9d6c17eeae2754c9b49171261b93bd . '();');}}}catch (ReflectionException $ve1671797c52e15f763380b45e841ec32) {}}}public static function setMacrosExtendedResult($v7a9c583c97b63120627701be91f7fe82 = array(), $v4aaa7091e6b3e72468d094d95852b99e = array()) {self::$macrosesXsltExtendedResult = array($v7a9c583c97b63120627701be91f7fe82, $v4aaa7091e6b3e72468d094d95852b99e);}public static function getMacrosExtendedProps() {return self::$macrosesXsltExtendedResult[0];}public static function getMacrosExtendedGroups() {return self::$macrosesXsltExtendedResult[1];}public function __admin() {if(cmsController::getInstance()->getCurrentMode() == "admin" && !class_exists("__" . get_class($this))) {$this->__loadLib("__admin.php");$this->__implement("__" . get_class($this));}}public function __call($vea9f6aca279138c58f705c8d4cb4b8ce, $args) {foreach($this->__classes as $v6f66e878c62db60568a3487869695820) {$v9cf2b355321721c32cf156db7683c382 = get_class_methods($v6f66e878c62db60568a3487869695820);if(is_null($v9cf2b355321721c32cf156db7683c382)) continue;if(in_array($vea9f6aca279138c58f705c8d4cb4b8ce, $v9cf2b355321721c32cf156db7683c382)) {$v21ffce5b8a6cc8cc6a41448dd69623c9 = "";if(is_array($args)) {$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($args);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v21ffce5b8a6cc8cc6a41448dd69623c9 .= '$args[' . $v865c0c0b4ab0e063e5caa3387c1a8741 . ']';if($v865c0c0b4ab0e063e5caa3387c1a8741 != $v7dabf5c198b0bab2eaa42bb03a113e55-1) $v21ffce5b8a6cc8cc6a41448dd69623c9 .= ", ";}}$result = false;eval('$result = ' . $v6f66e878c62db60568a3487869695820 . '::' . $vea9f6aca279138c58f705c8d4cb4b8ce . '(' . $v21ffce5b8a6cc8cc6a41448dd69623c9 . ');');return $result;}}$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v8b1dc169bf460ee884fceef66c6607d6->langs[get_class($this)][$vea9f6aca279138c58f705c8d4cb4b8ce] = "Ошибка";$vd34fec3e69adc884a61c941174d12dc0 = $v8b1dc169bf460ee884fceef66c6607d6->getModule("content");if (!$vd34fec3e69adc884a61c941174d12dc0) {return '';}if ($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMode() == "admin") {return "Вызов несуществующего метода.";}if ($v8b1dc169bf460ee884fceef66c6607d6->getCurrentModule() == get_class($this) && $v8b1dc169bf460ee884fceef66c6607d6->getCurrentMethod() == $vea9f6aca279138c58f705c8d4cb4b8ce) {return $vd34fec3e69adc884a61c941174d12dc0->gen404();}else {return "";}}public function __construct() {$this->lang = cmsController::getInstance()->getCurrentLang()->getPrefix();$this->init();}public function getSortedModulesList() {$v8c08416b3f150309cf3bc93bbe3d4ba0 = Array(   'events'  => 1,    'content'  => 2,   'news'   => 3,    'menu'  => 4,   'forum'   => 5,    'blogs20'  => 6,   'vote'   => 7,    'comments'  => 8,   'photoalbum' => 9,    'webforms'  => 10,   'dispatches' => 11,    'faq'   => 12,   'eshop'   => 13,   'emarket'  => 14,    'catalog'  => 15,   'users'   => 16,    'banners'  => 17,   'seo'   => 18,    'stat'   => 19,   'social_networks' => 20,    'exchange'  => 21,   'data'   => 101,   'config'  => 102,   'backup'  => 103,   'autoupdate' => 104,   'webo'   => 105,   'search'  => 106,   'filemanager' => 107  );$vd3134b23eb03b77752dc3ae32a9ef2c4 = array('config', 'trash' ,'search', 'autoupdate');$vfa169c61c2f25544afde9a90364848fb = array('data','backup', 'webo', 'filemanager');$v0ffc9ad8303afce4216f05d62289e63c = regedit::getInstance()->getList('//modules');$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$result = array();foreach($v0ffc9ad8303afce4216f05d62289e63c as $v22884db148f0ffb0d830ba431102b0b5) {list( $v22884db148f0ffb0d830ba431102b0b5 ) = $v22884db148f0ffb0d830ba431102b0b5;if ( $v41275a535677f79ff347e01bc530c176->isAllowedModule(false, $v22884db148f0ffb0d830ba431102b0b5) == false ) {continue;}$vb988295c268025b49dfb3df26171ddc3 = isset($v8c08416b3f150309cf3bc93bbe3d4ba0[$v22884db148f0ffb0d830ba431102b0b5]) ? $v8c08416b3f150309cf3bc93bbe3d4ba0[$v22884db148f0ffb0d830ba431102b0b5] : 99;$result[$v22884db148f0ffb0d830ba431102b0b5] = $vb988295c268025b49dfb3df26171ddc3;}$vceb594c5f1b9a87761fe1885ffc65259 = $v41275a535677f79ff347e01bc530c176->isAllowedMethod( $v41275a535677f79ff347e01bc530c176->getUserId(), "data", "trash" );if ( system_get_skinName() == "mac" && $vceb594c5f1b9a87761fe1885ffc65259 != false ) {$result['trash'] = 999;}natsort($result);foreach($result as $v22884db148f0ffb0d830ba431102b0b5 => $vb988295c268025b49dfb3df26171ddc3) {if(in_array($v22884db148f0ffb0d830ba431102b0b5, $vd3134b23eb03b77752dc3ae32a9ef2c4))    $v599dcce2998a6b40b1e38e8c6006cb0a = 'system';else if(in_array($v22884db148f0ffb0d830ba431102b0b5, $vfa169c61c2f25544afde9a90364848fb))    $v599dcce2998a6b40b1e38e8c6006cb0a = 'util';else $v599dcce2998a6b40b1e38e8c6006cb0a = null;$vaf80a05f917adc9f186b87b7c7e00cab = array();$vaf80a05f917adc9f186b87b7c7e00cab['name'] = $v22884db148f0ffb0d830ba431102b0b5;$vaf80a05f917adc9f186b87b7c7e00cab['label'] = getLabel("module-" . $v22884db148f0ffb0d830ba431102b0b5);$vaf80a05f917adc9f186b87b7c7e00cab['type'] = $v599dcce2998a6b40b1e38e8c6006cb0a;$result[$v22884db148f0ffb0d830ba431102b0b5] = $vaf80a05f917adc9f186b87b7c7e00cab;}return $result;}public function getCommonTabs() {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v7b975dff6c0134c6f231fd13895c2349 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentModule();$vd0be0d735c5faa2c934694eb004edf15 = get_class($this);if (($v7b975dff6c0134c6f231fd13895c2349 != $vd0be0d735c5faa2c934694eb004edf15) && ($v7b975dff6c0134c6f231fd13895c2349 != false && $vd0be0d735c5faa2c934694eb004edf15 != 'users')) return false;if (!$this->common_tabs instanceof adminModuleTabs) {$this->common_tabs = new adminModuleTabs("common");}return $this->common_tabs;}public function getConfigTabs() {if (cmsController::getInstance()->getCurrentModule() != get_class($this)) return false;if (!$this->config_tabs instanceof adminModuleTabs) {$this->config_tabs = new adminModuleTabs("config");}return $this->config_tabs;}public function cms_callMethod($v2fa70149e2a7e75da2b0303d0a36a944, $args) {if(!$v2fa70149e2a7e75da2b0303d0a36a944) return;$v3f55633ad6a2b78c9c4f9787fecbf3bc = array();if(USE_REFLECTION_EXT && class_exists('ReflectionMethod')) {try {$va29fd518fa2a9b10f0cdaa6311ae9112   = new ReflectionMethod($this, $v2fa70149e2a7e75da2b0303d0a36a944);$v857375480bae137bd20938aafadc9163 = max($va29fd518fa2a9b10f0cdaa6311ae9112->getNumberOfRequiredParameters(), count($args));if($v857375480bae137bd20938aafadc9163) $v3f55633ad6a2b78c9c4f9787fecbf3bc = array_fill(0, $v857375480bae137bd20938aafadc9163, 0);}catch(Exception $ve1671797c52e15f763380b45e841ec32) {}}for($v865c0c0b4ab0e063e5caa3387c1a8741=0;$v865c0c0b4ab0e063e5caa3387c1a8741<count($args);$v865c0c0b4ab0e063e5caa3387c1a8741++) $v3f55633ad6a2b78c9c4f9787fecbf3bc[$v865c0c0b4ab0e063e5caa3387c1a8741] = $args[$v865c0c0b4ab0e063e5caa3387c1a8741];if(count($v3f55633ad6a2b78c9c4f9787fecbf3bc) && !(empty($args[0]) && sizeof($args) == 1)) {return call_user_func_array(array($this, $v2fa70149e2a7e75da2b0303d0a36a944), $v3f55633ad6a2b78c9c4f9787fecbf3bc);}else {return $this->$v2fa70149e2a7e75da2b0303d0a36a944();}}public function init() {if ($v6829cdfdefd69b947abedd8fa2c4bcc7 = cmsController::getInstance()->getResourcesDirectory()) {$vd4a32ede0a2c8f57c66072f681f21196 = realpath($v6829cdfdefd69b947abedd8fa2c4bcc7 . '/classes/modules') . '/' . get_class($this) . '/class.php';if (file_exists($vd4a32ede0a2c8f57c66072f681f21196)) {require_once $vd4a32ede0a2c8f57c66072f681f21196;$v6f66e878c62db60568a3487869695820 = get_class($this) . '_custom';if (!in_array($v6f66e878c62db60568a3487869695820, $this->__classes)) {$this->__implement($v6f66e878c62db60568a3487869695820);new $v6f66e878c62db60568a3487869695820($this);}}}$vd4a32ede0a2c8f57c66072f681f21196 = CURRENT_WORKING_DIR . '/classes/modules/' . get_class($this) . '/includes.php';if (file_exists($vd4a32ede0a2c8f57c66072f681f21196) && !defined('SKIP_MODULES_INCLUDES')) {require_once $vd4a32ede0a2c8f57c66072f681f21196;}}public static function checkHTTPReferer() {preg_match('|^http(?:s)?:\/\/(?:www\.)?([^/:]+)|ui', getServer('HTTP_REFERER'), $v9c28d32df234037773be184dbdafc274);if (!isset($v9c28d32df234037773be184dbdafc274[1]) || count($v9c28d32df234037773be184dbdafc274[1])!=1) {return false;}$v14a0ffee308315f250f040d5b4d48560 = domainsCollection::getInstance();if ($v14a0ffee308315f250f040d5b4d48560->getDomainId($v9c28d32df234037773be184dbdafc274[1])===false && $v14a0ffee308315f250f040d5b4d48560->getDomainId('www.'.$v9c28d32df234037773be184dbdafc274[1])===false) {return false;}return true;}public static function install($INFO) {$v3d788fa62d7c185a1bee4c9147ee1091 = '//modules/' . $INFO['name'];$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$vb1444fb0c07653567ad325aa25d4e37a->setVar($v3d788fa62d7c185a1bee4c9147ee1091, $INFO['name']);if(is_array($INFO)) {foreach($INFO as $vb2145aac704ce76dbe1ac7adac535b23 => $v64e4aa9627156d16045e98476d0cb2df) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v64e4aa9627156d16045e98476d0cb2df;$vb1444fb0c07653567ad325aa25d4e37a->setVar($v3d788fa62d7c185a1bee4c9147ee1091 . "/" . $vb2145aac704ce76dbe1ac7adac535b23, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}}}public function uninstall() {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v6f66e878c62db60568a3487869695820 = get_class($this);$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v43ffd9ee6b3f090d83614b1f94205d4e = $vb1444fb0c07653567ad325aa25d4e37a->getVal('//settings/default_module_admin');if ($v43ffd9ee6b3f090d83614b1f94205d4e == $v6f66e878c62db60568a3487869695820) {$vb1444fb0c07653567ad325aa25d4e37a->setVal('//settings/default_module_admin', 'content');}$v8ce4b16b22b58894aa86c421e8759df3 = $vb1444fb0c07653567ad325aa25d4e37a->getKey('//modules/' . $v6f66e878c62db60568a3487869695820);$vb1444fb0c07653567ad325aa25d4e37a->delVar('//modules/' . $v6f66e878c62db60568a3487869695820);}public function redirect($v572d4e421e5e6b9bc11d815e8a027112, $v4b600907378cf5f500d3eccfb74d7f87 = true) {if(getRequest('redirect_disallow')) return;if(!$v572d4e421e5e6b9bc11d815e8a027112) $v572d4e421e5e6b9bc11d815e8a027112 = $this->pre_lang . "/";if($v4b600907378cf5f500d3eccfb74d7f87 && (isset($this) && $this instanceof def_module)) $v572d4e421e5e6b9bc11d815e8a027112 = $this->removeErrorParam($v572d4e421e5e6b9bc11d815e8a027112);umiHierarchy::getInstance()->__destruct();outputBuffer::current()->redirect($v572d4e421e5e6b9bc11d815e8a027112);}public function requireSlashEnding() {if(getRequest('is_app_user') !== null) {return;}if(getRequest('xmlMode') == "force" || sizeof($_POST) > 0) {return;}if (getRequest('jsonMode') == "force" || sizeof($_POST) > 0) {return;}$v9305b73d359bd06734fee0b3638079e1 = getServer('REQUEST_URI');if($v9305b73d359bd06734fee0b3638079e1 == '/') {return;}$vbef65933acbed511ed4f607e97852f2b = parse_url($v9305b73d359bd06734fee0b3638079e1);if (cmsController::getInstance()->getCurrentMode() == "admin") {if(substr($vbef65933acbed511ed4f607e97852f2b['path'], -1, 1) != "/") {$v9305b73d359bd06734fee0b3638079e1 = $vbef65933acbed511ed4f607e97852f2b['path'] . "/";if(isset($vbef65933acbed511ed4f607e97852f2b['query']) && $vbef65933acbed511ed4f607e97852f2b['query']) {$v9305b73d359bd06734fee0b3638079e1 .= "?" . $vbef65933acbed511ed4f607e97852f2b['query'];}self::redirect($v9305b73d359bd06734fee0b3638079e1);}return;}if ($v5f44c555cfb3ecb28f624fa95617f277 = mainConfiguration::getInstance()->get('seo', 'url-suffix')){$v5e0bdcbddccca4d66d74ba8c1cee1a68 = strrpos($vbef65933acbed511ed4f607e97852f2b['path'], $v5f44c555cfb3ecb28f624fa95617f277);if ($v5e0bdcbddccca4d66d74ba8c1cee1a68 === false || !($v5e0bdcbddccca4d66d74ba8c1cee1a68 + strlen($v5f44c555cfb3ecb28f624fa95617f277) == strlen($vbef65933acbed511ed4f607e97852f2b['path']))) {$v9305b73d359bd06734fee0b3638079e1 = rtrim($vbef65933acbed511ed4f607e97852f2b['path'], '/') . $v5f44c555cfb3ecb28f624fa95617f277;if(isset($vbef65933acbed511ed4f607e97852f2b['query']) && $vbef65933acbed511ed4f607e97852f2b['query']) {$v9305b73d359bd06734fee0b3638079e1 .= "?" . $vbef65933acbed511ed4f607e97852f2b['query'];}self::redirect($v9305b73d359bd06734fee0b3638079e1);}}}protected function __loadLib($ve8acc63b1e238f3255c900eed37254b8, $vd6fe1d0be6347b8ef2427fa629c04485 = "", $vdc3c99bb4e249a95567a2bf7d5f327ed = false) {$v9f8629bce6f6014f7ffecc272843c09f = ($vd6fe1d0be6347b8ef2427fa629c04485) ? $vd6fe1d0be6347b8ef2427fa629c04485 . $ve8acc63b1e238f3255c900eed37254b8 : "classes/modules/" . get_class($this) . "/" . $ve8acc63b1e238f3255c900eed37254b8;$vd6fe1d0be6347b8ef2427fa629c04485 = ($vd6fe1d0be6347b8ef2427fa629c04485) ? $v9f8629bce6f6014f7ffecc272843c09f : CURRENT_WORKING_DIR . '/' . $v9f8629bce6f6014f7ffecc272843c09f;if (isset($this->FORMS_CACHE[$v9f8629bce6f6014f7ffecc272843c09f])) {$FORMS = $this->FORMS_CACHE[$v9f8629bce6f6014f7ffecc272843c09f];}else {if (file_exists($vd6fe1d0be6347b8ef2427fa629c04485)) require_once $vd6fe1d0be6347b8ef2427fa629c04485;}if($vdc3c99bb4e249a95567a2bf7d5f327ed) {$this->FORMS = $FORMS;$this->FORMS_CACHE[$v9f8629bce6f6014f7ffecc272843c09f] = $FORMS;}return true;}public function setHeader($v099fb995346f31c749f6e40db0f395e3) {$v4d424a5679c0aa6e84a0235ec1949c43 = cmsController::getInstance();$v4d424a5679c0aa6e84a0235ec1949c43->currentHeader = $v099fb995346f31c749f6e40db0f395e3;}protected function setTitle($vd5d3db1765287eef77d7927cc956f50a = "", $v15d61712450a686a7f365adf4fef581f = 0) {$v4d424a5679c0aa6e84a0235ec1949c43 = cmsController::getInstance();if($vd5d3db1765287eef77d7927cc956f50a) {if($v15d61712450a686a7f365adf4fef581f)    $v4d424a5679c0aa6e84a0235ec1949c43->currentTitle = regedit::getInstance()->getVal('//domains/' . $_REQUEST['domain'] . '/title_pref_' . $_REQUEST['lang']) . $vd5d3db1765287eef77d7927cc956f50a;else    $v4d424a5679c0aa6e84a0235ec1949c43->currentTitle = $vd5d3db1765287eef77d7927cc956f50a;}else   $v4d424a5679c0aa6e84a0235ec1949c43->currentTitle = cmsController::getInstance()->currentHeader;}protected function setH1($v346b81a32e7007eccadf60252bb599f0) {$this->setHeader($v346b81a32e7007eccadf60252bb599f0);}public function flush($v78e6221f6393d1356681db398f14ce6d = "", $v0cc9cc73ee8fb2aca47ef76287572fdd = false) {if($v0cc9cc73ee8fb2aca47ef76287572fdd !== false) {header("Content-type: " . $v0cc9cc73ee8fb2aca47ef76287572fdd);}echo $v78e6221f6393d1356681db398f14ce6d;exit();}public static function loadTemplatesMeta($v6a2a431fe8b621037ea949531c28551d = "") {$vdbc11caa5bda99f77e6fb4dabd882e7d = func_get_args();$vfed36e93a0509e20f2dc96cbbd85b678 = call_user_func_array(array('def_module', "loadTemplates"), $vdbc11caa5bda99f77e6fb4dabd882e7d);for($v865c0c0b4ab0e063e5caa3387c1a8741=1;$v865c0c0b4ab0e063e5caa3387c1a8741 < count($vdbc11caa5bda99f77e6fb4dabd882e7d);$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vfed36e93a0509e20f2dc96cbbd85b678[$v865c0c0b4ab0e063e5caa3387c1a8741-1] = $vfed36e93a0509e20f2dc96cbbd85b678[$v865c0c0b4ab0e063e5caa3387c1a8741-1] ? array("#template" => $vfed36e93a0509e20f2dc96cbbd85b678[$v865c0c0b4ab0e063e5caa3387c1a8741-1], "#meta" => array("name" => $vdbc11caa5bda99f77e6fb4dabd882e7d[$v865c0c0b4ab0e063e5caa3387c1a8741], "file" => $v6a2a431fe8b621037ea949531c28551d)) : $vfed36e93a0509e20f2dc96cbbd85b678[$v865c0c0b4ab0e063e5caa3387c1a8741-1];}return $vfed36e93a0509e20f2dc96cbbd85b678;}public static function loadTemplates($v47826cacc65c665212b821e6ff80b9b0 = "") {$args = func_get_args();$v640eac53ad75db5c49a9ec86390d8530 = self::isXSLTResultMode() ? 'umiTemplaterXSLT' : 'umiTemplaterTPL';if (!self::isXSLTResultMode() && !is_file($v47826cacc65c665212b821e6ff80b9b0)) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v3dfc504080246659af41d36f9366d52c = langsCollection::getInstance()->getDefaultLang();$v6260204e62537354783e453ec069a046 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang();$v6829cdfdefd69b947abedd8fa2c4bcc7 = $v8b1dc169bf460ee884fceef66c6607d6->getResourcesDirectory();$v535d02e594853266d2db02ff178dd7f7 = '';if ($v3dfc504080246659af41d36f9366d52c && $v6260204e62537354783e453ec069a046 && ($v3dfc504080246659af41d36f9366d52c->getId() != $v6260204e62537354783e453ec069a046->getId())) {$v535d02e594853266d2db02ff178dd7f7 = $v6260204e62537354783e453ec069a046->getPrefix();}if (substr($v47826cacc65c665212b821e6ff80b9b0, -4) === '.tpl') {$v47826cacc65c665212b821e6ff80b9b0 = substr($v47826cacc65c665212b821e6ff80b9b0, 0, -4);}$v45b963397aa40d4a0063e0d85e4fe7a1 = array();if ( system_is_mobile() ) {$v1af4d7e444526825e8273a27c76ccc15 = explode('/', $v47826cacc65c665212b821e6ff80b9b0);$vc99442f239a975ab3c36a6942f4a69c7 = '/mobile/' . array_pop($v1af4d7e444526825e8273a27c76ccc15);$vc99442f239a975ab3c36a6942f4a69c7 = implode('/', $v1af4d7e444526825e8273a27c76ccc15) . $vc99442f239a975ab3c36a6942f4a69c7;if ( strlen($v535d02e594853266d2db02ff178dd7f7) ) {$v45b963397aa40d4a0063e0d85e4fe7a1[] = $vc99442f239a975ab3c36a6942f4a69c7 . '.' . $v535d02e594853266d2db02ff178dd7f7;}$v45b963397aa40d4a0063e0d85e4fe7a1[] = $vc99442f239a975ab3c36a6942f4a69c7;}if ( strlen($v535d02e594853266d2db02ff178dd7f7) ) {$v45b963397aa40d4a0063e0d85e4fe7a1[] = $v47826cacc65c665212b821e6ff80b9b0 . '.' . $v535d02e594853266d2db02ff178dd7f7;}$v45b963397aa40d4a0063e0d85e4fe7a1[] = $v47826cacc65c665212b821e6ff80b9b0;$v736007832d2167baaae763fd3a3f3cf1 = rtrim(($v6829cdfdefd69b947abedd8fa2c4bcc7 ? $v6829cdfdefd69b947abedd8fa2c4bcc7 : CURRENT_WORKING_DIR), '/') . '/tpls/';foreach($v45b963397aa40d4a0063e0d85e4fe7a1 as $v47826cacc65c665212b821e6ff80b9b0) {$v47826cacc65c665212b821e6ff80b9b0 = $v736007832d2167baaae763fd3a3f3cf1 . $v47826cacc65c665212b821e6ff80b9b0. '.tpl';if ( is_file($v47826cacc65c665212b821e6ff80b9b0) ) {break;}}$args[0] = $v47826cacc65c665212b821e6ff80b9b0;}$result = call_user_func_array(array(   $v640eac53ad75db5c49a9ec86390d8530, 'getTemplates'  ), $args);return $result;}public static function loadTemplatesForMail($v47826cacc65c665212b821e6ff80b9b0 = "") {if (substr($v47826cacc65c665212b821e6ff80b9b0, -4) === '.tpl') {$v47826cacc65c665212b821e6ff80b9b0 = substr($v47826cacc65c665212b821e6ff80b9b0, 0, -4);}$v6a559eac8ab38b0b76a6fca32dcb9749 = $v47826cacc65c665212b821e6ff80b9b0;if (strpos($v6a559eac8ab38b0b76a6fca32dcb9749, "mail") !== false) {$v6a559eac8ab38b0b76a6fca32dcb9749 = str_replace(array("mail/", "mails/"), array('', ''), $v6a559eac8ab38b0b76a6fca32dcb9749);}if ($v6829cdfdefd69b947abedd8fa2c4bcc7 = cmsController::getInstance()->getResourcesDirectory()) {$v78d9546862ca881fe1073d4eff9722ab = $v6829cdfdefd69b947abedd8fa2c4bcc7 . "/xslt/mail/" . $v6a559eac8ab38b0b76a6fca32dcb9749 . ".xsl";$v89309e3c0cfa042543ba21bfec8a6156 = $v6829cdfdefd69b947abedd8fa2c4bcc7 . "/tpls/" . $v47826cacc65c665212b821e6ff80b9b0 . ".tpl";}else {$v78d9546862ca881fe1073d4eff9722ab = CURRENT_WORKING_DIR . "/xsltTpls/mail/" . $v6a559eac8ab38b0b76a6fca32dcb9749 . ".xsl";$v89309e3c0cfa042543ba21bfec8a6156 = CURRENT_WORKING_DIR . "/tpls/" . $v47826cacc65c665212b821e6ff80b9b0 . ".tpl";}$v2fc0ee40a595762e231f441cf58711d3 = null;if (is_file($v78d9546862ca881fe1073d4eff9722ab)) {$v2fc0ee40a595762e231f441cf58711d3 = 'umiTemplaterXSLT';$vba1383ce0ab1b09b605e4c7010356023 = $v78d9546862ca881fe1073d4eff9722ab;}elseif (is_file($v89309e3c0cfa042543ba21bfec8a6156)) {$v2fc0ee40a595762e231f441cf58711d3 = 'umiTemplaterTPL';$vba1383ce0ab1b09b605e4c7010356023 = $v89309e3c0cfa042543ba21bfec8a6156;}else {throw new coreException("Невозможно подключить шаблон \"{$v47826cacc65c665212b821e6ff80b9b0}\" для отправки письма", 2);}$args = func_get_args();$args[0] = $vba1383ce0ab1b09b605e4c7010356023;$result = call_user_func_array(array(   $v2fc0ee40a595762e231f441cf58711d3, 'getTemplates'  ), $args);return $result;}public static function parseTPLMacroses($v9a0364b9e99bb480dd25e1f0284c8555, $vaf0bf69b4590545119c86ee0e59c088d = false, $v5d8603331b744a86bd36e07552225714 = false, $v38f6b9a82e70bf7b0c240ce3e48f3d47 = array()) {if (strpos($v9a0364b9e99bb480dd25e1f0284c8555, '%') === false) return $v9a0364b9e99bb480dd25e1f0284c8555;$v8980246496f088322ddf9eca96750755 = umiTemplater::create('TPL');$v8980246496f088322ddf9eca96750755->setScope($vaf0bf69b4590545119c86ee0e59c088d, $v5d8603331b744a86bd36e07552225714);return $v8980246496f088322ddf9eca96750755->parse($v38f6b9a82e70bf7b0c240ce3e48f3d47, $v9a0364b9e99bb480dd25e1f0284c8555);}public static function parseTemplate($v66f6181bcb4cff4cd38fbc804a036db6, $v47c80780ab608cc046f2a6e6f071feb6, $vfb7ab9257f439d2f8d60f02aff686db4 = false, $vf82387093c2d547d55f1c4ad7b8b4e16 = false, $ved4cbba2712a5b0bb6881a7a1b0c0a4a = null) {$v594c103f2c6e04c3d8ab059f031e0c1a = cmsController::getInstance();if (!is_array($v47c80780ab608cc046f2a6e6f071feb6)) $v47c80780ab608cc046f2a6e6f071feb6 = array();$v4a4342178dad007c454130c4dd77d9e4 = null;if (is_bool($ved4cbba2712a5b0bb6881a7a1b0c0a4a)) {$v4a4342178dad007c454130c4dd77d9e4 = self::isXSLTResultMode($ved4cbba2712a5b0bb6881a7a1b0c0a4a);}if (self::isXSLTResultMode()) {$result = array();$v7a9c583c97b63120627701be91f7fe82 = self::getMacrosExtendedProps();$v4aaa7091e6b3e72468d094d95852b99e = self::getMacrosExtendedGroups();if ((!empty($v7a9c583c97b63120627701be91f7fe82) || !empty($v4aaa7091e6b3e72468d094d95852b99e)) && ($vfb7ab9257f439d2f8d60f02aff686db4 || $vf82387093c2d547d55f1c4ad7b8b4e16)) {if ($vfb7ab9257f439d2f8d60f02aff686db4) {$vf5e638cc78dd325906c1298a0c21fb6b = umiHierarchy::getInstance()->getElement($vfb7ab9257f439d2f8d60f02aff686db4);if ($vf5e638cc78dd325906c1298a0c21fb6b) $vf5e638cc78dd325906c1298a0c21fb6b = $vf5e638cc78dd325906c1298a0c21fb6b->getObject();}else {$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectsCollection::getInstance()->getObject($vf82387093c2d547d55f1c4ad7b8b4e16);}if ($vf5e638cc78dd325906c1298a0c21fb6b) {$vd5915fe95c249b45edb664a24c7f0390 = array();foreach ($v7a9c583c97b63120627701be91f7fe82 as $v972bf3f05d14ffbdb817bef60638ff00) {if ($v972bf3f05d14ffbdb817bef60638ff00 == 'name' && !isset($v47c80780ab608cc046f2a6e6f071feb6['attribute:name'], $v47c80780ab608cc046f2a6e6f071feb6['@name'])) {$v47c80780ab608cc046f2a6e6f071feb6['@name'] = $vf5e638cc78dd325906c1298a0c21fb6b->getName();}elseif ($vbc1fe0e06161c85d7ff66b2e82835deb = $vf5e638cc78dd325906c1298a0c21fb6b->getPropByName($v972bf3f05d14ffbdb817bef60638ff00)) {$vd5915fe95c249b45edb664a24c7f0390[] = $vbc1fe0e06161c85d7ff66b2e82835deb;}}if (count($vd5915fe95c249b45edb664a24c7f0390)) {if (!isset($v47c80780ab608cc046f2a6e6f071feb6['extended'])) $v47c80780ab608cc046f2a6e6f071feb6['extended'] = array();$v47c80780ab608cc046f2a6e6f071feb6['extended']['properties'] = array('+property' => $vd5915fe95c249b45edb664a24c7f0390);}$vc437cb71c701209eead86df905660492 = array();foreach ($v4aaa7091e6b3e72468d094d95852b99e as $va2b861d0e7719d9108522aacfd4181bc) {if ($vdb0f6f37ebeb6ea09489124345af2a45 = $vf5e638cc78dd325906c1298a0c21fb6b->getType()->getFieldsGroupByName($va2b861d0e7719d9108522aacfd4181bc)) {$v03f2ce8694aef1464a97f254c78a26ae = translatorWrapper::get($vdb0f6f37ebeb6ea09489124345af2a45);$vc437cb71c701209eead86df905660492[] = $v03f2ce8694aef1464a97f254c78a26ae->translateProperties($vdb0f6f37ebeb6ea09489124345af2a45, $vf5e638cc78dd325906c1298a0c21fb6b);}}if (count($vc437cb71c701209eead86df905660492)) {if (!isset($v47c80780ab608cc046f2a6e6f071feb6['extended'])) $v47c80780ab608cc046f2a6e6f071feb6['extended'] = array();$v47c80780ab608cc046f2a6e6f071feb6['extended']['groups'] = array('+group' => $vc437cb71c701209eead86df905660492);}}}foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (is_null($v3a6d0284e743dc4a9b86f97d6dd1a3bf) || $v3a6d0284e743dc4a9b86f97d6dd1a3bf === false || $v3a6d0284e743dc4a9b86f97d6dd1a3bf === "") continue;if (is_array($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::parseTemplate($v66f6181bcb4cff4cd38fbc804a036db6, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}$v518d8dec3947df909fe6e4c9940f98a6 = xmlTranslator::getSubKey($v3c6e0b8a9c15224a8228b9a98ca1531d);if($v518d8dec3947df909fe6e4c9940f98a6 == "subnodes") {$vde0366a04f7345d0b277b28f9e86f357 = xmlTranslator::getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d);$result[$vde0366a04f7345d0b277b28f9e86f357] = array(      'nodes:item' => $v3a6d0284e743dc4a9b86f97d6dd1a3bf     );continue;}$result[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v3a6d0284e743dc4a9b86f97d6dd1a3bf;}return $result;}else {$v640eac53ad75db5c49a9ec86390d8530 = umiTemplater::create('TPL');$v87cd8b8808600624d8c590cfc2e6e94b = array();foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v6f8f57715090da2632453988d9a1501b => $v9e3669d19b675bd57058fd4664205d2a) {$v6f8f57715090da2632453988d9a1501b = self::getRealKey($v6f8f57715090da2632453988d9a1501b);if(is_array($v9e3669d19b675bd57058fd4664205d2a)) {$v9b207167e5381c47682c6b4f58a623fb = "";$v9e3669d19b675bd57058fd4664205d2a = array_values($v9e3669d19b675bd57058fd4664205d2a);$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v9e3669d19b675bd57058fd4664205d2a);for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v341be97d9aff90c9978347f66f945b77 = $v9e3669d19b675bd57058fd4664205d2a[$v865c0c0b4ab0e063e5caa3387c1a8741];$va19373d8cf7848b7a7a64585a21e588f = ($v865c0c0b4ab0e063e5caa3387c1a8741 == 0) ? "first" : "";$v3fc83eb3fa31aa67931bfa8bc28d226b = ($v865c0c0b4ab0e063e5caa3387c1a8741 == $v7dabf5c198b0bab2eaa42bb03a113e55-1) ? "last" : "";$vde52846838c8fd48e802d9bbd5c16dfb = (($v865c0c0b4ab0e063e5caa3387c1a8741+1) % 2 == 0) ? "odd" : "";$v9fecaef75a60788aa9752fdba935e8f7 = $vde52846838c8fd48e802d9bbd5c16dfb ? "" : "even";$vdfe9983b41f9b6b0cc15c0910cb78687 = ($v865c0c0b4ab0e063e5caa3387c1a8741 + 1);$v1980437b4ed46cecf41a68f16dd59311 = $v3fc83eb3fa31aa67931bfa8bc28d226b ? '' : ', ';$vd98a07f84921b24ee30f86fd8cd85c3c = Array(       '%list-class-first%', '%list-class-last%', '%list-class-odd%', '%list-class-even%', '%list-position%',       '%list-comma%'      );$v01b6e20344b68835c5ed1ddedf20d531 = Array(       $va19373d8cf7848b7a7a64585a21e588f, $v3fc83eb3fa31aa67931bfa8bc28d226b, $vde52846838c8fd48e802d9bbd5c16dfb, $v9fecaef75a60788aa9752fdba935e8f7, $vdfe9983b41f9b6b0cc15c0910cb78687, $v1980437b4ed46cecf41a68f16dd59311      );$v9b207167e5381c47682c6b4f58a623fb .= str_replace($vd98a07f84921b24ee30f86fd8cd85c3c, $v01b6e20344b68835c5ed1ddedf20d531, $v341be97d9aff90c9978347f66f945b77);}$v9e3669d19b675bd57058fd4664205d2a = $v9b207167e5381c47682c6b4f58a623fb;}if(!is_object($v9e3669d19b675bd57058fd4664205d2a)) {$v87cd8b8808600624d8c590cfc2e6e94b[$v6f8f57715090da2632453988d9a1501b] = $v9e3669d19b675bd57058fd4664205d2a;}}$v47c80780ab608cc046f2a6e6f071feb6 = $v87cd8b8808600624d8c590cfc2e6e94b;}$v640eac53ad75db5c49a9ec86390d8530->setScope($vfb7ab9257f439d2f8d60f02aff686db4, $vf82387093c2d547d55f1c4ad7b8b4e16);$result = $v640eac53ad75db5c49a9ec86390d8530->parse($v47c80780ab608cc046f2a6e6f071feb6, $v66f6181bcb4cff4cd38fbc804a036db6);$result = $v640eac53ad75db5c49a9ec86390d8530->replaceCommentsAfterParse($result);if (!is_null($v4a4342178dad007c454130c4dd77d9e4)) {self::isXSLTResultMode($v4a4342178dad007c454130c4dd77d9e4);}return $result;}public static function renderTemplate($v66f6181bcb4cff4cd38fbc804a036db6, $v14511f2f5564650d129ca7cabc333278, $v8c51095009676ab05282b2c05a5917f6 = array(), $v7552cd149af7495ee7d8225974e50f80 = false) {list($v4f2afc9c4099ee1f39c9f551123e54bd) = def_module::loadTemplates($v66f6181bcb4cff4cd38fbc804a036db6, $v14511f2f5564650d129ca7cabc333278);return def_module::parseTemplate($v4f2afc9c4099ee1f39c9f551123e54bd, $v8c51095009676ab05282b2c05a5917f6, $v7552cd149af7495ee7d8225974e50f80);}public static function parseTemplateForMail($v66f6181bcb4cff4cd38fbc804a036db6, $v47c80780ab608cc046f2a6e6f071feb6, $vfb7ab9257f439d2f8d60f02aff686db4 = false, $vf82387093c2d547d55f1c4ad7b8b4e16 = false) {if (strpos($v66f6181bcb4cff4cd38fbc804a036db6, 'file://') === 0) {$v824f0a4faad1c4ccea8d68cc5717db93 = @parse_url($v66f6181bcb4cff4cd38fbc804a036db6);if (!is_array($v824f0a4faad1c4ccea8d68cc5717db93)) {throw new publicException('Невозможно обработать шаблон "' . $v66f6181bcb4cff4cd38fbc804a036db6 . '"');}$vfbf236c2ed0d94c877048bc5bb1db3d9 = $v824f0a4faad1c4ccea8d68cc5717db93['path'];$v6ad17e4f2a02b6cc1b795ed671ab4430 = (isset($v824f0a4faad1c4ccea8d68cc5717db93['fragment']) && strlen($v824f0a4faad1c4ccea8d68cc5717db93['fragment'])) ? $v824f0a4faad1c4ccea8d68cc5717db93['fragment'] : 'result';$v640eac53ad75db5c49a9ec86390d8530 = umiTemplater::create('XSLT', $vfbf236c2ed0d94c877048bc5bb1db3d9);return $v640eac53ad75db5c49a9ec86390d8530->parse(array(    $v6ad17e4f2a02b6cc1b795ed671ab4430 => $v47c80780ab608cc046f2a6e6f071feb6   ));}else {return def_module::parseTemplate($v66f6181bcb4cff4cd38fbc804a036db6, $v47c80780ab608cc046f2a6e6f071feb6, $vfb7ab9257f439d2f8d60f02aff686db4, $vf82387093c2d547d55f1c4ad7b8b4e16, false);}}public static function parseContent($v66f6181bcb4cff4cd38fbc804a036db6, $v47c80780ab608cc046f2a6e6f071feb6, $vfb7ab9257f439d2f8d60f02aff686db4 = false, $vf82387093c2d547d55f1c4ad7b8b4e16 = false) {return self::parseTemplateForMail($v66f6181bcb4cff4cd38fbc804a036db6, $v47c80780ab608cc046f2a6e6f071feb6, $vfb7ab9257f439d2f8d60f02aff686db4, $vf82387093c2d547d55f1c4ad7b8b4e16);}static public function getRealKey($v3c6e0b8a9c15224a8228b9a98ca1531d, $v4d9c2073afa3c2abb817dceb22c34de6 = false) {$v2d22f3163256d29f2b7c36d81f13fb26 = array('@', '#', '+', '%', '*');if(in_array(substr($v3c6e0b8a9c15224a8228b9a98ca1531d, 0, 1), $v2d22f3163256d29f2b7c36d81f13fb26)) {return substr($v3c6e0b8a9c15224a8228b9a98ca1531d, 1);}if($v5e0bdcbddccca4d66d74ba8c1cee1a68 = strpos($v3c6e0b8a9c15224a8228b9a98ca1531d, ":")) {++$v5e0bdcbddccca4d66d74ba8c1cee1a68;}else {$v5e0bdcbddccca4d66d74ba8c1cee1a68 = 0;}return $v4d9c2073afa3c2abb817dceb22c34de6 ? substr($v3c6e0b8a9c15224a8228b9a98ca1531d, 0, $v5e0bdcbddccca4d66d74ba8c1cee1a68 - 1) : substr($v3c6e0b8a9c15224a8228b9a98ca1531d, $v5e0bdcbddccca4d66d74ba8c1cee1a68);}public function formatMessage($v78e731027d8fd50ed642340b7c9a63b3, $v53ba30e62ebd73a4c463bf0f89122428 = 0) {static $v07bc986ba2309c96bfee8ab44fcd7a7b;static $vbcffce8c435eab26326994a1a20de892;$vc6e04a063682d1a8e122995752335853 = $this->isXSLTResultMode(false);try {list($va63684ca0122549cf2f21d0b2e40871e, $v909d9619443130093af575e7f221a15d) = $this->loadTemplates('quote/default', 'quote_begin', 'quote_end');}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$va63684ca0122549cf2f21d0b2e40871e = "<div class='quote'>";$v909d9619443130093af575e7f221a15d = "</div>";}if (self::isXSLTResultMode()) {$va63684ca0122549cf2f21d0b2e40871e = "<div class='quote'>";$v909d9619443130093af575e7f221a15d = "</div>";}if (!(is_array($v07bc986ba2309c96bfee8ab44fcd7a7b) && is_array($vbcffce8c435eab26326994a1a20de892) && count($v07bc986ba2309c96bfee8ab44fcd7a7b) === count($vbcffce8c435eab26326994a1a20de892))) {try {list($v07bc986ba2309c96bfee8ab44fcd7a7b, $vbcffce8c435eab26326994a1a20de892) = $this->loadTemplates('bb/default', 'bb_from', 'bb_to');if (!(is_array($v07bc986ba2309c96bfee8ab44fcd7a7b) && is_array($vbcffce8c435eab26326994a1a20de892) && count($v07bc986ba2309c96bfee8ab44fcd7a7b) === count($vbcffce8c435eab26326994a1a20de892) && count($vbcffce8c435eab26326994a1a20de892))) {$v07bc986ba2309c96bfee8ab44fcd7a7b = Array("[b]", "[i]", "[/b]", "[/i]",      "[quote]", "[/quote]", "[u]", "[/u]", "\r\n"     );$vbcffce8c435eab26326994a1a20de892   = Array("<strong>", "<em>", "</strong>", "</em>",      $va63684ca0122549cf2f21d0b2e40871e, $v909d9619443130093af575e7f221a15d, "<u>", "</u>", "<br />"     );}}catch (publicException $ve1671797c52e15f763380b45e841ec32) {$v07bc986ba2309c96bfee8ab44fcd7a7b = Array("[b]", "[i]", "[/b]", "[/i]",     "[quote]", "[/quote]", "[u]", "[/u]", "\r\n"    );$vbcffce8c435eab26326994a1a20de892   = Array("<strong>", "<em>", "</strong>", "</em>",     $va63684ca0122549cf2f21d0b2e40871e, $v909d9619443130093af575e7f221a15d, "<u>", "</u>", "<br />"    );}}$v6d65d06366b15d5773bba936bb9e7b0c = substr_count(wa_strtolower($v78e731027d8fd50ed642340b7c9a63b3), "[quote]");$v8671c37a8592584b608e129b2b08a126 = substr_count(wa_strtolower($v78e731027d8fd50ed642340b7c9a63b3), "[/quote]");if($v6d65d06366b15d5773bba936bb9e7b0c > $v8671c37a8592584b608e129b2b08a126) {$v78e731027d8fd50ed642340b7c9a63b3 .= str_repeat("[/quote]", $v6d65d06366b15d5773bba936bb9e7b0c - $v8671c37a8592584b608e129b2b08a126);}if($v6d65d06366b15d5773bba936bb9e7b0c < $v8671c37a8592584b608e129b2b08a126) {$v78e731027d8fd50ed642340b7c9a63b3 = str_repeat("[quote]", $v8671c37a8592584b608e129b2b08a126 - $v6d65d06366b15d5773bba936bb9e7b0c) . $v78e731027d8fd50ed642340b7c9a63b3;}$v78e731027d8fd50ed642340b7c9a63b3 = preg_replace("`((http)+(s)?:(//)|(www\.))((\w|\.|\-|_)+)(/)?([/|#|?|&|=|\w|\.|\-|_]+)?`i", "[url]http\\3://\\5\\6\\8\\9[/url]", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_ireplace($v07bc986ba2309c96bfee8ab44fcd7a7b, $vbcffce8c435eab26326994a1a20de892, $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_ireplace("</h4>", "</h4><p>", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_ireplace("</div>", "</p></div>", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_replace(".[/url]", "[/url].", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_replace(",[/url]", "[/url],", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_replace(Array("[url][url]", "[/url][/url]"), Array("[url]", "[/url]"), $v78e731027d8fd50ed642340b7c9a63b3);if ($v53ba30e62ebd73a4c463bf0f89122428 === 0) {$v812c342988bda380c1d0c3f65c76ff21 = array();$v9200dff13536775b0403786f82503726 = preg_match_all("/[^\s^<^>]{70,}/u", $v78e731027d8fd50ed642340b7c9a63b3, $v812c342988bda380c1d0c3f65c76ff21);if ($v9200dff13536775b0403786f82503726 && isset($v812c342988bda380c1d0c3f65c76ff21[0]) && is_array($v812c342988bda380c1d0c3f65c76ff21[0])) {foreach ($v812c342988bda380c1d0c3f65c76ff21[0] as $v341be97d9aff90c9978347f66f945b77) {$v03c7c0ace395d80182db07ae2c30f034 = "";if (strpos($v341be97d9aff90c9978347f66f945b77, "[url]") === false) {for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741<wa_strlen($v341be97d9aff90c9978347f66f945b77);$v865c0c0b4ab0e063e5caa3387c1a8741++) $v03c7c0ace395d80182db07ae2c30f034 .= wa_substr($v341be97d9aff90c9978347f66f945b77, $v865c0c0b4ab0e063e5caa3387c1a8741, 1).(($v865c0c0b4ab0e063e5caa3387c1a8741 % 30) === 0 ? " " : "");$v78e731027d8fd50ed642340b7c9a63b3 = str_replace($v341be97d9aff90c9978347f66f945b77, $v03c7c0ace395d80182db07ae2c30f034, $v78e731027d8fd50ed642340b7c9a63b3);}}}}elseif ($v53ba30e62ebd73a4c463bf0f89122428 === 1) {}if (preg_match_all("/\[url\]([^А-я^\r^\n^\t]*)\[\/url\]/U", $v78e731027d8fd50ed642340b7c9a63b3, $v9c28d32df234037773be184dbdafc274, PREG_SET_ORDER)) {for ($v865c0c0b4ab0e063e5caa3387c1a8741=0;$v865c0c0b4ab0e063e5caa3387c1a8741<count($v9c28d32df234037773be184dbdafc274);$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vb430fbd4502a780e07e51efa94a18c4a = $v9c28d32df234037773be184dbdafc274[$v865c0c0b4ab0e063e5caa3387c1a8741][1];$v6e024da3f968bfc66443732ff044e5c5 = strlen($vb430fbd4502a780e07e51efa94a18c4a);if ($v6e024da3f968bfc66443732ff044e5c5>40) {$v147d56ae8d4429cac2dedef6bbf357b2 = ceil(($v6e024da3f968bfc66443732ff044e5c5-40)/2);$vfdddf6054c314b389468409e95f9a490 = ceil($v6e024da3f968bfc66443732ff044e5c5/2);$vb430fbd4502a780e07e51efa94a18c4a = substr_replace($vb430fbd4502a780e07e51efa94a18c4a, "...", $vfdddf6054c314b389468409e95f9a490-$v147d56ae8d4429cac2dedef6bbf357b2, $v147d56ae8d4429cac2dedef6bbf357b2*2);}$v78e731027d8fd50ed642340b7c9a63b3 = str_replace($v9c28d32df234037773be184dbdafc274[$v865c0c0b4ab0e063e5caa3387c1a8741][0], "<a href='/go-out.php?url=".$v9c28d32df234037773be184dbdafc274[$v865c0c0b4ab0e063e5caa3387c1a8741][1]."' target='_blank' title='Ссылка откроется в новом окне'>".$vb430fbd4502a780e07e51efa94a18c4a."</a>", $v78e731027d8fd50ed642340b7c9a63b3);}}$v78e731027d8fd50ed642340b7c9a63b3 = str_replace("&", "&amp;", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_ireplace("[QUOTE][QUOTE]", "", $v78e731027d8fd50ed642340b7c9a63b3);if(preg_match_all("/\[smile:([^\]]+)\]/im", $v78e731027d8fd50ed642340b7c9a63b3, $vc68271a63ddbc431c307beb7d2918275)) {foreach($vc68271a63ddbc431c307beb7d2918275[1] as $v61f8faa3b914efa0084edfaf8444fb7e) {$v03c7c0ace395d80182db07ae2c30f034 = $v61f8faa3b914efa0084edfaf8444fb7e;$v61f8faa3b914efa0084edfaf8444fb7e = "images/forum/smiles/" . $v61f8faa3b914efa0084edfaf8444fb7e . ".gif";if(file_exists($v61f8faa3b914efa0084edfaf8444fb7e)) {$v78e731027d8fd50ed642340b7c9a63b3 = str_replace("[smile:" . $v03c7c0ace395d80182db07ae2c30f034 . "]", "<img src='/{$v61f8faa3b914efa0084edfaf8444fb7e}' />", $v78e731027d8fd50ed642340b7c9a63b3);}}}$v78e731027d8fd50ed642340b7c9a63b3 = preg_replace("/<p>(<br \/>)+/", "<p>", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = nl2br($v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_replace("<<br />br /><br />", "", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_replace("<p<br />>", "<p>", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_replace("&amp;quot;", "\"", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_replace("&amp;quote;", "\"", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = html_entity_decode($v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = str_replace("%", "&#37;", $v78e731027d8fd50ed642340b7c9a63b3);$v78e731027d8fd50ed642340b7c9a63b3 = $this->parseTPLMacroses($v78e731027d8fd50ed642340b7c9a63b3);$this->isXSLTResultMode($vc6e04a063682d1a8e122995752335853);return $v78e731027d8fd50ed642340b7c9a63b3;}public function autoDetectAttributes() {if($v7057e8409c7c531a1a6e9ac3df4ed549 = cmsController::getInstance()->getCurrentElementId()) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);if(!$v8e2dcfd7e7e24b1ca76c1193f645902b) return false;if($v346b81a32e7007eccadf60252bb599f0 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue("h1")) {$this->setHeader($v346b81a32e7007eccadf60252bb599f0);}else {$this->setHeader($v8e2dcfd7e7e24b1ca76c1193f645902b->getName());}if($vd5d3db1765287eef77d7927cc956f50a = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue("title")) {$this->setTitle($vd5d3db1765287eef77d7927cc956f50a);}}}public function autoDetectOrders(umiSelection $v8be74552df93e31bbdd6b36ed74bdb6a, $v87306dd4235ed712ebc07fe169b76f83) {if(array_key_exists("order_filter", $_REQUEST)) {$v8be74552df93e31bbdd6b36ed74bdb6a->setOrderFilter();$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);$vdb64cd49d22f58e2d5fc26108f11b181 = getRequest('order_filter');foreach($vdb64cd49d22f58e2d5fc26108f11b181 as $v73f329f154a663bfda020aadcdd0b775 => $vef72c37be9d1b9e6e5bbd6ef09448abe) {if($vef72c37be9d1b9e6e5bbd6ef09448abe === "asc") $vef72c37be9d1b9e6e5bbd6ef09448abe = true;if($vef72c37be9d1b9e6e5bbd6ef09448abe === "desc") $vef72c37be9d1b9e6e5bbd6ef09448abe = false;if($v73f329f154a663bfda020aadcdd0b775 == "name") {$v8be74552df93e31bbdd6b36ed74bdb6a->setOrderByName((bool) $vef72c37be9d1b9e6e5bbd6ef09448abe);continue;}if($v73f329f154a663bfda020aadcdd0b775 == "ord") {$v8be74552df93e31bbdd6b36ed74bdb6a->setOrderByOrd((bool) $vef72c37be9d1b9e6e5bbd6ef09448abe);continue;}if($v599dcce2998a6b40b1e38e8c6006cb0a) {if($v3aabf39f2d943fa886d86dcbbee4d910 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($v73f329f154a663bfda020aadcdd0b775)) {$v8be74552df93e31bbdd6b36ed74bdb6a->setOrderByProperty($v3aabf39f2d943fa886d86dcbbee4d910, (bool) $vef72c37be9d1b9e6e5bbd6ef09448abe);}else {continue;}}}}else {return false;}}public function autoDetectFilters(umiSelection $v8be74552df93e31bbdd6b36ed74bdb6a, $v87306dd4235ed712ebc07fe169b76f83) {if(is_null(getRequest('search-all-text')) == false) {$v23182694bce9f52758fbab174a0b3607 = getRequest('search-all-text');if(is_array($v23182694bce9f52758fbab174a0b3607)) {foreach($v23182694bce9f52758fbab174a0b3607 as $v597a51f04d341eba4ca965899acc10b3) {if($v597a51f04d341eba4ca965899acc10b3) {$v8be74552df93e31bbdd6b36ed74bdb6a->searchText($v597a51f04d341eba4ca965899acc10b3);}}}}if(array_key_exists("fields_filter", $_REQUEST)) {$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$ve98bb545c87bd6f12f14ce797342ef54 = $v8b1dc169bf460ee884fceef66c6607d6->getModule("data");if(!$ve98bb545c87bd6f12f14ce797342ef54) {throw new publicException("Need data module installed to use dynamic filters");}$v8be74552df93e31bbdd6b36ed74bdb6a->setPropertyFilter();$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);$vdb64cd49d22f58e2d5fc26108f11b181 = getRequest('fields_filter');if(!is_array($vdb64cd49d22f58e2d5fc26108f11b181)) {return false;}foreach($vdb64cd49d22f58e2d5fc26108f11b181 as $v73f329f154a663bfda020aadcdd0b775 => $v2063c1608d6e0baf80249c42e2be5804) {if($v73f329f154a663bfda020aadcdd0b775 == "name") {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterName($v8be74552df93e31bbdd6b36ed74bdb6a, $v2063c1608d6e0baf80249c42e2be5804);continue;}if($v3aabf39f2d943fa886d86dcbbee4d910 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($v73f329f154a663bfda020aadcdd0b775)) {$this->isSelectionFiltered = true;$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);$v1e3f04102267eaf5e8d0ca424fd5c561 = $v06e3d36fa30cea095545139854ad1fb9->getFieldTypeId();$v519504d7d4beb745dac24ccfb6c1d7c9 = umiFieldTypesCollection::getInstance()->getFieldType($v1e3f04102267eaf5e8d0ca424fd5c561);$v17f71d965fe9589ddbd11caf7182243e = $v519504d7d4beb745dac24ccfb6c1d7c9->getDataType();switch($v17f71d965fe9589ddbd11caf7182243e) {case "text": {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterText($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}case "wysiwyg": {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterText($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}case "string": {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterText($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}case "tags": {$vfa816edb83e95bf0c8da580bdfd491ef = array_extract_values($v2063c1608d6e0baf80249c42e2be5804);if(empty($vfa816edb83e95bf0c8da580bdfd491ef)) {break;}}case "boolean": {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterBoolean($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}case "int": {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterInt($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}case "symlink":      case "relation": {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterRelation($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}case "float": {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterFloat($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}case "price": {$vfcaea7edd270964cc145ea48e4367d43 = $v8b1dc169bf460ee884fceef66c6607d6->getModule('emarket');if($vfcaea7edd270964cc145ea48e4367d43 instanceof def_module) {$ve7f82a9e3265341d89499a8a0efaa995 = $vfcaea7edd270964cc145ea48e4367d43->getDefaultCurrency();$v5a045cb6d112451dfef1f1d4c97978aa = $vfcaea7edd270964cc145ea48e4367d43->getCurrentCurrency();$vafae32efe0f84fece3f96b377b768b33 = $vfcaea7edd270964cc145ea48e4367d43->formatCurrencyPrice($v2063c1608d6e0baf80249c42e2be5804, $ve7f82a9e3265341d89499a8a0efaa995, $v5a045cb6d112451dfef1f1d4c97978aa);foreach($v2063c1608d6e0baf80249c42e2be5804 as $v6a992d5529f459a44fee58c733255e86 => $vcab8111fd0b710a336c898e539090e34) {$v2063c1608d6e0baf80249c42e2be5804[$v6a992d5529f459a44fee58c733255e86] = getArrayKey($vafae32efe0f84fece3f96b377b768b33, $v6a992d5529f459a44fee58c733255e86);}}$ve98bb545c87bd6f12f14ce797342ef54->applyFilterPrice($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}case "file":      case "img_file":      case "swf_file":      case "boolean": {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterInt($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}case "date": {$ve98bb545c87bd6f12f14ce797342ef54->applyFilterDate($v8be74552df93e31bbdd6b36ed74bdb6a, $v06e3d36fa30cea095545139854ad1fb9, $v2063c1608d6e0baf80249c42e2be5804);break;}default: {break;}}}else {continue;}}}else {return false;}}public function analyzeRequiredPath($vd8f372e47e93e598b92f6e78cb0c9c9f, $v3959c77e55e5cb592d53424d5a5f33ac = true) {if(is_numeric($vd8f372e47e93e598b92f6e78cb0c9c9f)) {return (umiHierarchy::getInstance()->isExists((int) $vd8f372e47e93e598b92f6e78cb0c9c9f)) ? (int) $vd8f372e47e93e598b92f6e78cb0c9c9f : false;}else {$vd8f372e47e93e598b92f6e78cb0c9c9f = trim($vd8f372e47e93e598b92f6e78cb0c9c9f);if($vd8f372e47e93e598b92f6e78cb0c9c9f) {if(strpos($vd8f372e47e93e598b92f6e78cb0c9c9f, " ") === false) {return umiHierarchy::getInstance()->getIdByPath($vd8f372e47e93e598b92f6e78cb0c9c9f);}else {$v627c8d7be6cef603f74903d960f48057 = explode(" ", $vd8f372e47e93e598b92f6e78cb0c9c9f);$vbf516925bb37a8544c8ee19a24e15c05 = Array();foreach($v627c8d7be6cef603f74903d960f48057 as $vc3dafca664a9ef955b76fe1271859e3d) {$vb80bb7740288fda1f201890375a60c8f = $this->analyzeRequiredPath($vc3dafca664a9ef955b76fe1271859e3d, false);if($vb80bb7740288fda1f201890375a60c8f === false) {continue;}else {$vbf516925bb37a8544c8ee19a24e15c05[] = $vb80bb7740288fda1f201890375a60c8f;}}if(sizeof($vbf516925bb37a8544c8ee19a24e15c05) > 0) {return $vbf516925bb37a8544c8ee19a24e15c05;}else {return false;}}}else {if($v3959c77e55e5cb592d53424d5a5f33ac) {return cmsController::getInstance()->getCurrentElementId();}else {return false;}}}}public function checkPostIsEmpty($va190997ca73ac4c36ddff1a28647cec7 = true) {$v9f735923585d489d8baaf23faba610bc = !is_array($_POST) || (is_array($_POST) && !count($_POST));if ($v9f735923585d489d8baaf23faba610bc && $va190997ca73ac4c36ddff1a28647cec7) {$v572d4e421e5e6b9bc11d815e8a027112 = preg_replace("/(\r)|(\n)/", "", $_REQUEST['pre_lang'])."/admin/";header("Location: ".$v572d4e421e5e6b9bc11d815e8a027112);exit();}else {return $v9f735923585d489d8baaf23faba610bc;}}public static function setEventPoint(umiEventPoint $v70e8822b2e035fa3777d666207aeafa8) {umiEventsController::getInstance()->callEvent($v70e8822b2e035fa3777d666207aeafa8);}public function breakMe() {return false;}public function errorRegisterFailPage($vc4f822e3b833533bd91a9ccae200a611) {cmsController::getInstance()->errorUrl = $vc4f822e3b833533bd91a9ccae200a611;}public function errorNewMessage($vd83a5a8080de341e6551f42e0feece88, $v807faf30a1af1d06cf395929b750354c = true, $v0279985cdca9ad2836b5dc949af215c8 = false, $v936118f3c9a8cbff715043c515139eb7 = false) {$v594c103f2c6e04c3d8ab059f031e0c1a = cmsController::getInstance();$v510ff634fce407eea1763854519fd3ce = 'errors_' . $v594c103f2c6e04c3d8ab059f031e0c1a->getRequestId();if(!isset($_SESSION[$v510ff634fce407eea1763854519fd3ce])) {$_SESSION[$v510ff634fce407eea1763854519fd3ce] = Array();}$vd83a5a8080de341e6551f42e0feece88 = $v594c103f2c6e04c3d8ab059f031e0c1a->getCurrentTemplater()->putLangs($vd83a5a8080de341e6551f42e0feece88);$_SESSION[$v510ff634fce407eea1763854519fd3ce][] = Array("message" => $vd83a5a8080de341e6551f42e0feece88,      "code" => $v0279985cdca9ad2836b5dc949af215c8,      "strcode" => $v936118f3c9a8cbff715043c515139eb7);if($v807faf30a1af1d06cf395929b750354c) {$this->errorPanic();}}public function errorPanic() {if(is_null(getRequest('_err')) == false) {return false;}if(self::$noRedirectOnPanic) {$v510ff634fce407eea1763854519fd3ce = 'errors_' . cmsController::getInstance()->getRequestId();if(!isset($_SESSION[$v510ff634fce407eea1763854519fd3ce])) {$_SESSION[$v510ff634fce407eea1763854519fd3ce] = Array();}$vd83a5a8080de341e6551f42e0feece88 = "";foreach($_SESSION[$v510ff634fce407eea1763854519fd3ce] as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v6b3e9cdfd9fd6b6f313d7dd4526c9ceb) {unset($_SESSION[$v510ff634fce407eea1763854519fd3ce][$v865c0c0b4ab0e063e5caa3387c1a8741]);$vd83a5a8080de341e6551f42e0feece88 .= $v6b3e9cdfd9fd6b6f313d7dd4526c9ceb['message'];}throw new errorPanicException($vd83a5a8080de341e6551f42e0feece88);}if($vc4f822e3b833533bd91a9ccae200a611 = cmsController::getInstance()->errorUrl) {$vc4f822e3b833533bd91a9ccae200a611 = preg_replace("/_err=\d+/is", '', $vc4f822e3b833533bd91a9ccae200a611);while (strpos($vc4f822e3b833533bd91a9ccae200a611, '&&') !== false || strpos($vc4f822e3b833533bd91a9ccae200a611, '??') !== false || strpos($vc4f822e3b833533bd91a9ccae200a611, '?&') !== false) {$vc4f822e3b833533bd91a9ccae200a611 = str_replace('&&', '&', $vc4f822e3b833533bd91a9ccae200a611);$vc4f822e3b833533bd91a9ccae200a611 = str_replace('??', '?', $vc4f822e3b833533bd91a9ccae200a611);$vc4f822e3b833533bd91a9ccae200a611 = str_replace('?&', '?', $vc4f822e3b833533bd91a9ccae200a611);}if (strlen($vc4f822e3b833533bd91a9ccae200a611) && (substr($vc4f822e3b833533bd91a9ccae200a611, -1) === '?' || substr($vc4f822e3b833533bd91a9ccae200a611, -1) === '&')) $vc4f822e3b833533bd91a9ccae200a611 = substr($vc4f822e3b833533bd91a9ccae200a611, 0, strlen($vc4f822e3b833533bd91a9ccae200a611)-1);$v10eaf019ae9a34467652d52158eae042 = (strpos($vc4f822e3b833533bd91a9ccae200a611, '?') === false ? '?' : '&');$vc4f822e3b833533bd91a9ccae200a611 .= $v10eaf019ae9a34467652d52158eae042 . "_err=" . cmsController::getInstance()->getRequestId();$this->redirect($vc4f822e3b833533bd91a9ccae200a611, false);}else {throw new privateException("Can't find error redirect string");}}public function importDataTypes() {$v4898220f0b67da1137954c79f361f57f = dirname(__FILE__)."/".get_class($this)."/types.xml";$ve2592cf92e2fae115a396849ff39f8ad = new umiModuleDataImporter();$v6da648158add0c53655351ff6ac29a12 = $ve2592cf92e2fae115a396849ff39f8ad->loadXmlFile($v4898220f0b67da1137954c79f361f57f);if ($v6da648158add0c53655351ff6ac29a12) {$ve2592cf92e2fae115a396849ff39f8ad->import();return "data types imported ok";}else {return "can not import data from file '".$v4898220f0b67da1137954c79f361f57f."'";}}public function exportDataTypes() {$v4898220f0b67da1137954c79f361f57f = dirname(__FILE__)."/".get_class($this)."/types.xml";$ve94eaa63103b9ede00e3c5ff5a778f56 = new umiModuleDataExporter(get_class($this));$v00d8ecaf9351b32f104d83c400f6d181 = $ve94eaa63103b9ede00e3c5ff5a778f56->getXml();$ve3230b4db6a8e43553feaab2def2ccb3 = file_put_contents($v4898220f0b67da1137954c79f361f57f, $v00d8ecaf9351b32f104d83c400f6d181);if ($ve3230b4db6a8e43553feaab2def2ccb3 === false) {return "can not write to file '".$v4898220f0b67da1137954c79f361f57f."'";}else {@chmod($v4898220f0b67da1137954c79f361f57f, 0777);return $ve3230b4db6a8e43553feaab2def2ccb3." bytes exported to the file '".$v4898220f0b67da1137954c79f361f57f."' successfully";}}public function guessDomain() {$v9b207167e5381c47682c6b4f58a623fb = false;for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;($veca07335a33c5aeb5e1bc7c98b4b9d80 = getRequest("param" . $v865c0c0b4ab0e063e5caa3387c1a8741)) || $v865c0c0b4ab0e063e5caa3387c1a8741 <= 3;$v865c0c0b4ab0e063e5caa3387c1a8741++) {if(is_numeric($veca07335a33c5aeb5e1bc7c98b4b9d80)) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($veca07335a33c5aeb5e1bc7c98b4b9d80);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$v662cbf1253ac7d8750ed9190c52163e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();if($v662cbf1253ac7d8750ed9190c52163e5) $v9b207167e5381c47682c6b4f58a623fb = $v662cbf1253ac7d8750ed9190c52163e5;}else {continue;}}else {continue;}}$vad5f82e879a9c5d6b5b442eb37e50551 = domainsCollection::getInstance()->getDomain($v9b207167e5381c47682c6b4f58a623fb);if($vad5f82e879a9c5d6b5b442eb37e50551 instanceof iDomain) {return $vad5f82e879a9c5d6b5b442eb37e50551->getHost();}else {return false;}}public static function pushEditable($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb80bb7740288fda1f201890375a60c8f) {umiTemplater::pushEditable($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb80bb7740288fda1f201890375a60c8f);}public function isMethodExists($_sMethodName) {if(class_exists('ReflectionClass')) {$va29fd518fa2a9b10f0cdaa6311ae9112 = new ReflectionClass($this);if($va29fd518fa2a9b10f0cdaa6311ae9112->hasMethod($_sMethodName)) {return true;}foreach($this->__classes as $v26b2a720f7b8c9bd8d3999c52da409d0) {$va29fd518fa2a9b10f0cdaa6311ae9112 = new ReflectionClass($v26b2a720f7b8c9bd8d3999c52da409d0);if($va29fd518fa2a9b10f0cdaa6311ae9112->hasMethod($_sMethodName)) {return true;}}if ($_sMethodName == 'tagsDomainCloud') {}return false;}else {$vd3a52c495071e7fbfb7dbdbfcd302b47 = get_class_methods($this);if(in_array($_sMethodName, $vd3a52c495071e7fbfb7dbdbfcd302b47)) {return true;}foreach($this->__classes as $v26b2a720f7b8c9bd8d3999c52da409d0) {$vd3a52c495071e7fbfb7dbdbfcd302b47 = get_class_methods($v26b2a720f7b8c9bd8d3999c52da409d0);if(in_array($_sMethodName, $vd3a52c495071e7fbfb7dbdbfcd302b47)) {return true;}}return false;}}public function flushAsXML($vddaa6e8c8c412299272e183087b8f7b6) {static $v4a8a08f09d37b73795649038408b5f33 = 0;if($v4a8a08f09d37b73795649038408b5f33++ == 0) {$v0f635d0e0f3874fff8b581c132e6c7a7 = true;if (getRequest('jsonMode') == 'force') {$v0f635d0e0f3874fff8b581c132e6c7a7 = false;}$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v7f2db423a49b305459147332fb01cf87->contentType('text/' . ($v0f635d0e0f3874fff8b581c132e6c7a7 ? 'xml' : 'javascript'));$v7f2db423a49b305459147332fb01cf87->charset('utf-8');$v7f2db423a49b305459147332fb01cf87->clear();$v7f2db423a49b305459147332fb01cf87->push(file_get_contents("udata://" . get_class($this) . "/" . $vddaa6e8c8c412299272e183087b8f7b6 . ($v0f635d0e0f3874fff8b581c132e6c7a7 ? '' : '.json')));$v7f2db423a49b305459147332fb01cf87->end();}}public function ifNotXmlMode() {if(getRequest('xmlMode') != 'force') {$this->setData(array('message' => 'This method returns result only by direct xml call'));return true;}}public function removeErrorParam($v572d4e421e5e6b9bc11d815e8a027112) {return preg_replace("/_err=\d+/", "", $v572d4e421e5e6b9bc11d815e8a027112);}public function getObjectEditLink($v16b2b26000987faccb260b9d39df1269, $v599dcce2998a6b40b1e38e8c6006cb0a = false) {return false;}public static function validateTemplate(&$v918d83c715c19dd93ff49f87e2fae0b3) {if(!$v918d83c715c19dd93ff49f87e2fae0b3 && $v918d83c715c19dd93ff49f87e2fae0b3 == 'default' && self::$defaultTemplateName != 'default') {$v918d83c715c19dd93ff49f87e2fae0b3 = self::$defaultTemplateName;}}public function templatesMode($v15d61712450a686a7f365adf4fef581f) {$vb0efae39904aed41aca525e2d7ccb04f = self::isXSLTResultMode();if($v15d61712450a686a7f365adf4fef581f == 'xslt' && !$vb0efae39904aed41aca525e2d7ccb04f) {throw new xsltOnlyException;}if($v15d61712450a686a7f365adf4fef581f == 'tpl' && $vb0efae39904aed41aca525e2d7ccb04f) {throw new tplOnlyException;}}public static function isXSLTResultMode($v7f7cfde5ec586119b48911a2c75851e5 = null) {if (is_null(self::$xsltResultMode)) {self::$xsltResultMode = cmsController::getInstance()->getCurrentTemplater() instanceof umiTemplaterXSLT;}if (!is_null($v7f7cfde5ec586119b48911a2c75851e5)) {$v0382b9fd9ef50b6a335f35e0aaaebf99 = self::$xsltResultMode;self::$xsltResultMode = (bool) $v7f7cfde5ec586119b48911a2c75851e5;return $v0382b9fd9ef50b6a335f35e0aaaebf99;}return self::$xsltResultMode;}public function validateEntityByTypes($vf5e638cc78dd325906c1298a0c21fb6b, $vd14a8022b085f9ef19d479cbdd581127, $vdb36e6e135266266c261c3ea07a88855 = false) {if($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiHierarchyElement) {$v22884db148f0ffb0d830ba431102b0b5 = $vf5e638cc78dd325906c1298a0c21fb6b->getModule();$vea9f6aca279138c58f705c8d4cb4b8ce = $vf5e638cc78dd325906c1298a0c21fb6b->getMethod();}else if($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiObject) {$v726e8e4809d4c1b28a6549d86436a124 = selector::get('object-type')->id($vf5e638cc78dd325906c1298a0c21fb6b->getTypeId());if($vdb36e6e135266266c261c3ea07a88855) {$v726e8e4809d4c1b28a6549d86436a124 = selector::get('object-type')->id($v726e8e4809d4c1b28a6549d86436a124->getParentId());}if($vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v726e8e4809d4c1b28a6549d86436a124->getHierarchyTypeId()) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = selector::get('hierarchy-type')->id($vacf567c9c3d6cf7c6e2cc0ce108e0631);$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule();$vea9f6aca279138c58f705c8d4cb4b8ce = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getMethod();}else {$v22884db148f0ffb0d830ba431102b0b5 = null;$vea9f6aca279138c58f705c8d4cb4b8ce = null;}}else {throw new publicException("Page or object must be given");}if(is_null($v22884db148f0ffb0d830ba431102b0b5) && is_null($vea9f6aca279138c58f705c8d4cb4b8ce) && is_null($vd14a8022b085f9ef19d479cbdd581127)) {return true;}if($v22884db148f0ffb0d830ba431102b0b5 == 'content' && $vea9f6aca279138c58f705c8d4cb4b8ce == '') {$vea9f6aca279138c58f705c8d4cb4b8ce = 'page';}if(getArrayKey($vd14a8022b085f9ef19d479cbdd581127, 'module')) {$vd14a8022b085f9ef19d479cbdd581127 = array($vd14a8022b085f9ef19d479cbdd581127);}foreach($vd14a8022b085f9ef19d479cbdd581127 as $v599dcce2998a6b40b1e38e8c6006cb0a) {$v34fcf34df8c8ba155d0eaed678a799d7 = getArrayKey($v599dcce2998a6b40b1e38e8c6006cb0a, 'module');$ve0ffc5711775f5b9d18ed1235050612f = getArrayKey($v599dcce2998a6b40b1e38e8c6006cb0a, 'method');if($v34fcf34df8c8ba155d0eaed678a799d7 == 'content' && $ve0ffc5711775f5b9d18ed1235050612f == '') {$ve0ffc5711775f5b9d18ed1235050612f = 'page';}if($v34fcf34df8c8ba155d0eaed678a799d7 == $v22884db148f0ffb0d830ba431102b0b5) {if(is_null($ve0ffc5711775f5b9d18ed1235050612f)) return;if($ve0ffc5711775f5b9d18ed1235050612f == $vea9f6aca279138c58f705c8d4cb4b8ce) return;}}throw new publicException(getLabel('error-common-type-mismatch'));}public function is_demo() {return defined('CURRENT_VERSION_LINE') && CURRENT_VERSION_LINE == 'demo';}public function errorAddErrors($v07213a0161f52846ab198be103b5ab43) {$result = array();if ($v07213a0161f52846ab198be103b5ab43 instanceof Exception) {$vcb5e100e5a9a3e7f6d1fd97512215282 = array(    'message' => $v07213a0161f52846ab198be103b5ab43->getMessage(),    'code' => $v07213a0161f52846ab198be103b5ab43->getCode(),    );return array_push($this->errors, $vcb5e100e5a9a3e7f6d1fd97512215282);}elseif (is_array($v07213a0161f52846ab198be103b5ab43)) {if (array_key_exists('message', $v07213a0161f52846ab198be103b5ab43)) {$vcb5e100e5a9a3e7f6d1fd97512215282 = array_intersect_key($v07213a0161f52846ab198be103b5ab43, array('message'=>'', 'code'=>''));return array_push($this->errors, $vcb5e100e5a9a3e7f6d1fd97512215282);}else {foreach ($v07213a0161f52846ab198be103b5ab43 as $vcb5e100e5a9a3e7f6d1fd97512215282) {$result[] = $this->errorAddErrors($vcb5e100e5a9a3e7f6d1fd97512215282);}return $result;}}elseif (is_string($v07213a0161f52846ab198be103b5ab43)) {return array_push($this->errors, array('message' => $v07213a0161f52846ab198be103b5ab43));}return false;}protected function errorSetErrors () {}public function errorGetErrors() {return $this->errors;}public function errorHasErrors() {return (!empty($this->errors));}public function errorSetErrorPage($v4d9d5a42cba3225418d79c0fa9eece0f) {$v4d9d5a42cba3225418d79c0fa9eece0f = preg_replace('#http://[^/]+#', '', trim($v4d9d5a42cba3225418d79c0fa9eece0f));$v4d9d5a42cba3225418d79c0fa9eece0f = preg_replace("/_err=\d+/is", '', $v4d9d5a42cba3225418d79c0fa9eece0f);while (strpos($v4d9d5a42cba3225418d79c0fa9eece0f, '&&') !== false || strpos($v4d9d5a42cba3225418d79c0fa9eece0f, '??') !== false || strpos($v4d9d5a42cba3225418d79c0fa9eece0f, '?&') !== false) {$v4d9d5a42cba3225418d79c0fa9eece0f = str_replace('&&', '&', $v4d9d5a42cba3225418d79c0fa9eece0f);$v4d9d5a42cba3225418d79c0fa9eece0f = str_replace('??', '?', $v4d9d5a42cba3225418d79c0fa9eece0f);$v4d9d5a42cba3225418d79c0fa9eece0f = str_replace('?&', '?', $v4d9d5a42cba3225418d79c0fa9eece0f);}if (strlen($v4d9d5a42cba3225418d79c0fa9eece0f) && (substr($v4d9d5a42cba3225418d79c0fa9eece0f, -1) === '?' || substr($v4d9d5a42cba3225418d79c0fa9eece0f, -1) === '&')) {$v4d9d5a42cba3225418d79c0fa9eece0f = substr($v4d9d5a42cba3225418d79c0fa9eece0f, 0, strlen($v4d9d5a42cba3225418d79c0fa9eece0f)-1);}$this->errorPage = $v4d9d5a42cba3225418d79c0fa9eece0f;return true;}public function errorGetErrorPage() {return $this->errorPage;}public function errorThrow($v15d61712450a686a7f365adf4fef581f = false) {if (!$this->errorHasErrors()) {return false;}if(self::$noRedirectOnPanic) {$vd83a5a8080de341e6551f42e0feece88 = '';foreach ($this->errors as $vcb5e100e5a9a3e7f6d1fd97512215282) {$vd83a5a8080de341e6551f42e0feece88 .= getLabel($vcb5e100e5a9a3e7f6d1fd97512215282['message']) . ' ';}$this->errors = array();throw new errorPanicException($vd83a5a8080de341e6551f42e0feece88);}switch ($v15d61712450a686a7f365adf4fef581f) {case 'public' : {$this->errorThrowPublic();break;}case 'admin' : {$this->errorThrowAdmin();break;}case 'xml' : {$v07213a0161f52846ab198be103b5ab43 = array();foreach ($this->errors as $vcb5e100e5a9a3e7f6d1fd97512215282) {$v07213a0161f52846ab198be103b5ab43[] = getLabel($vcb5e100e5a9a3e7f6d1fd97512215282['message']);}$this->errors = array();throw new wrongValueException('<br/>' . implode("<br/><br/>", $v07213a0161f52846ab198be103b5ab43));}}}private function errorThrowPublic() {foreach ($this->errors as &$vcb5e100e5a9a3e7f6d1fd97512215282) {$vcb5e100e5a9a3e7f6d1fd97512215282['message'] = '%' . $vcb5e100e5a9a3e7f6d1fd97512215282['message'] . '%';}$this->errorRedirect();}private function errorThrowAdmin () {foreach ($this->errors as &$vcb5e100e5a9a3e7f6d1fd97512215282) {$vcb5e100e5a9a3e7f6d1fd97512215282['message'] = getLabel($vcb5e100e5a9a3e7f6d1fd97512215282['message']);}$this->errorRedirect();}private function errorRedirect () {$v510ff634fce407eea1763854519fd3ce = 'errors_' . cmsController::getInstance()->getRequestId();$_SESSION[$v510ff634fce407eea1763854519fd3ce] = $this->errors;if($vc4f822e3b833533bd91a9ccae200a611 = $this->errorPage) {$v10eaf019ae9a34467652d52158eae042 = (strpos($vc4f822e3b833533bd91a9ccae200a611, '?') === false ? '?' : '&');$vc4f822e3b833533bd91a9ccae200a611 .= $v10eaf019ae9a34467652d52158eae042 . "_err=" . cmsController::getInstance()->getRequestId();$this->errors = array();$this->redirect($vc4f822e3b833533bd91a9ccae200a611, false);}else {$this->errors = array();throw new privateException("Can't find error redirect string");}}};class umiBranch {public static function checkIfBranchedByHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631) {return false;}public static function getBranchedTableByTypeId($v6301cee35ea764a1e241978f93f01069) {return "cms3_object_content";}public static function saveBranchedTablesRelations() {return true;}};class umiEventPoint {public function setParam() {}public function getParam() {}public function &getRef() {}public function setMode() {}public function getMode() {}public function addRef() {}public function call() {}public function getEventId() {return false;}};class umiEventListener {public function setPriority() {}public function getPriority() {}public function setIsCritical() {}public function getIsCritical() {}public function getEventId() {}public function getCallbackModule() {}public function getCallbackMethod() {}}class umiEventsController {private static $oInstance  = null;public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = NULL) {if(self::$oInstance == null) {self::$oInstance = new umiEventsController();}return self::$oInstance;}public function callEvent() {}static public function registerEventListener() {}}?>